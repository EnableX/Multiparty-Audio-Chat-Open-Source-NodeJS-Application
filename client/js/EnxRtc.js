/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 @license  MIT
 Socket.IO v4.4.1
 (c) 2014-2022 Guillermo Rauch
 Released under the MIT License.
*/
var $jscomp$templatelit$1=['\n    <ul class="','">\n      ',"\n    </ul>\n  "];$jscomp$templatelit$1.raw=$jscomp$templatelit$1.slice();var $jscomp$templatelit$0=['\n        <li class="','">',"</li>\n      "];$jscomp$templatelit$0.raw=$jscomp$templatelit$0.slice();var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(l){var r=0;return function(){return r<l.length?{done:!1,value:l[r++]}:{done:!0}}};$jscomp.arrayIterator=function(l){return{next:$jscomp.arrayIteratorImpl(l)}};
$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(l,r,n){l!=Array.prototype&&l!=Object.prototype&&(l[r]=n.value)};$jscomp.getGlobal=function(l){return"undefined"!=typeof window&&window===l?l:"undefined"!=typeof global&&null!=global?global:l};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(l,r){this.$jscomp$symbol$id_=l;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:r})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function l(n){if(this instanceof l)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(n||"")+"_"+r++,n)}var r=0;return l}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var l=$jscomp.global.Symbol.iterator;l||(l=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[l]&&$jscomp.defineProperty(Array.prototype,l,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var l=$jscomp.global.Symbol.asyncIterator;l||(l=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(l){$jscomp.initSymbolIterator();l={next:l};l[$jscomp.global.Symbol.iterator]=function(){return this};return l};
$jscomp.makeIterator=function(l){var r="undefined"!=typeof Symbol&&Symbol.iterator&&l[Symbol.iterator];return r?r.call(l):$jscomp.arrayIterator(l)};$jscomp.arrayFromIterator=function(l){for(var r,n=[];!(r=l.next()).done;)n.push(r.value);return n};$jscomp.arrayFromIterable=function(l){return l instanceof Array?l:$jscomp.arrayFromIterator($jscomp.makeIterator(l))};$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(l){var r=function(){};r.prototype=l;return new r};
$jscomp.underscoreProtoCanBeSet=function(){var l={a:!0},r={};try{return r.__proto__=l,r.a}catch(n){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(l,r){l.__proto__=r;if(l.__proto__!==r)throw new TypeError(l+" is not extensible");return l}:null;
$jscomp.inherits=function(l,r){l.prototype=$jscomp.objectCreate(r.prototype);l.prototype.constructor=l;if($jscomp.setPrototypeOf){var n=$jscomp.setPrototypeOf;n(l,r)}else for(n in r)if("prototype"!=n)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(r,n);e&&Object.defineProperty(l,n,e)}else l[n]=r[n];l.superClass_=r.prototype};
$jscomp.polyfill=function(l,r,n,e){if(r){n=$jscomp.global;l=l.split(".");for(e=0;e<l.length-1;e++){var u=l[e];u in n||(n[u]={});n=n[u]}l=l[l.length-1];e=n[l];r=r(e);r!=e&&null!=r&&$jscomp.defineProperty(n,l,{configurable:!0,writable:!0,value:r})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(l){function r(){this.batch_=null}function n(d){return d instanceof u?d:new u(function(a,b){a(d)})}if(l&&!$jscomp.FORCE_POLYFILL_PROMISE)return l;r.prototype.asyncExecute=function(d){if(null==this.batch_){this.batch_=[];var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})}this.batch_.push(d)};var e=$jscomp.global.setTimeout;r.prototype.asyncExecuteFunction=function(d){e(d,0)};r.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var d=
this.batch_;this.batch_=[];for(var a=0;a<d.length;++a){var b=d[a];d[a]=null;try{b()}catch(g){this.asyncThrow_(g)}}}this.batch_=null};r.prototype.asyncThrow_=function(d){this.asyncExecuteFunction(function(){throw d;})};var u=function(d){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{d(a.resolve,a.reject)}catch(b){a.reject(b)}};u.prototype.createResolveAndReject_=function(){function d(g){return function(d){b||(b=!0,g.call(a,d))}}var a=this,b=!1;
return{resolve:d(this.resolveTo_),reject:d(this.reject_)}};u.prototype.resolveTo_=function(d){if(d===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(d instanceof u)this.settleSameAsPromise_(d);else{a:switch(typeof d){case "object":var a=null!=d;break a;case "function":a=!0;break a;default:a=!1}a?this.resolveToNonPromiseObj_(d):this.fulfill_(d)}};u.prototype.resolveToNonPromiseObj_=function(d){var a=void 0;try{a=d.then}catch(b){this.reject_(b);return}"function"==typeof a?
this.settleSameAsThenable_(a,d):this.fulfill_(d)};u.prototype.reject_=function(d){this.settle_(2,d)};u.prototype.fulfill_=function(d){this.settle_(1,d)};u.prototype.settle_=function(d,a){if(0!=this.state_)throw Error("Cannot settle("+d+", "+a+"): Promise already settled in state"+this.state_);this.state_=d;this.result_=a;this.executeOnSettledCallbacks_()};u.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var d=0;d<this.onSettledCallbacks_.length;++d)m.asyncExecute(this.onSettledCallbacks_[d]);
this.onSettledCallbacks_=null}};var m=new r;u.prototype.settleSameAsPromise_=function(d){var a=this.createResolveAndReject_();d.callWhenSettled_(a.resolve,a.reject)};u.prototype.settleSameAsThenable_=function(d,a){var b=this.createResolveAndReject_();try{d.call(a,b.resolve,b.reject)}catch(g){b.reject(g)}};u.prototype.then=function(d,a){function b(a,b){return"function"==typeof a?function(k){try{g(a(k))}catch(w){e(w)}}:b}var g,e,p=new u(function(a,b){g=a;e=b});this.callWhenSettled_(b(d,g),b(a,e));return p};
u.prototype.catch=function(d){return this.then(void 0,d)};u.prototype.callWhenSettled_=function(d,a){function b(){switch(g.state_){case 1:d(g.result_);break;case 2:a(g.result_);break;default:throw Error("Unexpected state: "+g.state_);}}var g=this;null==this.onSettledCallbacks_?m.asyncExecute(b):this.onSettledCallbacks_.push(b)};u.resolve=n;u.reject=function(d){return new u(function(a,b){b(d)})};u.race=function(d){return new u(function(a,b){for(var g=$jscomp.makeIterator(d),e=g.next();!e.done;e=g.next())n(e.value).callWhenSettled_(a,
b)})};u.all=function(d){var a=$jscomp.makeIterator(d),b=a.next();return b.done?n([]):new u(function(g,d){function p(a){return function(b){k[a]=b;e--;0==e&&g(k)}}var k=[],e=0;do k.push(void 0),e++,n(b.value).callWhenSettled_(p(k.length-1),d),b=a.next();while(!b.done)})};return u},"es6","es3");$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(l){if(!(l instanceof Object))throw new TypeError("Iterator result "+l+" is not an object");};
$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};
$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(l){this.yieldResult=l};$jscomp.generator.Context.prototype.throw_=function(l){this.abruptCompletion_={exception:l,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(l){this.abruptCompletion_={return:l};this.nextAddress=this.finallyAddress_};
$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(l){this.abruptCompletion_={jumpTo:l};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(l,r){this.nextAddress=r;return{value:l}};$jscomp.generator.Context.prototype.yieldAll=function(l,r){l=$jscomp.makeIterator(l);var n=l.next();$jscomp.generator.ensureIteratorResultIsObject_(n);if(n.done)this.yieldResult=n.value,this.nextAddress=r;else return this.yieldAllIterator_=l,this.yield(n.value,r)};
$jscomp.generator.Context.prototype.jumpTo=function(l){this.nextAddress=l};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(l,r){this.catchAddress_=l;void 0!=r&&(this.finallyAddress_=r)};$jscomp.generator.Context.prototype.setFinallyBlock=function(l){this.catchAddress_=0;this.finallyAddress_=l||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(l,r){this.nextAddress=l;this.catchAddress_=r||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(l){this.catchAddress_=l||0;l=this.abruptCompletion_.exception;this.abruptCompletion_=null;return l};$jscomp.generator.Context.prototype.enterFinallyBlock=function(l,r,n){n?this.finallyContexts_[n]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=l||0;this.finallyAddress_=r||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(l,r){r=this.finallyContexts_.splice(r||0)[0];if(r=this.abruptCompletion_=this.abruptCompletion_||r){if(r.isException)return this.jumpToErrorHandler_();void 0!=r.jumpTo&&this.finallyAddress_<r.jumpTo?(this.nextAddress=r.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=l};$jscomp.generator.Context.prototype.forIn=function(l){return new $jscomp.generator.Context.PropertyIterator(l)};
$jscomp.generator.Context.PropertyIterator=function(l){this.object_=l;this.properties_=[];for(var r in l)this.properties_.push(r);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var l=this.properties_.pop();if(l in this.object_)return l}return null};$jscomp.generator.Engine_=function(l){this.context_=new $jscomp.generator.Context;this.program_=l};
$jscomp.generator.Engine_.prototype.next_=function(l){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,l,this.context_.next_);this.context_.next_(l);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(l){this.context_.start_();var r=this.context_.yieldAllIterator_;if(r)return this.yieldAllStep_("return"in r?r["return"]:function(l){return{value:l,done:!0}},l,this.context_.return);this.context_.return(l);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(l){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],l,this.context_.next_);this.context_.throw_(l);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(l,r,n){try{var e=l.call(this.context_.yieldAllIterator_,r);$jscomp.generator.ensureIteratorResultIsObject_(e);if(!e.done)return this.context_.stop_(),e;var u=e.value}catch(m){return this.context_.yieldAllIterator_=null,this.context_.throw_(m),this.nextStep_()}this.context_.yieldAllIterator_=null;n.call(this.context_,u);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var l=this.program_(this.context_);if(l)return this.context_.stop_(),{value:l.value,done:!1}}catch(r){this.context_.yieldResult=void 0,this.context_.throw_(r)}this.context_.stop_();if(this.context_.abruptCompletion_){l=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(l.isException)throw l.exception;return{value:l.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(l){this.next=function(r){return l.next_(r)};this.throw=function(r){return l.throw_(r)};this.return=function(r){return l.return_(r)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(l,r){r=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(r));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(r,l.prototype);return r};
$jscomp.asyncExecutePromiseGenerator=function(l){function r(e){return l.next(e)}function n(e){return l.throw(e)}return new Promise(function(e,u){function m(d){d.done?e(d.value):Promise.resolve(d.value).then(r,n).then(m,u)}m(l.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(l){return $jscomp.asyncExecutePromiseGenerator(l())};$jscomp.asyncExecutePromiseGeneratorProgram=function(l){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(l)))};
$jscomp.iteratorFromArray=function(l,r){$jscomp.initSymbolIterator();l instanceof String&&(l+="");var n=0,e={next:function(){if(n<l.length){var u=n++;return{value:r(u,l[u]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};$jscomp.polyfill("Array.prototype.keys",function(l){return l?l:function(){return $jscomp.iteratorFromArray(this,function(l){return l})}},"es6","es3");
$jscomp.polyfill("Object.is",function(l){return l?l:function(l,n){return l===n?0!==l||1/l===1/n:l!==l&&n!==n}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(l){return l?l:function(l,n){var e=this;e instanceof String&&(e=String(e));var u=e.length;n=n||0;for(0>n&&(n=Math.max(n+u,0));n<u;n++){var m=e[n];if(m===l||Object.is(m,l))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(l,r,n){if(null==l)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(r instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return l+""};$jscomp.polyfill("String.prototype.includes",function(l){return l?l:function(l,n){return-1!==$jscomp.checkStringArgs(this,l,"includes").indexOf(l,n||0)}},"es6","es3");
$jscomp.owns=function(l,r){return Object.prototype.hasOwnProperty.call(l,r)};$jscomp.polyfill("Object.entries",function(l){return l?l:function(l){var n=[],e;for(e in l)$jscomp.owns(l,e)&&n.push([e,l[e]]);return n}},"es8","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var l={},r=Object.create(new $jscomp.global.Proxy(l,{get:function(n,e,u){return n==l&&"q"==e&&u==r}}));return!0===r.q}catch(n){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();
$jscomp.polyfill("WeakMap",function(l){function r(){if(!l||!Object.seal)return!1;try{var a=Object.seal({}),b=Object.seal({}),d=new l([[a,2],[b,3]]);if(2!=d.get(a)||3!=d.get(b))return!1;d.delete(a);d.set(b,4);return!d.has(a)&&4==d.get(b)}catch(k){return!1}}function n(){}function e(a){var b=typeof a;return"object"===b&&null!==a||"function"===b}function u(a){if(!$jscomp.owns(a,d)){var b=new n;$jscomp.defineProperty(a,d,{value:b})}}function m(a){var b=Object[a];b&&(Object[a]=function(a){if(a instanceof
n)return a;u(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(l&&$jscomp.ES6_CONFORMANCE)return l}else if(r())return l;var d="$jscomp_hidden_"+Math.random();m("freeze");m("preventExtensions");m("seal");var a=0,b=function(b){this.id_=(a+=Math.random()+1).toString();if(b){b=$jscomp.makeIterator(b);for(var g;!(g=b.next()).done;)g=g.value,this.set(g[0],g[1])}};b.prototype.set=function(a,b){if(!e(a))throw Error("Invalid WeakMap key");u(a);if(!$jscomp.owns(a,d))throw Error("WeakMap key fail: "+
a);a[d][this.id_]=b;return this};b.prototype.get=function(a){return e(a)&&$jscomp.owns(a,d)?a[d][this.id_]:void 0};b.prototype.has=function(a){return e(a)&&$jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)};b.prototype.delete=function(a){return e(a)&&$jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)?delete a[d][this.id_]:!1};return b},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(l){function r(){if($jscomp.ASSUME_NO_NATIVE_MAP||!l||"function"!=typeof l||!l.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),g=new l($jscomp.makeIterator([[a,"s"]]));if("s"!=g.get(a)||1!=g.size||g.get({x:4})||g.set({x:4},"t")!=g||2!=g.size)return!1;var d=g.entries(),p=d.next();if(p.done||p.value[0]!=a||"s"!=p.value[1])return!1;p=d.next();return p.done||4!=p.value[0].x||"t"!=p.value[1]||!d.next().done?!1:!0}catch(k){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(l&&$jscomp.ES6_CONFORMANCE)return l}else if(r())return l;$jscomp.initSymbolIterator();var n=new WeakMap,e=function(a){this.data_={};this.head_=d();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};e.prototype.set=function(a,g){a=0===a?0:a;var b=u(this,a);b.list||(b.list=this.data_[b.id]=[]);b.entry?b.entry.value=g:(b.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:g},b.list.push(b.entry),this.head_.previous.next=b.entry,this.head_.previous=b.entry,this.size++);return this};e.prototype.delete=function(a){a=u(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};e.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=d();this.size=0};e.prototype.has=function(a){return!!u(this,a).entry};
e.prototype.get=function(a){return(a=u(this,a).entry)&&a.value};e.prototype.entries=function(){return m(this,function(a){return[a.key,a.value]})};e.prototype.keys=function(){return m(this,function(a){return a.key})};e.prototype.values=function(){return m(this,function(a){return a.value})};e.prototype.forEach=function(a,g){for(var b=this.entries(),d;!(d=b.next()).done;)d=d.value,a.call(g,d[1],d[0],this)};e.prototype[Symbol.iterator]=e.prototype.entries;var u=function(b,g){var d=g&&typeof g;"object"==
d||"function"==d?n.has(g)?d=n.get(g):(d=""+ ++a,n.set(g,d)):d="p_"+g;var p=b.data_[d];if(p&&$jscomp.owns(b.data_,d))for(b=0;b<p.length;b++){var k=p[b];if(g!==g&&k.key!==k.key||g===k.key)return{id:d,list:p,index:b,entry:k}}return{id:d,list:p,index:-1,entry:void 0}},m=function(a,g){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:g(b)};b=null}return{done:!0,value:void 0}})},d=function(){var a={};return a.previous=
a.next=a.head=a},a=0;return e},"es6","es3");$jscomp.assign="function"==typeof Object.assign?Object.assign:function(l,r){for(var n=1;n<arguments.length;n++){var e=arguments[n];if(e)for(var u in e)$jscomp.owns(e,u)&&(l[u]=e[u])}return l};$jscomp.polyfill("Object.assign",function(l){return l||$jscomp.assign},"es6","es3");$jscomp.polyfill("Object.values",function(l){return l?l:function(l){var n=[],e;for(e in l)$jscomp.owns(l,e)&&n.push(l[e]);return n}},"es8","es3");
$jscomp.polyfill("Math.log10",function(l){return l?l:function(l){return Math.log(l)/Math.LN10}},"es6","es3");$jscomp.polyfill("Array.from",function(l){return l?l:function(l,n,e){n=null!=n?n:function(a){return a};var u=[],m="undefined"!=typeof Symbol&&Symbol.iterator&&l[Symbol.iterator];if("function"==typeof m){l=m.call(l);for(var d=0;!(m=l.next()).done;)u.push(n.call(e,m.value,d++))}else for(m=l.length,d=0;d<m;d++)u.push(n.call(e,l[d],d));return u}},"es6","es3");
$jscomp.findInternal=function(l,r,n){l instanceof String&&(l=String(l));for(var e=l.length,u=0;u<e;u++){var m=l[u];if(r.call(n,m,u,l))return{i:u,v:m}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(l){return l?l:function(l,n){return $jscomp.findInternal(this,l,n).v}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(l){return l?l:function(l,n,e){var u=this.length||0;0>n&&(n=Math.max(0,u+n));if(null==e||e>u)e=u;e=Number(e);0>e&&(e=Math.max(0,u+e));for(n=Number(n||0);n<e;n++)this[n]=l;return this}},"es6","es3");$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6","es3");
$jscomp.polyfill("Set",function(l){function r(){if($jscomp.ASSUME_NO_NATIVE_SET||!l||"function"!=typeof l||!l.prototype.entries||"function"!=typeof Object.seal)return!1;try{var e=Object.seal({x:4}),u=new l($jscomp.makeIterator([e]));if(!u.has(e)||1!=u.size||u.add(e)!=u||1!=u.size||u.add({x:4})!=u||2!=u.size)return!1;var m=u.entries(),d=m.next();if(d.done||d.value[0]!=e||d.value[1]!=e)return!1;d=m.next();return d.done||d.value[0]==e||4!=d.value[0].x||d.value[1]!=d.value[0]?!1:m.next().done}catch(a){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(l&&$jscomp.ES6_CONFORMANCE)return l}else if(r())return l;$jscomp.initSymbolIterator();var n=function(e){this.map_=new Map;if(e){e=$jscomp.makeIterator(e);for(var u;!(u=e.next()).done;)this.add(u.value)}this.size=this.map_.size};n.prototype.add=function(e){e=0===e?0:e;this.map_.set(e,e);this.size=this.map_.size;return this};n.prototype.delete=function(e){e=this.map_.delete(e);this.size=this.map_.size;return e};n.prototype.clear=function(){this.map_.clear();
this.size=0};n.prototype.has=function(e){return this.map_.has(e)};n.prototype.entries=function(){return this.map_.entries()};n.prototype.values=function(){return this.map_.values()};n.prototype.keys=n.prototype.values;n.prototype[Symbol.iterator]=n.prototype.values;n.prototype.forEach=function(e,u){var m=this;this.map_.forEach(function(d){return e.call(u,d,d,m)})};return n},"es6","es3");
$jscomp.polyfill("String.prototype.startsWith",function(l){return l?l:function(l,n){var e=$jscomp.checkStringArgs(this,l,"startsWith");l+="";var u=e.length,m=l.length;n=Math.max(0,Math.min(n|0,e.length));for(var d=0;d<m&&n<u;)if(e[n++]!=l[d++])return!1;return d>=m}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(l){return l?l:function(l,n){var e=$jscomp.checkStringArgs(this,l,"endsWith");l+="";void 0===n&&(n=e.length);n=Math.max(0,Math.min(n|0,e.length));for(var u=l.length;0<u&&0<n;)if(e[--n]!=l[--u])return!1;return 0>=u}},"es6","es3");
var EnxRtc=function(l){function r(e){if(n[e])return n[e].exports;var u=n[e]={i:e,l:!1,exports:{}};l[e].call(u.exports,u,u.exports,r);u.l=!0;return u.exports}var n={};r.m=l;r.c=n;r.d=function(e,l,m){r.o(e,l)||Object.defineProperty(e,l,{configurable:!1,enumerable:!0,get:m})};r.n=function(e){var l=e&&e.__esModule?function(){return e["default"]}:function(){return e};r.d(l,"a",l);return l};r.o=function(e,l){return Object.prototype.hasOwnProperty.call(e,l)};r.p="";return r(r.s=32)}([function(l,r,n){Object.defineProperty(r,
"__esModule",{value:!0});l=n(1);var e=n.n(l),u=n(33),m=function(){var d=u().format("YYMMDDHHmmss")+"::";var a=function(a){console.log.apply(console,$jscomp.arrayFromIterable(a))};return{DEBUG:0,TRACE:1,INFO:2,WARNING:3,ERROR:4,NONE:5,setLogLevel:function(a){console.log("setting log level:  old: "+m.logLevel+" new: "+a);if("string"===typeof a||"number"===typeof a){var b=a;"number"===typeof b?(b=Math.round(a),a>m.NONE?b=m.NONE:a<m.DEBUG&&(b=m.DEBUG),m.logLevel=b):-1<"DEBUG TRACE INFO WARNING ERROR NONE".split(" ").indexOf(b)?
m.logLevel=b:m.error("setLogLevel() invalid param");m.logLevel>m.INFO&&(m.logLevel=m.INFO)}else m.error("setLogLevel() invalid param type")},getLogLevel:function(a){return m.logLevel},setOutputFunction:function(b){a=b},setLogPrefix:function(a){d=a},log:function(b,g){for(var x=[],p=1;p<arguments.length;++p)x[p-1]=arguments[p];var k=d;if(!(b<m.logLevel)){b===m.DEBUG?k+="D":b===m.TRACE?k+="T":b===m.INFO?k+="I":b===m.WARNING?k+="W":b===m.ERROR&&(k+="E");k+="::WB::";p=e.a.getLocalStorageItem("logID");
k+=null!=p?p:"";p=[k].concat(x);if(null!=e.a.getLocalStorageItem("vcxRTCLib-log")){var v=JSON.parse(e.a.getLocalStorageItem("vcxRTCLib-log"));500<Object.keys(v).length&&delete Object.keys(v)[0];var t="",w;for(w in x)t="object"===typeof x[w]?t+JSON.stringify(x[w],null,2):t+x[w];v[k]=t;e.a.removeLocalStorageItem("vcxRTCLib-log");e.a.setLocalStorageItem("vcxRTCLib-log",JSON.stringify(v,null,2))}if(void 0!==m.panel){x="";for(w=0;w<p.length;w+=1)x+=p[w];m.panel.value=m.panel.value+"\n"+x}else a.apply(m,
[p])}},debug:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];m.log.apply(m,[m.DEBUG].concat($jscomp.arrayFromIterable(b)))},trace:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];m.log.apply(m,[m.TRACE].concat($jscomp.arrayFromIterable(b)))},info:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];m.log.apply(m,[m.INFO].concat($jscomp.arrayFromIterable(b)))},warning:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];
m.log.apply(m,[m.WARNING].concat($jscomp.arrayFromIterable(b)))},error:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];m.log.apply(m,[m.ERROR].concat($jscomp.arrayFromIterable(b)))}}}();m.logLevel=m.INFO;r["default"]=m},function(l,r,n){n(34);var e={socketCustomPathSupported:!0,socketCustomPath:"/v3/socket.io/"};r=e.socketCustomPathSupported?void 0!=e.socketCustomPath?e.socketCustomPath:"/v3/socket.io/":void 0;e.socketiopath=r;e.browser_info=function(){var d="none",a,b=window.navigator.userAgent;
if(-1!=(a=b.indexOf("OPR")))var g="opera";else-1!=(a=b.indexOf("Firefox"))?g="mozilla":-1!=(a=b.indexOf("Edg"))?g="edge":-1!=(a=b.indexOf("Chrome"))?g="chrome-stable":-1!=b.indexOf("Safari")?(g="safari",-1!=(a=b.indexOf("Version"))&&(d=b.substring(a+8))):-1!=(a=b.indexOf("MSIE"))||-1!=(a=b.indexOf("Windows NT"))?g="IE":(b.includes("iPhone")||b.includes("iPad"))&&b.includes("Mobile")&&-1!=(a=b.indexOf("OS"))?((g=b.substring(a+3))&&(d=g.substring(0,g.indexOf(" "))),d?(d.replace(/_/g,"."),g="safari"):
(g="none",a=-1)):g="none";if("none"==d&&-1!=a){var e=b.substring(a);-1!=(a=e.indexOf("/"))&&(d=e.substring(a+1))}var p;-1!=(p=d.indexOf(";"))&&(d=d.substring(0,p));-1!=(p=d.indexOf(" "))&&(d=d.substring(0,p));a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(b)?"mobile":"desktop";return{name:g,version:d,device_type:a}}();e.is_supported=!(void 0===RTCPeerConnection||!/chrome-stable|mozilla|safari|opera|edge/i.test(e.browser_info.name));e.browser_type=window.navigator.userAgent.match("Chrome")?
"chrome-stable":window.navigator.userAgent.match("Firefox")?"mozilla":window.navigator.userAgent.match(/Safari|AppleWebKit/g)?"safari":window.navigator.userAgent.match("Edge")?"edge":window.navigator.userAgent.match("Electron")?"electron":window.navigator.userAgent.match(".NET")?"IE":"none";e.device_type=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(window.navigator.userAgent)?"mobile":"desktop";e.videoBitrateQualityMap;e.cameraResolutionTable;var u=function(d,
a,b,g){var e=b;switch(a){case "get":e=d.getItem(b);break;case "set":d.setItem(b,g);break;case "remove":d.removeItem(b)}return e},m=function(d,a,b){try{return u(localStorage,d,a,b)}catch(g){if(void 0!=g.SecurityError)try{return u(sessionStorage,d,a,b)}catch(x){}return null}};l.exports={product:{company:"Vcloudx Inc",product:"enablex.io",version:"2.3.16",release:"2.3.16"},default_region:["IN"],data_throughput_duration:2,video_bandwidth_duration:10,audio_bandwidth_duration:10,video_layer_bitrates:{0:3E5,
1:8E5,2:15E5},video_resolution_range:{FD:{min:{width:160,height:90},max:{width:1280,height:720}},HD:{min:{width:320,height:180},max:{width:1280,height:720}},SD:{min:{width:320,height:180},max:{width:960,height:540}},LD:{min:{width:160,height:90},max:{width:640,height:360}},Default:{min:{width:160,height:90},max:{width:1280,height:720}}},video_bandwidth_range:{FD:{0:{min:100,max:1200},1:{min:100,max:800},2:{min:100,max:400}},HD:{0:{min:100,max:1200},1:{min:100,max:800},2:{min:100,max:400}},SD:{0:{min:100,
max:700},1:{min:100,max:400},2:{min:100,max:250}},LD:{0:{min:80,max:400},1:{min:80,max:250},2:{min:80,max:150}},ND:{0:{min:0,max:0},1:{min:40,max:200},2:{min:40,max:100}},share:{min:100,max:400},canvas:{min:1024,max:4096}},screen_resolution_range:{FD:{bw:600,fps:20},HD:{bw:600,fps:20},SD:{bw:400,fps:15},LD:{bw:200,fps:10}},proxy_api_url:"apiproxy.enablex.io",proxy_api_port:443,ice_servers:{IN:{turnURI:"turns:ts.enablex.io:443",turnUsername:"vcxturn",turnCredential:"V201301",stunURI:"stun:stun.l.google.com:19302"},
US:{turnURI:"turns:eu2ts.enablex.io:443",turnUsername:"vcxturn",turnCredential:"V201301",stunURI:"stun:stun.l.google.com:19302"},SG:{turnURI:"turns:sgts.enablex.io:443",turnUsername:"vcxturn",turnCredential:"V201301",stunURI:"stun:stun.l.google.com:19302"},DE:{turnURI:"turns:gwcts.enablex.io:443",turnUsername:"vcxturn",turnCredential:"V201301",stunURI:"stun:stun.l.google.com:19302"}},browser_info:e.browser_info,browser_type:e.browser_type,device_type:e.device_type,socketiopath:e.socketiopath,user_agent:window.navigator.userAgent,
is_supported:function(){return e.is_supported},setVideoBwQualityMapper:function(d){d.minBwKbpsToCheck&&(e.videoBitrateQualityMap=d.bpsQualityMapTable.slice(),e.cameraResolutionTable=d.camResTable.slice());e.videoQualityMapMinBwKbps=d.minBwKbpsToCheck},getBitrateMapTable:function(){return e.videoBitrateQualityMap},getCamResolutionTable:function(){return e.cameraResolutionTable},getCamResTableToCheck:function(d){if(void 0!==e.videoBitrateQualityMap&&d<=e.videoQualityMapMinBwKbps)for(var a=0;a<e.videoBitrateQualityMap.length;a++)if(e.videoBitrateQualityMap[a].kbps<=
d)return{resTable:e.cameraResolutionTable.slice(e.videoBitrateQualityMap[a].resTable.index),fps:e.videoBitrateQualityMap[a].fps.max}},internetDetectionUrl:"https://api.enablex.io/status",getLocalStorageItem:function(d){return m("get",d)},setLocalStorageItem:function(d,a){return m("set",d,a)},removeLocalStorageItem:function(d){return m("remove",d)},senduserDataMaximumLimit:2048,noise_analysis:!0,noise_suppression_sdk_url:"https://d1seim8g02n0k0.cloudfront.net/noise_suppression_sdk/EnxNs.js",csp_enabled:!1,
eventLogLevel:"error",getMediaConnectionTimeoutSecs:function(d){return d?5:30}}},function(l,r,n){var e=n(4);r.a=function(){var l=Object(e.c)({});l.url="";return l}},function(l,r,n){var e=function(l){var m=l.name;var d=l.src;var a=l.srcObject;var b=l.href;var g=l.rel;var x=l.type;var p=l.target;var k=l.autoplay;var v=l.playsinline;var t=l.alt;var w=l.title;var q=l.id;var c=l.class;l=e.getStyle(l.style);var u=null;m&&""!=m&&null!=m&&(u=document.createElement(m),d&&""!=d&&null!=d&&u.setAttribute("src",
d),a&&""!=a&&null!=a&&u.setAttribute("srcObject",a),b&&""!=b&&null!=b&&u.setAttribute("href",b),p&&""!=p&&null!=p&&u.setAttribute("target",p),t&&""!=t&&null!=t&&u.setAttribute("alt",t),w&&""!=w&&null!=w&&u.setAttribute("title",w),g&&""!=g&&null!=g&&u.setAttribute("rel",g),x&&""!=x&&null!=x&&u.setAttribute("type",x),k&&""!=k&&null!=k&&u.setAttribute("autoplay",k),v&&""!=v&&null!=v&&u.setAttribute("playsinline",v),q&&""!=q&&null!=q&&u.setAttribute("id",q),c&&""!=c&&null!=c&&u.setAttribute("class",c),
l&&""!=l&&null!=l&&u.setAttribute("style",l));return u};e.getStyle=function(e){var m="",d;for(d in e)m+=d+":"+e[d]+";";return m};e.getById=function(e){return document.getElementById(e)};e.getByClass=function(e){return document.getElementsByClassName(e)[0]};e.getByTag=function(e){return document.getElementsByTagName(e)[0]};e.getTagByDOM=function(e,m){return m.getElementsByTagName(e)[0]};e.getByClass=function(e,m){return m.getElementsByClassName(e)[0]};e.append=function(e,m){return m.appendChild(e)};
e.setStyle=function(e,m,d){e.style[m]=d};e.addCssFile=function(l){e.getByTag("head").appendChild(l)};e.checkParam=function(e){var m=!1;e&&null!=e&&""!=e&&(m=!0);return m};r.a=e},function(l,r,n){n.d(r,"c",function(){return m});n.d(r,"b",function(){return d});n.d(r,"e",function(){return a});n.d(r,"f",function(){return b});n.d(r,"d",function(){return g});n.d(r,"g",function(){return x});n.d(r,"a",function(){return p});var e=n(0),u=n(7),m=function(){var a={},b={};a.addEventListener=function(a,k){void 0===
b[a]&&(b[a]=[]);b[a].push(k)};a.removeEventListener=function(a,k){b[a]&&(k=b[a].indexOf(k),-1!==k&&b[a].splice(k,1))};if("IE"!==u.a.browserEngineCheck())a.dispatchEvent=function(a){if(!a||!a.type)throw Error("Undefined event");"onStatSubscription"!=a.type&&"genericEvents"!=a.type&&"talker-notification"!=a.type&&e["default"].debug("Event: "+a.type);for(var k=b[a.type]||[],c=0;c<k.length;c+=1)k[c](a)};else{var d=function(a,k){k=k||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");
c.initCustomEvent(a,k.bubbles,k.cancelable,k.detail);c.data=k.detail;return c};d.prototype=window.Event.prototype;window.CustomEvent=d;a.dispatchEvent=function(a){"onStatSubscription"!=a.type&&"genericEvents"!=a.type&&"talker-notification"!=a.type&&e["default"].debug("Event: "+a.type);a=d(a.type,{bubbles:!1,cancelable:!1,detail:a});document.getElementById("WebrtcEverywherePluginId").dispatchEvent(a)}}a.on=a.addEventListener;a.off=a.removeEventListener;a.emit=a.dispatchEvent;a.eventsList=b;return a},
d=function(a){var k={};k.type=a.type;return k},a=function(a){var k=d(a);k.streams=a.streams;k.message=a.message;k.room=a.room;k.users=a.users;k.type=a.type;k.bandwidth=a.bandwidth;k.TalkerCount=a.TalkerCount;k.me=a.me;k.mediaRecord=a.mediaRecord;k.error=a.error;return k},b=function(a){var k=d(a);k.stream=a.stream;k.msg=a.msg;k.bandwidth=a.bandwidth;k.attrs=a.attrs;return k},g=function(a){return d(a)},x=function(a){var k=d(a);k.name=a.name;k.role=a.role;k.clientId=a.clientId;k.permissions=a.permission;
return k},p=function(a){var k=d(a);k.message=a.message;return k}},function(l,r,n){l={SocketEvent:{},RoomEvent:{},UserEvent:{},StreamEvent:{}};l.SocketEvent.onAddStream="onAddStream";l.SocketEvent.onRemoveTrack="onRemoveTrack";l.SocketEvent.media_engine_connecting="media_engine_connecting";l.SocketEvent.signaling_message_peer="signaling_message_peer";l.SocketEvent.publish_me="publish_me";l.SocketEvent.unpublish_me="unpublish_me";l.SocketEvent.onBandwidthAlert="onBandwidthAlert";l.SocketEvent.onBandwidthEvents=
"bandwidthEvents";l.SocketEvent.onSelfBandwidthAlert="onSelfBandwidthAlert";l.SocketEvent.onDataStream="onDataStream";l.SocketEvent.onUpdateAttributeStream="onUpdateAttributeStream";l.SocketEvent.onRemoveStream="onRemoveStream";l.SocketEvent.disconnect="disconnect";l.SocketEvent.connection_failed="connection_failed";l.SocketEvent.error="error";l.SocketEvent.connect_error="connect_error";l.SocketEvent.connect_timeout="connect_timeout";l.SocketEvent.reconnecting="reconnecting";l.SocketEvent.reconnect=
"reconnect";l.SocketEvent.reconnected="reconnected";l.SocketEvent.reconnect_attempt="reconnect_attempt";l.SocketEvent.reconnect_error="reconnect_error";l.SocketEvent.reconnect_failed="reconnect_failed";l.SocketEvent.user_connected="user-connected";l.SocketEvent.user_updated="user-updated";l.SocketEvent.user_disconnected="user-disconnected";l.SocketEvent.user_subscribed="user-subscribed";l.SocketEvent.user_unsubscribed="user-unsubscribed";l.SocketEvent.dial_state_events="dialStateEvents";l.RoomEvent.user_role_changed=
"userRoleChanged";l.SocketEvent.onStatSubscription="onStatSubscription";l.SocketEvent.onStreamingNotification="onStreamingNotification";l.SocketEvent.onHlsStreamingNotification="onHlsStreamingNotification";l.SocketEvent.onHlsStreamingNotificationToPublisher="onHlsStreamingNotificationToPublisher";l.SocketEvent.onLiveRecordingNotification="onLiveRecordingNotification";l.SocketEvent.onRoomLiveRecordingOn="room-live-recording-on";l.SocketEvent.onRoomLiveRecordingOff="room-live-recording-off";l.SocketEvent.onRoomLiveRecordingFailed=
"room-live-recording-failed";l.SocketEvent.data_stream_room="onDataStreamToRoom";l.RoomEvent.onStreamingNotification="onStreamingNotification";l.RoomEvent.onHlsStreamingNotification="onHlsStreamingNotification";l.RoomEvent.onHlsStreamingNotificationToPublisher="onHlsStreamingNotificationToPublisher";l.RoomEvent.onLiveRecordingNotification="onLiveRecordingNotification";l.UserEvent.user_awaited="user-awaited";l.UserEvent.user_joined="user-joined";l.RoomEvent.room_connected="room-connected";l.RoomEvent.room_disconnected=
"room-disconnected";l.RoomEvent.room_awaited="room-awaited";l.RoomEvent.room_record_on="room-record-on";l.RoomEvent.room_record_off="room-record-off";l.RoomEvent.onRoomLiveRecordingOn="room-live-recording-on";l.RoomEvent.onRoomLiveRecordingOff="room-live-recording-off";l.RoomEvent.onRoomLiveRecordingFailed="room-live-recording-failed";l.RoomEvent.update_layout="update-layout";l.RoomEvent.change_layout="change-layout";l.RoomEvent.new_active_talker="active-talkers-updated";l.RoomEvent.hard_mute_audio=
"hardmute-user-audio";l.RoomEvent.hard_unmute_audio="hardunmute-user-audio";l.RoomEvent.hard_mute_video="hardmute-user-video";l.RoomEvent.get_active_talker="getNumberOfTalker";l.RoomEvent.set_active_talker="setNumberOfTalker";l.RoomEvent.get_active_max_talker="getMaxNumberOfTalker";l.RoomEvent.set_adavanced_options="setAdvancedOptions";l.RoomEvent.get_adavanced_options="getAdvancedOptions";l.RoomEvent.client_stats="clientStats";l.RoomEvent.switch_user_role="switchUserRole";l.RoomEvent.hard_unmute_video=
"hardunmute-user-video";l.RoomEvent.auxilary_publish_events="auxilaryPublishEvents";l.RoomEvent.share_started="shareStarted";l.RoomEvent.share_stopped="shareStopped";l.RoomEvent.screen_share_override="shareOverride";l.RoomEvent.streaming_uri="streamingUri";l.RoomEvent.stop_sharing="stopSharing";l.RoomEvent.share_state_events="shareStateEvents";l.RoomEvent.extend_conference_duration="extendConferenceDuration";l.RoomEvent.lock_room="lockRoom";l.RoomEvent.drop="drop";l.RoomEvent.subscriber_video_mute=
"subscriber-video-mute";l.RoomEvent.switch_codec="switch-publish-media-codec";l.RoomEvent.canvas_started="canvasStarted";l.RoomEvent.canvas_stopped="canvasStopped";l.RoomEvent.canvas_state_events="canvasStateEvents";l.RoomEvent.custom_data_saved="CustomDataSaved";l.RoomEvent.custom_data_updated="CustomDataUpdated";l.RoomEvent.transcription_events="transcription-events";l.RoomEvent.analytics_events="meeting-summary-events";l.RoomEvent.invite_breakout_room="invite-breakout-room";l.RoomEvent.user_joined_breakout_room=
"user-joined-breakout-room";l.RoomEvent.user_left_breakout_room="breakout-user-disconnected";l.RoomEvent.breakout_room_destroyed="breakout-room-destroyed";l.RoomEvent.generic_events="genericEvents";l.RoomEvent.network_reconnected="network-reconnected";l.RoomEvent.network_disconnected="network-disconnected";l.RoomEvent.network_reconnectiontimeout="network-reconnect-timeout";l.RoomEvent.network_reconnectfailed="network-reconnect-failed";l.RoomEvent.fs_upload_started="fs-upload-started";l.RoomEvent.fs_file_uploaded=
"fs-file-available";l.RoomEvent.fs_download_started="fs-download-started";l.RoomEvent.fs_file_downloaded="fs-upload-success";l.RoomEvent.fs_file_upload_result="fs-upload-result";l.RoomEvent.fs_file_download_result="fs-download-result";l.SocketEvent.floor_management_events="floorManagementEvents";l.SocketEvent.room_management_events="roomManagementEvents";l.UserEvent.user_audio_muted="user-audio-muted";l.UserEvent.user_audio_unmuted="user-audio-unmuted";l.UserEvent.user_video_muted="user-video-muted";
l.UserEvent.user_video_unmuted="user-video-unmuted";l.SocketEvent.hard_mute="hardMute";l.SocketEvent.hard_mute_room="room-muted";l.SocketEvent.hard_unmute_room="room-unmuted";l.SocketEvent.switched_room="roomSwitched";l.RoomEvent.room_transcription_on="room-transcription-on";l.RoomEvent.room_transcription_off="room-transcription-off";l.RoomEvent.self_transcription_on="self-transcription-on";l.RoomEvent.self_transcription_off="self-transcription-off";l.constant={};l.constant.H264_CODEC="H264_AND_OPUS";
l.constant.default="default";l.constant.SAFARI_VERSION_NOT_SUPPORTING_VP8="12.0";l.constant.SAFARI_VERSION_SUPPORTING_VP8="12.1";l.constant.FIREFOX_VERSION_VIDEO_MUTE_SUPPORT="60.0";l.constant.CHROME_VERSION_SCREEN_SHARE_WITHOUT_EXTN_SUPPORT="72.0";l.constant.FIREFOX_VERSION_SCREEN_SHARE_WITHOUT_EXTN_SUPPORT="66.0";l.constant.SAFARI_VERSION_SCREEN_SHARE_SUPPORT="13.0.0";l.constant.FIREFOX_VERSION_SENDER_ENCODINGS_PARAM_SUPPORT="64.0";l.constant.SAFARI_VERSION_SENDER_ENCODINGS_PARAM_SUPPORT="13.1.0";
l.constant.SAFARI_VERSION_DEVICE_CHANGE_EVENT_SUPPORT="11.0.0";r.a=l},function(l,r,n){r.a={error_000:{result:0,msg:"success"},error_1000:{result:1E3,msg:"Non supported browser"},error_1130:{result:1130,error:"Moderator not present/ wait for Moderator",desc:""},error_1140:{result:1140,error:"Previous similar request in process",desc:""},error_1141:{result:1141,error:"Remote streams can't be muted",desc:""},error_1142:{result:1142,error:"Invalid Device Id",desc:"OverconstrainedError: Invalid device id provided"},
error_1143:{result:1143,error:"Requested device not found",desc:"NotFoundError: Requested device was not found"},error_1144:{result:1144,error:"Permission denied",desc:"NotAllowedError: The request is not allowed by the user agent or the platform in the current context"},error_1145:{result:1145,error:"Could not start video source",desc:"NotReadableError: Could not start video source"},error_1146:{result:1146,error:"Failed to execute getUserMedia on MediaDevices",desc:"TypeError: At least one of audio and video must be requested"},
error_1147:{result:1147,error:"Constraints could be not satisfied",desc:"OverconstrainedError: Video width constraint could not be satisfied"},error_1148:{result:1148,error:"Constraints could be not satisfied",desc:"OverconstrainedError: Video height constraint could not be satisfied"},error_1149:{result:1149,error:"Constraints could be not satisfied",desc:"One of the constraints (Height, Width, DeviceId) is not satisfied."},error_1150:{result:1150,error:"Reason unknown",desc:"Reason unknown"},error_1151:{result:1151,
error:"A screen share is already running",desc:""},error_1152:{result:1152,error:"Audio only calls are allowed with your current browser version",desc:""},error_1153:{result:1153,error:"Unsupported browser",desc:""},error_1154:{result:1154,error:"Given frame rate is not supported",desc:"Frame rate might be negative or not a number which is not accepted by captureStream method"},error_1155:{result:1155,error:"Invalid options/parameters /values",desc:"Invalid options parameters/values "},error_1156:{result:1156,
error:"Invalid streamType",desc:" streamType  should be set as canvas for canvas streams and talker for talker streams"},error_1157:{result:1157,error:"The given canvas element does not exist in the DOM",desc:"The canvas element you have provided does not exist in the DOM"},error_1158:{result:1158,error:"This browser does not support canvas",desc:"This browser does not support canvas"},error_1159:{result:1159,error:"Stream not found",desc:"Stream not found"},error_1160:{result:1160,error:"Media connection failure",
desc:"Media connection failure"},error_1161:{result:1161,error:"Server connection failure",desc:"Server connection failure"},error_1162:{result:1162,error:"The DOM element does not exist",desc:"The element with DOM reference provided does not exist"},error_1163:{result:1163,error:"Network disconnected",desc:"Socket or media connection has failed due to network error"},error_1164:{result:1164,error:"Network reconnected",desc:"Network reconnected"},error_1165:{result:1165,error:"Reconnect attempt exceeded",
desc:"Reconnection failed"},error_1166:{result:1166,error:"Reconnection timed out",desc:"Reconnection failed"},error_1167:{result:1167,error:"Publish or subscribe failed",desc:"After reconnection publish or subscibe failed"},error_1168:{result:1168,error:"Not allowed",desc:"Only moderator has rights to excercise this transaction"},error_1169:{result:1169,msg:"No listener for event",desc:""},error_1170:{result:1170,error:"Not supported",desc:"Feature is not enabled because of room config or no licence "},
error_1171:{result:1171,error:"Room not connected",desc:"Room not connected"},error_1172:{result:1172,error:"Room connect failed",desc:"Room connect failed"},error_1173:{result:1173,error:"Floor not granted for participant",desc:"Floor not granted"},error_1174:{result:1174,error:"Local Recording started already",desc:""},error_1175:{result:1175,error:"Local Recording not started /stream not having media",desc:""},error_1176:{result:1176,error:"Moderator declined right to control media devices ",desc:""},
error_1177:{result:1177,error:"MediaDevice state is already in same state",desc:""},error_1178:{result:1178,error:"Reconnection for a single participant in the room is not allowed",desc:"Reconnection not allowed"},error_1179:{result:1179,error:" files to upload input array size is 0",desc:" empty file transfer is not allowed"},error_1180:{result:1180,error:" room is disconected",desc:" file sharing is not allowed on disconnected rooms"},error_1181:{result:1181,error:" Recieve file operation is not permitted.",
desc:" File which you are trying to receive  does not exist."},error_1182:{result:1182,error:"file upload failed",desc:"file upload failed "},error_1183:{result:1183,error:" file download failed ",desc:" file download failed"},error_1184:{result:1184,error:"user video resolution inavlid range",desc:"user video resolution inavlid range"},error_1185:{result:1185,error:"file upload failed ",desc:"file upload failed because provided file list is empty"},error_1186:{result:1186,error:"file upload failed ",
desc:"file size is zero bytes"},error_1187:{result:1187,error:"file upload failed ",desc:"file upload failed because it exceeded max upload limit"},error_1188:{result:1188,error:"current and requested state / value are same",desc:"current and requested state / value are same"},error_1189:{result:1189,error:"Media operation not allowed in mute state",desc:""},error_4121:{result:4121,error:"room already locked / unlocked",desc:" room is already locked/unlocked"},error_7000:{result:7E3,error:"streaming error",
desc:" streaming error"},error_7008:{result:7008,error:"streaming error",desc:"only moderator can start streaming"},error_7009:{result:7009,error:"streaming error",desc:"invalid or undefined streaming configuration"},error_7101:{result:7101,error:"streaming error",desc:"rtmpUrl should not exceed more than 3 values"},error_7102:{result:7102,error:"streaming error",desc:"invalid rtmp or url format"},error_7103:{result:7103,error:"streaming error",desc:"room is disconnecting, cannot start streaming"},
error_7044:{result:7044,error:"streaming error",desc:"only moderator can stop streaming"},error_7045:{result:7045,error:"streaming error",desc:"room is disconnecting, streaming will be stopped"},error_7072:{result:7072,error:"streaming params change error",desc:"only moderator can change streaming params"},error_7078:{result:7078,error:"streaming params change error",desc:"room is disconnecting, cannot change streaming params"},error_7201:{result:7201,error:"live recording error",desc:"only moderator can start live recording"},
error_7202:{result:7202,error:"live recording error",desc:"invalid url format"},error_7203:{result:7203,error:"live recording error",desc:"room is disconnecting, cannot start live recording"},error_7204:{result:7204,error:"live recording error",desc:"live recording error"},error_7036:{result:7036,error:"live recording error",desc:"only moderator can stop live recording"},error_7037:{result:7037,error:"live recording error",desc:"room is disconnecting, live recording will be stopped"},error_7079:{result:7079,
error:"room is disconected",desc:"Layout update is not allowed on disconnected rooms"},error_7071:{result:7071,error:"live recording error",desc:"only moderator can change live recording params"},error_8000:{result:8E3,error:"invalidate transcoding error",desc:"Room is disconnecting, invalidate transcoding cannot be performed now"},error_8001:{result:8001,error:"Live transcription is already in progress",desc:"Live transcription is already in progress"},error_8002:{result:8002,error:"Live transcription is not running",
desc:"Live transcription is not started"},error_8003:{result:8003,error:"Live summary is already in progress",desc:"Live summary is already in progress"},error_8004:{result:8004,error:"Live summary is not running",desc:"Live summary is not started"},CC002:{cause:2002,msg:"unexpected-disconnection"},CC006:{cause:2006,msg:"normal-disconnect"},error_1190:{result:1190,error:"Exception found",desc:"Could not fetch video size"},error_1191:{result:1191,error:"Stream track ended state ",desc:"Stream track is already ended"},
error_1192:{result:1192,error:"Invalid parameters",desc:"Invalid value for layout parameter"},error_1193:{result:1193,error:"Invalid parameters",desc:"Invalid value for service parameter"},error_1194:{result:1194,error:"Invalid parameters",desc:"Invalid value for clients parameter"},error_1195:{result:1195,error:"Large text Data",desc:"Failed to handle larger text-data"},error_1196:{result:1196,error:"content-length value exceeded.",desc:"Entered value of content-length exceeded the maximum allowed value."},
error_1197:{result:1197,error:"stream Invalid state .",desc:"room not published or already stream in published."},error_1198:{result:1198,error:"failed to start noise suppression",desc:""},error_1199:{result:1199,error:"failed to stop noise suppression",desc:""},error_1200:{result:1200,error:"share initiation timeout",desc:""}}},function(l,r,n){(function(e){var l=n(37),m=n(38),d=n(39),a=n(0),b=n(25),g=n(6),x=n(5),p=n(8),k=n(9),v=103,t,w=!1,q={deviceList:void 0},c=function(){var a="none";"undefined"!==
typeof e&&e.exports?a="fake":null!==window.navigator.userAgent.match("Firefox")?a="mozilla":null!==window.navigator.userAgent.match("Chrome")?(a="chrome-stable",null!==window.navigator.userAgent.match("Electron")?a="electron":null!==window.navigator.userAgent.match("Edge")&&(a="edge")):null!==window.navigator.userAgent.match("Safari")?a="safari":null!==window.navigator.userAgent.match("AppleWebKit")?a="safari":null!==window.navigator.userAgent.match(".NET")&&(a="IE");return a},G=function(){var a=
navigator.userAgent,c=a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(c[1])){var k=/\brv[ :]+(\d+)/g.exec(a)||[];return"IE "+(k[1]||"")}if("Chrome"===c[1]&&(k=a.match(/\b(OPR|Edge)\/(\d+)/),null!=k))return k.slice(1).join(" ").replace("OPR","Opera");c=c[2]?c[2]:navigator.appVersion;null!=(k=a.match(/version\/([^\s]+)/i))&&(c=k[1]);return c},E=function(a){var c=G();if("string"!==typeof a)return!1;c=c.split(".");a=a.split(".");for(var k=Math.min(c.length,
a.length),b=0;b<k;++b){c[b]=parseInt(c[b],10);a[b]=parseInt(a[b],10);if(c[b]>a[b])return!1;if(c[b]<a[b])return!0}return c.length==a.length?!1:!(c.length<a.length)},z=function(a,c){for(var k={cam:[],mic:[],speaker:[]},b=0;b<a.length;b++)switch(a[b].kind){case "audioinput":c.mic&&k.mic.push(a[b]);break;case "videoinput":c.cam&&k.cam.push(a[b]);break;case "audiooutput":c.speaker&&k.speaker.push(a[b])}return k},K=function(a){var c={cam:[],mic:[],speaker:[]},k={cam:[],mic:[],speaker:[]},b={cam:[],mic:[],
speaker:[]};if(void 0!==q.deviceList){k=JSON.parse(JSON.stringify(q.deviceList));for(var f in a.cam){var d=!1,g;for(g in k.cam)a.cam[f].deviceId===k.cam[g].deviceId&&(b.cam.push(k.cam.splice(g,1)[0]),d=!0);!1===d&&c.cam.push(a.cam[f])}for(var p in a.mic){d=!1;for(var e in k.mic)a.mic[p].deviceId===k.mic[e].deviceId&&a.mic[p].label===k.mic[e].label&&(b.mic.push(k.mic.splice(e,1)[0]),d=!0);!1===d&&c.mic.push(a.mic[p])}for(var m in a.speaker){d=!1;for(var t in k.speaker)a.speaker[m].deviceId===k.speaker[t].deviceId&&
a.speaker[m].label===k.speaker[t].label&&(b.speaker.push(k.speaker.splice(t,1)[0]),d=!0);!1===d&&c.speaker.push(a.speaker[m])}q.deviceList=a}return{current:b,added:c,removed:k}},B=function(d,e,m){m=void 0===m?!0:m;"IE"===c()||"edge"===c()?(k.a.error("agent-event",p.a.event_incompatible_browser,{error:g.a.error_1153}),e(null,g.a.error_1153)):w&&"safari"===c()?e("success",null):navigator.mediaDevices.getUserMedia(d).then(function(a){w=!0;e(a,null)}).catch(function(c){c=Object(b.a)(c);k.a.error("agent-event",
p.a.event_gum_failed,{error:c});if(!m||c.result!==g.a.error_1143.result&&c.result!==g.a.error_1144.result)a["default"].error("Failed to get media devices : "+JSON.stringify(c)),e(null,c);else if(d.video&&d.audio){var f=JSON.parse(JSON.stringify(d));f.video=!1;f.videoConfigured=d.video;a["default"].warning("getUserMedia() failed with error: "+JSON.stringify(c)+" retry with audio-only");B(f,e)}else d.video||void 0==d.videoConfigured?(a["default"].error("Failed to get media devices permission: "+JSON.stringify(c)),
e(null,c)):(f=JSON.parse(JSON.stringify(d)),f.video=d.videoConfigured,f.audio=!1,console.log("getUserMedia() failed with error: "+JSON.stringify(c)+" retry with video-only"),B(f,e))})},Y=function(a){navigator.mediaDevices.enumerateDevices().then(function(c){a(c)})},y=function(c,k){var b={};void 0!==c?(b.mic=void 0!=c.mic?c.mic:!1,b.cam=void 0!=c.cam?c.cam:!1,b.speaker=void 0!=c.speaker?c.speaker:!1):b={mic:!0,cam:!0,speaker:!0};a["default"].debug("getDeviceList ops: "+JSON.stringify(c)+" media ops: "+
JSON.stringify(b));b.mic||b.cam?B({audio:b.mic,video:b.cam},function(a,c){a||c&&c.result===g.a.error_1145.result?Y(function(a,f){a?(a=z(a,b),k({result:0,devices:a})):k(c&&c.result===g.a.error_1145.result?c:f)}):k(c)}):b.speaker?Y(function(a,c){a&&(a=z(a,b),k({result:0,devices:a}))}):k(g.a.error_1155)},F=function(){return document.getElementById("WebrtcEverywherePluginId")},S=function(a,c,k,b){a.addEventListener(c,k,b)};r.a={GetUserMedia:function(b,d,g){d=void 0===d?function(){}:d;g=void 0===g?function(){}:
g;var m,f=c();if("chrome-stable"===f||"electron"===f||"mozilla"===f||"safari"===f){var q=function(a,c,f){navigator.mediaDevices.getUserMedia(a).then(c).catch(f)};var v=function(a,c,f){navigator.getDisplayMedia?navigator.getDisplayMedia({video:!0}).then(c).catch(f):navigator.mediaDevices.getDisplayMedia(a).then(c).catch(f)}}else q=navigator.getUserMedia=function(a,c,f){"complete"!==document.readyState?t||(t=!0,S(document,"readystatechange",function(){t&&"complete"==document.readyState&&(t=!1,F().getUserMedia(a,
c,f))})):F().getUserMedia(a,c,f)};f=function(){a["default"].debug("Screen access requested");switch(c()){case "electron":a["default"].debug("Screen sharing in Electron");m={};m.video=b.video||{};m.video.mandatory=b.video.mandatory||{};m.video.mandatory.chromeMediaSource="screen";q(m,d,g);break;case "mozilla":a["default"].debug("Screen sharing in Firefox max fps: 5");m={};void 0!==b.video?(m.video={},m.video.mediaSource="window"):m={audio:b.audio,video:{mediaSource:"window"}};E(x.a.constant.FIREFOX_VERSION_SCREEN_SHARE_WITHOUT_EXTN_SUPPORT)?
q(m,d,g):(m.video={framerate:{ideal:b.fps}},v(m,d,g));break;case "safari":E(x.a.constant.SAFARI_VERSION_SCREEN_SHARE_SUPPORT)?(a["default"].error("Screen Sharing not supported for safari version: "+G()),k.a.error("agent-event",p.a.event_incompatible_browser,{error:"This safari version does not support ScreenSharing"})):(a["default"].debug("Screen sharing  Safari "),v({video:!0},d,g));break;case "chrome-stable":a["default"].debug("Screen sharing in Chrome");m={};if(b.desktopStreamId)m.video=b.video||
{mandatory:{}},m.video.mandatory=m.video.mandatory||{},m.video.mandatory.chromeMediaSource="desktop",m.video.mandatory.chromeMediaSourceId=b.desktopStreamId,m.video.mandatory.chromeMediaSourceId=b.desktopStreamId,q(m,d,g);else if(E(x.a.constant.CHROME_VERSION_SCREEN_SHARE_WITHOUT_EXTN_SUPPORT)){var f="apedaiecomcfkjdjbnkfcdafaikkdkeo";b.extensionId&&(a["default"].debug("extensionId supplied, using "+b.extensionId),f=b.extensionId);a["default"].debug("Screen access on chrome stable, looking for extension");
try{chrome.runtime.sendMessage(f,{getStream:!0},function(c){void 0===c?(a["default"].error("Access to screen denied"),g({code:"Access to screen denied"})):(c=c.streamId,void 0!==b.video.mandatory?(m.video=b.video,m.video.mandatory.chromeMediaSource="desktop",m.video.mandatory.chromeMediaSourceId=c):m={video:{mandatory:{maxFrameRate:b.fps,chromeMediaSource:"desktop",chromeMediaSourceId:c}}},q(m,d,g))})}catch(N){a["default"].debug("Screensharing plugin is not accessible "),k.a.error("agent-event",p.a.event_incompatible_browser,
{error:"Screensharing plugin is not accessible"}),g({code:"no_plugin_present"})}}else a["default"].debug("Screen sharing in Chrome without extension max Fps:: 3"),m.video={frameRate:{ideal:b.fps}},void 0!=b.audio&&!1!==b.audio&&(m.audio=!0),v(m,d,g);break;default:a["default"].error("This browser does not support ScreenSharing"),k.a.error("agent-event",p.a.event_incompatible_browser,{error:"This browser does not support ScreenSharing"})}};b.screen?f():"undefined"!==typeof e&&e.exports?a["default"].error("Video/audio streams not supported in controller yet"):
(a["default"].debug("Calling getUserMedia with config",JSON.stringify(b)),q(b,d,g))},buildPair:function(b){var g={};v+=1;b.sessionId=v;g.browser=c();if("fake"===g.browser)a["default"].warning("Publish/subscribe video/audio streams not supported in media yet"),k.a.warn("agent-event",p.a.event_incompatible_browser,{error:"Publish/subscribe video/audio streams not supported in media yet"}),g=Object(d.a)(b);else if("mozilla"===g.browser)a["default"].debug("Firefox Stack"),g=Object(m.a)(b);else if("safari"===
g.browser)a["default"].debug("Safari using Chrome Stable Stack"),g=Object(l.a)(b);else if("chrome-stable"===g.browser||"electron"===g.browser)a["default"].debug("Chrome Stable Stack"),g=Object(l.a)(b);else if("IE"===g.browser)a["default"].debug("IE using Chrome Stable Stack"),g=Object(l.a)(b);else throw a["default"].error("No stack available for this browser"),k.a.error("agent-event",p.a.event_incompatible_browser,{error:"No stack available for this browser"}),Error("WebRTC stack not available");
g.updateSpec||(g.updateSpec=function(c,b){b=void 0===b?function(){}:b;a["default"].error("Update Configuration not implemented in this browser");k.a.error("agent-event",p.a.event_incompatible_browser,{error:"Update Configuration not implemented in this browser"});b("unimplemented")});return g},browserEngineCheck:c,getAndroidVersion:function(){var a=navigator.userAgent;return 0<=a.indexOf("Android")?parseFloat(a.slice(a.indexOf("Android")+8)):!1},mediaDeviceUpdate:function(a,b,k){void 0!=q.changedDevicesCallbacks?
b&&(q.changedDevicesCallbacks[b]=k):(void 0===q.deviceList&&y(a,function(a){q.deviceList=a.devices}),q.changedDevicesCallbacks={id:k},"safari"===c()&&E(x.a.constant.SAFARI_VERSION_DEVICE_CHANGE_EVENT_SUPPORT)?setInterval(function(){y(a,function(a){if(void 0===q.deviceList)q.deviceList=a.devices;else{a=K(a.devices);for(var c=$jscomp.makeIterator(Object.entries(q.changedDevicesCallbacks)),b=c.next();!b.done;b=c.next())b=$jscomp.makeIterator(b.value),b.next(),b=b.next().value,b(a)}})},3E3):navigator.mediaDevices.ondevicechange=
function(c){if(void 0==q.receivedDC||1!=q.receivedDC)q.receivedDC=!0,setTimeout(function(){q.receivedDC=!1;y(a,function(a){if(0==a.result)if(void 0===q.deviceList)q.deviceList=a.devices;else{a=K(a.devices);for(var c=$jscomp.makeIterator(Object.entries(q.changedDevicesCallbacks)),f=c.next();!f.done;f=c.next())f=$jscomp.makeIterator(f.value),f.next(),f=f.next().value,f(a)}else console.log("ondevicechange() getDeviceList failed error: "+JSON.stringify(a))})},1E3)})},getDeviceList:y,getBrowserVersion:G,
GetCanvasStream:function(b,d,e){d=void 0===d?function(){}:d;e=void 0===e?function(){}:e;var m=null,f=null,q=c();if(b.canvas)if("chrome-stable"===q||"mozilla"===q||"safari"===q){if(void 0!==b.canvas.fps&&0<b.canvas.fps)var t=b.canvas.fps;else if(void 0!==b.canvas.fps){a["default"].error("Framerate is invalid is: ",b.canvas.fps);e(g.a.error_1154);k.a.error("agent-event",p.a.event_incompatible_browser,{error:g.a.error_1154});return}b=b.canvas.canvasId;try{(m=document.querySelector("#"+b))&&(m instanceof
HTMLMediaElement||m instanceof HTMLCanvasElement)?(f=m.captureStream(m instanceof HTMLCanvasElement?t:void 0))?d(f):(a["default"].error("captureStream() failed . canvasFps : ",t),e(g.a.error_1159),k.a.error("agent-event",p.a.event_incompatible_browser,{error:g.a.error_1159})):(a["default"].error("DOM Element does not exists/ not a Media Element. DomId is: ",b),k.a.error("agent-event",p.a.event_incompatible_browser,{error:g.a.error_1157}),e(g.a.error_1157))}catch(I){a["default"].error("DOM Element does not exists/ not a Media Element. DomId is: ",
b),e(g.a.error_1157),k.a.error("agent-event",p.a.event_incompatible_browser,{error:g.a.error_1157,exception:"Canvas chrome err: "+JSON.stringify(I)})}}else a["default"].error(" getCanvasStream() This browser does not support canvas"),e(g.a.error_1158),k.a.error("agent-event",p.a.event_incompatible_browser,{error:g.a.error_1154});else a["default"].error(" getCanvasStream() is called without canvas options"),k.a.error("agent-event",p.a.event_incompatible_browser,{error:"Canvas called without options"}),
e(g.a.error_1155)},isCurrentVerLess:E,getSupportedDeviceConstraints:function(){return navigator.mediaDevices.getSupportedConstraints()}}}).call(r,n(36)(l))},function(l,r,n){r.a={event_ice_failed:{event_code:"4000",severity:"critical",event_name:"ice-failed",event_description:"ICE failed"},event_ice_success:{event_code:"40001",severity:"",event_name:"ice-success",event_description:"ICE success"},event_stream_subscribe_failed:{event_code:"4001",severity:"critical",event_name:"stream-subscribe-failed",
event_description:"Failed to subscribe to stream"},event_stream_subscribe_success:{event_code:"40011",severity:"",event_name:"stream-subscribe-success",event_description:"Subscribe to stream successful"},event_stream_unsubscribe_failed:{event_code:"4002",severity:"critical",event_name:"stream-unsubscribe-failed",event_description:"Failed to unsubscribe from stream"},event_stream_unsubscribe_success:{event_code:"40021",severity:"",event_name:"stream-unsubscribe-success",event_description:"Unsubscribe from stream success"},
event_socket_connect_failed:{event_code:"4003",severity:"critical",event_name:"socket-connect-failed",event_description:"Socket connection failed"},event_socket_connect_success:{event_code:"40031",severity:"",event_name:"socket-connect-success",event_description:"Socket connection successful"},event_stream_publish_failed:{event_code:"4004",severity:"critical",event_name:"stream-publish-failed",event_description:"Failed to publish stream"},event_stream_publish_success:{event_code:"40041",severity:"",
event_name:"stream-publish-success",event_description:"stream published successfully"},event_stream_unpublish_failed:{event_code:"4005",severity:"critical",event_name:"stream-unpublish-failed",event_description:"Failed to unpublish stream"},event_stream_unpublish_success:{event_code:"40051",severity:"",event_name:"stream-unpublish-success",event_description:"Unpublish stream success"},event_start_recording_failed:{event_code:"4006",severity:"critical",event_name:"start-recording-failed",event_description:"Failed to start recording"},
event_start_recording_success:{event_code:"40061",severity:"",event_name:"start-recording-success",event_description:"Start recording success"},event_start_local_recording_failed:{event_code:"40062",severity:"critical",event_name:"start-local-recording-failed",event_description:"Failed to start local recording"},event_start_local_recording_success:{event_code:"40063",severity:"",event_name:"start-local-recording-success",event_description:"Start local recording success"},event_stop_recording_failed:{event_code:"4007",
severity:"critical",event_name:"stop-recording-failed",event_description:"Failed to stop recording"},event_stop_recording_success:{event_code:"40071",severity:"",event_name:"stop-recording-success",event_description:"Stop recording success"},event_stop_local_recording_failed:{event_code:"40072",severity:"critical",event_name:"stop-local-recording-failed",event_description:"Failed to stop local recording"},event_stop_local_recording_success:{event_code:"40073",severity:"",event_name:"stop-local-recording-success",
event_description:"Stop local recording success"},event_start_screenshare_failed:{event_code:"4008",severity:"critical",event_name:"start-screenshare-failed",event_description:"Failed to start screenshare"},event_start_screenshare_success:{event_code:"40081",severity:"",event_name:"start-screenshare-success",event_description:"Screenshare Start successfully"},event_stop_screenshare_failed:{event_code:"4009",severity:"critical",event_name:"stop-screenshare-failed",event_description:"Failed to stop screenshare"},
event_stop_screenshare_success:{event_code:"40091",severity:"",event_name:"stop-screenshare-success",event_description:"Screenshare stopped successfully"},event_start_canvas_failed:{event_code:"4010",severity:"critical",event_name:"start-canvas-failed",event_description:"Failed to start canvas"},event_start_canvas_success:{event_code:"40101",severity:"",event_name:"start-canvas-success",event_description:"Canvas started successfully"},event_stop_canvas_failed:{event_code:"4011",severity:"critical",
event_name:"stop-canvas-failed",event_description:"Failed to stop canvas"},event_stop_canvas_success:{event_code:"40111",severity:"",event_name:"stop-canvas-success",event_description:"Canvas stopped successfully"},event_network_reconnect_timeout:{event_code:"4012",severity:"high",event_name:"network-reconnect-timeout",event_description:"Reconnection timed out"},event_start_annotation_failed:{event_code:"4012",severity:"high",event_name:"start-annotation-failed",event_description:"Start Annotation Failed"},
event_start_annotation_success:{event_code:"40121",severity:"high",event_name:"start-annotation-success",event_description:"Start Annotation successful"},event_stop_annotation_failed:{event_code:"4013",severity:"high",event_name:"stop-annotation-failed",event_description:"Stop Annotation Failed"},event_stop_annotation_success:{event_code:"40131",severity:"high",event_name:"stop-annotation-success",event_description:"Stop Annotation successful"},event_send_message_failed:{event_code:"4013",severity:"high",
event_name:"send-message-failed",event_description:"Failed to send message"},event_send_message_success:{event_code:"40131",severity:"",event_name:"send-message-success",event_description:"Send message success"},event_reconnect_socket_failed:{event_code:"4014",severity:"high",event_name:"reconnect-socket-failed",event_description:"Failed to reconnect socket"},event_reconnect_socket_success:{event_code:"40141",severity:"",event_name:"reconnect-socket-success",event_description:"Socket reconnection success"},
event_send_data_failed:{event_code:"4018",severity:"high",event_name:"send-data-failed",event_description:"Failed to send data"},event_send_data_success:{event_code:"40181",severity:"",event_name:"send-data-success",event_description:"Send data success"},event_media_access_denied:{event_code:"4019",severity:"critical",event_name:"media-access-denied",event_description:"Access to media denied"},event_media_access_success:{event_code:"40191",severity:"",event_name:"media-access-allowed-success",event_description:"User has granted access to local media."},
event_agent_media_access_denied:{event_code:"40192",severity:"critical",event_name:"agent-media-access-denied-failed",event_description:"Access to media denied (Agent)"},event_gum_failed:{event_code:"4020",severity:"critical",event_name:"gum-failed",event_description:"Get User Media failed"},event_gum_success:{event_code:"40201",severity:"",event_name:"gum-success",event_description:"Get User Media success"},event_agent_gum_failed:{event_code:"40201",severity:"critical",event_name:"agent-gum-failed",
event_description:"Get User Media failed (Agent)"},event_audio_device_access_failed:{event_code:"4021",severity:"critical",event_name:"audio-device-access-failed",event_description:"Failed to access Audio device"},event_agent_audio_device_access_failed:{event_code:"40211",severity:"critical",event_name:"agent-audio-device-access-failed",event_description:"Failed to access Audio device (Agent)"},event_video_device_access_failed:{event_code:"4022",severity:"critical",event_name:"video-device-access-failed",
event_description:"Failed to access Video device"},event_agent_video_device_access_failed:{event_code:"40221",severity:"critical",event_name:"agent-video-device-access-failed",event_description:"Failed to access Video device (Agent)"},event_remote_canvas_stream_failed:{event_code:"4023",severity:"high",event_name:"remote-canvas-stream-failed",event_description:"Remote canvas stream failed"},event_capture_canvas_stream_failed:{event_code:"4024",severity:"critical",event_name:"capture-canvas-stream-failed",
event_description:"Failed to capture canvas stream"},event_set_local_description:{event_code:"4025",severity:"none",event_name:"set-local-description",event_description:"Local SDP description is set"},event_set_remote_description:{event_code:"4026",severity:"none",event_name:"set-remote-description",event_description:"Remote SDP description is set"},event_reconnect_subscribe_failed:{event_code:"4027",severity:"high",event_name:"reconnect-subscribe-failed",event_description:"Failed to subscribe while reconnecting"},
event_reconnect_publish_failed:{event_code:"4028",severity:"high",event_name:"reconnect-publish-failed",event_description:"Failed to publish while reconnecting"},event_incompatible_browser:{event_code:"4029",severity:"high",event_name:"incompatible-browser",event_description:"Browser is incompatible"},event_connect_socket_failed:{event_code:"4030",severity:"high",event_name:"connect-socket-failed",event_description:"Socket connection failed"},event_connect_socket_success:{event_code:"40301",severity:"",
event_name:"connect-socket-success",event_description:"Socket connection successful"},event_room_reconnection_failed:{event_code:"4031",severity:"high",event_name:"room-reconnection-failed",event_description:"Room reconnection failed"},event_room_reconnection_success:{event_code:"40311",severity:"",event_name:"room-reconnection- success",event_description:"Room reconnection success"},event_room_disconnection_failed:{event_code:"4032",severity:"high",event_name:"room-disconnection-failed",event_description:"Room disconnection failed"},
event_room_disconnection_success:{event_code:"40321",severity:"",event_name:"room-disconnection-success",event_description:"Room disconnection success"},event_mute_self_audio_failed:{event_code:"4033",severity:"high",event_name:"mute-self-audio-failed",event_description:"mute self audio failed"},event_mute_self_audio_success:{event_code:"40331",severity:"",event_name:"mute-self-audio-success",event_description:"mute self audio success"},event_unmute_self_audio_failed:{event_code:"4034",severity:"high",
event_name:"unmute-self-audio-failed",event_description:"unmute self audio failed"},event_unmute_self_audio_success:{event_code:"40341",severity:"",event_name:"unmute-self-audio-success",event_description:"unmute self audio success"},event_room_mute_failed:{event_code:"4035",severity:"high",event_name:"room-mute-failed",event_description:"room mute failed"},event_room_mute_success:{event_code:"40351",severity:"",event_name:"room-mute-success",event_description:"room mute success"},event_room_unmute_failed:{event_code:"4036",
severity:"high",event_name:"room-unmute-failed",event_description:"room unmute failed"},event_room_unmute_success:{event_code:"40361",severity:"",event_name:"room-unmute-success",event_description:"room unmute success"},event_file_shared_failed:{event_code:"4037",severity:"high",event_name:"file-shared-failed",event_description:"file shared failed"},event_file_shared_success:{event_code:"40371",severity:"",event_name:"file-shared-success",event_description:"file shared success"},event_file_download_failed:{event_code:"4038",
severity:"high",event_name:"file-downlod-failed",event_description:"file download failed"},event_file_download_success:{event_code:"40381",severity:"",event_name:"file-downlod-success",event_description:"file downlod success"},event_mute_self_video_failed:{event_code:"4039",severity:"high",event_name:"mute-self-video-failed",event_description:"mute self video failed"},event_mute_self_video_success:{event_code:"40391",severity:"",event_name:"mute-self-video-success",event_description:"mute self video success"},
event_unmute_self_video_failed:{event_code:"4040",severity:"high",event_name:"unmute-self-video-failed",event_description:"unmute self video failed"},event_unmute_self_video_success:{event_code:"40401",severity:"",event_name:"unmute-self-video-success",event_description:"unmute self video failed"},event_low_bandwidth_update:{event_code:"4041",severity:"",event_name:"low-bandwidth-update",event_description:"low bandwidth update"},event_network_change:{event_code:"4042",severity:"",event_name:"network-change",
event_description:"network change"},event_connection_lost:{event_code:"4043",severity:"",event_name:"connection-lost",event_description:"connection lost"},event_make_outbound_call_failed:{event_code:"4044",severity:"high",event_name:"make-outbound-call-failed",event_description:"Outbound call failed"},event_make_outbound_call_success:{event_code:"40441",severity:"",event_name:"make-outbound-call-success",event_description:"Outbound call success"},event_make_outbound_call_state:{event_code:"4045",
severity:"",event_name:"make-outbound-call-state",event_description:"Outbound call state"},event_abwd_mute_video_success:{event_code:"4101",severity:"",event_name:"mute-publisher-video-success",event_description:"Publisher video muted due to low bandwidth"},event_fs_upload_started_success:{event_code:"4102",severity:"",event_name:"fs-upload-started-success",event_description:"File is being shared"},event_fs_file_available_success:{event_code:"4103",severity:"",event_name:"fs-file-available-success",
event_description:"File is being shared"},event_room_user_connect_failed:{event_code:"4104",severity:"",event_name:"room-user-connect-failed",event_description:"User connection to the Room failed"},event_room_user_connect_success:{event_code:"41041",severity:"",event_name:"room-user-connect-success",event_description:"A new user is connected to the Room"},event_room_user_disconnect_failed:{event_code:"4105",severity:"",event_name:"room-user-disconnect-failed",event_description:"User disconnection to the Room failed"},
event_room_user_disconnect_success:{event_code:"41051",severity:"",event_name:"room-user-disconnect-success",event_description:"User is disconnected to the Room"},event_start_live_recording_failed:{event_code:"4046",severity:"critical",event_name:"start-live-recording-failed",event_description:"Failed to start live recording"},event_start_live_recording_success:{event_code:"40461",severity:"",event_name:"start-live-recording-success",event_description:"Start live recording success"},event_stop_live_recording_failed:{event_code:"4047",
severity:"critical",event_name:"stop-live-recording-failed",event_description:"Failed to stop live recording"},event_stop_live_recording_success:{event_code:"40471",severity:"",event_name:"stop-live-recording-success",event_description:"Stop live recording success"},event_live_recording_param_change_failed:{event_code:"40472",severity:"",event_name:"live-recording-param-change-failed",event_description:"live recording params change failed"},event_live_recording_param_change_success:{event_code:"40473",
severity:"",event_name:"live-recording-param-change-success",event_description:"live recording params change success"},event_streaming_param_change_failed:{event_code:"40474",severity:"",event_name:"Streaming-param-change-failed",event_description:"Streaming params change failed"},event_streaming_param_change_success:{event_code:"40475",severity:"",event_name:"Streaming-param-change-success",event_description:"Streaming params change success"},event_general_failed:{event_code:"4106",severity:"critical",
event_name:"general-failed",event_description:"General error"},event_general_success:{event_code:"41061",severity:"",event_name:"general-success",event_description:"General success"},event_stream_player_failed:{event_code:"4107",severity:"critical",event_name:"player-play-failed",event_description:"player div is not playing the video"},event_media_connection_failed:{event_code:"4108",severity:"critical",event_name:"media-connection-failed",event_description:"media connection/s failed"}}},function(l,
r,n){var e=n(0);l=n(1);var u=n.n(l);n=function(){var m={eventLoggerToken:void 0,eventServer:{},logID:void 0,eventBuffer:[],uniqueSequence:1,clientId:void 0};switch(u.a.eventLogLevel){case "trace":m.logLevel=2;break;case "debug":m.logLevel=1;break;case "info":m.logLevel=3;break;case "warn":m.logLevel=4;break;case "error":m.logLevel=5;break;default:m.logLevel=6}m.init=function(d){try{d.eventServer&&d.eventServer.url&&(m.eventServer.url=d.eventServer.url,m.logID=d.logId)}catch(a){e["default"].error("Error! Failed to send auth request to Event Server. Error: "+
a+".")}};m.log=function(d,a){try{if(!(d<m.logLevel)){e["default"].debug("EventLogger.log event SENT"+JSON.stringify(a));var b=(new Date).toISOString(),g="info",x={};switch(d){case 1:g="debug";break;case 2:g="trace";break;case 3:g="info";break;case 4:g="warning";break;case 5:g="error";break;default:g="info"}x.key={logID:m.logID,endpointType:"client",instanceID:m.logID,uniqueSequence:m.uniqueSequence++};x.severity=a.event?a.event.severity:"none";x.eventLevel=[];x.eventLevel.push(g);x.eventLevel.push(a.source);
x.eventMeta={};x.eventMeta.event=a.event;x.eventMeta.meta=a.meta;x.isAnonymousInfo=!0;x.sourceTimeStamp=b;if(m.eventServer.url&&m.eventLoggerToken){var p=new XMLHttpRequest;p.onreadystatechange=function(){4===this.readyState&&200===this.status?e["default"].info(this.responseText):e["default"].error("Connection to Event Server did not establish. readyState: "+this.readyState+" Status: "+this.status)};p.open("POST","https://"+m.eventServer.url+"/event",!0);p.setRequestHeader("Content-Type","application/json");
p.setRequestHeader("eventToken",m.eventLoggerToken);p.send(JSON.stringify(x))}else m.eventBuffer.push(x)}}catch(k){e["default"].error("Error! Failed to post log event to Event Server. Error: "+k+".")}};m.debug=function(d,a,b){m.log(1,{source:d,event:a,meta:b})};m.trace=function(d,a,b){m.log(2,{source:d,event:a,meta:b})};m.info=function(d,a,b){m.log(3,{source:d,event:a,meta:b})};m.warn=function(d,a,b){m.log(4,{source:d,event:a,meta:b})};m.error=function(d,a,b){void 0!=b.error&&"object"!=typeof b.error&&
(b.error={errorDesc:b.error});m.log(5,{source:d,event:a,meta:b})};m.close=function(){};m.revalidate=function(){};m.processBufferEvents=function(){for(var d=0;d<m.eventBuffer.length;d++){var a=m.eventBuffer[d],b=new XMLHttpRequest;b.onreadystatechange=function(){4==this.readyState&&200==this.status?e["default"].info(this.responseText):e["default"].error("Connection to Event Server did not establish. Status: "+this.status)};b.open("POST","https://"+m.eventServer.url+"/event",!0);b.setRequestHeader("Content-Type",
"application/json");b.setRequestHeader("eventToken",m.eventLoggerToken);b.send(JSON.stringify(a))}};m.setClientId=function(d){m.clientId=d};m.setEventLoggerToken=function(d){d&&(m.eventLoggerToken=d,m.eventLoggerToken&&m.eventServer&&m.eventServer.url&&m.processBufferEvents())};return m}();r.a=n},function(l,r,n){r.a={vcx_player:{width:"inherit",height:"inherit",position:"relative","background-color":"black",overflow:"hidden"},vcx_player_loader:{width:"100%",height:"100%",position:"absolute"},vcx_player_screen_saver:{width:"100%",
height:"100%",position:"absolute","z-index":"1"},vcx_stream:{width:"inherit !important",height:"inherit !important",position:"absolute","object-fit":"cover"},default_vcx_bar:{height:"100%",width:"100%",position:"absolute"},vcx_subbar_bottom:{width:"100%",height:"15%","max-height":"33px",color:"#aaa",position:"absolute",bottom:0,"background-repeat":"repeat-x;","-webkit-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)",transition:"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-moz-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)",
"background-position":"bottom","padding-top":"50px","z-index":2},vcx_subbar_top:{width:"100%",height:"15%","max-height":"30px",color:"#aaa",position:"absolute",top:0,"background-repeat":"repeat-x",transition:"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-webkit-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-moz-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","background-position":"top !important","padding-bottom":"50px","z-index":2},vcx_subbar_left:{width:"15%",height:"100%","max-width":"30px",
color:"#aaa",position:"absolute",left:0,"background-repeat":"repeat-x",transition:"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-webkit-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-moz-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","background-position":"bottom"},vcx_subbar_right:{width:"15%",height:"100%","max-width":"30px",color:"#aaa",position:"absolute",right:0,transition:"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","-webkit-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)",
"-moz-transition":"opacity .25s cubic-bezier(0.0,0.0,0.2,1)","background-position":"bottom"},brand_logo:{"max-width":"30px","max-height":"30px",cursor:"pointer",position:"absolute",right:"0px",margin:"5px"},theater_view:{width:"100% !important",height:"80% !important"},full_view:{width:"100% !important",height:"100% !important",top:"0px",left:"0px",position:"fixed !important","z-index":3},icon:{margin:"7px","max-width":"30px",cursor:"pointer"},icon_record:{color:"#f00"},icon_volume:{color:"#aaa"},
icon_play:{color:"#aaa"},icon_mic:{color:"#aaa"},icon_zoom:{color:"#aaa"},icon_share:{color:"#aaa"}}},function(l,r,n){var e=this,u=n(7),m=n(4),d=n(40),a=n(14),b=n(52),g=n(3),x=n(53),p=n(19),k=n(0),v=n(5),t=n(6);l=n(1);var w=n.n(l),q=n(8),c=n(9),G=n(16),E=n(56),z=n(61),K=n(62),B=n(67),Y=["user","owner","room","session"],y=["all","none"],F=!0,S;window.statsIcon='<svg  viewBox="0 0 16 16" width="16" height="16" xml:space="preserve" fill="green"><rect height="6" width="4" y="10"/><rect height="10" width="4" x="6" y="6"/><rect height="16" width="4" x="12"/></svg>';
window.lowBwIcon='<svg id="icon_low_bw" height="20" viewBox="0 0 24 24" width="20" title="Low Bandwidth"><path d="m16.155 13.799-5.284 7.908c-.43.665.048 1.542.84 1.542h10.507c.789 0 1.268-.872.843-1.538l-5.223-7.908c-.392-.613-1.288-.616-1.683-.004z" fill="#ffc107"/><path fill="#f44236" d="m22.288 24.031h-10.576c-.944 0-1.712-.747-1.712-1.665 0-.333.098-.647.281-.908l5.271-8.206c.294-.479.852-.784 1.448-.784s1.154.305 1.456.796l5.28 8.221c.166.235.264.549.264.882 0 .918-.768 1.664-1.712 1.664zm-5.288-10.062c-.088 0-.154.042-.179.082l-5.296 8.245c-.025.148.062.235.187.235h10.576c.125 0 .212-.087.212-.165 0-.027-.006-.042-.008-.044l-5.306-8.26c-.032-.051-.098-.093-.186-.093z"/><path fill="#f44236" d="m17 19.719c-.414 0-.75-.336-.75-.75v-1.917c0-.414.336-.75.75-.75s.75.336.75.75v1.917c0 .414-.336.75-.75.75z"/><ellipse cx="17" cy="21.365" rx=".75" ry=".719"/><path fill="#f44236" d="m.75 24c-.414 0-.75-.336-.75-.75v-7.5c0-.414.336-.75.75-.75s.75.336.75.75v7.5c0 .414-.336.75-.75.75z"/><path fill="#f44236" d="m6.75 24c-.414 0-.75-.336-.75-.75v-11.5c0-.414.336-.75.75-.75s.75.336.75.75v11.5c0 .414-.336.75-.75.75z"/><path fill="#f44236" d="m12.75 13.74c-.414 0-.75-.336-.75-.75v-7.24c0-.414.336-.75.75-.75s.75.336.75.75v7.24c0 .414-.336.75-.75.75z"/><path fill="#f44236" d="m18.75 11.11c-.414 0-.75-.336-.75-.75v-9.61c0-.414.336-.75.75-.75s.75.336.75.75v9.61c0 .414-.336.75-.75.75z"/></svg>';
r.a=function(l,n,r){function M(h){return void 0==h||"string"!=typeof h||0==Y.includes(h)?!1:!0}if(w.a.is_supported()){var f=Object(m.c)(r),ba=void 0,ca=0;f.filesToUpload=[];f.f2rec={};f.availableFiles=[];var I=new Map,N=new Map,O=new Map,U=[],H=10485760,ia="",ea="";f.showFsUi=!1;f.internetDetectionUrl=w.a.internetDetectionUrl;f.remoteStreams=Object(x.a)();f.remotePendingStreams=Object(x.a)();f.numATSubscribersAdded=0;f.localStreams=Object(x.a)();f.roomID="";f.talkerCount=0;f.userAudioTalkerCount=
0;f.userVideoTalkerCount=0;f.state=0;f.allStreamsActive=!1;f.streamsHealthTimerId=0;f.Connection=void 0===n?u.a:n;f.receiveVideoQuality=new Map;f.receiveVideoQuality.set("talker","Auto");f.receiveVideoQuality.set("canvas","HD");f.mediaStatsMode="disable";f.liveTranscription=!1;f.liveRoomTranscription=!1;f.transcriptionLanguage="";f.liveMeetingAnalytics=!1;var A=Object(d.a)(l);f.socket=A;f.userList=new Map;f.dialOutList=new Map;f.cControlReq=void 0;f.cCrequest=[];f.awaitedParticipants=new Map;f.floorGranted=
!1;f.floorInvited=!1;f.floorAccepted=!1;f.roomJson=void 0;f.clientId=void 0;f.mode=void 0;f.activeTalker=!1;f.shareStatus=!1;f.share_override_room=!1;f.shareOverRide=!1;f.shareOverRideCallback=void 0;f.isOverRidingShare=!1;f.ScreenSharelocalStream=null;f.isSharingClient=!1;f.forcedStopSharing=!1;f.isCanvasSharing=!1;f.isCanvasSharingClient=!1;f.canvasStatus=!1;f.activeTalkerList=new Map;f.audioOnlyMode=!1;f.roomMuted=!1;var Z=JSON.parse(p.a.decodeBase64(r.token));f.reconnectionState=!1;f.reconnectAttempt=
0;f.connectAttempt=0;var D=3;f.isStreamingClient=!1;f.sendRecvBitrateStats=!1;f.speakerInfo={id:r&&r.speakerId?r.speakerId:void 0,volume:1};var V="none",fa=0,aa=!1,Aa=!1,ka=!1,ra=!1,ma=!1,va;r.hasOwnProperty("reconnectInfo")?(k["default"].info("reconnect parameter",r.reconnectInfo),f.reconnectionAllowed=r.reconnectInfo.allow_reconnect,f.reconnectionTimeOutInterval=r.reconnectInfo.timeout_interval,D=r.reconnectInfo.number_of_attempts):(f.reconnectionAllowed=!0,f.reconnectionTimeOutInterval=45E3,D=
3);w.a.alertNotifyInfo={mode:"image"};r.alertNotifyInfo&&"object"===typeof r.alertNotifyInfo&&r.alertNotifyInfo.mode&&("text"==r.alertNotifyInfo.mode||"image"==r.alertNotifyInfo.mode||"none"==r.alertNotifyInfo.mode)&&(w.a.alertNotifyInfo=Object.assign(w.a.alertNotifyInfo,r.alertNotifyInfo));var W=!1,sa=-1;f.localStreamsBeforeReconnect=Object(x.a)();f.oldSpecInfo=void 0;f.mediaConfiguration=Z.roomMeta.settings.media_configuration?Z.roomMeta.settings.media_configuration:"Default";f.maxVideoLayers=0;
f.defaultBandwidth=new Map;f.defaultBandwidth.set(1,2E5);f.defaultBandwidth.set(2,3E5);f.defaultBandwidth.set(3,4E5);f.defaultBandwidth.set(4,6E5);f.defaultBandwidth.set(5,8E5);f.defaultBandwidth.set(6,1E6);f.defaultBandwidth.set(7,12E5);f.videoMutedUsers={};var Fa,da;f.mediaActivationDelaySecs=0;var P,T=f.remoteStreams,na=f.remotePendingStreams,wa=f.numATSubscribersAdded,X=f.localStreams,J={},Q={};f.hardMuteRoom=!1;var xa=Object(b.a)(null,null);f.breakOutRoom=xa;f.me={};f.roomSettings={};f.mute=
!1;f.muteInfo={room:{audio:!1,video:!1},stream:{hard:{audio:!1,video:!1}}};f.muteAudioOnJoin=!1;f.muteVideoOnJoin=!1;f.cCapprovedHands=[];f.externalIp="";f.subscribeSessionStats=!1;f.canvasOptions={width:1280,height:720,domHandle:""};f.inputContext=null;f.canvasVideoPlayer="";var R=w.a.video_resolution_range[Z.roomMeta.settings.quality],Ga=document.createElement("style");Ga.innerHTML=".stats-container{ \n                         position: absolute;\n                         z-index: 5;\n                         padding: 2px;\n                         top: 2px;\n                         right: 2px;\n                         font-size: 12px;\n                         width: 22px;\n                         height: 22px;\n                         text-align: center;\n                         background: white;\n                         border-radius: 10px;\n                     }\n                     .stats-button{\n                         cursor:pointer;\n                         width: 15px;\n                         height: 15px;\n                         padding: 0 0 0 2px;\n                     }\n                     .stats-detail{ height: 100%;}\n                     .stats-overlay-inner{\n                         display: flex;\n                         flex-direction: row;\n                         justify-content: space-between;\n                         padding: 8px 2px 6px 10px;\n                     }\n                     .stats-right-partition, .stats-left-partition {}\n                     .stats-left-partition {margin-right: 10px;}\n                     .stats-button svg {width: 12px;height: 12px;}\n                         ";
var Pa=document.createElement("style");Pa.innerHTML=".bw-notification{\n                                 position: absolute;\n                                 //z-index: 5;\n                                 top:1%;\n                                 left:50%;\n                                 //bottom: 5px;\n                                 //right: 5px;\n                                 //margin-top:-50px;\n                                 //margin-left:-100px;\n                                 padding: 5px;\n                                 color: #fff;\n                                 //background: rgba(50,50,50,0.5);\n                                 }";
var ya=!1,za=!1,$a=0,Ba=function(h){k["default"].info(" in Remove stream : id: "+h.getID()+" stream.stream : "+h.stream);h.stream&&(h.hide(),h.stop(),h.close(),delete h.stream);h.pc&&(h.pc.close(),delete h.pc)},Ia=function(h,a){Ha(h,"add",function(h){})},Gb=function(h,a){k["default"].info("Stream subscribed");a.stream&&(h.initRemoteStream(a.stream),f.remoteStreams.remove(h.getID()),f.remoteStreams.add(h.getID(),h));a=Object(m.f)({type:"stream-subscribed",stream:h});f.dispatchEvent(a);h.room=f;!0!==
h.screen&&!0!==h.canvas||h.updateVideo(h.getID())},ab=function(h,a,c){var b={callback:function(a){k["default"].debug("Sending message",a);f.socket.sendSDP("signaling_message",{streamId:h.getID(),msg:a,browser:h.pc.browser},void 0,function(){})},nop2p:!0,audio:a.audio&&h.ifAudio(),video:a.video&&h.ifVideo(),maxAudioBW:a.maxAudioBW,maxVideoBW:a.maxVideoBW,limitMaxAudioBW:r.maxAudioBW,limitMaxVideoBW:r.maxVideoBW,iceServers:f.iceServers,forceTurn:h.forceTurn};c||(b.simulcast=a.simulcast);return b},Hb=
function(){2==f.state&&f.allStreamsActive&&(T.forEach(function(h,a){2==f.state&&"connected"==h.state&&(a=bb(h),a.audio&&a.video||Ha(h,"add",function(h){}))}),X.forEach(function(h,a){2==f.state&&"connected"==h.state&&(a=bb(h),a.audio&&a.video||(k["default"].debug(" stream state: id "+h.getID()+" health: "+JSON.stringify(a)),h.ifScreen()&&h.ifCanvas()?(a=h.ifScreen()?" stream-screen failed ":" stream-canvas failed",f.dispatchEvent({type:a,stream:h})):(a.audio||h.muteAudio(function(a){h.unmuteAudio(function(a){a.result!==
t.a.error_000.result&&f.dispatchEvent({type:"stream-audio failed",stream:h})},!1)},!1),a.video||h.muteVideo(function(a){h.unmuteVideo(function(a){a.result!==t.a.error_000.result&&f.dispatchEvent({type:"stream-video failed",stream:h})},!1)},!1))))}))},bb=function(h){var a={audio:!0,video:!0};if(h){var b=function(a,c,f){void 0==h.tracksInfo&&(h.tracksInfo={audio:{numSecsMuted:0},video:{numSecsMuted:0}});if(c){var b=a.getAudioTracks();a=h.tracksInfo.audio}else b=a.getVideoTracks(),a=h.tracksInfo.video;
c="NA";b=$jscomp.makeIterator(b);for(var d=b.next();!d.done;d=b.next())d=d.value,!0===d.enabled?"live"===d.readyState?f&&d.muted?3>++a.numSecsMuted?k["default"].error("Track ready but muted ,wait timeout id: "+h.getID()+" - "+d.kind+"num secs muted: "+a.numSecsMuted):(c="INACTIVE",a.numSecsMuted=0,k["default"].error("Track not ready - muted with timeout id: "+h.getID()+" - "+d.kind+" num secs muted: "+a.numSecsMuted)):(k["default"].debug("Track ready  id: "+h.getID()+" - "+d.kind),a.numSecsMuted&&
(a.numSecsMuted=0),c="ACTIVE"):(k["default"].error("Track not ready id : "+h.getID()+" - "+d.kind+" state: "+d.readyState),a.numSecsMuted=0,c="INACTIVE"):k["default"].debug("Track not ready  and not enabled : id "+h.getID()+" - "+d.kind);return c},d=!1,g=!1;if(h.local)h.audioStream&&(a.audio=b(h.audioStream,!0,!h.ifCanvas()&&!h.ifScreen())),h.videoStream&&(a.video=b(h.videoStream,!1,!h.ifCanvas()&&!h.ifScreen()));else{if(h.ifScreen()||h.ifCanvas())h.ifScreen();else{var e=f.activeTalkerList.get(h.getID());
if(e)switch(e.mediatype){case "audiovideo":d=g=!0;break;case "video":d=!0;break;case "audio":case "audioOnly":g=!0}}h.stream&&(a.audio="INACTIVE"!=b(h.stream,!0,g),a.video="INACTIVE"!=b(h.stream,!1,d),a.video&&f.isStreamingClient&&h.player&&h.player.video&&(b=h.player.video,b.player_stats&&3E3<b.getVideoPlaybackQuality().creationTime-b.player_stats.creationTime&&!(b.getVideoPlaybackQuality().totalVideoFrames>b.player_stats.totalVideoFrames)&&(console.error(" video player stats stopped : frames prev: "+
b.player_stats.totalVideoFrames+" new: "+b.getVideoPlaybackQuality().totalVideoFrames),b={streamId:h.getID(),currTotalFrames:b.getVideoPlaybackQuality().totalVideoFrames,prevTotalFrames:b.player_stats.totalVideoFrames},c.a.error("stream-event",q.a.event_stream_player_failed,{error:b}))))}}return a},Jb=function(h,a){h.pc=f.Connection.buildPair(ab(h,a,!0));k["default"].info("Create remote connection for subscribe:-"+JSON.stringify(a));h.pc.onaddstream=Gb.bind(null,h);k["default"].info("Registering the peer connection timer for the subscriber stream "+
h.getID());var b=function(a,f){k["default"].debug(" stream state ICE remote id - "+h.getID()+" : "+a+" source: "+f);"failed"===a?(h.reconnect=!1,k["default"].error(f+" connection state failed - streamId: "+h.getID()),Ia(h),c.a.error("room-event",q.a.event_ice_failed,{error:{}})):(k["default"].debug("stream ID",h.getID()),k["default"].debug("ice connection state",a),"connected"===a&&(k["default"].info("ice connection state connected - streamId : "+h.getID()),c.a.info("room-event",q.a.event_ice_success,
{message:"ICE connected successfully"}),h.reconnect&&(h.reconnect=!1,h.reconnectAttempt=0,(a=O.get(h.getID()))?("none"!=a.mediatype&&(f=JSON.parse(JSON.stringify(a)),f.mediatype="none",h.reloadPlayer(f,ka)),h.reloadPlayer(a,ka)):k["default"].info(" stream state ICE remote id - "+h.getID()+" : ICE reconnected "))))};h.pc.oniceconnectionstatechange=function(h){b(h,"ice")};h.pc.onconnectionstatechange=function(h){b(h,"pc")};h.pc.createOffer(!0)},Ha=function(h,a,c){c=void 0===c?function(){}:c;if(0==f.socket.state||
!0===f.reconnectionState)k["default"].error("checkWaitReconnectStream() room/socket not connected id : "+h.getID()+" sock state: "+f.socket.state+" recon state: "+f.reconnectionState),c(!1);if("add"==a)if("connected"!==h.state)k["default"].error("checkWaitReconnectStream() invalid state - stream id : "+h.getID()+" state: "+h.state),c(!1);else if(h.reconnectAttempt>=D)k["default"].error("checkWaitReconnectStream() reconnect retries exceed - global reconnect stream id: "+h.getID()),2==f.state&&f.socket.disconnect(),
c(!1);else{h.reconnect=!0;h.state="wait_for_reconnect";if("mobile"==w.a.browser_info.device_type){var b=Object.keys(J).length||Object.keys(Q).length;h.local?h.ifCanvas()||h.ifScreen()?h.ifScreen()?J.screen=h:h.ifCanvas()&&(J.canvas=h):J.main=h:Q[h.getID().toString()]=h;if(b){k["default"].warning("reconnectStream() queue > 1 waiting id: "+h.getID()+" len loc: "+Object.keys(J).length+" rem: "+Object.keys(Q).length);c(!0);return}}fa||(fa++,f.dispatchEvent(Object(m.e)({type:"network-reconnecting",message:"Connection issues - reconnecting, please wait"})));
Sa(h,function(a){!1===a&&(k["default"].error("checkWaitReconnectStream () failed streamId: "+h.getID(),2==f.state?" global reconnect":"room not connected ignoring "),2==f.state&&f.socket.disconnect());c(a)})}else if("mobile"==w.a.browser_info.device_type){h.local?h.ifCanvas()||h.ifScreen()?h.ifScreen()?J.screen&&delete J.screen:J.canvas&&delete J.canvas:J.main&&delete J.main:Q[h.getID().toString()]&&delete Q[h.getID().toString()];a=0;for(b in J)if("wait_for_reconnect"==J[b].state){Sa(J[b],c);a++;
break}if(!a)for(var d in Q)if("wait_for_reconnect"==Q[d].state){Sa(Q[d],c);a++;break}a||(1==fa&&f.dispatchEvent(Object(m.e)({type:"network-reconnected"})),c(!0));fa&&fa--}},Sa=function(h,a){a=void 0===a?function(){}:a;h.state="reconnecting";h.reconnectAttempt++;h.reconnectsTotal+=1;var c=h.userRequestOptions,b="none",d=setTimeout(function(){k["default"].info("reconnectStream() fail timeout stream local: "+h.local+" id: "+h.getID()+" cmd: "+b);a(!1)},3E3);h.local?(k["default"].info("reconnectStream()  streamId: "+
h.getID()+" calling unpublish()"),b="unpublish",f.unpublish(h,function(la,g){k["default"].info("reconnectStream()  streamId: "+h.getID()+" unpublish callback calling publish()");b="publish";f.publish(h,c,function(){k["default"].info("reconnectStream()  streamId: "+h.getID()+" publish callback");b="publish-done";clearTimeout(d);a(!0)})})):(k["default"].info("reconnectStream()  streamId: "+h.getID()+" calling unsubscribe()"),b="unsubscribe",f.unsubscribe(h,function(la,g){b="subscribe";k["default"].info("reconnectStream()  streamId: "+
h.getID()+" unsubscribe callback calling publish()");f.subscribe(h,c,function(){b="subscribe-done";k["default"].info("reconnectStream()  streamId: "+h.getID()+" subscribe callback");clearTimeout(d);a(!0)})}))};f.reconnectStream=function(h,a){Ha(h,"add",void 0===a?function(){}:a)};f.notifyDeviceUpdate=function(){var h={mic:!0,cam:!0,speaker:!1};X.forEach(function(a,c){a.ifScreen()||a.ifCanvas()||(h.mic=a.audio,h.cam=a.video)});u.a.mediaDeviceUpdate(h,"room_notifyDeviceUpdate",function(h){f.dispatchEvent(Object(m.e)({type:"user-media-device-list-change",
message:h}))})};var Kb=function(h,a){a=Object.assign(a);h.audio||(a.audio=!1);h.pc=f.Connection.buildPair(ab(h,a));if(h.audioStream)for(var c=$jscomp.makeIterator(h.audioStream.getAudioTracks()),b=c.next();!b.done;b=c.next())h.pc.addTrack(b.value);if(b=h.ifCanvas()||h.ifScreen()?h.videoStream:h.inputMediaSource.video[h.inputMediaSource.video.selected])for(c=$jscomp.makeIterator(b.getVideoTracks()),b=c.next();!b.done;b=c.next())h.pc.addTrack(b.value);k["default"].info("Registering the peer connection timer for the subscriber stream "+
h.getID());var d=function(a,c){var f=h.ifCanvas()?"canvas":h.ifScreen()?"screen":"main";"failed"===a?(h.reconnect=!1,k["default"].error(" stream state  local  "+f+" : "+a+" source: "+c+" reconnect: "+h.reconnect),Ia(h)):"connected"===a&&(h.reconnect=!1,h.reconnectAttempt=0,k["default"].info(" stream state local  "+f+" : "+a+" source: "+c));k["default"].info("handleConnectionStateChange state:",a)};h.pc.oniceconnectionstatechange=function(h){d(h,"ice")};h.pc.onconnectionstatechange=function(h){d(h,
"pc")};a.createOffer||h.pc.createOffer()},cb=function(h){var b=Object(a.a)(f.Connection,{streamID:h.id,local:!1,clientId:h.clientId,audio:h.audio,video:h.video,data:h.data,screen:h.screen,attributes:h.attributes});b.room=f;T.add(h.id,b);h=Object(m.f)({type:"stream-added",stream:b});c.a.info("room-event",q.a.event_general_success,{message:"socketOnAddStream - stream added"});f.dispatchEvent(h)},Lb=function(h){h=h.id.streamId;var b=Object(a.a)(f.Connection,{streamID:h}),k=g.a.getById("screen_saver_"+
h);g.a.getByClass("icon_play",k.parentNode).disabled=!0;k&&"none"===k.style.display?k.style.display="block":k&&"block"===k.style.display&&(k.style.display="none");h=Object(m.e)({type:"track-removed",streams:[b],message:"tracked removed from stream: "+h});c.a.info("room-event",q.a.event_general_success,{message:"socketOnRemoveTrack - tracked removed from stream"});f.dispatchEvent(h)},eb=function(h){var a=h.name,b=h.role,d=h.permissions,g={name:h.name,permissions:h.permissions,role:h.role,user_ref:h.user_ref,
videoMuted:h.videoMuted,audioMuted:h.audioMuted};g.audioEnabled=void 0!=h.audioEnabled?h.audioEnabled:!0;g.videoEnabled=void 0!=h.videoEnabled?h.videoEnabled:!0;void 0!=h.data&&(g.data=h.data);"audience"!=h.role&&f.userList.set(h.clientId,g);"audience"==h.role&&(f.audienceCount=h.audienceCount?h.audienceCount:0);var e=g.numActiveATSubs?g.numActiveATSubs:f.userList.size;if(e>wa&&na.size()){var p=wa+1,t=na.get(p);t?(na.remove(p),T.add(p,t),wa=p,db(t,t.userRequestOptions,function(){})):k["default"].error("susbcribe failed user connected stream not found streams id: "+
(wa+1)+" numActiveATSubs: "+e+" First: "+na.get(p)+" second: "+na.get(p.toString()))}f.awaitedParticipants.get(h.clientId)&&f.awaitedParticipants.delete(h.clientId);k["default"].info("userConnected() user name: "+a);c.a.info("room-event",q.a.event_room_user_connect_success,{message:"userConnect - user connected"});h={type:"user-connected",clientId:h.clientId};f.privacyModes&&f.privacyModes.userListHidden&&"moderator"!==f.me.role||(h.name=a,h.role=b,h.permission=d,h.user=g);f.dispatchEvent(Object(m.g)(h))},
Mb=function(h){var a=f.userList.get(h.clientId);!a||f.privacyModes&&f.privacyModes.userListHidden&&"moderator"!==f.me.role?void 0==a?k["default"].error("userUpdate() failed - user not found : "+JSON.stringify(h)):k["default"].debug("userUpdate() failed - privacy policy userList hidden enabled"):"media-modes"==h.key?void 0!=h.info&&void 0!=h.info.publish?(a.audioEnabled!=h.info.publish.audio&&(a.audioEnabled=h.info.publish.audio,f.dispatchEvent(Object(m.g)({type:a.audioEnabled?"user-audio-enabled":
"user-audio-disabled",clientId:h.clientId}))),a.videoEnabled!=h.info.publish.video&&(a.videoEnabled=h.info.publish.video,f.dispatchEvent(Object(m.g)({type:a.videoEnabled?"user-video-enabled":"user-video-disabled",clientId:h.clientId})))):k["default"].error("userUpdate() failed - filed missing for media-modes : "+JSON.stringify(h)):k["default"].error("userUpdate() failed - invalid key : "+JSON.stringify(h))},fb=function(h){var a=h.name,b=h.role,k=h.permissions,d=h.clientId;"audience"!=b&&f.userList.delete(h.clientId);
"audience"==h.role&&f.audienceCount&&0<f.audienceCount&&f.audienceCount--;"lecture"===f.mode&&"moderator"===f.me.role&&Ja(d);h=Object(m.g)({type:"user-disconnected",name:a,clientId:d,role:b,permission:k});c.a.info("room-event",q.a.event_room_user_disconnect_success,{message:"userDisConnect - user disconnected"});f.dispatchEvent(h)},gb=function(h){h=Object(m.d)({type:"user-subscribed",name:h.name,role:h.role,user_ref:h.user_ref,socket:h.socket});c.a.info("room-event",q.a.event_general_success,{message:"userSubcribe - user subscribed"});
f.dispatchEvent(h)},hb=function(h){h=Object(m.d)({type:"user-subscribed",name:h.name,role:h.role,user_ref:h.user_ref,socket:h.socket});c.a.info("room-event",q.a.event_general_success,{message:"userUnSubcribe - user unsubscribed"});f.dispatchEvent(h)},ib=function(h){var a;k["default"].debug(" socketOnVcxRtcMessage() arg: "+JSON.stringify(h));if((a=h.peerId?T.get(h.peerId):X.get(h.streamId))&&!a.failed&&a.pc)if(a.pc.processSignalingMessage(h.msg,f.mediaConfiguration),h.msg&&"object"===typeof h.msg&&
"ready"===h.msg.type){if(a.local)if(Ma(a.ifScreen(),a.ifCanvas()),a.ifCanvas()||a.ifScreen())Na(!1,a.getID(),!0),k["default"].info("stream state local "+(a.ifCanvas()?"canvas":"screen")+" ready");else{k["default"].info(" stream state local main: ready");h={local:!1,hard:!1,eventInfo:void 0};var c={local:!1,hard:!1,eventInfo:void 0};f.muteInfo.stream.hard.audio&&!f.hardMuteInitiator&&(h.hard|=1);k["default"].info("streamId: "+a.getID()+" local cam Publish ready state");void 0!=f.videoMuteOnJoin&&(c.local|=
f.videoMuteOnJoin.local,c.hard|=f.videoMuteOnJoin.hard,delete f.videoMuteOnJoin);void 0!=f.audioMuteOnJoin&&(h.local|=f.audioMuteOnJoin.local,h.hard|=f.audioMuteOnJoin.hard,delete f.audioMuteOnJoin);h.local|=a.config.audioMuted;c.local|=a.config.videoMuted;0==a.video&&(c={local:!1,hard:!1});0==a.audio&&(h={local:!1,hard:!1});Nb(a,h,c,!0);a.config.audioMuted&&(a.config.audioMuted=!1);a.config.videoMuted&&(a.config.videoMuted=!1)}else k["default"].info(" stream state remote id - "+a.getID()+" : ready");
a.onConnectionStateChanged(!0);Ha(a,"del")}else void 0!=f.speakerInfo.id&&a.setSpeaker(f.speakerInfo.id);else c=" id: ",c=void 0!=h.peerId?c+h.peerId:void 0!=h.streamId?c+h.streamId:c+"undefined ",c+=" err: ",c=a?a.failed?c+"stream failed true ":c+"stream PC  null":c+"stream not found",k["default"].error("socketOnVcxRtcMessage(), Failed "+c+" arg: "+JSON.stringify(h))},Ob=function(h){var a=X.get(h.streamId);a&&!a.failed?a.pc.get(h.peerSocket).processSignalingMessage(h.msg):(a=T.get(h.streamId),a.pc.processSignalingMessage(h.msg))},
jb=function(h){X.get(h.streamId)},Pb=function(h){X.get(h.streamId)},kb=function(h){k["default"].debug("Received SocketOnSelfBandwidthAlert",JSON.stringify(h));if("SubscriberBandWidth"===h.message){var a=Object(m.e)({type:"room-bandwidth-alert",message:h.bandwidth});f.dispatchEvent(a)}else X.forEach(function(a,f){1===h.bandwidth?(k["default"].info("mute publisher video due to low bandwidth"),c.a.info("room-event",q.a.event_low_bandwidth_update,{message:"socketOnSelfBandwidthAlert - muted publisher video due to low bandwidth"}),
a.muteVideo()):"ShareBandwidth"===h.message&&a.screen?a.setVideoParamsRange(h.bandwidth,void 0,void 0,void 0,!0):"PublisherBandwidth"!==h.message||a.screen||(S=h.bandwidth,a.setVideoParamsRange(h.bandwidth,void 0,void 0,void 0,!0))})},Qb=function(h){"bw-alert"===h.id?lb(h.msg):"publisher-bw"===h.id||"share-bw"===h.id?kb(h.msg):(h=Object(m.e)({type:h.id,message:h.msg}),f.dispatchEvent(h))},lb=function(h){k["default"].info("OnbandwidthAlert:",h);for(var a=0;a<h.length;a++){var c=f.remoteStreams.getAll()[h[a].streamId];
null==c?k["default"].info("Stream not found"):c.setBandwidthAlert(h[a])}},Rb=function(h){if(f.activeTalker)if(f.eventsList&&void 0!==f.eventsList&&"message-received"in f.eventsList){var a=Object(m.e)({type:"message-received",message:h.msg});f.dispatchEvent(a)}else a=Object(m.e)({type:"active-talker-data-in",message:h.msg}),f.dispatchEvent(a);else a=T.get(h.id),h=Object(m.f)({type:"stream-data-in",msg:h.msg,stream:a}),a.dispatchEvent(h)},Oa=function(h,a,c,b){b=document.createElement("div");b.setAttribute("id",
"fs-notif-id-"+Math.random());b.setAttribute("class","fs-notification");b.setAttribute("style","display:block;position:relative;z-index:3;padding:5px 10px;top:50%;right:50%;transform:translateX(50%);background:rgba(0,0,0,0.29);border-radius:5px;color:rgb(255,255,255)");a.appendChild(b);a=b;switch(c){case "fs-upload-init":c="upload started for file "+h.data[h.data.length-1].name+" of size "+h.data[h.data.length-1].size/1E3+" KB";b=h.message;h=document.createElement("br");a.appendChild(h);c=document.createTextNode(c);
a.appendChild(c);a.appendChild(h);break;case "fs-file-uploaded":c="uploaded 100 % "+h.name+"  of size "+h.size/1E3+" KB";b=h.message;h=document.createElement("br");a.appendChild(h);c=document.createTextNode(c);a.appendChild(c);a.appendChild(h);break;case "fs-upload-started":c=h.sender+" is sharing file "+h.message.data[h.message.data.length-1].name+"  of size "+h.message.data[h.message.data.length-1].size/1E3+" KB";b=h.message;h=document.createElement("br");a.appendChild(h);c=document.createTextNode(c);
a.appendChild(c);a.appendChild(h);break;case "fs-file-available":b=h.message;h=document.createElement("br");a.appendChild(h);var d=document.createElement("BUTTON");c=document.createTextNode(b.name);d.setAttribute("style","color:red;font-size:23px");d.setAttribute("id",U.length-1);d.appendChild(c);a.appendChild(d);d.onclick=function(){f.recvFiles(d.id)};a.appendChild(h);break;default:k["default"].info("random data to fantom UI ")}},Sb=function(h,a){k["default"].debug("socketOnDataStreamToRoom",h.type);
switch(h.type){case "chat":var b="message-received";break;case "data-internal-in":b=h.message.type;switch(h.message.type){case "fs-upload-started":h.message.broadcast=h.broadcast;h.message.sender=h.sender;h.message.senderId=h.senderId;k["default"].info(" file is being shared with you fs-upload-started",h.message);!0===f.showFsUi&&null!==document.getElementById(ea)&&(Oa(h,document.getElementById(ea),"fs-upload-started"),c.a.info("room-event",q.a.event_file_download_success,{error:{}}));break;case "fs-file-available":h.message.broadcast=
h.broadcast;h.message.sender=h.sender;h.message.senderId=h.senderId;U.push(h.message);var d={broadcast:h.broadcast,sender:h.sender,senderId:h.senderId,name:h.message.name,size:h.message.size,speed:h.message.speed,createdAt:h.message.createdAt,dlimit:h.message.dlimit,time:h.message.time,expiresAt:h.message.expiresAt,timeLimit:h.message.timeLimit,index:U.length-1};f.availableFiles.push(d);k["default"].info("file is available to download fs-file-available",d);d=Object(m.e)({type:"fs-download-result",
message:{messageType:"download-available",result:0,description:"file-available",response:{downloadStatus:"available",jobId:d.index,downloadInfo:d}}});f.dispatchEvent(d);!0===f.showFsUi&&null!==document.getElementById(ea)&&Oa(h,document.getElementById(ea),"fs-file-available");break;case "fs-upload-cancelled":break;default:k["default"].info("unknown internal data type from signaling server ",h.type),c.a.error("room-event",q.a.event_file_download_failed,{error:{}})}break;default:b="user-data-received"}f.eventsList&&
b in f.eventsList?(h=Object(m.e)({type:b,message:h}),f.dispatchEvent(h),a&&a(t.a.error_000)):a&&a(t.a.error_1169)},Tb=function(h){var a=T.get(h.id),c=Object(m.f)({type:"stream-attributes-updated",attrs:h.attrs,stream:a});a.updateLocalAttributes(h.attrs);a.dispatchEvent(c)},mb=function(h){var a=X.get(h.id);if(a)Ia(a);else if(a=T.get(h.id))T.remove(h.id),Ba(a),h=Object(m.f)({type:"stream-removed",stream:a}),c.a.info("room-event",q.a.event_general_success,{message:"socketOnRemoveStream - stream removed"}),
f.dispatchEvent(h)},Ub=function(){k["default"].info("Socket disconnected, lost connection to Signalling Server, room state: "+f.state);0!==f.state&&3!==f.state&&(f.breakOutRoom.disconnectAll(),pa(!1,!1))},Vb=function(h){if(h.streamId){var a="ICE Connection Failed on "+h.type+" "+h.streamId+" "+f.state;k["default"].error(a);c.a.error("room-event",q.a.event_ice_failed,{arg:h});h="publish"===h.type?X.get(h.streamId):T.get(h.streamId);Ia(h,a)}},Wb=function(h){k["default"].error("Cannot connect to client Controller");
c.a.info("room-event",q.a.event_general_success,{message:"socketOnError - Cannot connect to signalling"});f.dispatchEvent(Object(m.e)({type:"room-error",message:h}))},Ta=function(h){k["default"].debug("sendDataSocketFromStreamEvent");var a=h.stream;h=h.msg;a.local?A.sendMessage("sendDataStream",{id:a.getID(),msg:h}):(k["default"].error("You can not send data through a remote stream"),c.a.error("room-event",q.a.event_general_failed,{message:"sendDataSocketFromStreamEvent - You can not send data through a remote stream"}))},
Ua=function(h,a,c,b,d,g){h&&void 0!==a&&"boolean"===typeof a&&(!1!==a||c&&Array.isArray(c)&&c.length)&&"number"===typeof b?b>w.a.senduserDataMaximumLimit?(k["default"].error("message: content-length must be <= 2048, entered value : "+b+" kB"),g(t.a.error_1196)):f.socket.emitEvent("sendDataStreamToRoom",{msg:h,broadcast:a,clients:c,type:d},g):(k["default"].error("message: invalid parameter, msg/broadcast/clients/contentLength undefined or type mistmatch"),g(t.a.error_1155))};f.sendUserData=function(h,
a,c,f){f=void 0===f?function(){}:f;var b=100;h["content-length"]&&(b=h["content-length"],delete h["content-length"]);JSON.stringify(h).length/1024>b?(k["default"].error("message: large data, failed - larger text-data. Max allowed length is "+b+" kB"),f(t.a.error_1195)):Ua(h,a,c,b,"user_data",f)};var nb=function(h,a,c,f,b){h.type=a;Ua(h,c,f,0,"data-internal-in",void 0===b?function(){}:b)};f.recordTranscriptMessage=function(h,a){a=void 0===a?function(){}:a;"string"!=typeof h&&"object"==typeof h&&JSON.stringify(h);
f.socket.emitEvent("sendDataStreamToRoom",{msg:h,broadcast:!1,clients:[],type:"transcription"},a)};f.sendMessage=function(h,a,c,f){f=void 0===f?function(){}:f;var b=0;"string"==typeof h?b=h.length/1024:"object"==typeof h&&(b=JSON.stringify(h).length/1024);Ua(h,a,c,b,"chat",f)};var Xb=function(h,a){a=void 0===a?function(){}:a;var c=["grid","talker","presenter"],b=["liveRecording","streaming","screenShare","all"],d=h.service;h=h.layout;void 0==a||"function"!==typeof a?k["default"].error("message: invalid value for callback parameter"):
"moderator"!==f.me.role?(k["default"].warning("User should be a moderator to change layout details."),a(t.a.error_1168)):0===f.state?(k["default"].info("Room is disconnected"),a(t.a.error_7079)):void 0!=h&&"string"===typeof h&&c.includes(h)?void 0!=d&&"string"===typeof d&&b.includes(d)?(c={},c.layout=h,c.service=d,f.socket.sendParamEvent("sendLayoutData",c,function(h,c){k["default"].info("sending sendLayoutData");null===h?(k["default"].error("Error in layout update: ",c),a(c)):(k["default"].info("Layout updated successfully."),
a(h))})):(k["default"].error("message: invalid value for service parameter"),a&&a(t.a.error_1193)):(k["default"].error("message: invalid value for layout parameter"),a&&a(t.a.error_1192))},oa=function(h){var a=0,c=0,f=0,b=0,k=0,d=0,g="";h&&(Object.keys(h).forEach(function(g){switch(g){case "bitrateCalculated":b=Math.round(h[g]/1E3);break;case "framerateCalculated":k=h[g];break;case "bandwidth":f=Math.round(h[g]/1E3);break;case "packetsLost":d=h[g];break;case "frameHeight":a=h[g];break;case "frameWidth":c=
h[g]}}),!w.a.csp_enabled&&(g+='<div> <strong style="color:black;" > '+c+"X"+a+"p"+k+"@"+b+"Kbps</strong>:</div>",f||d))&&(g+='<div> <strong style="color:black;" > AvailBw:'+f+"Kbps, loss:"+d+"</strong>:</div>");return w.a.csp_enabled?{resHeight:a,resWidth:c,packetsLost:d,bandwidth:f,frameRate:k,bitrate:b}:{displayString:g,resHeight:a,resWidth:c,packetsLost:d,bandwidth:f,frameRate:k,bitrate:b}},Yb=function(h){var a=[],c={},b={},d={};h.statData.stats.forEach(function(h){var g=h.streamType;if("actStat"===
g){var la={};if(w.a.csp_enabled)for(void 0==a[h.subscriberStreamId]&&(a[h.subscriberStreamId]={id:h.subscriberStreamId}),la.video=[],Object.keys(h.total).forEach(function(a){"bitrateCalculated"===a&&(a=Math.round(h.total[a]/1E3),"notify"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)&&(la["total-bitrate-kbps"]=a)}),g=0;g<h.videoStats.length;g++)la.video[g]=oa(h.videoStats[g]);else g=document.querySelectorAll("#stats-left-part-"+h.subscriberStreamId),void 0==a[h.subscriberStreamId]&&(a[h.subscriberStreamId]=
{id:h.subscriberStreamId}),la.video=[],g.forEach(function(a){if(void 0!==a&&null!==a){var c="";Object.keys(h.total).forEach(function(a){if("bitrateCalculated"===a)if(a=Math.round(h.total[a]/1E3),"notify"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)la["total-bitrate-kbps"]=a;else if("display"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)c+="<div> <strong>Tx Total:</strong>:  "+a+"Kbps </div>"});for(var b=0;b<h.videoStats.length;b++)if(la.video[b]=oa(h.videoStats[b]),"display"==f.mediaStatsMode||
"notify-display"==f.mediaStatsMode)c+=la.video[b].displayString,a.innerHTML='<div id="" class="stats-detail"> \n                                    '+c+"\n                                </div>"}});a[h.subscriberStreamId].publisher=la}else if("selfPcStat"===g){void 0==a[h.subscriberStreamId]&&(a[h.subscriberStreamId]={id:h.subscriberStreamId});var e={video:[]};if(w.a.csp_enabled)for(parseInt(h.streamId),Object.keys(h.total).forEach(function(a){"bitrateCalculated"===a&&(a=Math.round(h.total[a]/1E3),
"notify"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)&&(e["total-bitrate-kbps"]=a)}),g=0;g<h.videoStats.length;g++)e.video[g]=oa(h.videoStats[g]);else{var p=parseInt(h.streamId)+1;document.querySelectorAll("#stats-right-part-"+h.subscriberStreamId).forEach(function(a){if(void 0!==a&&null!==a){var c="";Object.keys(h.total).forEach(function(a){if("bitrateCalculated"===a)if(a=Math.round(h.total[a]/1E3),"notify"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)e["total-bitrate-kbps"]=a;
else if("display"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)c+="<div> <strong>Rx ID: "+p+", Total:</strong>:  "+a+"Kbps </div>"});a.innerHTML='<div id="" class="stats-detail"> \n                                        '+c+"\n                                    </div>";for(var b=0;b<h.videoStats.length;b++)if(e.video[b]=oa(h.videoStats[b]),"display"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)c+=e.video[b].displayString,a.innerHTML='<div id="" class="stats-detail"> \n                                '+
c+"\n                                </div>"}})}k["default"].debug(" subscriberStreamId: "+h.subscriberStreamId+" substat: "+JSON.stringify(e));a[h.subscriberStreamId].subscriber=e}else if("selfPubStat"===g)if(w.a.csp_enabled)for(Object.keys(h.total).forEach(function(a){"bitrateCalculated"===a&&(a=Math.round(h.total[a]/1E3),"notify"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)&&(c["total-bitrate-kbps"]=a)}),c.video=[],g=0;g<h.videoStats.length;g++)c.video[g]=oa(h.videoStats[g]);else g=document.querySelectorAll("#stats-left-part-"+
h.streamId),g.forEach(function(a){if(void 0!==a&&null!==a){var b="";Object.keys(h.total).forEach(function(a){if("bitrateCalculated"===a)if(a=Math.round(h.total[a]/1E3),"notify"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)c["total-bitrate-kbps"]=a;else if("display"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)b+="<div> <strong>Tx Total</strong>: "+a+"Kbps</div>"});c.video=[];for(var k=0;k<h.videoStats.length;k++)if(c.video[k]=oa(h.videoStats[k]),"display"==f.mediaStatsMode||"notify-display"==
f.mediaStatsMode)b+=c.video[k].displayString,a.innerHTML='<div id="" class="stats-detail"> \n                                        '+b+"\n                                    </div>"}});else"canvasStat"===g?w.a.csp_enabled?(Object.keys(h.total).forEach(function(a){"bitrateCalculated"===a&&(a=Math.round(h.total[a]/1E3),"notify"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)&&(b["total-bitrate-kbps"]=a)}),b.video=oa(h.videoStats)):(g=document.querySelectorAll("#stats-left-part-"+h.subscriberStreamId),
g.forEach(function(a){if(void 0!==a&&null!==a){var c="";Object.keys(h.total).forEach(function(a){if("bitrateCalculated"===a)if(a=Math.round(h.total[a]/1E3),"notify"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)b["total-bitrate-kbps"]=a;else if("display"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)c+="<div> <strong>Tx Total:</strong>:  "+a+"Kbps </div>"});b.video=oa(h.videoStats);if("display"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)c+=b.video.displayString,a.innerHTML=
'<div id="" class="stats-detail"> \n                                            '+c+"\n                                        </div>"}})):"shareStat"===g&&(w.a.csp_enabled?(Object.keys(h.total).forEach(function(a){"bitrateCalculated"===a&&(a=Math.round(h.total[a]/1E3),"notify"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)&&(d["total-bitrate-kbps"]=a)}),d.video=oa(h.videoStats)):(g=document.querySelectorAll("#stats-left-part-"+h.subscriberStreamId),g.forEach(function(a){if(void 0!==a&&null!==
a){var c="";Object.keys(h.total).forEach(function(a){if("bitrateCalculated"===a)if(a=Math.round(h.total[a]/1E3),"notify"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)d["total-bitrate-kbps"]=a;else if("display"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)c+="<div> <strong>Tx Total:</strong>:  "+a+"Kbps </div>"});d.video=oa(h.videoStats);if("display"==f.mediaStatsMode||"notify-display"==f.mediaStatsMode)c+=d.video.displayString,a.innerHTML='<div id="" class="stats-detail"> \n                                            '+
c+"\n                                        </div>"}})))});k["default"].info("that.mediaStatsMode : "+f.mediaStatsMode+" talkers: "+JSON.stringify(a)+" selfPublisherStat: "+JSON.stringify(c));"notify"!=f.mediaStatsMode&&"notify-display"!=f.mediaStatsMode||f.dispatchEvent({type:"media-stats",talkers:a,publisher:c,share:d,canvas:b})},ob=function(h){var a=h.stream;h=h.attrs;a.local?(a.updateLocalAttributes(h),A.sendMessage("updateStreamAttributes",{id:a.getID(),attrs:h}),c.a.info("room-event",q.a.event_general_success,
{message:"updateAttributesFromStreamEvent - updateStreamAttributes - success"})):k["default"].error("You can not update attributes in a remote stream")},C=function(h,a){a.args?h.apply(null,$jscomp.arrayFromIterable(a.args)):h()},Va=function(h,a,c){return{state:h,data:a.ifData(),audio:a.ifAudio(),video:a.ifVideo(),screen:a.ifScreen(),canvas:a.ifCanvas(),canvasType:c.canvasType,attributes:a.getAttributes(),metadata:c.metadata,createOffer:c.createOffer,muteStream:c.muteStream,shareMetadata:c.shareMetadata}},
Wa=function(h,a,b,d){d=void 0===d?function(){}:d;null===h?(k["default"].error("Error when publishing the stream",b),c.a.error("room-event",q.a.event_stream_publish_failed,{error:b}),d(void 0,b)):(k["default"].info("Stream published"),c.a.info("room-event",q.a.event_stream_publish_success,{error:{}}),a.setID(h),a.on("internal-send-data",Ta),a.on("internal-set-attributes",ob),X.add(h,a),a.room=f,d(h))},Zb=function(h,a,c){c=void 0===c?function(){}:c;if(h.url){var b="url";var d=h.url}else b="recording",
d=h.recording;k["default"].info("Checking publish options for",h.getID());h.checkOptions(a);f.socket.sendSDP("publish",Va(b,h,a),d,function(a,b){Wa(a,h,b,c)})},$b=function(h,a,c){c=void 0===c?function(){}:c;f.socket.sendSDP("publish",Va("data",h,a),void 0,function(a,b){Wa(a,h,b,c)})},Na=function(h,a,c){k["default"].debug("setMediaConnectionTimer()  enable: "+h+" pub: "+c+"  streamId: "+a);void 0!=Fa&&clearTimeout(Fa);Fa=h?setTimeout(function(){ac(a,c)},1E3*w.a.getMediaConnectionTimeoutSecs(f.isStreamingClient)):
void 0},Xa=function(h,a,c){c=void 0===c?function(){}:c;if(void 0!==h.screen&&0!=h.screen||void 0!==h.canvas&&0!=h.canvas)void 0!==h.canvas&&1==h.canvas?k["default"].info("Publishing Canvas spatiallayers 3 createOffer",a.createOffer):k["default"].info("Publishing Share createOffer",a.createOffer);else{var b=a.maxVideoLayers?a.maxVideoLayers:f.maxVideoLayers;1<b&&3>=b&&(a.simulcast={numSpatialLayers:b,spatialLayerBitrates:w.a.video_layer_bitrates});k["default"].info("Publishing Main, createOffer",a.createOffer,
" Max video layers: "+b)}b=Va("media_engine",h,a);b.minVideoBW=a.minVideoBW;b.maxVideoBW=a.maxVideoBW;b.scheme=a.scheme;k["default"].info("publish video: constraints: "+JSON.stringify(b)+" options: "+JSON.stringify(a));f.socket.sendSDP("publish",b,void 0,function(b){b&&0===b.result&&(Wa(b.id,h,void 0,void 0),Kb(h,a),h.clientId=f.clientId,h.maxVideoBwKbpsReqByServer=a.maxVideoBW);c(b)});Na(!0,h.getID(),!0)},bc=function(h,a){h=a&&h.ifVideo();var c=a&&a.width,b=a&&a.height;a=a&&a.frameRate;return c||
b||a?{width:c,height:b,frameRate:a}:h},db=function(h,a,b){b=void 0===b?function(){}:b;a.maxVideoBW=a.maxVideoBW||r.defaultVideoBW;a.maxVideoBW>r.maxVideoBW&&(a.maxVideoBW=r.maxVideoBW);a.audio=void 0===a.audio?!0:a.audio;a.video=void 0===a.video?!0:a.video;a.data=void 0===a.data?!0:a.data;a.canvas=void 0===a.canvas?!0:a.canvas;h.checkOptions(a);var d={streamId:h.getID(),audio:a.audio&&h.ifAudio(),video:bc(h,a.video),data:a.data&&h.ifData(),canvas:a.canvas&&h.ifCanvas(),browser:f.Connection.browserEngineCheck(),
createOffer:a.createOffer,metadata:a.metadata,muteStream:a.muteStream,slideShowMode:a.slideShowMode};k["default"].debug("SOCKET EVENT subscribe:- "+JSON.stringify(d));f.socket.sendSDP("subscribe",d,void 0,function(f,d){null===f?(k["default"].error("Error subscribing to stream ",d),c.a.error("room-event",q.a.event_stream_subscribe_failed,{error:d}),b(void 0,d)):(k["default"].info("Subscriber added"),k["default"].info("stream subscription result",f),Jb(h,a),b(!0))})},cc=function(h,a,b){b=void 0===b?
function(){}:b;f.socket.sendSDP("subscribe",{streamId:h.getID(),data:a.data,metadata:a.metadata},void 0,function(a,d){null===a?(k["default"].error("Error subscribing to stream ",d),c.a.error("room-event",q.a.event_stream_subscribe_failed,{error:d}),b(void 0,d)):(k["default"].info("Stream subscribed"),a=Object(m.f)({type:"stream-subscribed",stream:h}),f.dispatchEvent(a),b(!0))})},pa=function(h,a){k["default"].info("validateProcessNetworkTimeout() forceDisconnect : "+h+" rejoin room:"+a+" retries: "+
f.reconnectAttempt+" state: "+f.state);if(h||0==f.state||2==f.state)!h&&f.reconnectAttempt<D?(f.reconnectionAllowed=!0,a?(f.dispatchEvent(Object(m.e)({type:"network-reconnecting",message:"Network issues - reconnecting, please wait "})),f.rejoinRoom(function(h){h.result!=t.a.error_000.result&&pa(!1,!0)})):Ya()):(k["default"].info("force disconnect"),f.reconnectionAllowed=!1,Ya(),f.dispatchEvent(Object(m.e)({type:"network-reconnect-timeout",error:t.a.error_1165.result,message:t.a.error_1165.error})))},
qb=function(){k["default"].info("detect doesConnectionExist");if(0===f.state){var h=0,a=new XMLHttpRequest,c=void 0!==f.internetDetectionUrl?f.internetDetectionUrl:w.a.internetDetectionUrl,b=Math.round(1E4*Math.random());a.timeout=15E3;a.open("HEAD",c+"?rand="+b,!0);a.ontimeout=function(a){k["default"].info("xhr timeout---------------")};a.addEventListener("readystatechange",function(c){4===a.readyState?200<=a.status&&304>a.status?(h++,k["default"].info("internet is back connection exists !"),pb(),
1===h&&pa(!1,!0)):(k["default"].info("internet connection doesn't exist!"),pb(),ca++,10>ca?ba=setInterval(qb,1E3):pa(!0,!1)):k["default"].debug("ajax req readystate: ",a.readyState,"status ",a.status,"timer",ba)},!1);a.send()}},pb=function(){void 0!==ba?(k["default"].info("stopInternetDetection kill it"),clearInterval(ba)):k["default"].info("stopInternetDetection handle is undefined",ba)},sb=function(a,c){T.forEach(function(a,h){void 0!==a&&void 0!==a.stream?a.stream.getTracks().forEach(function(a){a.onended=
null;a.stop()}):k["default"].debug("remote stream or media stream is undefined id: "+h);a.pc&&(a.pc.close(),delete a.pc);T.remove(h)});X.forEach(function(h,c){h.pc&&(h.pc.close(),delete h.pc);a&&rb(h);h&&h.local&&(k["default"].info("stream off for internal send data"),h.off("internal-send-data",Ta));X.remove(c)});f.allStreamsActive=!1},Ya=function(a){k["default"].debug("room-disconnected clear all ");if(!1===f.reconnectionAllowed){k["default"].debug("room-disconnected ---- reconnection not allowed---- clear all normal closer");
T.forEach(function(a,h){Ba(a);T.remove(h);a&&!a.failed&&(a=Object(m.f)({type:"stream-removed",stream:a}),f.dispatchEvent(a))});T=Object(x.a)();X.forEach(function(a,h){a.ifCanvas()&&f.stopCanvas(function(){});Ba(a);X.remove(h)});X=Object(x.a)();try{k["default"].debug("normal socket closure, disconnect socket room state:"+f.state);var h=function(h){k["default"].debug("disconnectSocket() room state: "+f.state+" initiator: "+h);0!=f.state&&(f.state=0,f.allStreamsActive=!1,0!==f.streamsHealthTimerId&&
(clearInterval(f.streamsHealthTimerId),f.streamsHealthTimerId=0),A.disconnect(),A.state=A.DISCONNECTED,A=void 0);a&&a(t.a.error_000)};if(2==f.state){f.state=3;f.allStreamsActive=!1;0!==f.streamsHealthTimerId&&(clearInterval(f.streamsHealthTimerId),f.streamsHealthTimerId=0);var b=setTimeout(h,1E3,"timer");f.socket.emitEvent(v.a.RoomEvent.drop,{self:!0},function(a){clearTimeout(b);h("disc callback")})}else 3!=f.state&&h("direct")}catch(jd){k["default"].debug("Socket already disconnected"),a&&a(t.a.error_1163)}}else{k["default"].debug("in clear all - unexpected disconnection and the case for reconnect");
sb(!0);A.state=A.DISCONNECTED;f.state=0;f.allStreamsActive=!1;0!==f.streamsHealthTimerId&&(clearInterval(f.streamsHealthTimerId),f.streamsHealthTimerId=0);k["default"].info("send network disconnected event");var d=Object(m.e)({type:"network-disconnected",error:t.a.error_1163.result,message:t.a.error_1163.error});f.dispatchEvent(d);f.reconStartTime=Date.now();qb();a&&(c.a.error("room-event",q.a.event_general_failed,{message:t.a.error_1163}),a(t.a.error_1163))}},tb=function(){sb(f.reconnectionState);
void 0===A&&!0===f.reconnectionState?(k["default"].info("reconnect creating a new socket"),f.state=0,f.allStreamsActive=!1,0!==f.streamsHealthTimerId&&(clearInterval(f.streamsHealthTimerId),f.streamsHealthTimerId=0),k["default"].info("reconnect force a new socket"),A=Object(d.a)(void 0),f.socket=A):(f.socket.disconnect(),k["default"].debug("previous connection is still there or the reconnection state is false"));f.userList.clear()};f.connect=function(a,b){a=void 0===a?{allow_reconnect:!0,number_of_attempts:3,
timeout_interval:45E3}:a;b=void 0===b?function(){}:b;var h=JSON.parse(p.a.decodeBase64(r.token));f.reconnectionAllowed=a.allow_reconnect;f.reconnectionTimeOutInterval=a.timeout_interval;D=a.number_of_attempts;k["default"].debug(" connection attempt check :"+f.connectAttempt);7<=f.connectAttempt||f.reconnectAttempt>=D?(pa(!0,!1),b(t.a.error_1165)):(!0===f.reconnectionState&&(f.reconnectAttempt++,h.isReconnecting=!0,h.reconnectAttempt=f.reconnectAttempt,h.oldClientIdForReconnect=f.clientId,!f.isModerator()&&
(f.sharePermissions&&"idle"!=f.sharePermissions.screen.state||"idle"!=f.sharePermissions.canvas.state)&&(h.changedOptions={sharePermissions:{screen:{state:f.sharePermissions.screen.state},canvas:{state:f.sharePermissions.canvas.state}}}),h.room=f.roomID,h.role=f.me.role,h.name=f.me.name,k["default"].info("new token request for the reconnection: ",h)),h.logId&&w.a.setLocalStorageItem("logID",h.logId),f.state=1,f.me.logId=h.logId,f.allStreamsActive=!1,0!==f.streamsHealthTimerId&&(clearInterval(f.streamsHealthTimerId),
f.streamsHealthTimerId=0),h.hostType=w.a.browser_info.name,h.hostVersion=w.a.browser_info.version,h.hostDeviceType=w.a.browser_info.device_type,h.userAgent=w.a.user_agent,h.advancedOptions=r.options,h.version=w.a.product.version,void 0!=r.maxActiveTalkers&&"number"==typeof r.maxActiveTalkers&&(h.maxActiveTalkers=r.maxActiveTalkers),f.connectAttempt++,k["default"].info("calling socket connect that.connectAttempt: "+f.connectAttempt),f.socket.connect(h,function(a){k["default"].info("socket response: ",
a);0===a.result?(f.connectAttempt=0,k["default"].info("socket.connect token accepted"),f.externalIp=a.connectedIP,b(t.a.error_000)):(k["default"].info("connect error",a),pa(!0,!1),f.dispatchEvent(Object(m.e)({type:"room-error",error:a.result,message:a.msg})),f.createEventLog("clientConnFailed",{clientId:"",hostType:w.a.browser_info.name,hostVersion:w.a.browser_info.version,error:a.msg,externalIp:f.externalIp}),b(t.a.error_1161))},function(a){k["default"].error("Not Connected! Error: "+a);pa(!0,!1);
if("object"==typeof a&&void 0!=a.result){k["default"].error("socket.connect failed with error: "+JSON.stringify(a));var h=a.result}else h=a;h=Object(m.e)({type:"room-error",error:h,message:a});c.a.error("room-event",q.a.event_general_failed,{message:"clientConnFailed - error"});f.dispatchEvent(h);f.createEventLog("clientConnFailed",{clientId:"",hostType:w.a.browser_info.name,hostVersion:w.a.browser_info.version,error:a,externalIp:f.externalIp});b(t.a.error_1161)}))};f.rejoinRoom=function(a){a=void 0===
a?function(){}:a;J={};Q={};k["default"].debug("=========== port of hope--- reconnect");""!=f.externalIp&&(f.reconnectionState=!0);k["default"].info(" rejoinRoom() disconnect and connect after 1 sec");f.state=4;tb();setTimeout(function(){k["default"].info(" rejoinRoom() connecting11 ");tb;f.connect(void 0,a)}.bind(e),1E3)};f.disconnect=function(a){k["default"].debug("that.disconnect() clearing all ");f.reconnectionAllowed=!1;Ya(function(h){void 0==a&&(a={cause:t.a.CC006});h=Object(m.e)({type:"room-disconnected",
message:a});k["default"].debug("that.disconnect() sending room-disconnected event");f.dispatchEvent(h)})};f.removeTrack=function(a){f.socket.sendSDP("removeTrack",{streamId:a,msg:"track-removed"},void 0,function(){})};f.getWaitingUserList=function(a){f.socket.sendMessage("getAwaitedUser",function(h){if(0===h.result)for(var c in h.awaitedParticipants)f.awaitedParticipants.set(h.awaitedParticipants[c].clientId,{clientId:h.awaitedParticipants[c].clientId,name:h.awaitedParticipants[c].name});a&&a(h)})};
f.updateLayout=function(a,c){Xb(a,c)};var Ka=function(a,c){k["default"].info("event: "+a+":"+c.clientId+"::::"+c.name);f.cCrequest.push({clientId:c.clientId,name:c.name,type:"raised"});a=Object(m.e)({type:a,users:c});f.dispatchEvent(a)},Ja=function(a){for(var h=!1,c=0;c<f.cCapprovedHands.length;c++)if(f.cCapprovedHands[c].clientId==a){f.cCapprovedHands.splice(c,1);h=!0;break}return h},dc=function(a){for(var h=!1,c=0;c<f.cCrequest.length;c++)if(f.cCrequest[c].clientId==a){f.cCrequest.splice(c,1);h=
!0;break}return h},La=function(a,b){switch(a){case "floor-granted":b.clientId===f.clientId?f.floorGranted=!0:f.cCapprovedHands.push({clientId:b.clientId,moderatorId:b.moderatorId});break;case "floor-invited":b.clientId===f.clientId&&(f.floorInvited=!0);break;case "floor-denied":b.clientId===f.clientId&&(f.floorGranted=!1);break;case "floor-cancelled":b.clientId===f.clientId?f.floorInvited=!1:Ja(b.clientId);break;case "floor-released":b.clientId===f.clientId?(f.localStreams.getAll(),X.forEach(function(a,
h){k["default"].info(a.getID()+"::::"+h);f.unpublish(a,function(h){1==h?(k["default"].info("stream has been un-published"),c.a.info("room-event",q.a.event_stream_unpublish_success,{error:{}})):(k["default"].info("error during stream un-publishing"),c.a.error("room-event",q.a.event_stream_unpublish_failed,{stream:a}));f.floorGranted=!1})})):Ja(b.clientId)}"floor-released"==a&&f.dispatchEvent(Object(m.e)({type:"release-floor",users:b}));f.dispatchEvent(Object(m.e)({type:a,users:b}))},ec=function(a){k["default"].info(" onFloorManagementEvents: "+
JSON.stringify(a));switch(a.id){case "floorRequested":Ka("floor-requested",a);break;case "floorCancelled":Ka("floor-cancelled",a);break;case "floorFinished":Ka("floor-finished",a);break;case "floorRejected":f.floorInvited=!1;Ka("floor-rejected",a);break;case "floorAccepted":Ka("floor-accepted",a);break;case "inviteToFloor":La("floor-invited",a);break;case "floorGranted":La("floor-granted",a);break;case "floorDenied":La("floor-denied",a);break;case "floorReleased":La("floor-released",a);break;case "cancelFloorInvite":La("floor-invite-cancelled",
a)}},fc=function(a){k["default"].info(a);a=Object(m.e)({type:"hard-mute",users:a});f.dispatchEvent(a)},gc=function(a,c){Ca(!1,!0,!1,!0,c,!0,{type:"hard-unmute-room",message:a});f.mute=f.muteInfo.room.audio=!1;f.hardMuteInitiator=!1},hc=function(a,c){Ca(!0,!0,!1,!0,c,!0,{type:"hard-mute-room",message:a});f.mute=f.muteInfo.room.audio=!0;f.hardMuteInitiator=!1};f.enableKnock=function(a,c){void 0!==a&&"boolean"===typeof a?f.socket.emitEvent("enableKnock",a,function(h){k["default"].info("enableKnock response"+
JSON.stringify(h));0===h.result&&!1===a&&f.awaitedParticipants.clear();c&&c(h)}):c(!1)};f.openFloor=function(a,c){void 0!==a&&"boolean"===typeof a?f.socket.emitEvent("openFloor",a,function(h){k["default"].info("openFloor response"+JSON.stringify(h));0===h.result&&(f.floorOpen=a);c&&c(h)}):c(!1)};var ic=function(a){a=Object(m.e)({type:"room-awaited",message:"waiting for moderator approval"});f.dispatchEvent(a)},jc=function(a){var h={clientId:a.clientId,name:a.name};a.data&&(h.data=a.data);f.awaitedParticipants.set(a.clientId,
h);a=Object(m.e)({type:"user-awaited",message:{user:h}});f.dispatchEvent(a)};f.approveAwaitedUser=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?f.socket.emitEvent("user-allowed",a,function(h,b){null===h?k["default"].error("Error on knock approve request",b):(f.awaitedParticipants.delete(a),c(h,b))}):k["default"].error("approveAwaitedUser() invalid param - callback")};f.denyAwaitedUser=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?f.socket.emitEvent("user-denied",
a,function(h,b){null===h?k["default"].error("Error on knock deny request",b):(f.awaitedParticipants.delete(a),c(h,b))}):k["default"].error("denyAwaitedUser() invalid param - callback")};var kc=function(h){k["default"].info("onRoomConnected() - reconnection: "+f.reconnectionState);var b=[],d=h.streams||[],g=h.id,e=h.userList,p=h.room;f.me=h.user||{};f.roomSettings=h.room.settings||{};f.mute=f.muteInfo.room.audio=h.room.mute;f.reconnectionState||(f.muteInfo.stream.hard.audio=f.muteInfo.room.audio);
f.mediaRecord=h.mediaRecord;f.subscription=h.subscription;f.mode=h.room.settings.mode;f.share_override_room=h.room.settings.screen_share_override||!1;w.a.csp_enabled||(document.head.append(Ga),document.head.append(Pa));"lecture"===f.mode&&"moderator"===h.user.role&&(0<h.raisedHands.length&&h.raisedHands.forEach(function(a){f.cCrequest.push(a)}),0<h.floorInvites.length&&h.floorInvites.forEach(function(a){f.cCrequest.push(a)}),0<h.approvedHands.length&&h.approvedHands.forEach(function(a){f.cCapprovedHands.push(a)}));
f.activeTalker=p.settings.active_talker;for(q in h.awaitedParticipants)f.awaitedParticipants.set(h.awaitedParticipants[q].clientId,{clientId:h.awaitedParticipants[q].clientId,name:h.awaitedParticipants[q].name});f.iceServers=h.iceServers;f.state=2;f.mediaConfiguration=h.mediaConfiguration;h.nonTalkerMediaParams&&(f.nonTalkerMediaParams=h.nonTalkerMediaParams);f.videoMutedUsers=h.videoMutedUsers;r.defaultVideoBW=h.defaultVideoBW;r.maxVideoBW=h.maxVideoBW;f.clientId=h.clientId;f.confId=h.room.conf_num;
f.maxVideoLayers=h.maxVideoLayers||0;f.maxCanvasRefreshRate=h.maxCanvasRefreshRate||0;f.share=h.room.share;f.locked=h.room.locked||!1;f.waitRoom=h.room.waitRoom||!1;f.knockEnabled=h.room.knockEnabled||!1;f.userAudioTalkerCount=h.numAudioTalkers||0;f.userVideoTalkerCount=h.numVideoTalkers||0;r.minVideoBW=h.minVideoBW;r.maxVideoFps=h.maxVideoFps;f.liveRoomTranscription=h.transcription;f.privacyModes=h.privacyModes;f.remoteUserNotifications=void 0!=h.remoteUserNotifications?h.remoteUserNotifications:
!0;f.mediaActivationDelaySecs=h.mediaActivationDelaySecs||0;h.room.sharePermissions&&(f.sharePermissions=h.room.sharePermissions);!0===h.transcription&&(f.transcriptionLanguage=h.transcriptionLanguage);f.internetDetectionUrl=void 0!=h.internetDetectionUrl?h.internetDetectionUrl:w.a.internetDetectionUrl;f.floorOpen=void 0!==h.room.openFloor?h.room.openFloor:!0;w.a.setVideoBwQualityMapper(h.videoBitrateQualityMap);c.a.setClientId(h.clientId);h.utilToken&&c.a.setEventLoggerToken(h.utilToken);if(void 0!==
h.room.fileShareService){var q={};q=h.room.fileShareService;var t={};t.call_num=h.clientId;t.room_id=h.id;t.service_id=h.room.service_id;t.conf_num=h.room.conf_num;t.userName=h.user.name||"";H=h.room.fileShareService.maxSize;q.callInfo=t;Object(G.f)(q)}void 0!=h.isStreamingClient?!0===h.isStreamingClient?(k["default"].info("is a streaming client setting log level to debug"),k["default"].setLogLevel(k["default"].DEBUG),f.isStreamingClient=!0,f.getStats(!0,{intervalSecs:2,log:!0})):(k["default"].debug("NOT A S T Client"),
f.isStreamingClient=!1):k["default"].info(" server does not support file sharing ",h.room.fileShareService);void 0!=h.room.hls&&(f.hls=h.room.hls);f.audienceCount=h.audienceCount?h.audienceCount:0;h.room.customRoomData&&(f.customRoomData=h.room.customRoomData);h.room.customSessionData&&(f.customSessionData=h.room.customSessionData);t=h.initialNumATs?parseInt(h.initialNumATs):1;var x=Object.keys(d);k["default"].info(" onRoomConnected() num subs streams: "+x.length+" activate: "+t);for(var v=0;v<x.length;v+=
1){var l=d[x[v]];q=Object(a.a)(f.Connection,{streamID:l.id,local:!1,audio:l.audio,video:l.video,data:l.data,screen:l.screen,canvas:!("undefined"===typeof l.canvas||!1===l.canvas),attributes:l.attributes});b.push(q);q.screen||q.canvas||parseInt(l.id)<=t||f.isStreamingClient?T.add(l.id,q):na.add(l.id,q)}wa=t;f.roomID=g;f.confID=p.conf_num;k["default"].info("Connected to room "+f.roomID);for(var R in e)f.userList.set(e[R].clientId,e[R]);f.getMaxTalkers(function(a){f.talkerCount=a.maxTalkers});d={conf_num:p.conf_num,
name:p.name,owner_ref:p.owner_ref,mode:p.settings.mode,moderators:p.settings.moderators,participants:p.settings.participants,auto_recording:p.settings.auto_recording,canvas:p.settings.canvas,description:p.settings.description,created:p.created,mute:p.mute,quality:p.settings.quality,screen_share:p.share,locked:p.locked,wait_room:p.wait_room,duration:p.remainingDuration,analyzer:p.analyzer,screen_share_override:p.settings.screen_share_override,privacy_modes:p.privacyModes,remote_user_notifications:f.remoteUserNotifications};
f.sharePermissions&&(d.share_permissions=f.sharePermissions);f.screenResolutionRange=null!=h.room.screenResolutionRange?h.room.screenResolutionRange:w.a.screen_resolution_range[d.quality];void 0!=f.speakerInfo.id&&ub(f.speakerInfo.id,function(a){a||(f.speakerInfo.id=void 0);k["default"].error("selected speaker id valid : "+a)});k["default"].debug("room-connected event - room Info : "+JSON.stringify(d));b=Object(m.e)({type:"room-connected",streams:b,users:e,room:d,me:f.me,mediaRecord:f.mediaRecord});
f.dispatchEvent(b);k["default"].info("that.externalIp: ",f.externalIp);f.reconnectClientName=h.user.name;f.createEventLog("clientConnSuccess",{clientId:h.clientId,clientName:h.user.name,hostType:w.a.browser_info.name,hostVersion:w.a.browser_info.version,externalIp:f.externalIp})},ac=function(a,b){var h={streams:[]};f.localStreams.forEach(function(a,c){"connected"!=a.state&&(h.streams.push({id:c,type:"pub",state:a.state}),k["default"].error(" pub stream not connected id: "+c))});f.remoteStreams.forEach(function(a,
c){"connected"!=a.state&&(h.streams.push({id:c,type:"sub",state:a.state}),k["default"].error(" sub stream not connected id: "+c))});h.streams.length?(h.client={mode:f.isStreamingClient?"streamer":"regular",role:f.me.role,device_type:w.a.browser_info.device_type,sdk_version:w.a.product.version,browser:{version:w.a.browser_info.version,name:w.a.browser_info.name}},k["default"].info("mediaConnectionTimeout () stream disc info: "+JSON.stringify(h)),c.a.error("room-event",q.a.event_media_connection_failed,
h),pa(!1,!0)):k["default"].info("mediaConnectionTimeout ():  All streams in active state - Ignoring the event")},lc=function(a){k["default"].info(" onRoomDisconnected() : calling that.disconnect  with msg : "+JSON.stringify(a));void 0==a&&(a=t.a.CC002);f.disconnect(a)},Ca=function(a,b,d,g,e,p,x){var h=!1,la=function(a,c,b,d){k["default"].info("hardMuteMediaDevices callback resp : "+JSON.stringify(c));c.result===t.a.error_000.result&&d&&(b?f.dispatchEvent(Object(m.e)(d)):a.dispatchEvent(Object(m.f)(d)),
h=!0)};k["default"].info("hardMuteMediaDevices muteOn: "+a+" audio: "+b+" video: "+d+" sendsendServerEvent : "+g);f.localStreams.forEach(function(h,c){b&&h.ifAudio()?a?(f.muteInfo.stream.hard.audio=!0,h.muteAudio(function(a){la(h,a,p,x);e(a)},g,0,!1)):(f.muteInfo.stream.hard.audio=!1,h.unmuteAudio(function(a){la(h,a,p,x);e(a)},g,0,!1)):d&&h.ifVideo()&&(a?(f.muteInfo.stream.hard.video=!0,h.muteVideo(function(a){la(h,a,p,x);e(a)},g,0,!1)):(f.muteInfo.stream.hard.video=!1,h.unmuteVideo(function(a){la(h,
a,p,x);e(a)},g,0,!1)))});if(!h&&p&&x){var v=Object(m.e)(x);f.dispatchEvent(v)}e&&(c.a.error("room-event",q.a.event_general_failed,{message:t.a.error_1159.error}),e(t.a.error_1159))},Nb=function(a,c,b,f){var h=function(a,h){h.result===t.a.error_000.result?k["default"].info("mediaDeviceMuteOnJoin() "+a+" audio: "+JSON.stringify(c)+" video: "+JSON.stringify(b)+" success"):k["default"].error("mediaDeviceMuteOnJoin() "+a+" audio: "+JSON.stringify(c)+" video: "+JSON.stringify(b)+" failed. result: "+JSON.stringify(h))};
b.local?a.muteVideo(function(a){h("videoSelfMuteCallback",a)},f,1E3,!0):a.selfMuteVideo&&a.unmuteVideo(function(a){h("videoSelfUnmuteCallback",a)},f,1E3,!0);b.hard?a.muteVideo(function(a){h("videoHardMuteCallback",a)},f,1E3,!1):a.hardVideoMuted&&a.unmuteVideo(function(a){h("videoHardUnmuteCallback",a)},f,1E3,!1);c.local?a.muteAudio(function(a){h("AudioSelfMuteCallback",a)},f,1E3,!0):a.selfMuteAudio&&a.unmuteAudio(function(a){h("AudioSelfUnmuteCallback",a)},f,1E3,!0);c.hard?a.muteAudio(function(a){h("AudioHardMuteCallback",
a)},f,1E3,!1):a.hardAudioMuted&&a.unmuteAudio(function(a){h("AudioHardUnmuteCallback",a)},f,1E3,!1)},mc=function(a,c){f.hardMuteInitiator=!1;Ca(!0,!0,!1,!0,c,!0,{type:"hardmute-user-audio",message:a})},nc=function(a,c){f.hardMuteInitiator=!1;Ca(!1,!0,!1,!0,c,!0,{type:"hardunmute-user-audio",message:a})},oc=function(a,c){Ca(!0,!1,!0,!0,c,!0,{type:"hardmute-user-video",message:a})},pc=function(a,c){Ca(!1,!1,!0,!0,c,!0,{type:"hardunmute-user-video",message:a})},qc=function(a){switch(a.evnt){case "share-permission-mode-changed":f.sharePermissions[a.params.pubType].mode=
a.params.mode;!f.isModerator()||"all"!=a.params.mode&&"moderators"!=a.params.mode||(f.sharePermissions[a.params.pubType].approved=[],f.sharePermissions[a.params.pubType].pending=[]);break;case "share-permission-requested":f.isModerator()?-1==f.sharePermissions[a.params.pubType].pending.indexOf(a.params.clientId)&&f.sharePermissions[a.params.pubType].pending.push(a.params.clientId):f.sharePermissions[a.params.pubType].state=a.evnt;break;case "share-permission-granted":if(f.isModerator()){-1==f.sharePermissions[a.params.pubType].approved.indexOf(a.params.clientId)&&
f.sharePermissions[a.params.pubType].approved.push(a.params.clientId);var h=f.sharePermissions[a.params.pubType].pending.indexOf(a.params.clientId);-1!=h&&f.sharePermissions[a.params.pubType].pending.splice(h,1)}else f.sharePermissions[a.params.pubType].state=a.evnt;break;case "share-permission-denied":case "share-permission-released":f.isModerator()?(h=f.sharePermissions[a.params.pubType].approved.indexOf(a.params.clientId),-1!=h&&f.sharePermissions[a.params.pubType].approved.splice(h,1),h=f.sharePermissions[a.params.pubType].pending.indexOf(a.params.clientId),
-1!=h&&f.sharePermissions[a.params.pubType].pending.splice(h,1)):f.sharePermissions[a.params.pubType].state="idle";break;case "share-permission-cancelled":f.isModerator()&&(h=f.sharePermissions[a.params.pubType].pending.indexOf(a.params.clientId),-1!=h&&f.sharePermissions[a.params.pubType].pending.splice(h,1))}f.dispatchEvent(Object(m.e)({type:a.evnt,message:a.params}))},rc=function(a){ta(!0,f.canvasStatus);var h=Object(m.e)({type:"share-started",message:{clientId:a.clientId,name:a.name,streamId:a.streamId,
layout:a.layout}});f.shareStatus=!0;f.clientId==a.clientId&&(f.isSharingClient=!0);k["default"].debug(" share-started event : "+JSON.stringify(h));f.dispatchEvent(h)},sc=function(a){0===a.result&&a.mediaConfiguration!==f.mediaConfiguration&&(f.mediaConfiguration=a.mediaConfiguration,f.localStreams.forEach(function(h,c){h.resetMediaConfiguration(a.mediaConfiguration)}))},tc=function(a){k["default"].info("Stop sharing requested by client: ",a.clientId);f.forcedStopSharing=!0;console.log("that.forcedStopSharing: ",
f.forcedStopSharing);f.isSharingClient&&(k["default"].info("stopScreenShare for current client"),f.stopScreenShare(function(a){}));1==f.isCanvasSharingClient&&(k["default"].info("stopCanvasShare for current client"),f.stopAnnotation(function(a){}))},uc=function(a){k["default"].info("Update Layout requested by client: ",a.clientId);f.clientId!=a.clientId&&(a=Object(m.e)({type:"layout-updated",message:a}),f.dispatchEvent(a))},vc=function(a){ta(!1,f.canvasStatus);var h={streamType:"share",streamId:a.streamId,
negotiatedCodecs:{video:{codec:"default"===f.mediaConfiguration||"Default"===f.mediaConfiguration?"VP8":f.mediaConfiguration},audio:{codec:"OPUS"}},externalIp:f.externalIp};console.log("that.forcedStopSharing: ",f.forcedStopSharing);a=0==f.forcedStopSharing?Object(m.e)({type:"share-stopped",message:{clientId:a.clientId,name:a.name,streamId:a.streamId}}):Object(m.e)({type:"share-stopped",message:{clientId:a.clientId,name:a.name,streamId:a.streamId,stoppedBy:"moderator"}});f.forcedStopSharing=!1;f.shareStatus=
!1;console.log(" share-stopped event : "+JSON.stringify(a));f.dispatchEvent(a);k["default"].info("additionalOptions: ",h);f.createEventLog("clientStreamShareStopped",h);f.isSharingClient=!1;f.isOverRidingShare&&(console.log("onShareStopped start sharing for this client"),h=f.startScreenShare(f.shareOverRideCallback),f.ScreenSharelocalStream=h,h=Object(m.e)({type:"start-new-screen-share",message:{clientId:f.clientId}}),f.dispatchEvent(h),f.isOverRidingShare=!1)},wc=function(a){console.log("onScreenShareOverride");
f.isSharingClient&&(f.stopScreenShare(function(a){console.log("stopScreenShare response: ",a)}),a=Object(m.e)({type:"stop-old-screen-share",message:{clientId:f.clientId}}),f.dispatchEvent(a))},xc=function(a){f.userList.get(a.clientId).audioMuted=a.user.audioMuted;f.userList.set(a.clientId,a.user);a.clientId!=f.clientId&&f.dispatchEvent(Object(m.g)({type:"user-audio-muted",clientId:a.clientId}));a.clientId==f.clientId?f.localStreams.forEach(function(h){!h.ifCanvas()&&!h.ifScreen()&&h.local&&h.isAudioMuted()&&
f.dispatchEvent(Object(m.g)({type:"user-audio-muted",clientId:a.clientId}))}):f.dispatchEvent(Object(m.g)({type:"user-audio-muted",clientId:a.clientId}))},yc=function(a){f.userList.get(a.clientId).audioMuted=a.user.audioMuted;f.userList.set(a.clientId,a.user);a.clientId==f.clientId?f.localStreams.forEach(function(h){h.ifCanvas()||h.ifScreen()||!h.local||h.isAudioMuted()||f.dispatchEvent(Object(m.g)({type:"user-audio-unmuted",clientId:a.clientId}))}):f.dispatchEvent(Object(m.g)({type:"user-audio-unmuted",
clientId:a.clientId}))},zc=function(a){f.userList.get(a.clientId).videoMuted=a.user.videoMuted;f.userList.set(a.clientId,a.user);a=Object(m.g)({type:"user-video-muted",clientId:a.clientId});f.dispatchEvent(a)},Ac=function(a){f.userList.get(a.clientId).videoMuted=a.user.videoMuted;f.userList.set(a.clientId,a.user);a=Object(m.g)({type:"user-video-unmuted",clientId:a.clientId});f.dispatchEvent(a)},ta=function(a,c){f.localStreams.forEach(function(h){if(!h.ifCanvas()&&!h.ifScreen()&&h.video&&h.local&&
1<f.maxVideoLayers){var b=a||c?"ND":Z.roomMeta.settings.quality;b={0:1E3*w.a.video_bandwidth_range[b][2].max,1:1E3*w.a.video_bandwidth_range[b][1].max,2:1E3*w.a.video_bandwidth_range[b][0].max};k["default"].info("updating main video simulcast bps: "+JSON.stringify(b));h.updateSimulcastLayersBitrate(b)}})};f.publish=function(a,b,d){b=void 0===b?{}:b;d=void 0===d?function(){}:d;if("function"===typeof d){var h=b;if(f.subscription&&(!f.subscription.audio_video&&a.video||!f.subscription.audio_only&&!f.subscription.audio_video&&
a.audio||!f.subscription.audio_video&&a.canvas||!f.subscription.audio_video&&a.share))k["default"].error("Licence error : feature not supported subscription - av: "+f.subscription.audio_video+" audio: "+f.subscription.audio_only+" canvas: "+f.subscription.audio_video+" share: "+f.subscription.audio_video+" req audio: "+a.audio+" video: "+a.video+" share: "+a.share+" canvas: "+a.canvas),c.a.error("room-event",q.a.event_general_failed,{message:t.a.error_1170.error}),d(t.a.error_1170);else{if(a.video&&
!a.canvas&&!a.share&&null!=a.videoStream){var g=void 0==a.videoSize?!0:!1,e=vb(a,!0);if(e.result!==t.a.error_000.result){k["default"].error(" Failed : room.publish video size invalid video size req: "+a.videoSize+" default : "+JSON.stringify(R));c.a.error("room-event",q.a.event_general_failed,{message:"room.publish video size invalid video size req: "+a.videoSize+" default : "+JSON.stringify(R)});d(e);return}!g||void 0===a.videoSize||"mobile"===w.a.browser_info.device_type||a.videoSize[0]==w.a.video_resolution_range.Default.min.wdith&&
a.videoSize[1]==w.a.video_resolution_range.Default.min.height&&a.videoSize[2]==w.a.video_resolution_range.Default.min.wdith&&a.videoSize[3]==w.a.video_resolution_range.Default.max.height||a.setVideoQualityParams(a.videoSize[0],a.videoSize[1],a.videoSize[2],a.videoSize[3]);a.maxVideoLayers=f.maxVideoLayers}if(b&&void 0!=b)try{a.userRequestOptions=JSON.parse(JSON.stringify(b))}catch(Qa){k["default"].info("Not a valid json")}!a.audio||a.canvas||a.share||null!=a.audioStream||(a.audio=!1);!1===f.reconnectionState?
a.ifScreen()?h.forceTurn=ra:a.ifCanvas()?(h.forceTurn=ma,va=h.canvasType):(ma=ra=aa=h.forceTurn?h.forceTurn:!1,(h.maxVideoBW||h.minVideoBW||h.maxVideoFps)&&a.setVideoParamsRange(h.maxVideoBW,h.minVideoBW,h.maxVideoFps,void 0,!1),(r.maxVideoBW||r.minVideoBW||r.maxVideoFps)&&a.setVideoParamsRange(r.maxVideoBW,r.minVideoBW,r.maxVideoFps,void 0,!0),k["default"].info(" options.maxVideoBW: "+h.maxVideoBW+" spec.maxVideoBW: "+r.maxVideoBW),void 0==h.maxVideoBW&&(h.maxVideoBW=r.maxVideoBW,h.minVideoBW=r.minVideoBW)):
a.ifScreen()?h.forceTurn=ra:a.ifCanvas()?(h.forceTurn=ma,h.canvasType=va):h.forceTurn=aa;h.maxVideoBW=h.maxVideoBW||r.defaultVideoBW;h.maxVideoBW>r.maxVideoBW&&(h.maxVideoBW=r.maxVideoBW);void 0===h.minVideoBW&&(h.minVideoBW=0);h.minVideoBW>r.defaultVideoBW&&(h.minVideoBW=r.defaultVideoBW);h.forceTurn&&(a.forceTurn=h.forceTurn);h.simulcast=h.simulcast||!1;h.muteStream={audio:a.ifCanvas()?!0:a.isAudioMuted(),video:a.isVideoMuted()};f.muteAudioOnJoin=!!h.audioMuted;f.muteVideoOnJoin=!!h.videoMuted;
k["default"].debug("Publish forceTurn: ( "+h.forceTurn+","+aa+" ) reconnect state: "+f.reconnectionState);if(a&&a.local&&!a.failed)if(f.waitRoom)k["default"].error("Publish() : failed Moderator not present and  waiting for moderator "),c.a.error("room-event",q.a.event_general_failed,{message:t.a.error_1130.error}),d(t.a.error_1130);else if(a.ifMedia())if(a.ifExternal())Zb(a,h,d);else if(void 0!=f.videoMuteOnJoin&&delete f.videoMuteOnJoin,void 0!=f.audioMuteOnJoin&&delete f.audioMuteOnJoin,!f.reconnectionState&&
!a.reconnect||a.ifCanvas()||a.ifScreen()){if(!a.ifCanvas()&&!a.ifScreen()){if(!a.video||h.videoMuted||h.muteStream&&h.muteStream.video)f.videoMuteOnJoin={local:!0,hard:!1};if(!a.audio||h.audioMuted||h.muteStream&&h.muteStream.audio)f.audioMuteOnJoin={local:!0,hard:!1}}k["default"].info("Publish stream options : ",h);Xa(a,h,d)}else if(f.audioMuteOnJoin={local:a.selfMuteAudio,hard:a.hardAudioMuted},a.selfMuteVideo||a.hardVideoMuted)f.videoMuteOnJoin={local:a.selfMuteVideo,hard:a.hardVideoMuted},a.unmuteVideo(function(c){0==
c.result?(a.muteVideo(function(){},!1,0,!0,!0),k["default"].info("Publish stream options after unmute video success")):k["default"].error("Publish stream opt after unmute video failed :"+JSON.stringify(c));Xa(a,h,d)},!1,0,!a.hardVideoMuted);else{if(!a.video||a.isVideoMuted())f.videoMuteOnJoin={local:!0,hard:!1};if(!a.audio||a.isAudioMuted())f.audioMuteOnJoin.local=!0;Xa(a,h,d)}else a.ifData()&&$b(a,h,d);else k["default"].error("Trying to publish invalid stream"),c.a.info("room-event",q.a.event_stream_publish_failed,
{stream:a}),d(void 0,"Invalid Stream"),b={streamId:a.getID(),selectedCandidates:{local:"",remote:""},negotiatedCodecs:{video:{codec:"default"===f.mediaConfiguration||"Default"===f.mediaConfiguration?"VP8":f.mediaConfiguration},audio:{codec:"OPUS"}},selectedCam:a.video.deviceId,selectedMic:a.audio.deviceId,error:"Invalid stream",externalIp:f.externalIp},f.createEventLog("clientStreamPublishFailed",b)}}else k["default"].error("publish() invalid param - callback")};var Bc=function(a){a=Object(m.e)({type:"room-record-on",
message:{moderatorId:a.moderatorId}});f.dispatchEvent(a)},Cc=function(a){a=Object(m.e)({type:"room-record-off",message:{moderatorId:a.moderatorId}});f.dispatchEvent(a)},Dc=function(a){a=Object(m.e)({type:"room-live-recording-on",message:{message:"live recording is running"}});f.dispatchEvent(a)},Ec=function(a){a=Object(m.e)({type:"room-live-recording-off",message:{message:""}});f.dispatchEvent(a)},Fc=function(a){a=Object(m.e)({type:"room-live-recording-failed",message:{error:a.error}});f.dispatchEvent(a)},
Gc=function(a){a=Object(m.e)({type:"change-layout",message:{layout:a.layout}});f.dispatchEvent(a)},Hc=function(a){f.liveRoomTranscription=!0;f.transcriptionLanguage=a.language;a=Object(m.e)({type:"room-transcription-on",message:{language:a.language}});f.dispatchEvent(a)},Ic=function(a){f.liveRoomTranscription=!1;!1===f.liveTranscription&&(f.transcriptionLanguage="");a=Object(m.e)({type:"room-transcription-off",message:{}});f.dispatchEvent(a)},Jc=function(a){f.liveTranscription=!0;f.transcriptionLanguage=
a.language;a=Object(m.e)({type:"self-transcription-on",message:{language:a.language}});f.dispatchEvent(a)},Kc=function(a){f.liveTranscription=!1;!1===f.liveRoomTranscription&&(f.transcriptionLanguage="");a=Object(m.e)({type:"self-transcription-off",message:{}});f.dispatchEvent(a)},xb=function(a){k["default"].info("processMediaActivationEvent () reason: "+a);f.mediaActivationDelaySecs=0;da&&(clearTimeout(da),da=void 0);f.activeTalkersList2Process&&(wb(f.activeTalkersList2Process),f.activeTalkersList2Process=
void 0)},wb=function(a){if(f.mediaActivationDelaySecs)k["default"].info("onNewActiveTalker() mediaActivationDelaySecs : "+f.mediaActivationDelaySecs),void 0==da&&(da=setTimeout(xb.bind(e),1E3*f.mediaActivationDelaySecs,"timeout")),f.activeTalkersList2Process=JSON.parse(JSON.stringify(a));else{"safari"===u.a.browserEngineCheck()&&!1===f.sendRecvBitrateStats&&yb();if(f.nonTalkerMediaParams&&a.active!=F){if(a.active){if(void 0==S&&(S=r.maxVideoBW),void 0!=r.minVideoBW){var h={min:r.minVideoBW,max:S};
var c=r.maxVideoFps}}else h={min:f.nonTalkerMediaParams.video.bw,max:f.nonTalkerMediaParams.video.bw},c=f.nonTalkerMediaParams.video.fps;void 0!=h&&(F=a.active,f.localStreams.forEach(function(b,f){!b.ifVideo()||b.ifScreen()||b.ifCanvas()||(k["default"].debug("onActiveList (): setting video param for AT: "+a.active+" kbps: "+h.max+" fps:"+c),b.setVideoParamsRange(h.max,h.min,c,void 0,!0))}))}for(var b=new Map,d=0;d<a.activeList.length;d++)if(f.remoteStreams.getAll()[a.activeList[d].streamId]){"audio"===
a.activeList[d].mediatype&&f.videoMutedUsers[a.activeList[d].clientId]?(f.remoteStreams.getAll()[a.activeList[d].streamId].audioOnly=!0,k["default"].info("Recieved active talker list, videomuted: "+a.activeList[d].videomuted+" reason: "+a.activeList[d].reason),f.remoteStreams.getAll()[a.activeList[d].streamId].setVideoMutedMessage(a.activeList[d]),delete f.videoMutedUsers[a.activeList[d].clientId]):"audioOnly"===a.activeList[d].mediatype&&(f.remoteStreams.getAll()[a.activeList[d].streamId].audioOnly=
!0);f.remoteStreams.getAll()[a.activeList[d].streamId].audioOnly&&"audiovideo"===a.activeList[d].mediatype&&delete f.remoteStreams.getAll()[a.activeList[d].streamId].audioOnly;f.remoteStreams.getAll()[a.activeList[d].streamId].reloadPlayer(a.activeList[d],ka);b.set(a.activeList[d].streamId,a.activeList[d]);var g=O.get(a.activeList[d].streamId);if(g&&g.mediatype!=a.activeList[d].mediatype){switch(a.activeList[d].mediatype){case "audiovideo":case "video":f.remoteStreams.getAll()[a.activeList[d].streamId].setVideoMutedMessage(a.activeList[d]);
f.remoteStreams.getAll()[a.activeList[d].streamId].blankFrameSet&&delete f.remoteStreams.getAll()[a.activeList[d].streamId].blankFrameSet;break;case "audio":case "audioOnly":f.remoteStreams.getAll()[a.activeList[d].streamId].setVideoMutedMessage(a.activeList[d]);f.remoteStreams.getAll()[a.activeList[d].streamId].blankFrameSet||(f.remoteStreams.getAll()[a.activeList[d].streamId].blankFrameSet=!0);break;default:k["default"].info("mediatype not handled entry:",JSON.stringify(a.activeList[d]))}O.set(a.activeList[d].streamId,
a.activeList[d])}else g||O.set(a.activeList[d].streamId,a.activeList[d])}else k["default"].error("onNewActiveTalker() remote stream undefined streamId: "+a.activeList[d].streamId);f.activeTalkerList=b;b=Object(m.e)({type:"active-talkers-updated",message:{activeList:a.activeList,active:a.active}});f.dispatchEvent(b);f.allStreamsActive||(f.allStreamsActive=!0,0==f.streamsHealthTimerId&&(Na(!1,0,!1),f.streamsHealthTimerId=setInterval(Hb,1E4)))}};f.startRecord=function(a){a=void 0===a?function(){}:a;
"function"===typeof a?f.startRecording(void 0,a):k["default"].error("startRecord() invalid param - callback")};f.stopRecord=function(a){a=void 0===a?function(){}:a;"function"===typeof a?f.stopRecording(void 0,a):k["default"].error("stopRecord() invalid param - callback")};f.startStreaming=function(a,b){b=void 0===b?function(){}:b;if("function"===typeof b&&"object"===typeof a&&a.hasOwnProperty("rtmpDetails")){k["default"].info("start streaming called");var h=!0;if("moderator"!==f.me.role)h=!1,k["default"].info("user is trying to start streaming and he is not a moderator"),
c.a.error("room-event",q.a.event_general_failed,{message:"startStreaming - "+t.a.error_7008.desc}),b(t.a.error_7008);else if(void 0===a.rtmpDetails)c.a.error("room-event",q.a.event_general_failed,{message:"startStreaming - "+t.a.error_7009.desc}),b(t.a.error_7009);else if(void 0!==a.rtmpDetails.rtmpUrl&&3<a.rtmpDetails.rtmpUrl.split(",").length)b(t.a.error_7101);else if(/(http|https|rtmp|rtmps):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(a.rtmpDetails.rtmpUrl)){var d={};
0===f.state?(d=t.a.error_7103,k["default"].info(" room is disconnected"),b(d)):(b&&"function"===typeof b||(b=function(a){k["default"].info("SDK defined callback streaming response ",a)}),k["default"].info("start streaming called with callback "),h?A.sendMessage("startStreaming",a,function(a,h){null===a?(k["default"].error("Error on start streaming",h),void 0!==h.result?b(h):void 0!==h.status&&b({result:h.status.resultCode,error:"streaming error",desc:h.status.error.errorDesc,status:h.status})):b({result:a.status.resultCode,
error:"",desc:"",status:a.status},h)}):b(t.a.error_7000))}else k["default"].info(" invalid rtmp or page input url"),h=!1,c.a.error("room-event",q.a.event_general_failed,{message:"startStreaming - "+t.a.error_7102.desc}),b(t.a.error_7102)}else k["default"].error("startStreaming() invalid param - streamingConfig/callback")};f.stopStreaming=function(a,c){var h;void 0!=a&&"function"===typeof a?h=a:void 0!=c&&"function"===typeof c&&(h=c);"function"===typeof h?(k["default"].info("stop streaming called"),
"moderator"!==f.me.role?(k["default"].info("user is trying to stop streaming and he is not a moderator"),h(t.a.error_7044)):(a={options:{confNum:"12345",roomId:"9876"},rtmpDetails:{rtmpUrl:"rtmp://a.rtmp.youtube.com/live2/4rjb-hprf-7wf5-9923"},urlDetails:{url:"https://vc-manu.vcloudx.com:9074/room/?token=",layOut:{}}},c={},0===f.state?(c=t.a.error_7045,k["default"].info(" room is disconnected"),h(c)):(h&&"function"===typeof h||(h=function(a){k["default"].info("SDK defined callback streaming response ",
a)}),k["default"].info("stop called with callback "),A.sendMessage("stopStreaming",a,function(a,c){null===a?(k["default"].error("Error on stop streaming",c),void 0!==c.status&&h({result:c.status.resultCode,error:"streaming error",desc:c.status.error.errorDesc,status:c.status})):(k["default"].info("Stop streaming"),h({result:a.status.resultCode,error:"",desc:"",status:a.status},c))})))):k["default"].error("stopStreaming() invalid param - streamingConfig/callback")};f.setStreamingParams=function(a,
b){k["default"].info("set Streaming Params called");if("moderator"!==f.me.role)k["default"].warning("User should be a moderator user to change Streaming params"),b(t.a.error_7072);else{var h={};0===f.state?(h=t.a.error_7078,k["default"].info(" room is disconnected"),b(h)):(b&&"function"===typeof b||(b=function(a){k["default"].info("SDK defined callback Streaming params change response ",a)}),k["default"].info("Streaming params change called with callback "),A.sendMessage("setStreamingParams",a,function(a,
h){null===a?(k["default"].error("Error on Streaming param change: ",h),c.a.error("room-event",q.a.event_streaming_param_change_failed,{error:h,message:h.status.error}),b(h)):(k["default"].info("Streaming param change Success"),c.a.info("room-event",q.a.event_streaming_param_change_success,{error:{}}),b(a,h))}))}};f.startLiveRecording=function(a,b){k["default"].info("start Live Recording called");var h=!0;if("moderator"!==f.me.role)h=!1,k["default"].warning("User should be a moderator to start live recording"),
b(t.a.error_7201);else{var d={};0===f.state?(d=t.a.error_7203,k["default"].info(" room is disconnected"),b(d)):(b&&"function"===typeof b||(b=function(a){k["default"].info("SDK defined callback Live recording response ",a)}),k["default"].info("start Live Recording called with callback "),h?A.sendMessage("startLiveRecording",a,function(a,h){if(null===a&&(k["default"].error("Error on start Live Recording",h),c.a.error("room-event",q.a.event_start_live_recording_failed,{error:h,message:h.message}),void 0!==
h.status)){b({result:h.status.resultCode,error:"live recording error",desc:h.status.error.errorDesc});return}7014===a.status.resultCode&&(W=!0);c.a.info("room-event",q.a.event_start_live_recording_success,{error:{}});k["default"].info("Start Live Recording Success");b({result:a.status.resultCode,error:"",desc:""},h)}):b(t.a.error_7204))}};f.stopLiveRecording=function(a){a=void 0===a?function(){}:a;k["default"].info("stop Live Recording called");if("moderator"!==f.me.role)k["default"].warning("User should be a moderator user to start live recording"),
a(t.a.error_7036);else{var h={urlDetails:{url:"",layOut:{}}},b={};0===f.state?(b=t.a.error_7037,k["default"].info(" room is disconnected"),a(b)):(a&&"function"===typeof a||(a=function(a){k["default"].info("SDK defined callback Live Recording response ",a)}),k["default"].info("stop Live Recording called with callback "),A.sendMessage("stopLiveRecording",h,function(h,b){null===h?(k["default"].error("Error on stop stop live recording",b),c.a.error("room-event",q.a.event_stop_live_recording_failed,{error:b,
message:b.message}),void 0!==b.status&&a({result:b.status.resultCode,error:"live recording error",desc:b.status.error.errorDesc})):(7034===h.status.resultCode&&(W=!1,h.status.resultCode=0),k["default"].info("Stop Live Recording Success"),c.a.info("room-event",q.a.event_stop_live_recording_success,{error:{}}),a({result:h.status.resultCode,error:"",desc:""},b))}))}};f.setLiveRecordingParams=function(a,b){k["default"].info("set Live Recording Params called");if("moderator"!==f.me.role)k["default"].warning("User should be a moderator user to change live recording params"),
t.a.error_7071.desc="Only moderator can change live recording params",b(t.a.error_7071);else{var h={};0===f.state?(h=t.a.error_7079,k["default"].info(" room is disconnected"),b(h)):(b&&"function"===typeof b||(b=function(a){k["default"].info("SDK defined callback Live Recording params change response ",a)}),k["default"].info("Live Recording params change called with callback "),A.sendMessage("setLiveRecordingParams",a,function(a,h){null===a?(k["default"].error("Error on live recording param change: ",
h),c.a.error("room-event",q.a.event_live_recording_param_change_failed,{error:h,message:h.status.error}),b(h)):(k["default"].info("Live Recording param change Success"),c.a.info("room-event",q.a.event_live_recording_param_change_success,{error:{}}),b(a,h))}))}};f.invalidateTranscoding=function(a,c){k["default"].info("Invalidate Transcoding called");var h={};0===f.state?(h=t.a.error_8000,k["default"].info(" room is disconnected"),c(h)):(c&&"function"===typeof c||(c=function(a){k["default"].info("SDK defined callback Invalidate Transcoding response ",
a)}),k["default"].info("Invalidate Transcoding called with callback "),A.sendMessage("invalidateTranscoding",a,function(a,h){null===a?(k["default"].error("Error on Invalidate Transcoding",h),c(h)):(k["default"].info("Invalidate Transcoding"),c(a,h))}))};f.requestFloor=function(a){a=void 0===a?function(){}:a;"function"===typeof a?qa(f.clientId,"requestFloor",function(h,c){a(h,c);void 0!==h&&(f.cCrequest=f.cCrequest.filter(function(a){return a.clientId!==options}))}):k["default"].error("requestFloor() invalid param - callback")};
f.cancelFloor=function(a){a=void 0===a?function(){}:a;"function"===typeof a?qa(f.clientId,"cancelFloor",function(h,c){a(h,c);null!==h&&(f.cCrequest=f.cCrequest.filter(function(a){return a.clientId!==options}))}):k["default"].error("cancelFloor() invalid param - callback")};f.finishFloor=function(a){a=void 0===a?function(){}:a;"function"===typeof a?qa(f.clientId,"finishFloor",function(h,c){X.forEach(function(a,h){k["default"].info("finishFloor: unpulish "+a.getID()+"::::"+h);f.unpublish(a,function(a){})});
f.floorGranted=!1;a(h,c)}):k["default"].error("finishFloor() invalid param - callback")};f.grantFloor=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?qa(a,"grantFloor",function(h,b){null!==h&&(f.cCrequest=f.cCrequest.filter(function(h){return h.clientId!==a}),f.cCapprovedHands.push({clientId:a,moderatorId:f.clientId}));c(h,b)}):k["default"].error("grantFloor() invalid param - callback")};f.denyFloor=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?qa(a,"denyFloor",function(h,
b){c(h,b);null!==h&&(f.cCrequest=f.cCrequest.filter(function(h){return h.clientId!==a}))}):k["default"].error("denyFloor() invalid param - callback")};f.relaseFloor=function(a,c){f.releaseFloor(a,void 0===c?function(){}:c)};f.releaseFloor=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?qa(a,"releaseFloor",function(h,b){null!==h&&(f.cCrequest=f.cCrequest.filter(function(h){return h.clientId!==a}),Ja(a));c(h,b)}):k["default"].error("releaseFloor() invalid param - callback")};f.inviteToFloor=
function(a,c){c=void 0===c?function(){}:c;var h={clientId:a};f.socket.sendMessage("inviteToFloor",h,function(b){0===b.result&&f.cCrequest.push({clientId:h.clientId,name:f.userList.get(a).name,type:"requested"});c(b)})};f.acceptInviteFloorRequest=function(a){a=void 0===a?function(){}:a;qa(f.clientId,"acceptFloor",function(h,c){a(h,c);void 0!==h&&(f.cCrequest=f.cCrequest.filter(function(a){return a.clientId!==options}))})};f.rejectInviteFloor=function(a){a=void 0===a?function(){}:a;qa(f.clientId,"rejectFloor",
function(h,c){f.floorInvited=!1;a(h,c);void 0!==h&&(f.cCrequest=f.cCrequest.filter(function(a){return a.clientId!==options}))})};f.cancelFloorInvite=function(a,c){c=void 0===c?function(){}:c;qa(a,"cancelFloorInvite",function(a,h){c(a,h);void 0!==a&&(f.cCrequest=f.cCrequest.filter(function(a){return a.clientId!==options}))})};f.chairControlMuteAll=function(a){a=void 0===a?function(){}:a;f.socket.sendEvent("room-muted",function(h,c){null===h?(k["default"].error("Error on floor request",c),a(void 0,
c)):a(h)})};f.chairControlUnMuteAll=function(a){a=void 0===a?function(){}:a;f.socket.sendEvent("room-unmuted",function(h,c){null===h?(k["default"].error("Error on floor request",c),a(void 0,c)):a(h)})};f.muteOne=function(a,c){c=void 0===c?function(){}:c;f.socket.sendParamEvent("muteUser",a,function(a,h){null===a?(k["default"].error("Error on floor request",h),c(void 0,h)):c(a)})};f.unMuteOne=function(a,c){c=void 0===c?function(){}:c;f.socket.sendParamEvent("unMuteUser",a,function(a,h){null===a?(k["default"].error("Error on floor request",
h),c(void 0,h)):c(a)})};f.muteRoom=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b?void 0===a||void 0===a.audio&&void 0===a.video?b(t.a.error_1155):!1===a.video&&!1===a.audio?(k["default"].error("at least one of the constraints should be false"),b(t.a.error_1155)):(X.forEach(function(h,c){h.screen||h.canvas||(!0===a.audio&&h.ifAudio()&&!h.selfMuteAudio&&h.muteAudio(function(a){k["default"].info("Mute Audio for the call")},!0,0,!1,!0),h.ifVideo()&&!0===a.video&&!h.selfMuteVideo&&h.muteVideo(function(a){k["default"].info("Mute Video for the call")},
!0,0,!1,!1,!0))}),f.socket.sendMessage("muteRoom",a,function(a,h){null===a?(k["default"].error("Error on mute room request",h),c.a.error("room-event",q.a.event_room_mute_failed,{message:"mute room request failed"}),b(void 0,h)):(f.roomMuted=!0,c.a.info("room-event",q.a.event_room_mute_success,{message:"mute room request succeeded"}),b(a))})):k["default"].error("muteRoom() invalid param - callback")};f.unMuteRoom=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b?void 0===a||void 0===
a.audio&&void 0===a.video?b(t.a.error_1155):0!=a.video&&0!=a.audio?(k["default"].error("at least one of the constraints should be false"),b(t.a.error_1155)):(X.forEach(function(h,c){h.screen||h.canvas||(k["default"].info("SelfMuteAudio: "+h.selfMuteAudio+" hardMutedAudio: "+h.hardAudioMuted),a.audio||!h.ifAudio()||h.hardAudioMuted||h.unmuteAudio(function(a){k["default"].info("UnMute Audio for the call")},!0,0,!1,!0),k["default"].info("SelfMuteVideo: "+h.selfMuteVideo+" hardMutedVideo: "+h.hardVideoMuted),
a.video||!h.ifVideo()||h.hardVideoMuted||h.unmuteVideo(function(a){k["default"].info("UnMute Video for the call")},!0,0,!1,!0))}),f.socket.sendMessage("unMuteRoom",a,function(a,h){null===a?(k["default"].error("Error on mute room request",h),c.a.error("room-event",q.a.event_room_unmute_failed,{message:"unmute room request failed"}),b(void 0,h)):(f.roomMuted=!1,c.a.info("room-event",q.a.event_room_unmute_success,{message:"unmute room request succeeded"}),b(a))})):k["default"].error("unMuteRoom() invalid param - callback")};
f.pauseRoom=function(a){a=void 0===a?function(){}:a;"function"===typeof a?(k["default"].info("Pausing the room"),f.muteRoom({audio:!0,video:!0},function(h){a(h)})):k["default"].error("pauseRoom() invalid param - callback")};f.resumeRoom=function(a){a=void 0===a?function(){}:a;"function"===typeof a?(k["default"].info("Resuming the room"),f.unMuteRoom({audio:!1,video:!1},function(h){a(h)})):k["default"].error("resumeRoom() invalid param - callback")};f.switchRoomMode=function(a,c){c=void 0===c?function(){}:
c;f.socket.sendParamEvent("switchRoomMode",a,function(a,h){null===a?(k["default"].error("Error on floor request",h),c(void 0,h)):c(a)})};f.startRecording=function(a,b){b=void 0===b?function(){}:b;k["default"].debug("Trying to start recording...");var h,d=!(f.subscription&&!1===f.subscription.recording);d&&(a&&!1===a.local||!a)?(a&&(h=a.getID()),A.sendMessage("startRecord",{to:h},function(a,h){null===a?(k["default"].error("Error on start recording",h),c.a.error("room-event",q.a.event_start_recording_failed,
{error:h,message:h.msg}),b(h),f.createEventLog("roomRecordingFailed",{error:h,externalIp:f.externalIp})):(k["default"].info("Started recording"),c.a.info("room-event",q.a.event_start_recording_success,{error:{}}),0===a.result&&(W=!0),b(a,h),f.createEventLog("roomRecordingSuccess",{externalIp:f.externalIp}))})):d||(c.a.info("room-event",q.a.event_start_recording_failed,{message:t.a.error_1170.desc}),b(t.a.error_1170))};f.onMediaDeviceStateChanged=function(a,c,b){b=void 0===b?function(){}:b;if("active"==
c.state)if("cam"==c.type)if("connected"!=a.state||a.negotiatedMedia.video)b(t.a.error_000);else{if(a.userRequestOptions.video)var h=a.userRequestOptions.video;zb(h,a,b)}else b(t.a.error_000);else"inactive"==c.state&&(k["default"].error("mediaDeviceError() errr: "+JSON.stringify(c.error)+"reconencting"),f.socket.disconnect(),b(t.a.error_000))};f.manageLiveTranscription=function(){console.log("Calling startLiveTranscription",f.liveTranscription);!0===f.liveTranscription&&0<f.reconnectAttempt&&!0===
f.reconnectionAllowed&&f.socket.sendMessage("startLiveTranscription",{language:f.transcriptionLanguage},function(a){f.liveTranscription=a&&0===a.result?!0:!1})};f.manageRecordingStatus=function(a){k["default"].info("reconnected manage recording status ",a);"moderator"===f.me.role&&1==W&&0<f.reconnectAttempt&&!0===f.reconnectionAllowed?(k["default"].info("room recording was enabled before reconnect"),f.startRecord(function(a,h){null!==a?(k["default"].info("reconnected manage recording success "),c.a.info("room-event",
q.a.event_start_recording_success,{message:"reconnected manage recording success"})):(k["default"].info("Failed to restart recording after reconnection."),c.a.error("room-event",q.a.event_start_recording_failed,{message:"Failed to restart recording after reconnection."}))})):(k["default"].info("reenbling recording for this role is not allowed ",f.me.role),c.a.info("room-event",q.a.event_start_recording_failed,{message:"reenbling recording for role "+f.me.role+" is not allowed"}))};f.stopRecording=
function(a,b){b=void 0===b?function(){}:b;f.subscription&&!1===f.subscription.recording?(c.a.info("room-event",q.a.event_stop_recording_failed,{message:t.a.error_1170.desc}),b(t.a.error_1170)):A.sendMessage("stopRecord",{id:a},function(h,d){null===h?(k["default"].error("Error on stop recording",d),c.a.error("room-event",q.a.event_stop_recording_failed,{error:d}),b(d)):(W=!1,k["default"].info("Stop recording",a),c.a.info("room-event",q.a.event_stop_recording_success,{error:{}}),b(h,d),f.createEventLog("roomRecordingStopped",
{externalIp:f.externalIp}))})};var Ma=function(a,c){var h=[];f.localStreamsBeforeReconnect.forEach(function(b,f){(b.canvas&&c||b.screen&&a||!(b.canvas||c||b.screen||a))&&h.push(b)});for(var b=0;b<h.length;b++)f.localStreamsBeforeReconnect.remove(h[b].getID())},rb=function(a){k["default"].debug("Inside storeLocalStreamForReconnect() reconnect: "+a.reconnect+" that.reconnectionState: "+f.reconnectionState+" that.reconnectionAllowed: "+f.reconnectionAllowed+" streamId: "+a.getID()+" canvas: "+a.canvas+
" screen: "+a.screen);return a.reconnect||f.reconnectionState||f.reconnectionAllowed?(Ma(a.screen,a.canvas),f.localStreamsBeforeReconnect.add(a.getID(),a),!0):!1};f.unpublish=function(a,b){b=void 0===b?function(){}:b;if("function"===typeof b)if(a&&a.local){A.sendMessage("unpublish",a.getID(),function(h,f){null===h?(k["default"].error("Error unpublishing stream",f),c.a.error("room-event",q.a.event_stream_unpublish_failed,{error:f}),b(void 0,f)):(delete a.failed,c.a.error("room-event",q.a.event_stream_unpublish_success,
{error:{}}),k["default"].info("Stream unpublished"),b(!0))});"connected"==a.state&&(a.state="inited");a.room=void 0;var h=X.get(a.getID());void 0!==h&&(h.hardVideoMuted&&h.unmuteVideo(function(a){k["default"].info("videoHardUnmuteCallback: "+JSON.stringify(a))},!1,0,!1),h.hardAudioMuted&&h.unmuteAudio(function(a){k["default"].info("audioHardUnmuteCallback: "+JSON.stringify(a))},!1,0,!1),h.pc&&(h.pc.close(),h.pc=null),h.reconnect&&rb(h));X.remove(a.getID());a.setID(0);a.off("internal-send-data",Ta);
a.off("internal-set-attributes",ob)}else c.a.info("room-event",q.a.event_stream_unpublish_failed,{error:"Cannot unpublish, stream does not exist or is not local"}),k["default"].error("Cannot unpublish, stream does not exist or is not local"),b(void 0,"Cannot unpublish, stream does not exist or is not local");else k["default"].error("unpublish() invalid param - callback")};f.sendControlMessage=function(a,c,b){a&&a.getID()&&(c={type:"control",action:b},f.socket.sendSDP("signaling_message",{streamId:a.getID(),
msg:c}))};f.subscribe=function(a,b,d){b=void 0===b?{}:b;d=void 0===d?function(){}:d;var h=JSON.parse(JSON.stringify(b));k["default"].debug("room.subscribe streamId: "+a.getID()+" options: "+JSON.stringify(h));if(!a||a.local||a.failed)b="Error on subscribe",a?a.local?(k["default"].warning("Cannot subscribe to local stream, you should subscribe to the remote version of your local stream"),b="Local copy of stream",c.a.error("room-event",q.a.event_stream_subscribe_failed,{error:b,stream:a})):a.failed&&
(k["default"].warning("Cannot subscribe to failed stream."),b="Failed stream",c.a.error("room-event",q.a.event_stream_subscribe_failed,{error:b,stream:a})):(k["default"].warning("Cannot subscribe to invalid stream"),b="Invalid or undefined stream",c.a.error("room-event",q.a.event_stream_subscribe_failed,{error:b})),d(void 0,b),a={streamType:a.ifScreen()?"share":"main",streamId:a.getID(),selectedCandidates:{local:"",remote:""},negotiatedCodecs:{video:{codec:"default"===f.mediaConfiguration||"Default"===
f.mediaConfiguration?"VP8":f.mediaConfiguration},audio:{codec:"OPUS"}},error:b,externalIp:f.externalIp},f.createEventLog("clientStreamSubscribeFailed",a);else{if(a.ifMedia())a.ifVideo()||a.ifScreen()||(h.video=!1),a.ifAudio()||(h.audio=!1),a.ifCanvas()&&(h.data=!1),a.ifCanvas()||(h.canvas=!1),f.mediaConfiguration!==v.a.constant.H264_CODEC&&"safari"===w.a.browser_info.name&&w.a.browser_info.version<=v.a.constant.SAFARI_VERSION_NOT_SUPPORTING_VP8?(h.video=!1,k["default"].debug("Stream for subscribe in room.subscribe:- SAFARI - false")):
f.mediaConfiguration!==v.a.constant.H264_CODEC&&"safari"===w.a.browser_info.name&&w.a.browser_info.version>=v.a.constant.SAFARI_VERSION_SUPPORTING_VP8&&(h.video=!0,k["default"].debug("Stream publish in Init publish:- SAFARI - true")),k["default"].info("Stream for subscribe in room.subscribe:- options:: "+JSON.stringify(h)),h.muteStream={audio:a.ifCanvas()?!0:void 0!=a.audioMuted?a.audioMuted:!1,video:a.videoMuted},k["default"].info("subscribe() streamId: ",a.getID()," options  ",JSON.stringify(h)),
!1===f.reconnectionState?(Aa=h.forceTurn?h.forceTurn:!1,ka=h.imageOnVideoMute?h.imageOnVideoMute:!1):h.forceTurn=Aa,k["default"].debug(" Subscribe forceTurn: ( "+h.forceTurn+","+Aa+" ) reconnect state: "+f.reconnectionState),a.forceTurn=h.forceTurn,a.userRequestOptions=JSON.parse(JSON.stringify(b)),na.get(a.getID())?d(t.a.error_000):db(a,h,d);else if(a.ifData()&&!1!==h.data)cc(a,h,d);else{k["default"].warning("There's nothing to subscribe to");d(void 0,"Nothing to subscribe to");return}k["default"].debug("Subscribing to: "+
a.getID());c.a.info("room-event",q.a.event_stream_subscribe_success,{message:"Subscribing to: "+a.getID()});Na(!0,a.getID(),!1)}};f.unsubscribe=function(a,b){b=void 0===b?function(){}:b;void 0!==A?a&&!a.local?a.reconnect?(k["default"].info(" in that.unsubscribe() remove stream"),Ba(a),delete a.failed,b(t.a.error_000)):A.sendMessage("unsubscribe",a.getID(),function(h,f){null===h?b(t.a.error_1167):(Ba(a),delete a.failed,c.a.error("room-event",q.a.event_stream_unsubscribe_success,{message:"Unsubscribe from stream - success"}),
b(t.a.error_000))},function(){k["default"].error("Error calling unsubscribe.");c.a.error("room-event",q.a.event_stream_unsubscribe_failed,{stream:a})}):b(t.a.error_1156):b(t.a.error_1163)};f.hardMute=function(a){a=void 0===a?function(){}:a;"function"===typeof a?Da("room-muted",!0,!1,!0,void 0,function(h){0==h.result&&(f.hardMuteInitiator=!0);a(h)}):k["default"].error("hardMute() invalid param - callback")};f.hardUnmute=function(a){a=void 0===a?function(){}:a;"function"===typeof a?Da("room-unmuted",
!0,!1,!0,void 0,function(h){0==h.result&&(f.hardMuteInitiator=!1);a(h)}):k["default"].error("hardUnmute() invalid param - callback")};f.hardMuteUserAudio=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?Da("hardmute-user-audio",!0,!1,!1,a,c):k["default"].error("hardMuteUserAudio() invalid param - callback")};f.hardUnmuteUserAudio=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?Da("hardunmute-user-audio",!0,!1,!1,a,c):k["default"].error("hardUnmuteUserAudio() invalid param - callback")};
f.hardMuteUserVideo=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?Da("hardmute-user-video",!1,!0,!1,a,c):k["default"].error("hardMuteUserVideo() invalid param - callback")};f.hardUnmuteUserVideo=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?Da("hardunmute-user-video",!1,!0,!1,a,c):k["default"].error("hardUnmuteUserVideo() invalid param - callback")};f.subscriberVideoMute=function(a,c){f.socket.emitEvent(v.a.RoomEvent.subscriber_video_mute,{streamId:a},function(a){0==
a.result&&c(a)})};f.setTalkerCount=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?"undefined"!=typeof a&&"number"===typeof a&&0<=a&&a===parseInt(a)?(sa=a,f.socket.emitEvent(v.a.RoomEvent.set_active_talker,{numTalkers:a,numAudioTalkers:3>=a?3:a,numVideoTalkers:f.audioOnlyMode?0:a},function(a){0==a.result&&(f.userAudioTalkerCount=a.numAudioTalkers,!1===f.audioOnlyMode&&(f.userVideoTalkerCount=a.numVideoTalkers));c(a)})):c(t.a.error_1155):k["default"].error("setTalkerCount() invalid param - callback")};
f.getTalkerCount=function(a){"function"===typeof a?f.socket.sendEvent(v.a.RoomEvent.get_active_talker,function(h){a(h)}):k["default"].error("getTalkerCount() invalid param - callback")};f.getMaxTalkers=function(a){"function"===typeof a?f.socket.sendEvent(v.a.RoomEvent.get_active_max_talker,function(h){a(h)}):k["default"].error("getMaxTalkers() invalid param - callback")};f.setAdvancedOptions=function(a,c){c=void 0===c?function(a){}:c;a&&Array.isArray(a)&&a.length&&"function"==typeof c?f.socket.emitEvent(v.a.RoomEvent.set_adavanced_options,
a,c):c(t.a.error_1155)};f.getAdvancedOptions=function(a){a=void 0===a?function(a){}:a;"function"==typeof a?f.socket.sendEvent(v.a.RoomEvent.get_adavanced_options,function(h){a(h)}):a(t.a.error_1155)};f.switchUserRole=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?"moderator"===f.me.role&&a&&f.clientId&&a!=f.clientId?f.socket.emitEvent(v.a.RoomEvent.switch_user_role,a,function(a){c(a)}):c("moderator"!==f.me.role?t.a.error_1168:f.clientId?t.a.error_1155:t.a.error_1171):k["default"].error("switchUserRole() invalid param - callback")};
f.setSpeakerVolume=function(a,c){c=void 0===c?function(){}:c;if(void 0==a||"number"!=typeof a&&"boolean"!=typeof a||"function"!=typeof c)c(t.a.error_1155);else{var h="boolean"==typeof a?Number(a):a;0<=h&&1>=h&&f.speakerInfo.volume!=a?(f.remoteStreams.forEach(function(c){c.setSpeaker(void 0,a)}),a?f.speakerInfo.volume||f.dispatchEvent(Object(m.e)({type:"speaker-unmuted",message:{}})):f.dispatchEvent(Object(m.e)({type:"speaker-muted",message:{}})),f.speakerInfo.volume=a,c(t.a.error_000)):c(f.speakerInfo.volume!=
a?t.a.error_1188:t.a.error_1155)}};f.switchSpeaker=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?void 0==a||void 0!=f.speakerInfo.id&&a==f.speakerInfo.id||void 0!=c&&"function"!==typeof c||"safari"===u.a.browserEngineCheck()?"function"===typeof c&&c("safari"===u.a.browserEngineCheck()?t.a.error_1153:void 0==a?t.a.error_1155:t.a.error_1177):ub(a,function(h){h?(T.forEach(function(c){c.setSpeaker(a)}),f.speakerInfo.id=a,c(t.a.error_000)):c(t.a.error_1142)}):k["default"].error("switchSpeaker() invalid param - callback")};
f.startLocalRecord=function(a,b,d){a=void 0===a?"remote":a;b=void 0===b?10:b;if("none"===V){var h=[],g=0;if("remote"===a||"all"===a)T.forEach(function(a){h[g]=new Promise(function(c,h){a.startLocalRecord(respCallback=function(h){c({id:a.getID(),status:h})})});g++}),V=a;if("local"===a||"all"===a)X.forEach(function(a){h[g]=new Promise(function(c,h){a.startLocalRecord(respCallback=function(h){c({id:a.getID(),status:h})})});g++}),V=a;"none"!==V?(0!==b&&(h[g]=new Promise(function(a,c){setTimeout(function(){f.stopLocalRecord(respCallback=
function(c,h){a(h)})},1E3*b)})),Promise.all(h).then(function(a){d&&(c.a.info("room-event",q.a.event_start_recording_success,{error:{}}),d(t.a.error_000,a))})):(k["default"].error("invalid param type"),c.a.info("room-event",q.a.event_start_recording_failed,{error:"invalid param type"}),d&&d(t.a.error_1155))}else k["default"].error("recording already in progress"),c.a.info("room-event",q.a.event_start_recording_failed,{error:"recording already in progress"}),d&&d(t.a.error_1174)};f.stopLocalRecord=
function(a){if("none"!==V){var h=0;"remote"!==V&&"all"!==V||T.forEach(function(a){new Promise(function(c,h){a.stopLocalRecord(respCallback=function(h){c({id:a.getID(),status:h})})});h++});"local"!==V&&"all"!==V||X.forEach(function(a){new Promise(function(c,h){a.stopLocalRecord(respCallback=function(h){c({id:a.getID(),status:h})})});h++});V="none";c.a.error("room-event",q.a.event_stop_recording_success,{error:{}})}else k["default"].error("recoding not stopped"),c.a.info("room-event",q.a.event_stop_recording_failed,
{message:t.a.error_1175.desc}),a&&a(t.a.error_1175)};f.setReceiveVideoQuality=function(a,c){if("[object Object]"===Object.prototype.toString.call(a)&&"function"===typeof c){var h={},b={},d={};d=a.videoQuality;var g=a.streamType;void 0===d&&(d="Auto");void 0===g&&(g="talker");k["default"].info("Dumping opts in setReceiveVideoQuality"+JSON.stringify(a)+" streamType"+g);if("talker"!=g&&"canvas"!=g)k["default"].info("setReceiveVideoQuality Failed Invalid Param -StreamType: "+g),c(t.a.error_1155);else{switch(d){case "HD":b.width=
1280;b.height=720;break;case "SD":b.width=960;b.height=540;break;case "LD":b.width=640;b.height=360;break;case "Auto":break;default:k["default"].info("setReceiveVideoQuality for "+g+". Failed Invalid Param -videoQuality: "+d);c(t.a.error_1155);return}b.frameRate=30;h.video=b;if("talker"==g&&f.receiveVideoQuality.get("talker")!==d||"canvas"==g&&f.receiveVideoQuality.get("canvas")!==d)T.forEach(function(a){"talker"===g&&!1===a.canvas&&!1===a.screen?a.updateConfiguration(h,function(a){k["default"].info("stream.updateConfiguration for talker stream result : "+
a)}):"canvas"===g&&!0===a.canvas&&a.updateConfiguration(h,function(a){k["default"].info("stream.updateConfiguration for canvas stream result : "+a)})}),f.receiveVideoQuality.set(g,d);d={result:0,msg:"Video quality successfully updated."};c(d)}}else"function"!==typeof c?k["default"].error("setReceiveVideoQuality() invalid param - callback() "):(k["default"].error("setReceiveVideoQuality() invalid param - QualityOpt "),c(t.a.error_1155))};f.getReceiveVideoQuality=function(a){return"talker"===a||"canvas"===
a?{result:0,videoQuality:f.receiveVideoQuality.get(a)}:t.a.error_1156};f.getStats=function(a,c,b){c=void 0===c?{intervalSecs:2,log:!0}:c;b=void 0===b?function(){}:b;if(void 0!=a&&"boolean"==typeof a&&"function"==typeof b)if(a){var h=function(a,h,b,f){a.pc&&a.pc.peerConnection&&a.pc.peerConnection.getStats(null).then(function(d){var k;d.forEach(function(h){switch(h.type){case "candidate-pair":h.nominated&&(k=h);break;case "outbound-rtp":case "inbound-rtp":void 0==b[a.getID()+"-"+h.kind]&&(b[a.getID()+
"-"+h.kind]={id:a.getID(),ssrc:0,reconnects:0,availKbps:0},f[a.getID()+"-"+h.kind]={});var d="outbound-rtp"===h.type,g=b[a.getID()+"-"+h.kind],e=f[a.getID()+"-"+h.kind];g.ssrc=h.ssrc;g.id=a.getID();g.reconnects=a.reconnectsTotal;d?(g.type="pub",g.kbps=e.bytes?8*(h.bytesSent-e.bytes)/(1E3*c.intervalSecs):0,g.targetkbps=h.targetBitrate/1E3):(g.type="sub",g.kbps=e.bytes?8*(h.bytesReceived-e.bytes)/(1E3*c.intervalSecs):0,g.packetsLost=h.packetsLost);"video"==h.kind?(g.id="vid:"+a.getID(),d?(g.fps=e.framesSent?
(h.framesSent-e.frames)/c.intervalSecs:0,e.frames=h.framesSent,g.retransmitKbps=e.retransmittedBytesSent?8*(h.retransmittedBytesSent-e.retransmittedBytesSent)/(1E3*c.intervalSecs):0,e.retransmittedBytesSent=h.retransmittedBytesSent,g.keyFrames=h.keyFramesEncoded,g.targetFps=h.framesPerSecond):(g.fps=e.framesDecoded?(h.framesDecoded-e.framesDecoded)/c.intervalSecs:0,e.framesDecoded=h.framesDecoded,g.recivedfps=e.frames?(h.framesReceived-e.frames)/c.intervalSecs:0,e.frames=h.framesReceived,g.droppedfps=
e.framesDropped?(h.framesDropped-e.framesDropped)/c.intervalSecs:0,e.framesDropped=h.framesDropped),g.resoln=h.frameWidth+"X"+h.frameHeight,g.firs=h.firCount,g.plis=h.pliCount,g.nacks=h.nackCount):g.id="aud:"+a.getID();e.bytes=d?h.bytesSent:h.bytesReceived;g.type+=a.ifScreen()?"sh":a.ifCanvas()?"cn":"mn"}});k&&(d=(h?k.availableOutgoingBitrate:k.availableIncomingBitrate)/1E3,b[a.getID()+"-audio"]&&(b[a.getID()+"-audio"].availKbps=d),b[a.getID()+"-video"]&&(b[a.getID()+"-video"].availKbps=d))},function(a){return console.log(" peerconnection getStats failed err : "+
a)})},d={},g={};P=setInterval(function(){2==f.state&&(X.forEach(function(a,c){"connected"==a.state?h(a,!0,d,g):d[a.getID()+"-video"]&&(delete d[a.getID()+"-audio"],delete d[a.getID()+"-video"],delete g[a.getID()+"-audio"],delete g[a.getID()+"-video"])}),T.forEach(function(a,c){"connected"==a.state?(f.activeTalkerList.get(parseInt(c))||100<parseInt(c)&&(f.shareStatus||f.canvasStatus))&&h(a,!1,d,g):d[a.getID()+"-video"]&&(delete d[a.getID()+"-audio"],delete d[a.getID()+"-video"],delete g[a.getID()+
"-audio"],delete g[a.getID()+"-video"])}),c.log&&console.table(Object.values(d)))},1E3*c.intervalSecs)}else P&&(clearTimeout(P),P=void 0);else k["default"].error("Invalid paramaters "),b&&"function"==typeof b&&b(t.a.error_1155)};f.getStreamStats=function(a,c){c=void 0===c?function(){}:c;if(!A)return"Error getting stats - no socket";if(!a)return"Error getting stats - no stream";A.sendMessage("getStreamStats",a.getID(),function(a){a&&c(a)})};f.getStreamsByAttribute=function(a,c){var h=[];T.forEach(function(b){void 0!==
b.getAttributes()&&b.getAttributes()[a]===c&&h.push(b)});return h};f.installPlugin=function(){if(!document.getElementById("WebrtcEverywherePluginId")){var a=!!(Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||"ActiveXObject"in window);navigator.userAgent.indexOf("Safari");var b=document.createElement("object");a?b.setAttribute("classid","CLSID:7FD49E23-C8D7-4C4F-93A1-F7EACFA1EC53"):b.setAttribute("type","application/webrtc-everywhere");b.setAttribute("id",
"WebrtcEverywherePluginId");document.body.appendChild(b);b.setAttribute("width","0");b.setAttribute("height","0");b.isWebRtcPlugin||"undefined"!==typeof navigator.plugins&&(navigator.plugins["WebRTC Everywhere"]||navigator.plugins["WebRTC Everywhere Plug-in for Safari"])?(k["default"].info("Installed WEBRTC plugin for IE"),c.a.info("room-event",q.a.event_general_success,{message:"Installed WEBRTC plugin for IE"})):(k["default"].info("Browser does not appear to be WebRTC-capable"),c.a.warn("room-event",
q.a.event_incompatible_browser,{message:"Browser does not appear to be WebRTC-capable"}),window.open("/assets/plugin/VCXIE_PLUGINS.exe","new"))}};f.sendStoredLogs=function(a,c){f.socket.sendSDP("clientLogPosted",a,k["default"].storedBuff,function(a,h){a?a&&(a={result:0,message:"Log posted successfully"},c(a)):(a={result:1340,message:"Error in posing log"},c(a))})};f.postClientLogs=function(a,c){c=void 0===c?function(){}:c;if("function"===typeof c){var h=p.a.decodeBase64(a);a=w.a.getLocalStorageItem("vcxRTCLib-log");
null!=a&&(h=JSON.parse(h).logId,JSON.parse(a),JSON.stringify(a).replace(",",", ").replace("{","").replace("}",""),f.sendStoredLogs(h,c))}else k["default"].error("postClientLogs() invalid param - callback")};f.whoAmI=function(a){a=void 0===a?function(a){}:a;var c;f.userList.forEach(function(a,h){h===f.clientId&&(c=a)});a(c)};var zb=function(a,c,b){c.userRequestOptions.video=void 0!=a?a:!0;c.config.video||(c.config.video=c.video=!0);k["default"].info("addRenegotiateVideo() : caling reconnectStream");
Ha(c,"add",function(a){b(a?t.a.error_000:t.a.error_1167)})};f.addVideo=function(a,b){b=void 0===b?function(){}:b;if(void 0!=a&&null!=a&&"object"!=typeof a)k["default"].error("addVideo() failed Invalid params"),b(t.a.error_1155);else if(f.subscription&&!f.subscription.audio_video)k["default"].error("Licence error : feature not supported subscription - av: "+f.subscription.audio_video),c.a.error("room-event",q.a.event_general_failed,{message:t.a.error_1170.error}),b(t.a.error_1170);else{var h;X.forEach(function(a,
c){a.ifCanvas()||a.ifScreen()||(h=a)});!h||h.isVideoMuted()||"connected"!=h.state||h.negotiatedMedia.video?h?b(h.isVideoMuted()?t.a.error_1189:t.a.error_1197):b(t.a.error_1159):(a&&(h.config.video&&"object"==typeof h.config.video||(h.config.video={}),a.deviceId&&(h.config.video.deviceId=a.deviceId),a.facingMode&&(h.config.video.facingMode=a.facingMode),Object.keys(h.config.video).length||(h.config.video=!0)),h.unmuteVideo(function(c){console.log("reconnectStreamOnUnmuteVideo resp:: "+JSON.stringify(c));
0==c.result?zb(a,h,b):b(t.a.error_1145)},!1,0,!h.hardVideoMuted,!1,!0))}};var Ea=function(a,c,b){b=void 0===b?function(){}:b;"function"!==typeof b||!c||"object"!=typeof c||void 0==c.pubType||"screen"!==c.pubType&&"canvas"!==c.pubType?b(t.a.error_1155):(c=JSON.parse(JSON.stringify(c)),c.req=a,f.socket.emitEvent("auxilaryPublishRequests",c,b))};f.setSharePermissionMode=function(a,c){Ea("set-permission-mode",a,c)};f.requestSharePermission=function(a,c){Ea("req-permission",a,function(h){f.isModerator()||
h.result!=t.a.error_000.result||(f.sharePermissions[a.pubType].state="share-permission-requested");c(h)})};f.grantSharePermission=function(a,c){Ea("grant-permission",a,c)};f.denySharePermission=function(a,c){Ea("deny-permission",a,c)};f.cancelSharePermission=function(a,c){Ea("cancel-permission",a,function(h){f.isModerator()||h.result!=t.a.error_000.result||(f.sharePermissions[a.pubType].state="idle");c(h)})};f.releaseSharePermission=function(a,c){Ea("release-permission",a,c)};f.startScreenShare=function(a,
b){var h;if(void 0!=a&&"function"===typeof a)var d=a;else void 0!=b&&"function"===typeof b&&(void 0!=a&&(h=a),d=b);if("function"!==typeof d||!f.share||f.subscription&&!f.subscription.audio_video)"function"===typeof d?k["default"].error("startScreenShare() invalid param - callback"):(k["default"].info("Room not connected../ licence error"),c.a.info("room-event",q.a.event_start_screenshare_failed,{error:error}),d(t.a.error_1171));else{void 0==h?h={audio:"chrome-stable"===w.a.browser_info.name||"edge"===
w.a.browser_info.name}:void 0==h.audio&&(h.audio=!1);h.layout=void 0!=h.layout?h.layout:"grid";f.forcedStopSharing=!1;var g,e;"safari"===w.a.browser_info.name&&(e=new Promise(function(a){g=Ab(h,function(c){a(c)})}));f.socket.emitEvent("auxilaryPublishRequests",{req:"start",pubType:"screen",override:!0},function(a){a.result==t.a.error_000.result?("safari"!==w.a.browser_info.name&&(e=new Promise(function(a){g=Ab(h,function(c){a(c)})})),e.then(function(a){!0!==a||f.shareStatus||f.forcedStopSharing?(!0===
a&&(a=f.shareStatus?t.a.error_1151:t.a.error_1200,g.close()),k["default"].error("startShare failed: err "+JSON.stringify(a)),f.socket.emitEvent("auxilaryPublishRequests",{req:"stop",pubType:"screen"},function(a){}),d(a)):(g.addEventListener("stream-ended",function(a){k["default"].info(" screen share stream ended, stopping share");f.stopScreenShare(function(a){k["default"].info("stopScreenShare resp: "+JSON.stringify(a))})}),f.publish(g,{share:!0,shareMetadata:{layout:h.layout},maxVideoBW:w.a.video_bandwidth_range.share.max,
minVideoBW:w.a.video_bandwidth_range.share.min},function(a){d(a);var h={streamId:g.getID(),externalIp:f.externalIp,negotiatedCodecs:{audio:{codec:"OPUS"},video:{codec:"VP8"}}};a.result===t.a.error_000.result?ta(!0,f.canvasStatus):4108===a.result&&(h.error=a.msg,f.createEventLog("clientStreamShareFailed",h),c.a.info("room-event",q.a.event_start_screenshare_failed,{addOpt:h}),g.stream.getTracks().forEach(function(a){a.stop()}))}))})):(g&&g.stream.getTracks().forEach(function(a){a.stop()}),d(a))})}localStream&&
(f.ScreenSharelocalStream=localStream);return localStream};f.getScreenShareStream=function(){return f.ScreenSharelocalStream};f.stopScreenShare=function(a,b){b=void 0===b?function(){}:b;if("function"===typeof b){var h=t.a.error_1159;if(f&&f.share&&(!f.subscription||f.subscription.audio_video)){var d;f.localStreams.forEach(function(a){a.ifScreen()&&a.local&&(Ma(!0,!1),a.close(),d=a,h=t.a.error_000)});ta(!1,f.canvasStatus);void 0!=d&&f.localStreams.remove(d.getID())}else h=f?t.a.error_1170:t.a.error_1171,
k["default"].info("Room not connected../ licence error"),c.a.info("room-event",q.a.event_stop_screenshare_failed,{error:h});f.ScreenSharelocalStream=null;b?b(h):a&&"function"===typeof a&&a(h)}else k["default"].error("stopScreenShare() invalid param - callback")};f.stopAllSharing=function(a){console.log("stopAllSharing");1!=f.shareStatus&&1!=f.isCanvasSharing||f.socket.sendParamEvent("stopAllSharing",f.clientId,function(c){0!=c.result&&(k["default"].error(c.msg),c.result=-1);a(c)})};var Lc=function(a){a=
Object(m.e)({type:"custom-data-saved",message:{result:a.result,scope:a.scope}});f.dispatchEvent(a)},Mc=function(a){var c=a.data,h=a.scope;"room"==h?f.customRoomData=c:"session"==h?f.customSessionData=c:"user"==h&&(h=f.userList.get(a.clientId),h.customUserData=c,f.userList.set(a.clientId,h));a=Object(m.e)({type:"custom-data-updated",message:{result:a.result,scope:a.scope,msg:a.msg}});f.dispatchEvent(a)};f.saveCustomData=function(a,c,b){if(!f.subscription||void 0!==f.subscription.datastore&&!1!==f.subscription.datastore){var h=
{result:0},d=a.scope,g=a.query;if(0==M(d))h.result=1,h.msg="Invalid scope parameter: "+d,b(h);else if(void 0==c||"object"!=typeof c||"object"==typeof c&&Array.isArray(c))k["default"].error("Invalid data: "+c),h.result=1,h.msg="Invalid  data",b(h);else if(g&&"string"!=typeof g)k["default"].error("Invalid data type of query: "+g),h.result=1,h.msg="Invalid  data type",b(h);else{g=Object.keys(c);g=$jscomp.makeIterator(g);for(var e=g.next();!e.done;e=g.next())if(""===e.value){h.result=1;h.msg="Empty string as key not allowed.";
b(h);return}f.socket.sendParamEvent("saveCustomData",{scope:d,data:c,query:a.query},function(a){0!=a.result&&k["default"].error(a.msg);b(a)})}}else k["default"].error("Customer datastore subsciption isn't supported for the room !!"),b(t.a.error_1170)};f.setCustomData=function(a,c,b){var h=a.scope,d=a.query;a=a.broadcast;if(!f.subscription||void 0!==f.subscription.datastore&&!1!==f.subscription.datastore){var g={result:0};if("owner"==h||0==M(h))g.result=1,g.msg="owner"==h?"Owner scope not allowed.":
"Invalid scope parameter: "+h,b(g);else{var e;if(e=a)e="string"!=typeof a||0==y.includes(a)?!1:!0,e=0==e;if(e)g.result=1,g.msg="Invalid broadcast parameter: "+a,b(g);else if(void 0==c||"object"!=typeof c||"object"==typeof c&&Array.isArray(c))k["default"].error("Invalid data: "+c),g.result=1,g.msg="Invalid  data",b(g);else if("user"!=h||void 0!=a&&"none"!=a){e=Object.keys(c);e=$jscomp.makeIterator(e);for(var p=e.next();!p.done;p=e.next())if(""===p.value){g.result=1;g.msg="Empty string as key not allowed.";
b(g);return}if(d&&"string"!=typeof d)k["default"].error("Invalid data type of query: "+d),g.result=1,g.msg="Invalid  data type",b(g);else if(d&&2<d.split(".").length)k["default"].error("Object level access exceeded, current size : "+d.split(".").length),g.result=1,g.msg="Object level access exceeded, It mustn't be greater than 2.",b(g);else{if("room"==h){if(d)if(e=d.split("."),0==e.length)f.customRoomData=Object.assign(f.customRoomData,c);else if(1==e.length)f.customRoomData[d]=f.customRoomData[d]?
Object.assign(f.customRoomData[d],c):c;else if(2==e.length)f.customRoomData[e[0]]?f.customRoomData[e[0]][e[1]]=f.customRoomData[e[0]][e[1]]?Object.assign(f.customRoomData[e[0]][e[1]],c):c:(f.customRoomData[e[0]]={},f.customRoomData[e[0]][e[1]]=c);else{k["default"].error("Object access level exceeded, it must be atmost 2 : "+d);g.result=1;g.msg="Object level access exceeded";b(g);return}else f.customRoomData=Object.assign(f.customRoomData,c);c=f.customRoomData}else if("session"==h){if(d)if(e=d.split("."),
0==e.length)f.customSessionData=Object.assign(f.customSessionData,c);else if(1==e.length)f.customSessionData[d]=f.customSessionData[d]?Object.assign(f.customSessionData[d],c):c;else if(2==e.length)f.customSessionData[e[0]]?f.customSessionData[e[0]][e[1]]=f.customSessionData[e[0]][e[1]]?Object.assign(f.customSessionData[e[0]][e[1]],c):c:(f.customSessionData[e[0]]={},f.customSessionData[e[0]][e[1]]=c);else{k["default"].error("Object access level exceeded, it must be atmost 2 : "+d);g.result=1;g.msg=
"Object level access exceeded";b(g);return}else f.customSessionData=Object.assign(f.customSessionData,c);c=f.customSessionData}"all"==a?f.socket.sendParamEvent("setCustomData",{scope:h,data:c,query:d},function(a){0!=a.result&&k["default"].error(a.msg);b(a)}):(c=Object(m.e)({type:"custom-data-updated",message:{result:0,scope:h,msg:"success"}}),f.dispatchEvent(c))}}else g.result=1,g.msg="Invalid broadcast option for scope USER, it mustn't be undefined or set to none.",b(g)}}else k["default"].error("Customer datastore subsciption isn't supported for the room !!"),
b(t.a.error_1170)};f.getCustomData=function(a,c){if(!f.subscription||void 0!==f.subscription.datastore&&!1!==f.subscription.datastore){var h={result:0};if(void 0==a||"object"!=typeof a||"object"==typeof a&&Array.isArray(a))k["default"].error("Invalid data: "+a),h.result=1,h.msg="Invalid  options",c(h);else{var b=a.scope,d=a.query,g=a.db;if(g&&"boolean"!=typeof g)k["default"].error("Invalid data type of db: "+d),h.result=1,h.msg="Invalid  data type",c(h);else if(0==M(b))h.result=1,h.msg="Invalid scope parameter: "+
b,c(h);else if(d&&"string"!=typeof d)k["default"].error("Invalid data type of query: "+d),h.result=1,h.msg="Invalid  data type",c(h);else if(d&&2<d.split(".").length)k["default"].error("Object level access exceeded, current size : "+d.split(".").length),h.result=1,h.msg="Object level access exceeded, It mustn't be greater than 2.",c(h);else if(void 0==g||0==g){if("room"==b)var e=f.customRoomData;else"session"==b?e=f.customSessionData:"user"==b&&f.userList.get(f.clientId)&&(e=f.userList.get(f.clientId).customUserData);
d?(a=d.split("."),2<a.length?(k["default"].error("Object access level exceeded, it must be atmost 2 : "+d),h.result=1,h.msg="Object level access exceeded",c(h)):void 0==e?c("No data is set wrt provided scope : "+b+", Data : "+e):0==a.length?c(e):1==a.length?e[d]?c(e[d]):c("Data wrt query doesn't exist"):2==a.length&&(e[a[0]]?e[a[0]][a[1]]?c(e[a[0]][a[1]]):c("Data wrt query doesn't exist"):c("Data wrt query doesn't exist"))):c(e)}else 1==g&&"session"!=b?(h.result=1,h.msg="Option true for db paramereter is valid for session scope only, scope used  : "+
b,c(h)):f.socket.sendParamEvent("getCustomData",{scope:b,options:a,query:d},function(a){0!=a.result&&k["default"].error(a.msg);c(a)})}}else k["default"].error("Customer datastore subsciption isn't supported for the room !!"),c(t.a.error_1170)};f.lock=function(a){Bb(!0,a)};f.unlock=function(a){Bb(!1,a)};f.dropUser=function(a,c){c=void 0===c?function(){}:c;if(void 0===a||null===a||Array.isArray(a)&&"function"===typeof c&&"moderator"===f.me.role){var h={all:!1};h.clientIds=void 0===a||null===a?[]:a;
f.socket.emitEvent(v.a.RoomEvent.drop,h,c)}else"function"===typeof c?c("moderator"!==f.me.role?t.a.error_1168:t.a.error_1155):k["default"].error("dropUser() invalid param - callback")};f.pinUsers=function(a,c){Cb(!0,a,void 0===c?function(){}:c)};f.unpinUsers=function(a,c){Cb(!1,a,void 0===c?function(){}:c)};f.addSpotlightUsers=function(a,c){Db(!0,a,void 0===c?function(){}:c)};f.removeSpotlightUsers=function(a,c){Db(!1,a,void 0===c?function(){}:c)};f.destroy=function(a){a=void 0===a?function(){}:a;
"function"===typeof a&&"moderator"===f.me.role?f.socket.emitEvent(v.a.RoomEvent.drop,{all:!0,clients:null},function(a){}):"function"===typeof a?(c.a.info("room-event",q.a.event_general_success,{message:"destroy - "+t.a.error_1168}),a(t.a.error_1168)):k["default"].error("() invalid param - callback")};f.setAudioOnlyMode=function(a,c){c=void 0===c?function(){}:c;if(void 0!==a&&"boolean"===typeof a&&a!=f.audioOnlyMode&&"function"===typeof c){var h=[],b={numTalkers:f.userVideoTalkerCount,numAudioTalkers:f.userAudioTalkerCount};
h[0]=new Promise(function(c,h){b.numVideoTalkers=a?0:f.userVideoTalkerCount;f.socket.emitEvent(v.a.RoomEvent.set_active_talker,b,function(a){c(a)})});h[1]=new Promise(function(c,h){X.forEach(function(h,b){h&&h.ifVideo()&&(a?h.muteVideo:h.unmuteVideo)(function(a){c(a)})})});Promise.all(h).then(function(h){for(var b=0;b<h.length;b++)if(0!==h[b].result&&h[b].result!==t.a.error_1177.result){c(h[b].result);return}f.audioOnlyMode=a;c(t.a.error_000)})}else h=void 0===a||"boolean"!==typeof a?t.a.error_1168:
t.a.error_1188,"function"===typeof c?c(h):k["default"].error("setAudioOnlyMode() invalid param - callback")};var ub=function(a,c){u.a.getDeviceList({speaker:!0},function(h){var b=!1;if(0==h.result)for(var d=0;d<h.devices.speaker.length;d++)if(h.devices.speaker[d].deviceId==a){b=!0;break}c(b)})},Bb=function(a,c){c=void 0===c?function(){}:c;"function"===typeof c?"moderator"===f.me.role&&a!=f.locked?f.socket.emitEvent(v.a.RoomEvent.lock_room,a,function(h){0===h.result&&(f.locked=a);c(h)}):c("moderator"!==
f.me.role?t.a.error_1168:t.a.error_4121):k["default"].error("lockRoom() invalid param - callback")},Cb=function(a,c,b){b=void 0===b?function(){}:b;void 0===c||null===c||Array.isArray(c)&&c.length&&"function"===typeof b&&"moderator"===f.me.role?f.setAdvancedOptions([{id:"update-pin-users",request:a?"add":"remove",clientIds:c}],b):"function"===typeof b?b("moderator"!==f.me.role?t.a.error_1168:t.a.error_1155):k["default"].error("pinUsers() invalid param - callback")},Db=function(a,c,b){b=void 0===b?
function(){}:b;void 0===c||null===c||Array.isArray(c)&&c.length&&"function"===typeof b&&"moderator"===f.me.role?f.setAdvancedOptions([{id:"spotlight-users",request:a?"add":"remove",clientIds:c}],b):"function"===typeof b?b("moderator"!==f.me.role?t.a.error_1168:t.a.error_1155):k["default"].error("spotlightUsers() invalid param - callback")},qa=function(a,c,b){b=void 0===b?function(){}:b;void 0!==a&&"string"===typeof a?f.socket.sendSDP("processFloorRequest",a,c,function(a,h){null===a?(k["default"].error("Error on "+
c+" error: "+h),b(void 0,h)):b(a)}):(k["default"].error(" Floor Req : "+c+"Invalid params"),b(void 0,t.a.error_1155))};f.sendSocketEvent=function(a,c){c=void 0===c?function(){}:c;f.socket.emitEvent("logClientEvents",a,function(a,h){h?c(h,"error"):c(a,"success")})};f.createEventLog=function(a,c){var h={eventType:a,roomId:f.roomID,logId:Z.logId,timestamp:new Date};Object.assign(h,c);k["default"].info(a+" :",h);f.sendSocketEvent(h,function(c,h){k["default"].info("Logging "+a+" response:  "+JSON.stringify(c)+
" , "+h+" ")})};var yb=function(){if(!1===f.reconnectionState){f.sendRecvBitrateStats||(f.sendRecvBitrateStats=!0);var a=[],c=0;T.forEach(function(h){h.pc&&h.pc.peerConnection&&(a[c]=h.pc.peerConnection.getStats(null).then(function(a){var c;a.forEach(function(a){"candidate-pair"===a.type&&void 0!==a.availableIncomingBitrate&&(k["default"].debug("incoming bitrate: "+a.availableIncomingBitrate),c={streamId:h.getID(),availableRecvBitrate:parseInt(a.availableIncomingBitrate)})});return c||{streamId:h.getID(),
availableRecvBitrate:0}},function(a){console.log(a);return{streamId:h.getID(),availableRecvBitrate:0}}),c++)});Promise.all(a).then(function(a){for(var c=0,h=0;h<a.length;h++)c+=a[h].availableRecvBitrate;k["default"].info("Bitrates Total:"+c+" streamInfo: "+JSON.stringify(a));f.socket.emitEvent(v.a.RoomEvent.client_stats,{media:{subscribers:{totalAvailableBw:c}}},function(a){})});k["default"].debug("Setting timeout again to execute ");setTimeout(yb,5E3)}else f.sendRecvBitrateStats=!1},vb=function(a,
c){if(void 0==a.videoSize)if(c)a.videoSize=[R.min.width,R.min.height,R.max.width,R.max.height];else return k["default"].error(" Failed : video size undefined"),t.a.error_1184;else{c=a.videoSize[0]*a.videoSize[1];var h=a.videoSize[2]*a.videoSize[3],b=R.min.width*R.min.height,d=R.max.width*R.max.height;if(c<b||c>d||h>d||h<b||c>h)return k["default"].error(" Failed : video size invalid minPixelsSet:"+c+" minPixelsConfig:"+b+" maxPixelsSet: "+h+" maxPixelsConfig: "+d+" req: min: "+a.videoSize[0]+" X "+
a.videoSize[1]+" max: "+a.videoSize[2]+" X "+a.videoSize[3]+" config: min: "+R.min.width+" X "+R.min.height+" max: "+R.max.width+" X "+R.max.height),t.a.error_1184}return t.a.error_000};f.initPublishStream=function(a,b,d,g){if(void 0!==b){if(void 0!=b.stream){var h=b.stream;if(h.audio||h.video)return h.stream?(void 0!=a&&null!==document.getElementById(a)&&h.play(a,b.options),d(h)):h.init(),h;k["default"].error(" Failed : initPublishStream(): audio and video disabled in input stream");c.a.error("room-event",
q.a.event_general_failed,{message:"initPublishStream - a/v disabled in input stream"});g(t.a.error_1146);return}if(b.audio||b.video||b.screen||b.canvas){b.video&&f.mediaConfiguration!==v.a.constant.H264_CODEC&&"safari"===w.a.browser_info.name&&w.a.browser_info.version<=v.a.constant.SAFARI_VERSION_NOT_SUPPORTING_VP8&&(b.video=!1,k["default"].info("Stream publish in Init publish:- SAFARI - false"));if(b.video&!b.canvas){var e=vb(b,!0);if(e.result!==t.a.error_000.result){k["default"].error(" Failed : initPublishStream(): video size invalid");
c.a.error("room-event",q.a.event_general_failed,{message:"initPublishStream - video size invalid"});g(e);return}}k["default"].debug("video Size: "+JSON.stringify(R)+" config.video_resolution_range: "+w.a.video_resolution_range+" token.roomMeta.settings.quality: "+Z.roomMeta.settings.quality+" room meta: "+JSON.stringify(Z.roomMeta)+" video Size: "+w.a.video_resolution_range[Z.roomMeta.settings.quality]);void 0!=b.videoSize&&b.videoSize.length||(b.videoSize=[R.min.width,R.min.height,R.max.width,R.max.height]);
h=EnxRtc.EnxStream(b)}else k["default"].error(" Failed : all stream opions (audio/video/screen/canvas)  false/undefined"),c.a.error("room-event",q.a.event_general_failed,{message:"initPublishStream - all stream opions (audio/video/screen/canvas) false/undefined"}),g(t.a.error_1155)}else c.a.info("room-event",q.a.event_stream_publish_success,{message:"initPublishStream - success"}),h=EnxRtc.EnxStream({audio:!0,video:!0,data:!0,videoSize:[R.min.width,R.min.height,R.max.width,R.max.height]});"IE"===
u.a.browserEngineCheck()?document.getElementById("WebrtcEverywherePluginId").addEventListener("media-access-allowed",function(c){k["default"].info("got media access:- "+JSON.stringify(c));null!==document.getElementById(a)&&h.play(a);d()}):(h.addEventListener("media-access-denied",g),h.addEventListener("media-access-failed",g),h.addEventListener("media-access-allowed",function(c){null!==document.getElementById(a)&&h.play(a,b.options);d(c.stream)}));h.init();return h};var Ab=function(a,b){var h={video:!0,
data:!0,screen:!0,fps:f.screenResolutionRange.fps,attributes:{name:"share"}};f.whoAmI(function(a){h.attributes.name=a.name+"_share"});h.audio=void 0!=a&&void 0!=a.audio?a.audio:!1;return f.initPublishStream("",h,function(){c.a.info("room-event",q.a.event_start_screenshare_success,{error:{}});b(!0)},function(a){"OverconstrainedError"===a.msg.name&&k["default"].info("Resolution selected is not supported by your webcam");c.a.error("room-event",q.a.event_start_screenshare_failed,{event:a});b(a.msg)})},
Eb=function(a,c,b){c=void 0===c?null:c;if(a)return a;c.style.position="relative";a=document.createElement("div");a.setAttribute("class","annotate-div");a.setAttribute("style","display:flex;justify-content: center;align-items: center;height: 100%;width: 100%;");if(b){var h=document.querySelector("#player_"+b.getID()).parentElement;if(h){var d=document.createElement("canvas"),g=f.canvasVideoPlayer+"_veneer";d.id=g;d.width=c?c.clientWidth:f.canvasOptions.width;d.height=c?c.clientHeight:f.canvasOptions.height;
c.style.height=d.height+"px";c.style.width=d.width+"px";d.className=f.canvasVideoPlayer+"_input_veneer";d.setAttribute("style","display:none;");document.body.appendChild(d);if(c){f.canvasOptions.width=c.clientWidth;f.canvasOptions.height=c.clientHeight;var k=document.createElement("div");k.setAttribute("id","canvas-wrapper");k.setAttribute("class","canvas-wrapper");if(!d)return;k.style.width=d.width+"px";k.style.height=d.height+"px";k.style.position="absolute";k.style.top="0%";k.append(d);B.a.appendCustomCanvas(k,
d.className,d.width,d.height);B.a.appendCanvasFrame(k,d.className,d.width,d.height,b);document.getElementById(c.id)&&document.getElementById(c.id).appendChild(k)}else document.body.appendChild(wrapper);null!=c&&(a.appendChild(c),h.prepend(a));B.a.bindEventListernersForTools();f.inputContext=d.getContext("2d");B.a.startFrame();B.a.pause_play();Nc();return g}}},Nc=function(){var a=B.a.getVideoFrameId(),c=document.getElementById(a);if(c){a=B.a.getCanvasId();var b=document.getElementById(a);b&&($a=setInterval(function(){f.inputContext.globalAlpha=
.1;0<c.width&&0<c.height&&0<B.a.getCanvasWidth()&&0<B.a.getCanvasHeight()&&f.inputContext.drawImage(c,0,0,B.a.getCanvasWidth(),B.a.getCanvasHeight());f.inputContext.globalAlpha=1;0<b.width&&0<b.height&&0<B.a.getCanvasWidth()&&0<B.a.getCanvasHeight()&&f.inputContext.drawImage(b,0,0,B.a.getCanvasWidth(),B.a.getCanvasHeight())},.3))}};f.annotateToolAction=function(a,c){B.a.toolBarAction(a,c)};f.startAnnotation=function(a,b){var h=document.getElementById("canvas-wrapper");h&&h.remove();try{if(a){var d=
a.getID(),g=document.querySelector("#player_"+d);if(g){var e=Za();k["default"].info(e,"status");f.canvas_video_player=document.getElementById("stream"+d);if(f.canvas_video_player)if(f.canvasVideoPlayer="stream"+d,e.result===t.a.error_000.result){var p=Eb(null,g,a);f.startCanvas({canvasSelector:p,fps:23,canvasType:"Annotation"},function(a){0==a.result&&b&&b(e)});za=!1;ya=!0;c.a.info("room-event",q.a.event_start_annotation_success,{error:{}});B.a.mouseAnnotate(p,f.inputContext,"player_"+d,a)}else b&&
b(e)}}}catch(Ra){console.info(Ra,"error"),k["default"].error("incorrect annotate params "+Ra),c.a.error("room-event",q.a.event_start_annotation_failed,{error:Ra}),b&&b(t.a.error_1155)}};f.stopAnnotation=function(a){ya=!1;f.stopCanvas(a);B.a.stopAnnotation();clearInterval($a)};f.adjustCanvas=function(){B.a.resize()};f.startCanvas=function(a,b){b=void 0===b?function(){}:b;if("function"===typeof b){var h,d,g=a?a.canvasSelector:"";try{var e=Za();e.result===t.a.error_000.result?f.socket.emitEvent("auxilaryPublishRequests",
{req:"start",pubType:"canvas"},function(p){if(p.result==t.a.error_000.result){d=Eb(g);if(a){p=a.fps?a.fps:f.canvasOptions.fps;var m=a.canvasType?a.canvasType:"default"}else p=f.canvasOptions.fps,m="default";h=Oc({domHandle:d,fps:23<p?23:p,canvasType:m,refreshFn:a.refreshFn,maxRefreshRate:f.maxCanvasRefreshRate},function(a,h){"success"===h?f.publish(a,{canvas:!0,canvasType:m,maxVideoBW:w.a.video_bandwidth_range.canvas.max,minVideoBW:w.a.video_bandwidth_range.canvas.min},function(a){0===a.result&&(k["default"].info("startCanvas response.result:",
a),c.a.info("room-event",q.a.event_start_canvas_success,{error:{}}),ta(f.shareStatus,!0),b&&b(a))}):b&&b(a)})}else b&&b(e)}):b&&b(e)}catch(Qa){k["default"].error("incorrect canvas params "+Qa),c.a.error("room-event",q.a.event_start_canvas_failed,{error:Qa}),b&&b(t.a.error_1155)}return h}k["default"].error("startCanvas() invalid param - callback")};f.playVideo=function(a,c,b){f.canvasVideoPlayer=a;a=document.querySelector("#"+a);void 0===a||null===a?b(t.a.error_1162):(f.canvas_video_player=a,c&&(f.canvasOptions.width=
c.width?c.width:f.canvasOptions.width,f.canvasOptions.height=c.height?c.height:f.canvasOptions.height,f.canvasOptions.fps=c.fps?c.fps:23),f.startCanvas({fps:c.fps},b))};f.stopCanvas=function(a){a=void 0===a?function(){}:a;if("function"===typeof a){var b=Za();if(b.result===t.a.error_000.result){var h;f.localStreams.forEach(function(b){b&&b.ifCanvas()&&(Ma(!1,!0),h=b,b.stream.getTracks().forEach(function(a){a.stop()}),b.onConnectionStateChanged(!1),b.close(),c.a.info("room-event",q.a.event_stop_canvas_success,
{error:{}}),a({result:0,msg:"Canvas stopped successfully."}))});ta(f.shareStatus,!1);void 0!=h&&f.localStreams.remove(h.getID())}else c.a.error("room-event",q.a.event_stop_canvas_failed,{error:{}}),a(b)}else k["default"].error("stopCanvas() invalid param - callback")};f.isModerator=function(){return f.me&&"moderator"===f.me.role};var Da=function(a,c,b,d,g,k){c=Pc(c,b,!0);c.result===t.a.error_000.result&&(d||g&&"string"===typeof g)?f.socket.sendMessage(a,{clientId:g},function(a){k(a)}):k(c.result!==
t.a.error_000.result?c:t.a.error_1155)},Pc=function(a,c,b){a=!f.subscription||(!c||f.subscription.audio_video)&&(!a||f.subscription.audio_only||f.subscription.audio_video);if(f&&a&&(!b||"moderator"===f.me.role))return t.a.error_000;b=f?a?t.a.error_1168:t.a.error_1170:t.a.error_1171;k["default"].error("validateCanvas error code "+b.result);return b},Za=function(){if(f&&(!f.subscription||f.subscription.audio_video)&&("lecture"!==f.mode||"moderator"===f.me.role||!0===f.floorGranted))return t.a.error_000;
var a=f?!f.subscription||f.subscription.audio_video?t.a.error_1173:t.a.error_1170:t.a.error_1171;k["default"].error("validateCanvas error code "+a.result);return a},Oc=function(a,c){var b=null,h={video:!0,canvas:!0,attributes:{name:"canvas"}};!1===h.canvas&&(h.canvas=!0);!1===h.video&&(h.video=!0);!0===h.audio&&(h.audio=!1);h.div||(h.div=a.domHandle);h.fps||(h.fps=a.fps);void 0!=a.refreshFn&&(h.refreshFn=a.refreshFn,h.maxCanvasRefreshRate=a.maxRefreshRate);void 0===h.attributes?h.attributes={name:"canvas"}:
(void 0===h.attributes.name||"canvas"===h.attributes.name)&&f.whoAmI(function(a){h.attributes.name=a.name+"_canvas"});h.videoSize=[1920,1080,1920,1080];k["default"].info("initcanvas config "+JSON.stringify(h));f.initPublishStream("",h,function(a){b=a;c(b,"success")},function(a){"OverconstrainedError"===a.msg.name&&k["default"].info("Resolution selected is not supported by your webcam");c(a.msg,"error")});return b},Qc=function(a){var c=null;f.isCanvasSharing=!0;f.clientId==a.clientId&&(f.isCanvasSharingClient=
!0);za?c=Object(m.e)({type:"annotation-started-ack",message:{clientId:a.clientId,name:a.name,streamId:a.streamId,canvasType:a.canvasType}}):"Annotation"===a.canvasType?(ya=!0,c=Object(m.e)({type:"canvas-started",message:{clientId:a.clientId,name:a.name,streamId:a.streamId,canvasType:a.canvasType}})):(f.canvasStatus=!0,ya&&(f.canvasStatus=!1),ya=!1,c=Object(m.e)({type:"canvas-started",message:{clientId:a.clientId,name:a.name,streamId:a.streamId,canvasType:a.canvasType?a.canvasType:"default"}}));ta(f.shareStatus,
!0);f.dispatchEvent(c);k["default"].debug("onCanvasStarted event :",JSON.stringify(c));a.streamId?(a=T.get(a.streamId))&&!a.failed?a._setStaticQualityLayer(2,-1,function(a){k["default"].info("stream._setStaticQualityLayer (2/-1) for canvas result : "+a)}):k["default"].error("canvas started:stream is undefined or failed"):k["default"].error("canvas arg.streamId is undefined")},Rc=function(a){a=Object(m.e)({type:"canvas-stopped",message:{clientId:a.clientId,name:a.name,streamId:a.streamId}});f.canvasStatus=
!1;f.isCanvasSharing=!1;ta(f.shareStatus,!1);k["default"].debug("onCanvasStopped event :",JSON.stringify(a));f.dispatchEvent(a);f.isCanvasSharingClient=!1},Sc=function(a){k["default"].info("canvasStateEvents");!0===a.videomuted?(a=Object(m.e)({type:"canvas-state-events",message:"Canvas stopped",reason:"bw"}),f.dispatchEvent(a)):(a=Object(m.e)({type:"canvas-state-events",message:"Canvas resumed",reason:"bw"}),f.dispatchEvent(a))},Tc=function(a){k["default"].info("shareStateEvents");!0===a.videomuted?
(a=Object(m.e)({type:"share-state-events",message:"Share stopped",reason:"bw"}),f.dispatchEvent(a)):(a=Object(m.e)({type:"share-state-events",message:"Share resumed",reason:"bw"}),f.dispatchEvent(a))},Uc=function(a){if("speaker_notification"===a.id){a.id="talker-notification";for(var c={},b=$jscomp.makeIterator(a.data),h=b.next();!h.done;h=b.next())h=h.value,!0===h.speech?c.speech=h.users:!0===h.noise&&(c.noise=h.users);a=Object(m.e)({type:a.id,message:c});f.dispatchEvent(a)}else a=Object(m.e)({type:a.id,
message:a.data}),f.dispatchEvent(a)},Vc=function(a){k["default"].debug("onUserRoleChangedEvent"+JSON.stringify(a)+" ownclientId: "+f.clientId);if(a.moderator.new===f.clientId)if("participant"===f.me.role){a.sharePermissions&&(f.sharePermissions.screen.approved=a.sharePermissions.screen.approved,f.sharePermissions.screen.pending=a.sharePermissions.screen.pending,f.sharePermissions.canvas.approved=a.sharePermissions.canvas.approved,f.sharePermissions.canvas.pending=a.sharePermissions.canvas.pending);
f.me.role="moderator";if(a.userList){f.userList.clear();for(var b in a.userList)f.userList.set(a.userList[b].clientId,a.userList[b])}if(a.awaitedParticipants)for(var h in a.awaitedParticipants)f.awaitedParticipants.set(a.awaitedParticipants[h].clientId,{clientId:a.awaitedParticipants[h].clientId,name:a.awaitedParticipants[h].name});"lecture"===f.mode&&(f.cCrequest=[],f.cCapprovedHands=[],a.raisedHands.length&&a.raisedHands.forEach(function(a){f.cCrequest.push(a)}),a.approvedHands.length&&a.approvedHands.forEach(function(a){f.cCapprovedHands.push(a)}))}else k["default"].info("onUserRoleChangedEvent() Already Moderator - no change");
else if(a.moderator.old===f.clientId)if("moderator"===f.me.role){f.me.role="participant";if(a.userList){f.userList.clear();for(var d in a.userList)f.userList.set(a.userList[d].clientId,a.userList[d])}f.sharePermissions.screen.approved=[];f.sharePermissions.screen.pending=[];f.sharePermissions.canvas.approved=[];f.sharePermissions.canvas.pending=[];f.sharePermissions.screen.state="idle";f.sharePermissions.canvas.state="idle";"lecture"===f.mode&&(f.cCrequest=[],f.cCapprovedHands=[],f.localStreams.getAll(),
X.forEach(function(a,b){f.unpublish(a,function(b){1==b?k["default"].info("stream has been un-published"):(k["default"].info("error during stream un-publishing"),c.a.error("room-event",q.a.event_stream_unpublish_failed,{stream:a}))})}))}else k["default"].info("onUserRoleChangedEvent() Already partcipant - no change");else"moderator"===f.me.role&&(b=function(a,c){var b=f.sharePermissions[a].pending.indexOf(c);-1!=b?f.sharePermissions[a].pending.splice(b,1):-1!=(b=f.sharePermissions[a].approved.indexOf(c))&&
f.sharePermissions[a].approved.splice(b,1)},b("screen",a.moderator.new),b("canvas",a.moderator.new),"lecture"===f.mode&&(dc(a.moderator.new)||Ja(a.moderator.new))),(b=f.userList.get(a.moderator.new))&&"participant"==b.role&&(b.role="moderator"),(b=f.userList.get(a.moderator.old))&&"moderator"==b.role&&(b.role="participant");a=Object(m.e)({type:"user-role-changed",message:a});f.dispatchEvent(a)},Wc=function(a){k["default"].debug("onUserRoleChangedEvent"+JSON.stringify(a)+" ownclientId: "+f.clientId);
"lecture"===f.mode?(f.mode="group",f.roomSettings.mode="group",f.cCrequest=[],f.cCapprovedHands=[]):"group"===f.mode&&(f.roomSettings.mode="lecture",f.mode="lecture",f.cCrequest=[],f.cCapprovedHands=[],"participant"===f.me.role?X.forEach(function(a,b){f.unpublish(a,function(b){1==b?k["default"].info("stream has been un-published"):(k["default"].info("error during stream un-publishing"),c.a.error("room-event",q.a.event_stream_unpublish_failed,{stream:a}))})}):k["default"].info("onUserRoleChangedEvent() Already Moderator - no change"));
a=Object(m.e)({type:"room-mode-switched",message:{mode:f.mode,moderator:a.moderator}});f.dispatchEvent(a)},Xc=function(c){k["default"].info("onRoomManagementEvents:"+JSON.stringify(c));var b={};switch(c.id){case "room-locked":case "room-unlocked":f.locked="room-locked"===c.id;b=c.msg;break;case "floor-opened":f.floorOpen=!0;break;case "floor-closed":f.floorOpen=!1;break;case "knock-enabled":f.knockEnabled=!0;break;case "knock-disabled":f.knockEnabled=!1;f.awaitedParticipants.clear();break;case "wait-room-disabled":f.waitRoom&&
(f.waitRoom=!1);for(var h=[],d=c.roomData.streams||[],g=Object.keys(d),e=c.roomData.userList,p=0;p<g.length;p+=1){var q=d[g[p]];b=Object(a.a)(f.Connection,{streamID:q.id,local:!1,audio:q.audio,video:q.video,data:q.data,screen:q.screen,canvas:!("undefined"===typeof q.canvas||!1===q.canvas),attributes:q.attributes});h.push(b);T.add(q.id,b)}for(var t in e)f.userList.set(e[t].clientId,e[t]);f.videoMutedUsers=c.roomData.videoMutedUsers||[];b={streams:h,users:e};break;case "privacy-modes-updated":f.privacyModes=
c.modes;b.modes=c.modes;if(c.userList)for(h in b.userList=c.userList,c.userList)f.userList.set(c.userList[h].clientId,c.userList[h]);break;case "conf-media-activated":xb("event");break;default:b=c.msg}c=Object(m.e)({type:c.id,message:b});f.dispatchEvent(c)},Yc=function(a){k["default"].info("Recieved an invite to join breakout room "+JSON.stringify(a));k["default"].info("Join Breakout Room event dispatched");if(!0===a.force_join){var c=Object(m.e)({type:"breakout-room-joining",message:{room_id:a.room_id,
requestor:a.requestor}});f.dispatchEvent(c);f.muteRoom({audio:!0,video:!0},function(c){0===c.result?X.forEach(function(c,b){c.screen||c.canvas||!c.ifAudio()&&!c.ifVideo()||f.joinBreakOutRoom({room_id:a.room_id,role:"participant"},{audio:!0,video:a.video?a.video:!1},function(a,c){a?(a=Object(m.e)({type:"breakout-room-connected",streams:a.streams,room:a.room,roomData:a.roomData,localBreakoutStream:a.localBreakoutStream}),f.dispatchEvent(a)):c&&(a=Object(m.e)({type:"breakout-room-error",message:c}),
f.dispatchEvent(a))})}):(c=Object(m.e)({type:"breakout-room-error"},{message:"mute room request failed"}),f.dispatchEvent(c))})}else c=Object(m.e)({type:"join-breakout-room",message:{room_id:a.room_id,requestor:a.requestor}}),f.dispatchEvent(c)};f.rejectBreakoutRoomInvite=function(a,c){c=void 0===c?function(){}:c;k["default"].info("Rejecting the breakout room invite ",a);a?f.socket.sendMessage("reject-breakout-room",a,function(a){a&&(k["default"].info("Reject breakout room, result: "+JSON.stringify(a)),
c(a))}):(k["default"].info("Invalid value room_id"),c&&c(t.a.error_1155))};var Zc=function(a){k["default"].info("Recieved user joined breakout room "+JSON.stringify(a));a=Object(m.e)({type:"user-joined-breakout-room",message:{clientId:a.client}});f.dispatchEvent(a)},$c=function(a){k["default"].info("USER DISCONNECTED BREAKOUT ROOM "+JSON.stringify(a));a=Object(m.e)({type:"user-disconnected-breakout-room",message:{name:a.name,clientId:a.clientId,room:a.room}});f.dispatchEvent(a)},ad=function(a){k["default"].info("BREAKOUT ROOM DESTROYED"+
JSON.stringify(a));a=Object(m.e)({type:"breakout-room-destroyed",message:{room_id:a.room_id}});f.dispatchEvent(a)},bd=function(a){k["default"].debug("Received Analytics events: "+JSON.stringify(a));a=Object(m.e)({type:"meeting-summary-events",message:{data:a}});f.dispatchEvent(a)},cd=function(a){k["default"].debug("Received transcription events: "+JSON.stringify(a));"transcription-started"===a.type?("room"===a.transcription_type?f.liveRoomTranscription=!0:f.liveTranscription=!0,f.transcriptionLanguage=
a.language):"transcription-stopped"===a.type&&("room"===a.transcription_type?f.liveRoomTranscription=!1:f.liveTranscription=!1);a=Object(m.e)({type:"transcription-events",message:{data:a}});f.dispatchEvent(a)};f.extendConferenceDuration=function(a){a=void 0===a?function(){}:a;"function"===typeof a?f.socket.emitEvent(v.a.RoomEvent.extend_conference_duration,{},function(c){a(c)}):k["default"].error("extendConferenceDuration() : failed Invalid param. callback is not function")};f.subscribeMediaStats=
function(a,c){c=void 0===c?function(){}:c;if(void 0!==a&&"string"===typeof a&&"function"===typeof c)if(2!==f.state||f.mediaStatsMode==a||"disable"!=a&&"notify"!=a&&"display"!=a&&"notify-display"!=a){var b=2!==f.state?t.a.error_1171:f.mediaStatsMode==a?t.a.error_1188:t.a.error_1155;k["default"].error("that.subscribeMediaStats () error: "+JSON.stringify(b));c(b)}else{var h=function(a){var c=document.querySelectorAll(".stats-container"),b=document.querySelectorAll(".stats-overlay");c.forEach(function(c){void 0!==
c&&null!==c&&(c.style.display=a)});b.forEach(function(c){void 0!==c&&null!==c&&(c.style.display=a)})};"disable"==a||"disable"==f.mediaStatsMode?X.forEach(function(c,b){c.ifCanvas()||c.ifScreen()||A.sendMessage("subscribeStreamStatsForClient",{streamId:b,statsEnabled:"disable"!=a},function(c){void 0!=c&&("Success"===c.status&&h("display"==a||"notify-display"==a?"block":"none"),f.mediaStatsMode=a)})}):(h("display"==a||"notify-display"==a?"block":"none"),f.mediaStatsMode=a)}else k["default"].error("that.subscribeMediaStats () invalid param "),
"function"===typeof c&&c(t.a.error_1155)};f.subscribeStreamStatsForClient=function(a,c,b){b=void 0===b?function(){}:b;if(!A)return"Error getting stats - no socket";if(!a)return"Error getting stats - no stream";A.sendMessage("subscribeStreamStatsForClient",{streamId:a.getID(),statsEnabled:c},function(a){if(a){var h=document.querySelectorAll(".stats-container"),d=document.querySelectorAll(".stats-overlay");"Success"===a.status&&!0===c?(f.mediaStatsMode="display",f.subscribeSessionStats=!0,h.forEach(function(a){void 0!==
a&&null!==a&&(a.style.display="block")}),d.forEach(function(a){void 0!==a&&null!==a&&(a.style.display="block")})):(f.mediaStatsMode="disable",f.subscribeSessionStats=!1,h.forEach(function(a){void 0!==a&&null!==a&&(a.style.display="none")}),d.forEach(function(a){void 0!==a&&null!==a&&(a.style.display="none")}));b(a)}})};f.subscribeForTalkerNotification=function(a,c){c=void 0===c?function(){}:c;if("function"===typeof c){if(!A)return"Error subscribing - no socket";f.setAdvancedOptions([{id:"speaker-notification",
enable:a}],c)}else k["default"].error("subscribeForTalkerNotification() invalid param - Callback")};f.manageStatsSubscription=function(a){"disable"!=f.mediaStatsMode?(a=f.mediaStatsMode,f.mediaStatsMode="disable",f.subscribeMediaStats(a,function(a){})):!0===f.subscribeSessionStats?(k["default"].info("resubscribe session stats"),f.subscribeStreamStatsForClient(a,f.subscribeSessionStats)):k["default"].info("session stats not subscribed")};f.reconPubSubFailed=function(a){k["default"].info("reconnect publish or subscribe failed",
a);pa(!0,!1)};f.manageNumTalker=function(){k["default"].info("Reset the preferred number of active talkers");-1!==sa?f.setTalkerCount(sa,function(a){k["default"].info("reset active talker",a)}):k["default"].info("Use default prefrence of number of active talkers")};f.startLiveMeetingSummary=function(a,c){var b={};k["default"].info("Starting the live meeting summary for the room");void 0===a&&void 0===c?b.language="english_us":void 0===c?a&&"function"===typeof a?(c=a,b.language="english_us",k["default"].info("Parameter null callback is params",
JSON.stringify(b))):void 0===a?(k["default"].error("Language parameter undefined, going ahead with default english_us"),b.language="english_us"):(b.language=a,k["default"].info("Parameter null callback is params",JSON.stringify(b))):b.language=a;!1===f.liveMeetingAnalytics?f.socket.sendMessage("startLiveMeetingAnalytics",b,function(a){a&&0===a.result&&(k["default"].info("Setting the live meeting analytics for room"),f.liveMeetingAnalytics=!0);c&&(k["default"].info("Sending the callbacks"),c(a))}):
c&&c(t.a.error_8003)};f.stopLiveMeetingSummary=function(a){a=void 0===a?function(){}:a;var c={};k["default"].info("Stopping the live meeting summary for the room");!0===f.liveMeetingAnalytics?f.socket.sendMessage("stopLiveMeetingAnalytics",c,function(c){f.liveMeetingAnalytics=!1;a(c)}):a(t.a.error_8004)};f.getLiveMeetingSummary=function(a){a=void 0===a?function(){}:a;k["default"].info("getting the live meeting summary for the room");f.socket.sendMessage("getLiveMeetingAnalytics",{},function(c){a(c)})};
f.startLiveTranscription=function(a,c){var b={};k["default"].info("Starting the live transcription for the room");void 0===a&&void 0===c?(b.language="english_us",b.room=!0):void 0===c?a&&"function"===typeof a?(c=a,b.room=!0,b.language="english_us",k["default"].info("Parameter null callback is params",JSON.stringify(b))):(b.room=!0,void 0===a?(k["default"].error("Language parameter undefined, going ahead with default english_us"),b.language="english_us"):(b.language=a,k["default"].info("Parameter null callback is params",
JSON.stringify(b)))):(b.room=!0,b.language=a);!1===f.liveRoomTranscription?f.socket.sendMessage("startLiveTranscription",b,function(a){a&&0===a.result&&(k["default"].info("Setting the live transcription for room"),f.liveRoomTranscription=!0);c&&(k["default"].info("Sending the callbacks"),c(a))}):c&&c(t.a.error_8001)};f.subscribeForLiveTranscription=function(a,c){var b={};void 0===a||void 0===c?(k["default"].error("subscribeForLiveTranscription() invalid parameters"),void 0!==a&&"function"===typeof a&&
a(response.error_1155)):void 0!==a&&void 0!==a.enable&&"boolean"===typeof a.enable?!0===a.enable?(!0===f.liveRoomTranscription?b.language=f.transcriptionLanguage:void 0!==a.language&&(b.language=a.language),!1===f.liveTranscription?f.socket.sendMessage("startLiveTranscription",b,function(a){a&&0===a.result&&(f.liveTranscription=!0);c&&c(a)}):c&&c(t.a.error_8001)):(a={client:!0},!0===f.liveTranscription?f.socket.sendMessage("stopLiveTranscription",a,function(a){f.liveTranscription=!1;c(a)}):c(t.a.error_8002)):
c(response.error_1155)};f.stopLiveTranscription=function(a){a=void 0===a?function(){}:a;var c={};!0===f.liveRoomTranscription?(c.room=!0,f.socket.sendMessage("stopLiveTranscription",c,function(c){f.liveRoomTranscription=!1;a(c)})):a(t.a.error_8002)};f.makeOutboundCall=function(a,b,d,g){g=void 0===g?function(){}:g;if("function"===typeof g){var h=!(f.subscription&&!1===f.subscription.sip_outbound),e={};void 0===d?e.silent_join=!0:(void 0!==d.name&&(e.name=d.name),void 0!==d.early_media&&"boolean"==
typeof d.early_media?e.early_media=d.early_media:e.silent_join=void 0!==d.silent_join&&"boolean"==typeof d.silent_join?d.silent_join:!0);!0===h?null!=a&&(console.log("Options: "+JSON.stringify(e)),f.socket.sendMessage("makeOutboundCall",{number:a,caller_id:b,options:e},function(c){c&&0===c.result?(f.dialOutList.set(a,{initiator:!0,state:"initiated"}),k["default"].info("Outbound call initiated for the number: "+a)):c&&1141===c.result?k["default"].error("Outbound call is in progress for the number: "+
a):k["default"].info("Received "+JSON.stringify(c)+" for outbound number: "+a);g&&g(c)})):!h&&g&&(c.a.error("room-event",q.a.event_general_failed,{message:"makeOutboundCall - not allowed"}),g(t.a.error_1170))}else k["default"].error("makeOutboundCall() invalid param - callback")};f.cancelOutboundCall=function(a,b){var h=f.dialOutList.get(a);void 0===h?"moderator"===f.me.role?f.socket.sendMessage("cancelOutboundCall",{number:a},function(a){k["default"].info("Cancel outbound call, response received is "+
JSON.stringify(a));c.a.info("room-event",q.a.event_general_success,{message:"cancelOutboundCall - success"});b&&b(a)}):b&&(c.a.error("room-event",q.a.event_general_failed,{message:"cancelOutboundCall - Insufficient Privileges"}),b({result:1705,msg:"Insufficient Privileges"})):"moderator"===f.me.role||!0===h.initiator?f.socket.sendMessage("cancelOutboundCall",{number:a},function(a){k["default"].info("Cancel outbound call, response received is "+JSON.stringify(a));c.a.info("room-event",q.a.event_general_success,
{message:"cancelOutboundCall - success"});b&&b(a)}):(k["default"].error(" You need to be moderator or the initiator of the oubound call to disconnect the call."),c.a.error("room-event",q.a.event_general_failed,{message:"cancelOutboundCall - Insufficient Privileges"}),b&&b({result:1705,msg:"Insufficient Privileges"}))};var dd=function(a){k["default"].debug("recieved dialStateEvents");var c=f.dialOutList.get(a.number);switch(a.status){case "dialing":void 0===c&&(c={initiator:!1,state:"dialing"},f.dialOutList.set(a.number,
c));break;case "proceeding":case "connected":c.state=a.status;break;case "failed":case "timeout":case "disconnected":f.dialOutList.delete(a.number);break;default:k["default"].debug("Unknown response received")}a=Object(m.e)({type:"dial-state-events",message:{number:a.number,state:a.status,description:a.description}});k["default"].debug("Dispatching dial state event: "+JSON.stringify(a));f.dispatchEvent(a)};f.pingBack=function(a){f.socket.sendMessage("pingBack",{},function(c){a&&a(c)})};f.startClientUsage=
function(a,c){f.socket.sendMessage("startClientUsage",a,function(a){c&&c(a)})};f.stopClientUsage=function(a,c){f.socket.sendMessage("stopClientUsage",a,function(a){k["default"].info("callback received "+JSON.stringify(a));c&&c(a)})};f.createBreakOutRoom=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b&&"object"===typeof a&&a.hasOwnProperty("participants")?a&&0<a.participants?f.socket.sendMessage("create-breakout-room",a,function(a){a&&(k["default"].info("Create breakout room, result: "+
JSON.stringify(a)),c.a.info("room-event",q.a.event_general_success,{message:"createBreakOutRoom - success"}),b(a))}):(k["default"].info("Invalid value for participants "+JSON.stringify(a)),c.a.error("room-event",q.a.event_general_failed,{message:"createBreakOutRoom - Invalid value for participants "+JSON.stringify(a)}),b&&b(t.a.error_1155)):k["default"].error("createBreakOutRoom() invalid param - callback/RoomDefinition")};f.createAndInviteBreakOutRoom=function(a,b){a&&0<a.max_rooms?(a.force_join=
!0,f.socket.sendMessage("create-invite-breakout-room",a,function(a){a&&(k["default"].info("Create breakout room, result: "+JSON.stringify(a)),c.a.info("room-event",q.a.event_general_success,{message:"createAndInviteBreakOutRoom - success"}),b(a))})):(k["default"].info("Invalid value for participants "+JSON.stringify(a)),c.a.error("room-event",q.a.event_general_failed,{message:"createAndInviteBreakOutRoom - Invalid value for participants "+JSON.stringify(a)}),b&&b(t.a.error_1155))};f.joinBreakOutRoom=
function(a,b,d){d=void 0===d?function(){}:d;"function"===typeof d?a&&null!==a.room_id&&null!==a.role?f.socket.sendMessage("join-breakout-room",a,function(h){h&&0===h.result?f.breakOutRoom.joinRoom(h.token,b,function(a,b){a&&(k["default"].info("****Join Breakout Room Success****, sending user-joined-event****"+JSON.stringify(a.roomData)),f.socket.sendMessage("user-joined-breakout-room",{name:a.roomData.name}),c.a.info("room-event",q.a.event_general_success,{message:"joinBreakOutRoom - success"}),d&&
d(a,null));b&&(c.a.error("room-event",q.a.event_general_failure,{message:"joinBreakOutRoom - failure"}),d&&d(null,b))}):(k["default"].error("Invalid data, room id not found "+JSON.stringify(a)),c.a.error("room-event",q.a.event_general_failure,{message:"joinBreakOutRoom - Invalid data, room id not found "+JSON.stringify(a)}),d&&d(t.a.error_1155))}):(k["default"].error("Invalid data, room id not found"+JSON.stringify(a)),c.a.error("room-event",q.a.event_general_failure,{message:"joinBreakOutRoom - Invalid data, room id not found "+
JSON.stringify(a)}),d&&d(t.a.error_1155)):k["default"].error("joinBreakoutRoom() invalid param - callback")};f.inviteToBreakoutRoom=function(a,b){b=void 0===b?function(){}:b;"function"===typeof b&&"object"===typeof a&&a.hasOwnProperty("room_id")?void 0===a||void 0===a.room_id?(k["default"].info("Invalid data, room id not found"+JSON.stringify(a)),c.a.error("room-event",q.a.event_general_failure,{message:"inviteToBreakoutRoom - Invalid data, room id not found "+JSON.stringify(a)}),b&&b(t.a.error_1155)):
f.socket.sendMessage("invite-breakout-room",a,function(a){a&&(k["default"].info("Create breakout room, result:"+JSON.stringify(a)),c.a.info("room-event",q.a.event_general_success,{message:"inviteToBreakoutRoom - success"}),b&&b(a))}):k["default"].error("inviteToBreakoutRoom() invalid param - callback/invitee")};f.clearAllBreakOutSession=function(a){void 0!==a&&"function"===typeof a&&(f.breakOutRoom.disconnectAll(),f.resumeRoom(a))};f.destroyAllBreakOutSession=function(a){"moderator"===f.me.role&&
(f.breakOutRoom.destroyAll(),f.resumeRoom(a))};var ed=function(a,b,d){b=void 0===b?{isMobile:!1,broadcast:!0,clientList:[]}:b;var h,g,e,p,x,v,l,w,R,z;return $jscomp.asyncExecutePromiseGeneratorProgram(function(u){if(1==u.nextAddress)return k["default"].info(" init file upload "),h=I.size,g={messageType:"upload-started",result:0,description:"upload started",response:{uploadStatus:"started",upJobId:h,uploadInfo:{upJobId:h,name:a.name,size:a.size,type:a.type}}},u.setCatchFinallyBlocks(2),e=new E.a,p=
{sender:e,status:"started"},I.set(h,p),x=Object(m.e)({type:"fs-upload-result",message:g}),f.dispatchEvent(x),u.yield(e.upload(a),4);if(2!=u.nextAddress){v=u.yieldResult;l=v.toJSON();p.status="completed";I.set(h,p);g.messageType="upload-completed";g.response.uploadStatus=p.status;g.response.upJobId=h;g.description=" upload completed";g.response.uploadInfo={upJobId:h,name:l.name,size:l.size,speed:l.speed,createdAt:l.createdAt,dlimit:l.dlimit,time:l.time,expiresAt:l.expiresAt,timeLimit:l.timeLimit};
if(!0===b.isMobile)return k["default"].info(" file sharing mobile client "),g.response.uploadInfo=l,g.response.uploadInfo.upJobId=h,x=Object(m.e)({type:"fs-upload-result",message:g}),f.dispatchEvent(x),d(g),u.return();k["default"].info(" is mobile  false ",b.isMobile);!0===f.showFsUi&&null!==document.getElementById(ea)&&Oa(l,document.getElementById(ea),"fs-file-uploaded");nb(l,"fs-file-available",b.broadcast,b.clientList,function(a){g.response.sentStatus=a;k["default"].info("sent message to all participants: file is available for download ",
a,"fupload result",g);x=Object(m.e)({type:"fs-upload-result",message:g});f.dispatchEvent(x);d(g)});x=Object(m.e)({type:"fs-upload-result",message:g});f.dispatchEvent(x);c.a.error("room-event",q.a.event_file_shared_success,{error:{}});d(g);return u.leaveTryBlock(0)}w=u.enterCatchBlock();k["default"].info("upload to file server failed",w);I.delete(h);g.messageType="upload-failed";g.response.uploadStatus="failed";g.description=" upload failed";g.result=1;R=Object(m.e)({type:"fs-upload-result",message:g});
f.dispatchEvent(R);k["default"].error("exception in file upload ",w);z=t.a.error_1182;k["default"].info(" send file failed",z);c.a.error("room-event",q.a.event_file_shared_failed,{error:{}});d(z);u.jumpToEnd()})};f.sendFiles=function(a,b,d){a=void 0===a?[]:a;b=void 0===b?{isMobile:!1,broadcast:!0,clientList:[]}:b;k["default"].info("Send file called options "+JSON.stringify(b)+" file object "+JSON.stringify(a));if(0===f.state&&!1===b.isMobile)a=t.a.error_1180,k["default"].info(" file upload: room is disconnected, file operations are not allowed"),
c.a.error("room-event",q.a.event_file_shared_failed,{message:"file upload: room is disconnected, file operations are not allowed"}),d(a);else if(d&&"function"===typeof d?k["default"].info("send file called with callback "):d=function(a){k["default"].info("SDK defined callback send file response ",a)},0<a.length){k["default"].info("preparing to upload files");f.filesToUpload=a;try{if(0>=f.filesToUpload[f.filesToUpload.length-1].size)k["default"].info(" file size is 0 bytes ",f.filesToUpload[f.filesToUpload.length-
1].size),d(t.a.error_1186+f.filesToUpload[f.filesToUpload.length-1].size);else{if(!b.isMobile){if(f.filesToUpload[f.filesToUpload.length-1].size>H){k["default"].info(" file upload limit exceeded. max allowed limit is ",H);d(t.a.error_1187+H);return}var h={};h.data=a;!0===f.showFsUi&&null!==document.getElementById(ea)&&Oa(h,document.getElementById(ea),"fs-upload-init");nb(h,"fs-upload-started",b.broadcast,b.clientList,function(a){k["default"].info(" file-upload-started sent to all participants",a)})}var g=
new z.a(a);ed(g,b,d);c.a.info("room-event",q.a.event_file_shared_success,{error:{}})}}catch(Ib){k["default"].error("exception occured in send file ",Ib),a=t.a.error_1182,k["default"].info(" send file failed",a),c.a.error("room-event",q.a.event_file_shared_failed,{error:{}}),d(a)}}else b=t.a.error_1185,k["default"].info(" input file list to upload is empty",b," length of file array",a.length),d(b)};f.recvFiles=function(a,b,d){b=void 0===b?{isMobile:!1}:b;d=void 0===d?function(){}:d;var h,g,e,p,x,v,
l,w,R,z,u,V,G,n,B;return $jscomp.asyncExecutePromiseGeneratorProgram(function(O){switch(O.nextAddress){case 1:if("function"!==typeof d){k["default"].error("recvFiles() invalid param - callback");O.jumpTo(0);break}if(0===f.state&&!1===b.isMobile)return h=t.a.error_1180,k["default"].info(" file download: room is disconnected file operations are not allowed"),void 0!=d&&d(h),O.return();if(a>U.length)return g=t.a.error_1181,k["default"].info(" file download: file is not available"),void 0!=d&&d(g),O.return();
e={messageType:"download-started",result:0,description:"download-started",response:{downloadStatus:"started",jobId:a,downloadInfo:f.availableFiles[a]}};O.setCatchFinallyBlocks(3);p=U[a];x=p.url.split("#")[0];return O.yield(fetch(x),5);case 5:return v=O.yieldResult,l=v.headers.get("WWW-Authenticate"),w=l.replace("send-v1 ",""),R=new K.a({secretKey:p.secretKey,id:p.id,nonce:w,requiresPassword:!1}),z={receiver:R,status:"started"},N.set(a,z),u=Object(m.e)({type:"fs-download-result",message:e}),f.dispatchEvent(u),
O.yield(R.getMetadata(),6);case 6:return O.yield(R.download(b),7);case 7:V=O.yieldResult;k["default"].info(" file downloaded successfully ",V);z.status="completed";N.set(a,z);e.messageType="download-completed";e.response.downloadStatus=z.status;e.response.jobId=a;e.description=" upload completed";u=Object(m.e)({type:"fs-download-result",message:e});c.a.info("room-event",q.a.event_file_download_success,{error:{}});f.dispatchEvent(u);void 0!=d&&d(V);O.leaveTryBlock(0);break;case 3:G=O.enterCatchBlock(),
k["default"].info(" file download failed",G),N.delete(a),e.messageType="download-failed",e.response.downloadStatus="failed",e.description=" download failed",e.result=1,n=Object(m.e)({type:"fs-download-result",message:e}),f.dispatchEvent(n),B=t.a.error_1183,c.a.error("room-event",q.a.event_file_download_failed,{error:t.a.error_1183.desc}),void 0!=d&&d(B),O.jumpToEnd()}})};f.mobileSetAvailableFile=function(a,c){k["default"].info("mobile sdk wants to set the available file list ",a);"fs-file-available"===
a.message.type&&(U.push(a.message),f.availableFiles.push({name:a.message.name,size:a.message.size,speed:a.message.speed,createdAt:a.message.createdAt,dlimit:a.message.dlimit,time:a.message.time,expiresAt:a.message.expiresAt,timeLimit:a.message.timeLimit,index:U.length-1}));c(!0)};f.setFsEndPoint=function(a){a=void 0===a?{isMobile:!1,fsDetails:{}}:a;!0===a.isMobile&&Object(G.f)(a.fsDetails,a.callInfo)};f.inJectFsUI=function(a){(a=void 0===a?{enable:!0,uploadElToAppend:"",recvElToAppend:""}:a)&&!0===
a.enable&&""!==a.uploadElToAppend&&null!==document.getElementById(a.uploadElToAppend)&&""!==a.recvElToAppend&&null!==document.getElementById(a.recvElToAppend)?(k["default"].info(" show file sharing UI "),f.showFsUi=!0,ia=a.uploadElToAppend,ea=a.recvElToAppend,f.testFT()):k["default"].info(" file UI injection failed")};f.testFT=function(){if(!1===f.showFsUi||!0===f.showFsUi&&null===document.getElementById(ia))k["default"].info(" file upload  UI can not be appended");else{var a=document.createElement("INPUT");
a.setAttribute("type","file");a.setAttribute("id","filesID");document.getElementById(ia).appendChild(a);document.getElementById("filesID").addEventListener("change",function(a){a=a.target.files;f.sendFiles(a);for(var c=0,b;b=a[c];c++)console.log(b)},!1);document.getElementById("filesID").addEventListener("click",function(a){a.target.value=null},!1)}};f.cancelUploads=function(a,c,b){a=void 0===a?!1:a;var d={description:"failed",result:1};if(void 0===c&&!1===a){if(k["default"].error(" upJobId must be defined for cancelling a particular upload "),
d.description="upJobId is undefined.",d.result=1,void 0!==b)return b(d)}else if(!0===a){c=$jscomp.makeIterator(I);for(a=c.next();!a.done;a=c.next())a=$jscomp.makeIterator(a.value),a.next(),a=a.next().value,"started"===a.status?(a.sender.cancel(),k["default"].info(" running jobs are",a)):k["default"].info(" status is ",a.status);d.description="Cancelled all uploads";d.result=0;void 0!==b&&b(d)}else void 0!=c&&(k["default"].info("cancelling specified upload with id",c),a=I.get(c),void 0!=a?"started"===
a.status?(k["default"].info("canceled upload",c),a.sender.cancel(),d.description="Cancelled upload "+c,d.result=0,void 0!=b&&b(d)):"completed"===a.status&&(k["default"].info("upload can not be cancelled because it is already completed"),d.description="upload is already completed.",d.result=1,void 0!=b&&b(d)):(k["default"].info("Uplode id is invalid"),d.description="Uplode id is invalid. ",d.result=1,void 0!=b&&b(d)))};f.cancelDownloads=function(a,c,b){a=void 0===a?!1:a;var d={description:"failed",
result:1};if(void 0===c&&!1===a){if(k["default"].error("ID must be defined for cancelling a particular upload "),d.description="ID is undefined.",d.result=1,void 0!==b)return b(d)}else if(!0===a){c=$jscomp.makeIterator(N);for(a=c.next();!a.done;a=c.next())a=$jscomp.makeIterator(a.value),a.next(),a=a.next().value,"started"===a.status?(a.receiver.cancel(),k["default"].info(" running jobs are",a)):k["default"].info(" status is ",a.status);d.description="Cancelled all downloads";d.result=0;void 0!==b&&
b(d)}else void 0!=c&&(k["default"].info("cancelling specified download with id",c),c=c.toString(),a=N.get(c),void 0!=a?"started"===a.status?(k["default"].info("cancelling download",c),a.receiver.cancel(),d.description="Cancelled download "+c,d.result=0,void 0!=b&&b(d)):"completed"===a.status&&(k["default"].info("Download can not be cancelled because it is already completed"),d.description="download is already completed.",d.result=1,void 0!=b&&b(d)):(k["default"].info("download id is invalid"),d.description=
"Download id is invalid. ",d.result=1,void 0!=b&&b(d)))};f.testFtMobile=function(a){a=void 0===a?!1:a;var c=document.createElement("INPUT");c.setAttribute("type","file");c.setAttribute("id","files-mobile");var b="";b=!1===a?document.getElementById("chat_btn"):document.body;b.appendChild(c);document.getElementById("files-mobile").addEventListener("change",function(a){a=a.target.files;k["default"].info("mobile list of files to upload",a[0]);f.filesToUpload=a;for(var c=0,b;b=a[c];c++)console.log("iterating file list",
b)},!1)};var fd=function(a){k["default"].debug("onstreamingnotification events"+JSON.stringify(a));a=Object(m.e)({type:a.type,message:a.data});f.dispatchEvent(a)},gd=function(a){k["default"].debug("socketOnHlsStreamingNotificationToPublisher events"+JSON.stringify(a));a=Object(m.e)({type:a.type,message:a.data});f.dispatchEvent(a)},hd=function(a){a=Object(m.e)({type:a.type,message:a.data});f.dispatchEvent(a)},id=function(a){a=Object(m.e)({type:a.type,message:a.data});f.dispatchEvent(a)};if("IE"!==
u.a.browserEngineCheck())A.on(v.a.SocketEvent.onAddStream,C.bind(null,cb)),A.on(v.a.SocketEvent.media_engine_connecting,C.bind(null,ib)),A.on(v.a.SocketEvent.signaling_message_peer,C.bind(null,Ob)),A.on(v.a.SocketEvent.publish_me,C.bind(null,jb)),A.on(v.a.SocketEvent.unpublish_me,C.bind(null,Pb)),A.on(v.a.SocketEvent.onBandwidthAlert,C.bind(null,lb)),A.on(v.a.SocketEvent.onBandwidthEvents,C.bind(null,Qb)),A.on(v.a.SocketEvent.onSelfBandwidthAlert,C.bind(null,kb)),A.on(v.a.SocketEvent.onDataStream,
C.bind(null,Rb)),A.on(v.a.SocketEvent.onUpdateAttributeStream,C.bind(null,Tb)),A.on(v.a.SocketEvent.onRemoveStream,C.bind(null,mb)),A.on(v.a.SocketEvent.disconnect,C.bind(null,Ub)),A.on(v.a.SocketEvent.connection_failed,C.bind(null,Vb)),A.on(v.a.SocketEvent.error,C.bind(null,Wb)),A.on(v.a.SocketEvent.onRemoveTrack,C.bind(null,Lb)),A.on(v.a.SocketEvent.user_connected,C.bind(null,eb)),A.on(v.a.SocketEvent.user_updated,C.bind(null,Mb)),A.on(v.a.SocketEvent.user_disconnected,C.bind(null,fb)),A.on(v.a.SocketEvent.user_subscribed,
C.bind(null,gb)),A.on(v.a.SocketEvent.user_unsubscribed,C.bind(null,hb)),A.on(v.a.SocketEvent.floor_management_events,C.bind(null,ec)),A.on(v.a.SocketEvent.dial_state_events,C.bind(null,dd)),A.on(v.a.UserEvent.user_awaited,C.bind(null,jc)),A.on(v.a.SocketEvent.data_stream_room,C.bind(null,Sb)),A.on(v.a.RoomEvent.room_awaited,C.bind(null,ic)),A.on(v.a.RoomEvent.room_connected,C.bind(null,kc)),A.on(v.a.RoomEvent.room_disconnected,C.bind(null,lc)),A.on(v.a.RoomEvent.room_record_on,C.bind(null,Bc)),A.on(v.a.RoomEvent.room_record_off,
C.bind(null,Cc)),A.on(v.a.RoomEvent.change_layout,C.bind(null,Gc)),A.on(v.a.RoomEvent.new_active_talker,C.bind(null,wb)),A.on(v.a.RoomEvent.hard_mute_audio,C.bind(null,mc)),A.on(v.a.RoomEvent.hard_unmute_audio,C.bind(null,nc)),A.on(v.a.RoomEvent.hard_mute_video,C.bind(null,oc)),A.on(v.a.RoomEvent.hard_unmute_video,C.bind(null,pc)),A.on(v.a.RoomEvent.auxilary_publish_events,C.bind(null,qc)),A.on(v.a.RoomEvent.share_started,C.bind(null,rc)),A.on(v.a.RoomEvent.share_stopped,C.bind(null,vc)),A.on(v.a.RoomEvent.screen_share_override,
C.bind(null,wc)),A.on(v.a.RoomEvent.stop_sharing,C.bind(null,tc)),A.on(v.a.RoomEvent.update_layout,C.bind(null,uc)),A.on(v.a.RoomEvent.share_state_events,C.bind(null,Tc)),A.on(v.a.RoomEvent.custom_data_saved,C.bind(null,Lc)),A.on(v.a.RoomEvent.custom_data_updated,C.bind(null,Mc)),A.on(v.a.RoomEvent.canvas_started,C.bind(null,Qc)),A.on(v.a.RoomEvent.canvas_stopped,C.bind(null,Rc)),A.on(v.a.RoomEvent.canvas_state_events,C.bind(null,Sc)),A.on(v.a.RoomEvent.generic_events,C.bind(null,Uc)),A.on(v.a.RoomEvent.user_role_changed,
C.bind(null,Vc)),A.on(v.a.RoomEvent.switch_codec,C.bind(null,sc)),A.on(v.a.RoomEvent.invite_breakout_room,C.bind(null,Yc)),A.on(v.a.RoomEvent.user_joined_breakout_room,C.bind(null,Zc)),A.on(v.a.RoomEvent.user_left_breakout_room,C.bind(null,$c)),A.on(v.a.RoomEvent.breakout_room_destroyed,C.bind(null,ad)),A.on(v.a.RoomEvent.transcription_events,C.bind(null,cd)),A.on(v.a.RoomEvent.analytics_events,C.bind(null,bd)),A.on(v.a.UserEvent.user_audio_muted,C.bind(null,xc)),A.on(v.a.UserEvent.user_audio_unmuted,
C.bind(null,yc)),A.on(v.a.UserEvent.user_video_muted,C.bind(null,zc)),A.on(v.a.UserEvent.user_video_unmuted,C.bind(null,Ac)),A.on(v.a.SocketEvent.room_management_events,C.bind(null,Xc)),A.on(v.a.SocketEvent.hard_mute,C.bind(null,fc)),A.on(v.a.SocketEvent.hard_mute_room,C.bind(null,hc)),A.on(v.a.SocketEvent.hard_unmute_room,C.bind(null,gc)),A.on(v.a.SocketEvent.onStatSubscription,C.bind(null,Yb)),A.on(v.a.SocketEvent.onStreamingNotification,C.bind(null,hd)),A.on(v.a.SocketEvent.onHlsStreamingNotification,
C.bind(null,fd)),A.on(v.a.SocketEvent.onHlsStreamingNotificationToPublisher,C.bind(null,gd)),A.on(v.a.SocketEvent.onLiveRecordingNotification,C.bind(null,id)),A.on(v.a.SocketEvent.onRoomLiveRecordingOn,C.bind(null,Dc)),A.on(v.a.SocketEvent.onRoomLiveRecordingOff,C.bind(null,Ec)),A.on(v.a.SocketEvent.onRoomLiveRecordingFailed,C.bind(null,Fc)),A.on(v.a.SocketEvent.switched_room,C.bind(null,Wc)),A.on(v.a.RoomEvent.room_transcription_on,C.bind(null,Hc)),A.on(v.a.RoomEvent.room_transcription_off,C.bind(null,
Ic)),A.on(v.a.RoomEvent.self_transcription_on,C.bind(null,Jc)),A.on(v.a.RoomEvent.self_transcription_off,C.bind(null,Kc));else{null===document.getElementById("WebrtcEverywherePluginId")&&f.installPlugin();var ua=document.getElementById("WebrtcEverywherePluginId");ua.addEventListener(v.a.SocketEvent.onAddStream,function(a){for(arg in a.data.args)cb(a.data.args[arg])});ua.addEventListener(v.a.SocketEvent.onRemoveStream,function(a){for(arg in a.data.args)mb(a.data.args[arg])});ua.addEventListener(v.a.SocketEvent.media_engine_connecting,
function(a){for(arg in a.data.args)ib(a.data.args[arg])});ua.addEventListener(v.a.SocketEvent.publish_me,function(a){for(arg in a.data.args)jb(a.data.args[arg])});ua.addEventListener(v.a.SocketEvent.user_connected,function(a){for(arg in a.data.args)eb(a.data.args[arg])});ua.addEventListener(v.a.SocketEvent.user_disconnected,function(a){for(arg in a.data.args)fb(a.data.args[arg])});ua.addEventListener(v.a.SocketEvent.user_subscribed,function(a){for(arg in a.data.args)gb(a.data.args[arg])});ua.addEventListener(v.a.SocketEvent.user_unsubscribed,
function(a){for(arg in a.data.args)hb(a.data.args[arg])})}return f}k["default"].info("Failed - Webrtc support is missing ")}},function(l,r,n){function e(a){a=void 0===a?100:a;return new Promise(function(b){return setTimeout(b,a)})}var u=n(28),m=!("object"!==typeof Intl||!Intl||"function"!==typeof Intl.NumberFormat||"object"!==typeof navigator),d=["bytes","kb","mb","gb"],a=function(){throw Error("uninitialized translate function. call setTranslate first");};l.exports={fadeOut:function(a){a=document.querySelector(a).classList;
a.remove("effect--fadeIn");a.add("effect--fadeOut");return e(300)},delay:e,allowedCopy:function(){return document.queryCommandSupported?document.queryCommandSupported("copy"):!1},bytes:function(b){if(1>b)return"0B";var g=Math.min(Math.floor(Math.log10(b)/3),d.length-1);b=Number(b/Math.pow(1024,g));var e=Math.floor(b)===b?0:1,p=b.toFixed(e);if(m)try{p=b.toLocaleString(locale(),{minimumFractionDigits:e,maximumFractionDigits:e})}catch(k){}return a("fileSize",{num:p,units:a(d[g])})},percent:function(a){if(m)try{return a.toLocaleString(locale(),
{style:"percent"})}catch(g){}return Math.floor(100*a)+"%"},number:function(a){return m?a.toLocaleString(locale()):a.toString()},copyToClipboard:function(a){var b=document.createElement("input");b.setAttribute("value",a);b.contentEditable=!0;b.readOnly=!0;document.body.appendChild(b);if(navigator.userAgent.match(/iphone|ipad|ipod/i)){var d=document.createRange();d.selectNodeContents(b);var e=getSelection();e.removeAllRanges();e.addRange(d);b.setSelectionRange(0,a.length)}else b.select();a=document.execCommand("copy");
document.body.removeChild(b);return a},arrayToB64:function(a){return u.fromByteArray(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},b64ToArray:function(a){return u.toByteArray(a+"===".slice((a.length+3)%4))},isFile:function(a){return/^[0-9a-fA-F]{10,16}$/.test(a)},openLinksInNewTab:function(a,d){d=void 0===d?!0:d;a=a||Array.from(document.querySelectorAll("a:not([target])"));d?a.forEach(function(a){a.setAttribute("target","_blank");a.setAttribute("rel","noopener noreferrer")}):a.forEach(function(a){a.removeAttribute("target");
a.removeAttribute("rel")});return a},browserName:function(){try{return/firefox/i.test(navigator.userAgent)?"firefox":/edge/i.test(navigator.userAgent)?"edge":/trident/i.test(navigator.userAgent)?"ie":/chrome/i.test(navigator.userAgent)?"chrome":/safari/i.test(navigator.userAgent)?"safari":/send android/i.test(navigator.userAgent)?"android-app":"other"}catch(b){return"unknown"}},streamToArrayBuffer:function(a,d){var b,g,k,e,m,l,q,c,u,n,z;return $jscomp.asyncExecutePromiseGeneratorProgram(function(p){switch(p.nextAddress){case 1:return b=
a.getReader(),p.yield(b.read(),2);case 2:g=p.yieldResult;if(!d){p.jumpTo(3);break}k=new Uint8Array(d);e=0;case 4:if(g.done){p.jumpTo(5);break}k.set(g.value,e);e+=g.value.length;return p.yield(b.read(),6);case 6:g=p.yieldResult;p.jumpTo(4);break;case 5:return p.return(k.buffer);case 3:m=[],l=0;case 7:if(g.done){p.jumpTo(8);break}m.push(g.value);l+=g.value.length;return p.yield(b.read(),9);case 9:g=p.yieldResult;p.jumpTo(7);break;case 8:q=0;c=new Uint8Array(l);u=$jscomp.makeIterator(m);for(n=u.next();!n.done;n=
u.next())z=n.value,c.set(z,q),q+=z.length;return p.return(c.buffer)}})},list:function(a,d,e){d=void 0===d?"":d;e=void 0===e?"":e;a=a.map(function(a){return html($jscomp$templatelit$0,e,a)});return html($jscomp$templatelit$1,d,a)},secondsToL10nId:function(a){return 3600>a?{id:"timespanMinutes",num:Math.floor(a/60)}:86400>a?{id:"timespanHours",num:Math.floor(a/3600)}:{id:"timespanDays",num:Math.floor(a/86400)}},timeLeft:function(a){if(1>a)return{id:"linkExpiredAlt"};a=Math.floor(a/1E3/60);var b=Math.floor(a/
60),d=Math.floor(b/24);return 1<=d?{id:"expiresDaysHoursMinutes",days:d,hours:b%24,minutes:a%60}:1<=b?{id:"expiresHoursMinutes",hours:b,minutes:a%60}:0===b?0===a?{id:"expiresMinutes",minutes:"< 1"}:{id:"expiresMinutes",minutes:a}:null},platform:function(){return"object"===typeof Android?"android":"web"},encryptedSize:function(a,d,e){e=(void 0===e?16:e)+1;return 21+a+e*Math.ceil(a/((void 0===d?65536:d)-e))},setTranslate:function(b){a=b}}},function(l,r){function n(e){this.max_=this.count_=this.sum_=
this.startTime_=0;this.rampUpThreshold_=e;this.rampUpTime_=Infinity}var e;n.prototype={add:function(e,m){0===this.startTime_&&(this.startTime_=e);this.sum_+=m;this.max_=Math.max(this.max_,m);Infinity===this.rampUpTime_&&m>this.rampUpThreshold_&&(this.rampUpTime_=e);this.count_+=1},getAverage:function(){return 0===this.count_?0:Math.round(this.sum_/this.count_)},getMax:function(){return this.max_},getRampUpTime:function(){return Math.round(this.rampUpTime_-this.startTime_)}};l.exports={arrayAverage:function(e){for(var m=
e.length,d=0,a=0;a<m;a++)d+=e[a];return Math.floor(d/m)},arrayMax:function(e){return 0===e.length?NaN:Math.max.apply(Math,$jscomp.arrayFromIterable(e))},arrayMin:function(e){return 0===e.length?NaN:Math.min.apply(Math,$jscomp.arrayFromIterable(e))},enumerateStats:function(e,m,d){var a={audio:{local:{audioLevel:0,bytesSent:0,clockRate:0,codecId:"",mimeType:"",packetsSent:0,payloadType:0,timestamp:0,trackId:"",transportId:""},remote:{audioLevel:0,bytesReceived:0,clockRate:0,codecId:"",fractionLost:0,
jitter:0,mimeType:"",packetsLost:-1,packetsReceived:0,payloadType:0,timestamp:0,trackId:"",transportId:""}},video:{local:{bytesSent:0,clockRate:0,codecId:"",firCount:0,framesEncoded:0,frameHeight:0,framesSent:-1,frameWidth:0,nackCount:0,packetsSent:-1,payloadType:0,pliCount:0,qpSum:0,timestamp:0,trackId:"",transportId:""},remote:{bytesReceived:-1,clockRate:0,codecId:"",firCount:-1,fractionLost:0,frameHeight:0,framesDecoded:0,framesDropped:0,framesReceived:0,frameWidth:0,nackCount:-1,packetsLost:-1,
packetsReceived:0,payloadType:0,pliCount:-1,qpSum:0,timestamp:0,trackId:"",transportId:""}},connection:{availableOutgoingBitrate:0,bytesReceived:0,bytesSent:0,consentRequestsSent:0,currentRoundTripTime:0,localCandidateId:"",localCandidateType:"",localIp:"",localPort:0,localPriority:0,localProtocol:"",remoteCandidateId:"",remoteCandidateType:"",remoteIp:"",remotePort:0,remotePriority:0,remoteProtocol:"",requestsReceived:0,requestsSent:0,responsesReceived:0,responsesSent:0,timestamp:0,totalRoundTripTime:0}};
e&&(e.forEach(function(b,g){switch(b.type){case "outbound-rtp":b.hasOwnProperty("trackId")&&(1!==b.trackId.indexOf(m.audio)&""!==m.audio?(a.audio.local.bytesSent=b.bytesSent,a.audio.local.codecId=b.codecId,a.audio.local.packetsSent=b.packetsSent,a.audio.local.timestamp=b.timestamp,a.audio.local.trackId=b.trackId,a.audio.local.transportId=b.transportId):1!==b.trackId.indexOf(m.video)&""!==m.video&&(a.video.local.bytesSent=b.bytesSent,a.video.local.codecId=b.codecId,a.video.local.firCount=b.firCount,
a.video.local.framesEncoded=b.framesEncoded,a.video.local.framesSent=b.framesSent,a.video.local.packetsSent=b.packetsSent,a.video.local.pliCount=b.pliCount,a.video.local.qpSum=b.qpSum,a.video.local.timestamp=b.timestamp,a.video.local.trackId=b.trackId,a.video.local.transportId=b.transportId));break;case "inbound-rtp":b.hasOwnProperty("trackId")&&(1!==b.trackId.indexOf(d.audio)&""!==d.audio&&(a.audio.remote.bytesReceived=b.bytesReceived,a.audio.remote.codecId=b.codecId,a.audio.remote.fractionLost=
b.fractionLost,a.audio.remote.jitter=b.jitter,a.audio.remote.packetsLost=b.packetsLost,a.audio.remote.packetsReceived=b.packetsReceived,a.audio.remote.timestamp=b.timestamp,a.audio.remote.trackId=b.trackId,a.audio.remote.transportId=b.transportId),1!==b.trackId.indexOf(d.video)&""!==d.video&&(a.video.remote.bytesReceived=b.bytesReceived,a.video.remote.codecId=b.codecId,a.video.remote.firCount=b.firCount,a.video.remote.fractionLost=b.fractionLost,a.video.remote.nackCount=b.nackCount,a.video.remote.packetsLost=
b.packetsLost,a.video.remote.packetsReceived=b.packetsReceived,a.video.remote.pliCount=b.pliCount,a.video.remote.qpSum=b.qpSum,a.video.remote.timestamp=b.timestamp,a.video.remote.trackId=b.trackId,a.video.remote.transportId=b.transportId));break;case "candidate-pair":b.hasOwnProperty("availableOutgoingBitrate")&&(a.connection.availableOutgoingBitrate=b.availableOutgoingBitrate,a.connection.bytesReceived=b.bytesReceived,a.connection.bytesSent=b.bytesSent,a.connection.consentRequestsSent=b.consentRequestsSent,
a.connection.currentRoundTripTime=b.currentRoundTripTime,a.connection.localCandidateId=b.localCandidateId,a.connection.remoteCandidateId=b.remoteCandidateId,a.connection.requestsReceived=b.requestsReceived,a.connection.requestsSent=b.requestsSent,a.connection.responsesReceived=b.responsesReceived,a.connection.responsesSent=b.responsesSent,a.connection.timestamp=b.timestamp,a.connection.totalRoundTripTime=b.totalRoundTripTime)}}.bind()),e.forEach(function(b){switch(b.type){case "track":b.hasOwnProperty("trackIdentifier")&&
(1!==b.trackIdentifier.indexOf(m.video)&""!==m.video&&(a.video.local.frameHeight=b.frameHeight,a.video.local.framesSent=b.framesSent,a.video.local.frameWidth=b.frameWidth),1!==b.trackIdentifier.indexOf(d.video)&""!==d.video&&(a.video.remote.frameHeight=b.frameHeight,a.video.remote.framesDecoded=b.framesDecoded,a.video.remote.framesDropped=b.framesDropped,a.video.remote.framesReceived=b.framesReceived,a.video.remote.frameWidth=b.frameWidth),1!==b.trackIdentifier.indexOf(m.audio)&""!==m.audio&&(a.audio.local.audioLevel=
b.audioLevel),1!==b.trackIdentifier.indexOf(d.audio)&""!==d.audio&&(a.audio.remote.audioLevel=b.audioLevel));break;case "codec":b.hasOwnProperty("id")&&(1!==b.id.indexOf(a.audio.local.codecId)&""!==m.audio&&(a.audio.local.clockRate=b.clockRate,a.audio.local.mimeType=b.mimeType,a.audio.local.payloadType=b.payloadType),1!==b.id.indexOf(a.audio.remote.codecId)&""!==d.audio&&(a.audio.remote.clockRate=b.clockRate,a.audio.remote.mimeType=b.mimeType,a.audio.remote.payloadType=b.payloadType),1!==b.id.indexOf(a.video.local.codecId)&
""!==m.video&&(a.video.local.clockRate=b.clockRate,a.video.local.mimeType=b.mimeType,a.video.local.payloadType=b.payloadType),1!==b.id.indexOf(a.video.remote.codecId)&""!==d.video&&(a.video.remote.clockRate=b.clockRate,a.video.remote.mimeType=b.mimeType,a.video.remote.payloadType=b.payloadType));break;case "local-candidate":b.hasOwnProperty("id")&&-1!==b.id.indexOf(a.connection.localCandidateId)&&(a.connection.localIp=b.ip,a.connection.localPort=b.port,a.connection.localPriority=b.priority,a.connection.localProtocol=
b.protocol,a.connection.localType=b.candidateType);break;case "remote-candidate":b.hasOwnProperty("id")&&-1!==b.id.indexOf(a.connection.remoteCandidateId)&&(a.connection.remoteIp=b.ip,a.connection.remotePort=b.port,a.connection.remotePriority=b.priority,a.connection.remoteProtocol=b.protocol,a.connection.remoteType=b.candidateType)}}.bind()));return a},doGetUserMedia:function(e,m,d){try{navigator.mediaDevices.getUserMedia(e).then(function(a){a.onremovetrack=function(){};m(a)}).catch(function(a){d(a)})}catch(a){d(a.message)}},
setTimeoutWithProgressBar:function(l,m){var d=window.performance.now(),a=setInterval(function(){var a=window.performance.now();e.setProgress(100*(a-d)/m)},100),b=function(){clearInterval(a);e.setProgress(100);l()},g=setTimeout(b,m);return function(){clearTimeout(g);b()}},setActiveTest:function(l){e=l},appendSourceId:function(e,m,d){""!==e&&(!0===d[m]?d[m]={optional:[{sourceId:e}]}:"object"===typeof d[m]&&("undefined"===typeof d[m].optional&&(d[m].optional=[]),d[m].optional.push({sourceId:e})))},StatisticsAggregate:n,
enumerateStatsFirefox:function(e){var m={audio:{local:{bytesSent:0,packetsSent:0},remote:{bytesReceived:-1,packetsReceived:0,packetsLost:-1,jitter:0,roundTripTime:0,timestamp:0}},video:{local:{bytesSent:0,packetsSent:-1,bitrateMean:0,bitrateStdDev:0,qpSum:0},remote:{bytesReceived:-1,packetsReceived:0,packetsLost:-1,bitrateMean:0,bitrateStdDev:0,roundTripTime:0,timestamp:0}},connection:{bytesSent:0,bytesReceived:0,timestamp:0}};e&&e.forEach(function(d,a){switch(d.type){case "outbound-rtp":"audio"==
d.mediaType?(m.audio.local.bytesSent=d.bytesSent,m.audio.local.packetsSent=d.packetsSent):"video"==d.mediaType&&(m.video.local.bytesSent=d.bytesSent,m.video.local.packetsSent=d.packetsSent,m.video.local.bitrateMean=d.bitrateMean,m.video.local.bitrateStdDev=d.bitrateStdDev,m.video.local.qpSum=d.qpSum);break;case "remote-outbound-rtp":"audio"==d.mediaType?(m.audio.local.bytesSent=d.bytesSent,m.audio.local.packetsSent=d.packetsSent):"video"==d.mediaType&&(m.video.local.bytesSent=d.bytesSent,m.video.local.packetsSent=
d.packetsSent);break;case "inbound-rtp":"audio"==d.mediaType?(m.audio.remote.bytesReceived=d.bytesReceived,m.audio.remote.packetsLost=d.packetsLost,m.audio.remote.packetsReceived=d.packetsReceived,m.audio.remote.jitter=d.jitter):"video"==d.mediaType&&(m.video.remote.bytesReceived=d.bytesReceived,m.video.remote.packetsLost=d.packetsLost,m.video.remote.packetsReceived=d.packetsReceived,m.video.remote.bitrateMean=d.bitrateMean,m.video.remote.bitrateStdDev=d.bitrateStdDev,m.video.remote.qpSum=d.qpSum);
break;case "remote-inbound-rtp":"audio"==d.mediaType?(m.audio.remote.bytesReceived=d.bytesReceived,m.audio.remote.packetsLost=d.packetsLost,m.audio.remote.packetsReceived=d.packetsReceived,m.audio.remote.jitter=d.jitter,m.audio.remote.roundTripTime=d.roundTripTime,m.audio.remote.timestamp=d.timestamp):"video"==d.mediaType&&(m.video.remote.bytesReceived=d.bytesReceived,m.video.remote.packetsLost=d.packetsLost,m.video.remote.packetsReceived=d.packetsReceived,m.video.remote.roundTripTime=d.roundTripTime,
m.video.remote.timestamp=d.timestamp);break;case "candidate-pair":m.connection.bytesReceived=d.bytesReceived,m.connection.bytesSent=d.bytesSent,m.connection.timestamp=d.timestamp}}.bind());return m}}},function(l,r,n){var e=n(4),u=n(42),m=n(26),d=n(7),a=n(0),b=n(25),g=n(6),x=n(5);n(27);var p=n(8),k=n(9);l=n(1);var v=n.n(l);n=n(51);if(1==v.a.noise_analysis)var t=new n.a;r.a=function(l,q){if(v.a.is_supported()){var c=Object(e.c)(q);c.config=q;c.stream=q.stream;c.url=q.url;c.recording=q.recording;c.recordingId=
void 0;c.room=void 0;c.showing=!1;c.local=!1;c.video=q.video;c.audio=q.audio;c.screen=q.screen;c.videoSize=q.videoSize;c.videoFrameRate=q.videoFrameRate;c.extensionId=q.extensionId;c.desktopStreamId=q.desktopStreamId;c.recordingId=q.recordingId;c.clientId=q.clientId;c.videoMutedDueToBw=!1;c.hardAudioMuted=!1;c.hardVideoMuted=!1;c.softVideoMuted=!1;c.selfMuteVideo=!1;c.selfMuteAudio=!1;c.ATVideoMuted=!1;c.selfPausedVideo=!1;c.selfPausedAudio=!1;c.processingVideoMute=!1;c.attributes=q.attributes;c.Connection=
void 0===l?d.a:l;c.playerDivs=[];c.canvas=q.canvas;c.transactions=new Map;c.audioStream=q.audioStream;c.audioStreamClone=void 0;c.videoStream=q.videoStream;c.recordedBlobs=[];c.negotiatedMedia={audio:void 0!=q.audio,video:void 0!=q.video};c.state="idle";var w={},n=!1,z=!1,K=!1;c.inputMediaSource={audio:{},video:{user:null,self:null,selected:"self"}};void 0==c.config.videoMuted&&(c.config.videoMuted=!1);void 0==c.config.audioMuted&&(c.config.audioMuted=!1);c.abwdEnabled=!0;c.abwdNotification="sdk";
c.abwdLanguage="en";var B="none",r="none",y=!1,F="none",S;c.maxVideoBwKbpsReqByUser=0;c.maxVideoBwKbpsReqByServer=0;c.maxVideoBwKbpsSet=0;c.reconnect=!1;c.reconnectAttempt=0;c.reconnectsTotal=0;c.pcmInputBuf=void 0;c.pcmOutputBuf=void 0;c.pcmInputIndex=void 0;c.rnn=void 0;c.bufferResidue=new Float32Array([]);c.scoreArrayVoice=[];c.scoreArrayNoise=[];c.audioLevelArray=[];c.processing_voice_while_mute=!1;c.processing_noise_detection=!1;c.audioContext=void 0;var M={videoFps:{set:0,max:{user:0,server:0},
min:{user:0,server:0}},videoBw:{set:0,max:{user:0,server:0},min:{user:0,server:0}}};void 0===q.local||!0===q.local?c.local=!0:n=z=!0;c.isAudioMuted=function(){return n};c.isVideoMuted=function(){return z||c.config.videoMuted};c.setID=function(a){(q.streamID=a)&&c.player&&c.player.streamUpdated(a)};c.getID=function(){return c.local&&!q.streamID?"local":q.streamID};c.getAttributes=function(){return q.attributes};c.setAttributes=function(b){c.local?c.emit(Object(e.f)({type:"internal-set-attributes",
stream:c,attrs:b})):a["default"].error("Error! Stream Object is not published. Failed to update attributes.")};c.updateLocalAttributes=function(a){q.attributes=a};c.ifAudio=function(){return!1!==q.audio&&void 0!==q.audio?!0:!1};c.ifVideo=function(){return!1!==q.video&&void 0!==q.video?!0:!1};c.ifData=function(){return!1!==q.data&&void 0!==q.data?!0:!1};c.ifScreen=function(){return q.screen};c.ifMedia=function(){return!1!==q.audio&&void 0!==q.audio||!1!==q.video&&void 0!==q.video||!1!==q.screen?!0:
!1};c.ifExternal=function(){return void 0!==c.url||void 0!==c.recording?!0:!1};c.ifCanvas=function(){return q.canvas};c.sendData=function(b){c.local&&c.ifData()?c.emit(Object(e.f)({type:"internal-send-data",stream:c,msg:b})):(a["default"].error("Error! Stream Object is not published. Failed to send data."),k.a.error("stream-event",p.a.event_send_data_failed,{error:"Error! Stream Object is not published. Failed to send data."}))};var da=function(){c.Connection.mediaDeviceUpdate({mic:!0,cam:!0,speaker:!1},
"stream_handleMediaDeviceChangeNotify",function(b){var d=b.current,f=b.added;b=b.removed;var k=function(a,c,b,d,f,g){var k=!1,e=!1,p="object"==typeof d?d.deviceId.exact:d.deviceId;d=d.groupId;var m="object"==typeof f?f.deviceId.exact:f.deviceId;f=f.groupId;for(var q in c)"default"!=p&&c[q].deviceId!=p||c[q].groupId!=d||(k=!1),"default"!=m&&c[q].deviceId!=m||c[q].groupId!=f||(e=!1);for(var t in a)"default"!=p&&a[t].deviceId!=p||a[t].groupId!=d||(k=!0),"default"!=m&&a[t].deviceId!=m||a[t].groupId!=
f||(e=!0);if(!k||!e)for(var v in b)"default"!=p&&b[v].deviceId!=p||b[v].groupId!=d||(k=!0),"default"!=m&&b[v].deviceId!=m||b[v].groupId!=f||(e=!0);if((p!=m||d!=f||!g)&&e)return m;if(!k){if(b.length)return b[0].deviceId;if(a.length)return a[0].deviceId}};if(q.params){var p=null,m=null;if(q.params.set.video&&c.videoStream){var t=!1;c.videoStream.getVideoTracks().forEach(function(a){"ended"!=a.readyState&&(t=!0)});p=k(d.cam,b.cam,f.cam,q.params.set.video,q.params.config.video,t)}else a["default"].error("spec.params.set.video not defined");
if(q.params.set.audio&&c.audioStream){var x=!1;c.audioStream.getAudioTracks().forEach(function(a){"ended"!=a.readyState&&(x=!0)});m=k(d.mic,b.mic,f.mic,q.params.set.audio,q.params.config.audio,x)}else a["default"].error("spec.params.set.audio not defined");var l,w;void 0!=m?(c.selfMuteAudio||c.hardAudioMuted||(l=m),c.selectedMicId=m):c.selectedMicId=q.params.set.audio.deviceId;void 0!=p?(c.selfMuteVideo||c.hardVideoMuted||(w={deviceId:p}),c.selectedCam={deviceId:p}):c.selectedCam={deviceId:"object"==
typeof q.params.set.video.deviceId?q.params.set.video.deviceId.exact:q.params.set.video.deviceId};void 0==w&&void 0==l||N(c,l,w,!0,function(b){if(b.result===g.a.error_000.result)b={},void 0!=w&&(H(c.inputMediaSource.video[c.inputMediaSource.video.selected]),b.video={deviceId:w.deviceId}),void 0!=l&&(b.audio={deviceId:l}),b=Object(e.f)({type:"media-device-updated",evntDetails:b}),c.dispatchEvent(b);else if(a["default"].error("setMediaDevicesTrack() returned failure : "+JSON.stringify(b)),b.result===
g.a.error_1145&&"mobile"==v.a.browser_info.device_type&&void 0!==c.room)c.room.onMediaDeviceStateChanged(c,{type:"mic",state:"inactive",error:b})})}else a["default"].error("spec.params not defined")})},ba=function(a){"mobile"!=v.a.browser_info.device_type&&(a.width={},a.height={},void 0!==c.videoSize?(a.width.min=c.videoSize[0],a.height.min=c.videoSize[1],a.width.max=c.videoSize[2],a.height.max=c.videoSize[3]):(a.width.min=v.a.video_resolution_range.Default.min.wdith,a.height.min=v.a.video_resolution_range.Default.min.height,
a.width.max=v.a.video_resolution_range.Default.max.width,a.height.max=v.a.video_resolution_range.Default.max.height),"chrome-stable"===d.a.browserEngineCheck()&&(a.width.ideal=a.width.max,a.height.ideal=a.height.max))};c.init=function(){try{if(a["default"].info("requested getUsermedia options: "+JSON.stringify(q)),q.audio||q.video||q.screen||q.canvas||void 0===q.url){a["default"].info("Note! Requested access to local media");var b=!1,g=!1,m=!1;q.video&&!1!==q.video&&(void 0!=q.disableGUMOptions&&
q.disableGUMOptions?b=!0:(b={},ba(b),void 0!==c.videoFrameRate&&(b.frameRate={min:c.videoFrameRate[0],max:c.videoFrameRate[1]}),"object"===typeof q.video&&(void 0!==q.video.deviceId&&""!==q.video.deviceId&&(b.deviceId="safari"!==d.a.browserEngineCheck()?{exact:q.video.deviceId}:q.video.deviceId),void 0!==q.video.facingMode&&""!==q.video.facingMode&&"mobile"==v.a.browser_info.device_type&&(b.facingMode=q.video.facingMode))));q.screen&&!1!==q.screen&&(b=!0);q.canvas&&!1!==q.canvas&&(m={},m=void 0===
c.videoSize?{width:{min:c.videoSizeForCanvas[0],max:c.videoSizeForCanvas[2]},height:{min:c.videoSizeForCanvas[1],max:c.videoSizeForCanvas[3]},canvasId:q.div,fps:q.fps}:{width:{min:c.videoSize[0],max:c.videoSize[2]},height:{min:c.videoSize[1],max:c.videoSize[3]},canvasId:q.div,fps:q.fps});q.audio&&!1!==q.audio&&(void 0!=q.disableGUMOptions&&q.disableGUMOptions?g=!0:(g={echoCancellation:{exact:!0},googEchoCancellation:{exact:!0},autoGainControl:{exact:!0},noiseSuppression:{exact:!0},googHighpassFilter:{exact:!0},
googExperimentalNoiseSuppression:{exact:!0},googExperimentalEchoCancellation:{exact:!0},googExperimentalAutoGainControl:{exact:!0}},"object"===typeof q.audio&&q.audio.deviceId&&""!==q.audio.deviceId&&(g.deviceId=q.audio.deviceId)));var t={video:b,audio:g,screen:q.screen,canvas:m,fake:q.fake,extensionId:c.extensionId,desktopStreamId:c.desktopStreamId};q.screen&&!1!==q.screen&&(t.fps=q.fps);q.canvas&&!1!==q.canvas?(c.state="initing",c.Connection.GetCanvasStream(t,function(b){c.videoStream=b;c.stream=
b;a["default"].debug("Got stream from canvas opt: "+t+" refreshFn: "+q.refreshFn);c.state="inited";c.videoStream.getTracks().forEach(function(b){a["default"].info("getTracks canvas: ",b);b.onended=function(){c.videoStream.getTracks().forEach(function(a){a.onended=null});var a=Object(e.f)({type:"stream-ended",stream:c,msg:b.kind});c.dispatchEvent(a)}});b=Object(e.f)({type:"media-access-allowed",stream:c});c.dispatchEvent(b);k.a.info("stream-event",p.a.event_media_access_success,{error:{}})},function(b){a["default"].error("GetCanvasStream: ",
b);var d=Object(e.f)({type:"media-access-denied",msg:b});c.dispatchEvent(d);k.a.error("stream-event",p.a.event_media_access_denied,{error:b})})):(a["default"].debug("Note!! calling getUserMedia "+JSON.stringify(t)),!q.screen&&c.local&&void 0==q.params&&(q.params={},q.params.config=JSON.parse(JSON.stringify(t)),q.params.set=JSON.parse(JSON.stringify(t))),c.state="initing",f(t,function(b,f){f?(c.ifScreen(),a["default"].error("Error! local media access Failed - share: "+c.ifScreen()+" Err : "+JSON.stringify(f)),
c.dispatchEvent(Object(e.f)({type:"media-access-denied",msg:f})),k.a.error("stream-event",p.a.event_media_access_denied,{error:f})):(void 0==q.params&&(q.params={set:{},config:{}}),a["default"].info("Note!!!!! User has granted access to local media."),k.a.info("stream-event",p.a.event_media_access_success,{error:{}}),c.stream=b,c.stream.getTracks().forEach(function(f,g){"video"===f.kind?(c.videoStream=b,c.inputMediaSource.video.self=b,a["default"].info(" GUM success vidtrack muted : "+f.muted+" state: "+
f.readyState+" enabled: "+f.enabled),"object"!==typeof q.video&&(q.video={}),q.video.trackIndex=g,f.getSettings().deviceId&&(q.video.deviceId=f.getSettings().deviceId,q.params.set.video={},q.params.config.video={},q.params.config.video.deviceId="safari"!==d.a.browserEngineCheck()?{exact:q.video.deviceId}:q.video.deviceId,q.params.config.video.groupId=f.getSettings().groupId,q.params.set.video=JSON.parse(JSON.stringify(q.params.config.video))),a["default"].info(" Checking and setting soft video muted : "+
c.config.videoMuted+" firstGumcall: "+c.firstGumCall),c.config.videoMuted&&void 0===c.firstGumCall&&(f.enabled=!1,c.softVideoMuted=!0,a["default"].debug(" soft muted video "))):"audio"===f.kind&&(c.audioStream=b,"object"!==typeof q.audio&&(q.audio={}),q.audio.trackIndex=g,f.getSettings().deviceId&&(q.audio.deviceId=f.getSettings().deviceId,q.params.set.audio={},q.params.config.audio={},q.params.config.audio.deviceId=(d.a.browserEngineCheck(),q.audio.deviceId),q.params.config.audio.groupId=f.getSettings().groupId,
q.params.set.audio=JSON.parse(JSON.stringify(q.params.config.audio))),c.config.audioMuted&&void 0===c.firstGumCall&&(f.enabled=!1,n=!0,c.selfMuteAudio=!0,a["default"].debug(" soft muted aduio")));!c.local||c.ifScreen()||c.ifCanvas()||"mobile"==v.a.browser_info.device_type||"safari"==d.a.browserEngineCheck()||da();a["default"].info("getTracks",f," kind: ",f.kind);f.onended=function(){c.stream.getTracks().forEach(function(a){a.onended=null});var a=Object(e.f)({type:"stream-ended",stream:c,msg:f.kind});
c.dispatchEvent(a)}}),null==c.videoStream&&(c.config.videoMuted=!0),null==c.audioStream&&(c.audio=!1,c.config.audioMuted=!0),!0!==q.audio&&!0!==q.video||(!1!==c.audio||c.ifScreen)&&!1!==c.video||(f={},!1===c.video&&(f.video=c.video),!1===c.audio&&(f.audio=c.audio),f=Object(e.f)({type:"media-access-failed",evntDetails:f}),c.dispatchEvent(f)),c.state="inited",f=Object(e.f)({type:"media-access-allowed",stream:c}),c.dispatchEvent(f),k.a.info("stream-event",p.a.event_media_access_success,{error:{}}));
c.fistGumCall=!0}))}else b=Object(e.f)({type:"media-access-allowed"}),c.dispatchEvent(b),k.a.info("stream-event",p.a.event_media_access_success,{error:{}})}catch(ka){a["default"].error("Error! Failed to get access to local media. Error was "+ka+"."),b=Object(e.f)({type:"media-access-denied",msg:ka}),c.dispatchEvent(b),k.a.error("stream-event",p.a.event_media_access_denied,{error:ka})}};c.initRemoteStream=function(a){if(!c.local){c.stream=a;if(c.ifAudio()||c.audioOnly)c.audioStream=new MediaStream,
c.stream.getAudioTracks().forEach(function(a){c.audioStream.addTrack(a)});c.mediaStream=new MediaStream;c.stream.getTracks().forEach(function(a){c.mediaStream.addTrack(a)})}};c.close=function(){c.local&&(void 0!==c.room&&c.room.unpublish(c),c.hide(),void 0!==c.videoStream&&(c.videoStream.getVideoTracks().forEach(function(a){a.enabled=!1;a.onended=null;a.stop()}),c.videoStream=void 0),void 0!==c.audioStream&&(c.audioStream.getAudioTracks().forEach(function(a){a.onended=null;a.stop()}),c.audioStream=
void 0),c.pc&&void 0!==c.pc.peerConnection&&c.pc.peerConnection.close(),c.stream=void 0,c.state="idle")};c.disableTrack=function(a){c.room.removeTrack(a)};c.attachMediaStream=function(c,b){if(!c)return null;if(c.isWebRtcPlugin)return c.src=b,c;if("video"===c.nodeName.toLowerCase()){a["default"].info("Checked element is video");if(!c.pluginObj&&b){a["default"].info("Plugins and stream validated");var d=document.createElement("object");if(Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,
"ActiveXObject")||"ActiveXObject"in window){a["default"].info("Browser IE validated");var f=document.createElement("param");f.setAttribute("name","windowless");f.setAttribute("value",!0);d.appendChild(f);d.setAttribute("classid","CLSID:7FD49E23-C8D7-4C4F-93A1-F7EACFA1EC53")}else a["default"].info("Other browser got"),d.setAttribute("type","application/webrtc-everywhere");c.pluginObj=d;d.setAttribute("className",c.className);d.setAttribute("innerHTML",c.innerHTML);f=c.getAttribute("width");var g=c.getAttribute("height"),
k=c.getBoundingClientRect();f||(f=k.right-k.left);g||(g=k.bottom-k.top);"getComputedStyle"in window&&(a["default"].info("computing style"),k=window.getComputedStyle(c,null),f||"auto"==k.width||"0px"==k.width||(f=k.width),g||"auto"==k.height||"0px"==k.height||(g=k.height));f?d.setAttribute("width",f):d.setAttribute("autowidth",!0);g?d.setAttribute("height",g):d.setAttribute("autoheight",!0);document.body.appendChild(d);c.parentNode&&(a["default"].info("parent node found"),c.parentNode.replaceChild(d,
c),document.body.appendChild(c),c.style.visibility="hidden")}c.pluginObj&&(a["default"].info("plugin object found"),c.pluginObj.bindEventListener("play",function(a){c.pluginObj&&(c.pluginObj.getAttribute("autowidth")&&a.videoWidth&&c.pluginObj.setAttribute("width",a.videoWidth),c.pluginObj.getAttribute("autoheight")&&a.videoHeight&&c.pluginObj.setAttribute("height",a.videoHeight))}),c.pluginObj.src=b);return c.pluginObj}if("audio"===c.nodeName.toLowerCase())return c};var ha=1,f=function(d,g,e){e=
void 0===e?!0:e;var m=JSON.parse(JSON.stringify(d));a["default"].info("getusermedia called  opt "+JSON.stringify(m));(d=c.Connection.getSupportedDeviceConstraints())&&m.video&&"object"==typeof m.video&&("mobile"==v.a.browser_info.device_type?(d.hasOwnProperty("facingMode")&&m.video.facingMode?m.video.deviceId&&delete m.video.deviceId:(d.hasOwnProperty("deviceId")&&m.video.deviceId||m.video.deviceId&&delete m.video.deviceId,m.video.facingMode&&delete m.video.facingMode),m.video.height&&delete m.video.height,
m.video.width&&delete m.video.width):d.hasOwnProperty("deviceId")&&m.video.deviceId?m.video.facingMode&&delete m.video.facingMode:d.hasOwnProperty("facingMode")&&m.video.facingMode?m.video.deviceId&&delete m.video.deviceId:(m.video.deviceId&&delete m.video.deviceId,m.video.facingMode&&delete m.video.facingMode),d.hasOwnProperty("frameRate")||void 0==m.video.frameRate||delete m.video.frameRate);a["default"].debug("calling gum with options: "+JSON.stringify(m));c.Connection.GetUserMedia(m,function(c){a["default"].info("getUserMedia success");
k.a.info("stream-event",p.a.event_gum_success,{error:{}});ha=0;g(c)},function(d){a["default"].error("Get User Media screen  failed streamId: ",c.getID()," Error ",d);d=Object(b.a)(d);m.video.height&&m.video.height.min&&m.video.width&&m.video.width.min&&(a["default"].info("getUserMedia failed error: "+d.result+" min Res: "+m.video.height.min+"X"+m.video.width.min),k.a.error("stream-event",p.a.event_gum_failed,{error:d}));var t={};Object.assign(t,m);switch(d.result){case 1143:case 1144:a["default"].error(" ERROR : "+
d.result+" newOpt: "+JSON.stringify(t));t.screen||q.media_order&&"exact"==q.media_order?(a["default"].error("getUserMedia() Failed with device denied/unvailable . no retry "),e=!1):t.video&&t.audio?(a["default"].error("getUserMedia() Failed with device denied/unvailable .. retrying with audio only"),t.video=!1):e=!1;break;case 1147:case 1148:case 1149:switch(t.video.height.min){case 720:t.video.height.min=540;t.video.width.min=960;break;case 540:t.video.height.min=540;t.video.width.min=960;break;
case 480:t.video.height.min=360;t.video.width.min=480;break;default:e=!1}break;case 1145:a["default"].error(" ERROR : "+d.result+" Opt: "+JSON.stringify(t)+" check and retry");break;default:a["default"].error(" ERROR Default : "+d.result+" newOpt: "+JSON.stringify(t)),e=!1}!c.ifScreen()&&!0===e&&5>=ha?(ha+=1,a["default"].info("getUserMedia() failed retry count: "+ha),f(t,g)):(a["default"].error("getUserMedia() failed for screen or no retry allowed  or retry count exceeded: "),ha=0,g(void 0,d))})};
c.setQualityLayers=function(b){c.pc&&c.stream&&c.local&&c.pc.peerConnection&&c.pc.peerConnection.getSenders?(a["default"].info(" that.setQulaityLayers numSpatialLayers:"+b),c.pc.peerConnection.getSenders().forEach(function(c){if(c.track&&"video"===c.track.kind){var d=c.getParameters();if(void 0!=d&&void 0!=d.encodings){for(var f=0;f<d.encodings.length;f++)b>f?(a["default"].info(" Layer :"+f+" enabled"),d.encodings[f].active=!0):(a["default"].info(" Layer :"+f+" disabled"),d.encodings[f].active=!1);
c.setParameters(d)}else a["default"].info(" that.setQulaityLayers: no sender params/encodings-  Not in simulcast mod")}})):a["default"].info("setQulaityLayers Failed invalid stream :"+c.stream+" local: "+c.local)};c.onConnectionStateChanged=function(b){a["default"].debug(" that.onConnectionStateChanged() active : "+b+" ");if(c.local)if(b)if(c.ifCanvas()){if(void 0!==q.refreshFn){q.refreshFn();var d=q.fps>q.maxCanvasRefreshRate?1E3/q.maxCanvasRefreshRate:1E3/q.fps;a["default"].info(" that.onConnectionStateChanged ()  timerVal : "+
d+" spec.fps: "+q.fps);c.refreshTimer=setInterval(function(){a["default"].debug("refresh called timer ");q.refreshFn()},d)}}else c.ifScreen()||(c.negotiatedMedia.video=void 0!=c.videoStream,c.negotiatedMedia.audio=void 0!=c.audioStream,c.video&&c.negotiatedMedia.video&&(0>=c.maxVideoLayers?(M.videoBw.set=M.videoFps.set=0,ja(M.videoBw,M.videoFps)):c.videoStream.getVideoTracks().forEach(function(b){var d=b.getConstraints();d.height.max=c.videoSize[3];d.height.ideal=c.videoSize[3];d.width.max=c.videoSize[2];
d.width.ideal=c.videoSize[2];d.frameRate={max:26};b.applyConstraints(d).then(function(){a["default"].debug("applying constraints for simulcast video success")}).catch(function(c){a["default"].error(" error in applying constraints for simulcast video error: "+c)})})));else c.ifCanvas()&&void 0!=c.refreshTimer&&(clearInterval(c.refreshTimer),c.refreshTimer=void 0);b&&(c.state="connected")};c.setVideoParamsRange=function(b,d,f,g,k){1<c.maxVideoLayers||(k?(void 0!==b&&(M.videoBw.max.server=parseInt(b)),
void 0!==f&&(M.videoFps.max.server=parseInt(f)),void 0!==d&&(M.videoBw.min.server=parseInt(d)),void 0!==g&&(M.videoFps.min.server=parseInt(g))):(void 0!==b&&(M.videoBw.max.user=parseInt(b)),void 0!==f&&(M.videoFps.max.user=parseInt(f)),void 0!==d&&(M.videoBw.min.user=parseInt(d)),void 0!==g&&(M.videoFps.min.user=parseInt(g))),a["default"].debug("setVideoParamsRange() id: "+c.getID()+" :: "+b+": "+d+":"+f+":"+g+":"+k),ja(M.videoBw,M.videoFps))};var ja=function(b,f){var g=0,e=0;g=b.max.user&&b.max.user<
b.min.user?b.min.user:b.max.user&&(!b.max.server||b.max.user<=b.max.server)?b.max.user:b.max.server&&b.max.server<b.min.user?b.min.user:b.max.server&&b.max.server<b.min.server?b.min.server:b.max.server;e=f.max.user<f.min.user?f.min.user:f.max.user&&(!f.max.server||f.max.user<=f.max.server)?f.max.user:f.max.server&&f.max.server<f.min.user?f.min.user:f.max.server&&f.max.server<f.min.server?f.min.server:f.max.server;if(void 0==c.pc||void 0==c.pc.peerConnection||void 0==c.room)a["default"].error("setVideoParams() not set pc/room not defined "+
JSON.stringify(M)+" b2Set: "+g+" fps2Set: "+e);else{if(g&&b.min.server!=g&&b.max.server!=g){var m=[{id:"publisher-video-bw-update",streamId:c.getID(),min:b.min.user,max:b.max.user}];c.room.setAdvancedOptions(m,function(){})}a["default"].debug(" setVideoParams: id: "+c.getID()+" b2Set "+g+" fps2Set "+e+" bwrange: "+JSON.stringify(b));if(g&&b.set!=g||e&&f.set!=e)if(m=d.a.browserEngineCheck(),"chrome-stable"===m||"mozilla"===m&&!d.a.isCurrentVerLess(x.a.constant.FIREFOX_VERSION_SENDER_ENCODINGS_PARAM_SUPPORT)||
"safari"===m&&!d.a.isCurrentVerLess(x.a.constant.SAFARI_VERSION_SENDER_ENCODINGS_PARAM_SUPPORT)){c.pc.peerConnection.getSenders().forEach(function(d){if(d.track&&"video"===d.track.kind){var k=d.getParameters();if(void 0!=k){k.encodings||(k.encodings=[{}]);for(var p=0;p<k.encodings.length;p++)g&&(a["default"].info(" that.setMaxVideoBitarte id: "+c.getID()+" bw: "+g),k.encodings[p].maxBitrate=1E3*g,b.set=g),e&&(a["default"].info(" that.setMaxVideoFramerate id: "+c.getID()+" fps: ",e),k.encodings[p].maxFramerate=
e,f.set=e);d.setParameters(k)}else a["default"].error(" that.setMaxVideoBitarte: no sender params/encodings-  ")}});var q=function(a,c,b,d,f,g,k,e){if(d<b.length){var p=a.getConstraints(),m=!1;c.height&&(c.height.max=b[d].res[f].height,c.height.ideal=b[d].res[f].height,p.height&&p.height.max&&p.height.max==c.height.max||(m=!0));c.width&&(c.width.max=b[d].res[f].width,c.width.ideal=b[d].res[f].width,p.width&&p.width.max&&p.width.max==c.width.max||(m=!0));c.frameRate={max:g};p.frameRate&&p.frameRate.max&&
p.frameRate.max==c.frameRate.max||(m=!0);m?a.applyConstraints(c).then(function(){e(c,k)}).catch(function(p){k.push({res:b[d].res[f],error:p});b[d].res.length<f+1?f++:(d++,f=0,g=30);q(a,c,b,d,f,g,k,e)}):e(c,k)}else e(null,k)};c.ifScreen()||c.ifCanvas()||"safari"===m||c.videoStream.getVideoTracks().forEach(function(d){var f=v.a.getCamResTableToCheck(b.set),g=d.getConstraints();void 0==f?(a["default"].error("reverting kbps: "+b.set+" constraints: curr: "+JSON.stringify(g)+" original: "+c.videoSize[3]+
" X "+c.videoSize[2]),void 0==g.height||void 0==g.width||void 0!=g.height.max&&void 0!=g.width.max&&c.videoSize[3]==g.height.max&&c.videoSize[2]==g.width.max||(g.height.max=c.videoSize[3],g.height.ideal=c.videoSize[3],g.width.max=c.videoSize[2],g.width.ideal=c.videoSize[2],g.frameRate={max:26},d.applyConstraints(g).then(function(){a["default"].info("apply constraints to original value")}).catch(function(c){a["default"].error("failed  - apply constraints to original value")}))):(g.height&&g.width||
(g.width={min:v.a.video_resolution_range.Default.min.width},g.height={min:v.a.video_resolution_range.Default.min.height}),q(d,g,f.resTable,0,0,f.fps,[],function(c,b){a["default"].debug("setVideoQualityConstraints() "+(null!=c?"Succes":"Failure")+" constraints old: "+JSON.stringify(g)+" new: "+JSON.stringify(c)+"  errors: "+JSON.stringify(b))}))})}else a["default"].error("Setting Max Bw  using sdp reneg videoBwKbps= ",videoBwKbps),m={maxVideoBW:g,Sdp:!0},b.set=g,c.pc.updateSpec(m,function(){a["default"].info("that.setMaxVideoBitarte: sdp reneg success")}),
k.a.warn("stream-event",p.a.event_incompatible_browser,{message:"Setting Max Bw  using traditional way of sdp renegotiation videoBwKbps= "+g});else a["default"].debug("setVideoParams Failed id: "+c.getID()+" b2Set "+g+" bwrange: "+JSON.stringify(b))}};c.setVideoQualityParams=function(b,f,g,k,e){c.videoStream.getVideoTracks().forEach(function(c){var p=c.getConstraints();a["default"].info("RESOLUTION Set track before constariants : "+JSON.stringify(p));null!=b&&null!=f&&(void 0==p.width&&(p.width={}),
void 0==p.height&&(p.height={}),p.width.min=b,p.height.min=f);null!=k&&null!=g&&(void 0==p.width&&(p.width={}),void 0==p.height&&(p.height={}),p.height.max=k,p.width.max=g,"chrome-stable"===d.a.browserEngineCheck()&&(p.width.ideal=g,p.height.ideal=k));if(p.width.min&&p.height.min&&p.width.max&&p.height.max&&p.width.min*p.height.min>p.width.max*p.height.max)return a["default"].error("setVideoResolution() : constraint mismatch : "+JSON.stringify(p)),!1;null!=e&&(p.frameRate={max:e});c.applyConstraints(p).then(function(){console.log("RESOLUTION Set track constariants success : "+
JSON.stringify(p))}).catch(function(c){a["default"].error("RESOLUTION Set trac constraints failed: "+c+" constraints: "+JSON.stringify(p))})})};c.switchMicrophone=function(b,d,f,e){e=void 0===e?!0:e;c.negotiatedMedia.audio?0==ca("setMicrophoneTrack")?(k.a.warn("stream-event",p.a.event_general_failed,{message:"switchMicrophone - Previous similar request in process"}),f(g.a.error_1140)):(c.selfMuteAudio||c.hardAudioMuted)&&e?(w.switchMicrophone={newStream:b,deviceInfo:d},I("setMicrophoneTrack"),f({result:0,
msg:"set but not active"})):N(b,d,void 0,!0,function(d){I("setMicrophoneTrack");a["default"].error("setMediaDevicesTrack() in switch mic returned failure : "+JSON.stringify(d)+"device type: "+v.a.browser_info.device_type);if(d.result===g.a.error_1145&&"mobile"==v.a.browser_info.device_type)if(void 0!==c.room)c.room.onMediaDeviceStateChanged(b,{type:"mic",state:"inactive",error:d});else f(d);else f(0===d.result?b:d)}):(k.a.error("stream-event",p.a.event_general_failed,{message:"switchMicrophone - Stream not found"}),
f(g.a.error_1159))};c.switchCamera=function(b,d,f,e,m){f=void 0===f?function(){}:f;e=void 0===e?!0:e;m=void 0===m?!0:m;if("function"===typeof f)if(void 0==c.stream)f(g.a.error_1159);else if(1!==c.stream.getVideoTracks().length)f(g.a.error_1159);else if(c.negotiatedMedia.video)if(0==ca("setCameraTrack"))k.a.warn("stream-event",p.a.event_general_failed,{message:"switchCamera - Previous similar request in process"}),f(g.a.error_1140);else if((c.selfMuteVideo||c.hardVideoMuted)&&!K&&e)w.switchCamera=
{newStream:b,deviceInfo:d},f({result:0,msg:"set but not active"}),I("setCameraTrack");else{var q={};if(void 0!=d){if("string"===typeof d)q.deviceId=d;else if("object"===typeof d){if(c.sendMessage("cameraSwitched",{}),void 0!=d.deviceId&&"string"===typeof d.deviceId&&(q.deviceId=d.deviceId),void 0!=d.facingMode&&"string"===typeof d.facingMode&&(q.facingMode=d.facingMode),void 0==q.deviceId&&void 0==q.facingMode){a["default"].error("Error switchCamera(), error: invalid camera options "+JSON.stringify(d));
k.a.error("stream-event",p.a.event_general_failed,{message:"Error switchCamera(), error: invalid camera options "+JSON.stringify(d)});f(g.a.error_1155);return}}else{a["default"].error("Error switchCamera(), error: invalid camera options type "+JSON.stringify(d));k.a.error("stream-event",p.a.event_general_failed,{message:"Error switchCamera(), error: invalid camera options type "+JSON.stringify(d)});f(g.a.error_1155);I("setCameraTrack");return}c.stream.getVideoTracks().forEach(function(d){d.enabled=
!1;d.stop();d.onended=N(b,void 0,q,m,function(d){var k=!1;b.stream.getVideoTracks().forEach(function(a){k=a.readyState});if(0===d.result)H(c.inputMediaSource.video[c.inputMediaSource.video.selected]),I("setCameraTrack"),f(0===d.result?b:d);else if(1150===d.result)"live"==k&&(H(c.inputMediaSource.video[c.inputMediaSource.video.selected]),I("setCameraTrack"),f(b));else if(I("setCameraTrack"),a["default"].error("setMediaDevicesTrack() switch cam returned failure : "+JSON.stringify(d)+"device type: "+
v.a.browser_info.device_type),d.result===g.a.error_1145&&"mobile"==v.a.browser_info.device_type)if(void 0!==c.room)c.room.onMediaDeviceStateChanged(b,{type:"cam",state:"inactive",error:d});else f(d);else I("setCameraTrack"),f(d)})})}else a["default"].error("Error switchCamera(), error: camera options undefined"),k.a.error("stream-event",p.a.event_general_failed,{message:"Error switchCamera(), error: camera options undefined"}),f(g.a.error_1155),I("setCameraTrack")}else k.a.error("stream-event",p.a.event_general_failed,
{message:"switchCamera - Stream not found"}),f(g.a.error_1159);else a["default"].error("switchCamera() invalid param - callback")};c.switchMediaDevices=function(b,d,f,e){if(c.negotiatedMedia.audio&&c.negotiatedMedia.video){if(void 0!==f){if(c.selfMuteVideo||c.hardVideoMuted){k.a.warn("stream-event",p.a.event_general_failed,{message:"switchMediaDevices - Media device switching not allowed in video mute state"});e(g.a.error_1189);return}if(0==ca("setCameraTrack")){k.a.warn("stream-event",p.a.event_general_failed,
{message:"switchMediaDevices - Previous similar request in process"});e(g.a.error_1140);return}}if(void 0!==d){if(c.selfMuteAudio||c.hardAudioMuted){k.a.warn("stream-event",p.a.event_general_failed,{message:"switchMediaDevices - Media device switching not allowed in audio mute state"});e(g.a.error_1189);void 0!==f&&I("setCameraTrack");return}if(0==ca("setMicrophoneTrack")){void 0!==f&&I("setCameraTrack");e(g.a.error_1140);k.a.warn("stream-event",p.a.event_general_failed,{message:"switchMediaDevices - Previous similar request in process"});
return}}var m={};if(void 0!=f)if("string"===typeof f)m.deviceId=f;else if("object"===typeof f){if(void 0!=f.deviceId&&"string"===typeof f.deviceId&&(m.deviceId=f.deviceId),void 0!=f.facingMode&&"string"===typeof f.facingMode&&(m.facingMode=f.facingMode),void 0==m.deviceId&&void 0==m.facingMode){a["default"].error("Error switchMediaDevices(), error: invalid camera options "+JSON.stringify(f));k.a.error("stream-event",p.a.event_general_failed,{message:"Error switchMediaDevices(), error: invalid camera options "+
JSON.stringify(f)});e(g.a.error_1155);return}}else{a["default"].error("Error switchMediaDevices(), error: invalid camera options type "+JSON.stringify(f));k.a.error("stream-event",p.a.event_general_failed,{message:"Error switchMediaDevices(), error: invalid camera options type "+JSON.stringify(f)});e(g.a.error_1155);return}else m=void 0;void 0==c.stream?(e(g.a.error_1159),I("setCameraTrack")):c.stream.getVideoTracks().forEach(function(a){a.stop();a.onended=N(b,d,m,!0,function(a){var d=!1;b.stream.getVideoTracks().forEach(function(a){d=
a.readyState});if(0===a.result)H(c.inputMediaSource.video[c.inputMediaSource.video.selected]),I("setCameraTrack"),I("setMicrophoneTrack"),e(0===a.result?b:a);else if(1150===a.result)H(c.inputMediaSource.video[c.inputMediaSource.video.selected]),e(b),"live"==d?(H(c.inputMediaSource.video[c.inputMediaSource.video.selected]),I("setCameraTrack"),I("setMicrophoneTrack"),e(b)):(I("setCameraTrack"),I("setMicrophoneTrack"),e(a));else if(I("setCameraTrack"),I("setMicrophoneTrack"),console.log("setMediaDevicesTrack() switch media dev  failure : "+
JSON.stringify(a)+"device type: "+v.a.browser_info.device_type),a.result===g.a.error_1145&&"mobile"==v.a.browser_info.device_type)if(void 0!==c.room)c.room.onMediaDeviceStateChanged(b,{type:"mic",state:"inactive",error:a});else e(a);else e(a)})})}else k.a.error("stream-event",p.a.event_general_failed,{message:"switchMediaDevices - Stream not found"}),e(g.a.error_1159)};c.setSpeaker=function(a,b){var d=c.getPlayerId();void 0!==document.querySelector("#"+d.stream)&&null!==document.querySelector("#"+
d.stream)&&document.querySelectorAll("#"+d.stream).forEach(function(c){"function"===typeof c.setSinkId&&void 0!=a&&c.setSinkId(a);void 0!=b&&(c.volume=b)})};var ca=function(b){if(!c.transactions.get(b))return c.transactions.set(b,{state:"inprogress"}),!0;a["default"].error("Invalid state: previous request in progress. transId: "+b);k.a.warn("stream-event",p.a.event_general_failed,{message:"setTrasactionIfNotExists - Invalid state: previous request in progress. transId: "+b});return!1},I=function(a){return c.transactions.delete(a)},
N=function(b,d,e,m,t){var v=new MediaStream;if(!b||!0!==b.local||b.ifScreen()||b.ifCanvas())a["default"].info("Cannot switch devices over invalid stream"),k.a.error("stream-event",p.a.event_general_failed,{message:"setMediaDevicesTrack - Cannot switch devices over invalid stream"}),t(g.a.error_1155);else{var l={};l.audio=void 0!==d?"none"!==d?{deviceId:d}:!0:!1;void 0!==e?(l.video={},ba(l.video),void 0!=e.deviceId&&"none"!==e.deviceId&&(l.video={deviceId:{exact:e.deviceId}}),void 0!=e.facingMode&&
(l.video={facingMode:{exact:e.facingMode}}),void 0!==c.videoFrameRate&&(l.video.frameRate={min:c.videoFrameRate[0],max:c.videoFrameRate[1]})):l.video=!1;f(l,function(f,x){void 0==x?(b.pc&&b.pc.peerConnection&&m&&(e?(x="user"===c.inputMediaSource.video.selected?c.inputMediaSource.video.user:f,c.inputMediaSource.video.self=f):x=f,O(b,void 0!==d,void 0!==e,x,"self"==c.inputMediaSource.video.selected)),e?(b.videoStream=f,q.params.set.video&&"object"==typeof q.params.set.video||(q.params.set.video={}),
c.inputMediaSource.video.self=f,f.getVideoTracks().forEach(function(a,c){v.addTrack(a);q.params.set.video.groupId=a.getSettings().groupId}),void 0!=e.deviceId?"none"!==e.deviceId&&(q.video.deviceId=e.deviceId,q.params.set.video.deviceId=JSON.parse(JSON.stringify(l.video.deviceId))):f.getVideoTracks().forEach(function(a,c){void 0!=a.getSettings().deviceId&&(q.video.deviceId=a.getSettings().deviceId);v.addTrack(a)}),a["default"].log("Got video access from devices:- ",q.video.deviceId),k.a.info("stream-event",
p.a.event_gum_success,{message:"Got video access from devices:- "+q.video.deviceId})):b.videoStream&&b.videoStream.getVideoTracks().forEach(function(a,c){v.addTrack(a)}),d?(b.audioStream=f,f.getAudioTracks().forEach(function(a,c){v.addTrack(a);q.params.set.audio.groupId=a.getSettings().groupId}),"none"!==d&&(q.audio&&(q.audio.deviceId=d),q.params.set.audio.deviceId=JSON.parse(JSON.stringify(l.audio.deviceId))),a["default"].log("Got audio access from devices:- ",d),k.a.info("stream-event",p.a.event_gum_success,
{message:"Got audio access from devices:- "+d})):b.audioStream&&b.audioStream.getAudioTracks().forEach(function(a){return v.addTrack(a)}),t(g.a.error_000)):(f=e?e.deviceId:"null",a["default"].info("Error getUserMedia(), error: "+x+" cam: "+f+" mic: ",d),k.a.error("stream-event",p.a.event_gum_failed,{cam_id:f,mic_id:d}),t(x));b.stream=v})}},O=function(c,b,d,f,g,e){g=void 0===g?!0:g;e=void 0===e?!0:e;var m=!1,t=!1;c.pc&&c.pc.peerConnection?c.pc.peerConnection.getSenders().forEach(function(a,k){a.track&&
(d&&"video"===a.track.kind?("object"!==typeof q.video&&(q.video={}),q.video.trackIndex=k,t=!0,f?f.getVideoTracks().forEach(function(c){c.enabled=!0;a.replaceTrack(c)}):a.replaceTrack(null),g&&c.videoStream.getVideoTracks().forEach(function(a){a.enabled=!1;a.onended=null;a.stop()})):b&&"audio"===a.track.kind&&(q.audio.trackIndex=k,m=!0,f?f.getAudioTracks().forEach(function(c){c.enabled=!0;a.replaceTrack(c)}):a.replaceTrack(null),e&&c.audioStream&&c.audioStream.getAudioTracks().forEach(function(a){a.enabled=
!1;a.onended=null;a.stop()})))}):(d&&c.videoStream&&g&&c.videoStream.getVideoTracks().forEach(function(a){console.log("without replace track setting current videotracks to stop");a.enabled=!1;a.onended=null;a.stop()}),b&&c.audioStream&&e&&c.audioStream.getAudioTracks().forEach(function(a){a.enabled=!1;a.onended=null;a.stop()}));c.pc&&c.pc.peerConnection&&(b&&!m||d&&!t)&&(c.pc.peerConnection.getSenders().forEach(function(a,c){!a.track&&f&&(b&&!m&&void 0!==q.audio.trackIndex&&c===q.audio.trackIndex&&
(m=!0,f.getAudioTracks().forEach(function(c){c.enabled=!0;a.replaceTrack(c)})),d&&!t&&void 0!==q.video.trackIndex&&c===q.video.trackIndex&&(t=!0,f.getVideoTracks().forEach(function(c){c.enabled=!0;a.replaceTrack(c)})))}),b&&!m||d&&!t)&&(a["default"].error("Error: Not finding sender track::  audio: "+b+" found: "+m+" index: "+q.audio.trackIndex+" video: "+d+" found: "+t+" index: "+q.video.trackIndex),k.a.error("stream-event",p.a.event_general_failed,{message:"replaceNewMediaStreamTrack - Not finding sender track::  audio: "+
b+" found: "+m+" index: "+q.audio.trackIndex+" video: "+d+" found: "+t+" index: "+q.video.trackIndex}),c.pc.peerConnection.getSenders().forEach(function(c,b){a["default"].error("index : "+b+" sender.track: "+c.track+" kind : "+(c.track?c.track.kind:"none"))}))},U=function(a,c,b){return a&&(r==c||"none"==r)&&("video"==B||"audiovideo"==B||y&&!b)};c.getPlayerId=function(a){a=void 0===a?null:a;var b=c.getID();a=a?a:c.room;a="breakout-room"===(a&&a.roomSettings&&a.roomSettings.room_type?a.roomSettings.room_type:
null)?"br_"+a.roomID+"_":"";return{stream:a+"stream"+b,player:a+"player_"+b}};c.reloadPlayer=function(b,f){var g=b.mediatype,k=b.clientId;if(B!=g||y||f&&"none"!=F&&F!=b.reason){a["default"].debug("reloadPlayer() streamId: "+c.getID()+" mediatype:( "+g+" , "+B+" ), clientId:( "+k+" , "+r+" ), reason:( "+b.reason+" , "+F+" )  imageOnVideoMute: "+f);c.getID();var e=c.getPlayerId();if(void 0!==document.querySelector("#"+e.stream)&&null!==document.querySelector("#"+e.stream)){var p=!1;document.querySelectorAll("#"+
e.stream).forEach(function(e){try{switch(g){case "audio":if(F=b.reason,U(f,k,"user"==b.reason)){c.mediaStream&&0==c.mediaStream.getAudioTracks().length&&c.stream.getAudioTracks().forEach(function(a){c.mediaStream.addTrack(a)});p=y=!0;n=!1;z=!0;break}case "audioOnly":c.audioStream?(e.srcObject=c.audioStream,y=!1,p=!0,n=!1,z=!0):a["default"].error("reloadPlayer() failed id : "+c.getID()+" audiostream null medtype - curr: "+(B+" new: "+g));break;case "video":c.mediaStream?("audiovideo"==B?(0==c.mediaStream.getVideoTracks().length&&
c.stream.getVideoTracks().forEach(function(a){c.mediaStream.addTrack(a)}),0!=c.mediaStream.getAudioTracks().length&&c.mediaStream.getAudioTracks().forEach(function(a){c.mediaStream.removeTrack(a)})):e.srcObject=c.mediaStream,y=!1,F="none",n=p=!0,z=!1):a["default"].error("reloadPlayer() failed id : "+c.getID()+" videostream null, medtype - curr: "+B+" new: "+g);break;case "audiovideo":if(c.mediaStream){0==c.mediaStream.getAudioTracks().length&&c.stream.getAudioTracks().forEach(function(a){c.mediaStream.addTrack(a)});
0==c.mediaStream.getVideoTracks().length&&c.stream.getVideoTracks().forEach(function(a){c.mediaStream.addTrack(a)});if("video"!=B||"safari"===d.a.browserEngineCheck())e.srcObject=c.mediaStream;y=!1;F="none";p=!0;n=z=!1}else a["default"].error("reloadPlayer() failed id : "+c.getID()+" stream null, medtype - curr: "+B+" new: "+g);break;default:F=b.reason,n=z=!0,U(f,k,"user"==b.reason)?y=!0:(e.srcObject=null,y=!1),p=!0}}catch(va){a["default"].error("reloadPlayer() id : "+c.getID()+" NULL set medtype - curr: "+
B+" new: "+g)}});p&&(B=g,r=k)}else a["default"].error("reloadPlayer() id : "+c.getID()+" ID selector null medtype - curr: "+B+" new: "+g+" storing AT req")}else{a["default"].debug("reloadPlayer() id : "+c.getID()+" no change in media type: "+g);if("none"===r)switch(B){case "audio":case "audioOnly":n=!1;z=!0;break;case "video":n=!0;z=!1;break;case "audiovideo":n=z=!1;break;default:n=z=!0}r=k}S={talkerInfo:JSON.parse(JSON.stringify(b)),imageOnVideoMute:f}};c.setBandwidthAlert=function(a){c.getID();
c.player&&!0===c.abwdEnabled&&("low"===a.bw?"sdk"===c.abwdNotification?c.player.setBwAlert(!0,a.type,a.name):(a=Object(e.f)({type:"bw-alert",stream:c,stream_type:a.type,msg:"subscriber"===a.type?"subscriber low":a.name+" publisher low"}),c.dispatchEvent(a)):"sdk"===c.abwdNotification?c.player.setBwAlert(!1):(a=Object(e.f)({type:"bw-restored",stream:c}),c.dispatchEvent(a)))};c.setVideoMutedMessage=function(a){null!=c.player&&(!0===a.videomuted&&"bw"===a.reason?(c.videoMutedDueToBw=!0,c.player.setVideoMutedMsg(a)):
!0===c.videoMutedDueToBw&&c.player.setVideoMutedMsg(a))};var H=function(b){for(var d=0;d<c.playerDivs.length;d++){var f=document.getElementById(c.playerDivs[d].elementId);f&&(f=f.querySelectorAll("video"),0<f.length&&document.querySelectorAll("#"+f[0].id).forEach(function(d){try{d.srcObject=b}catch(ka){a["default"].error("Exception:: attachStreamOnPlayerDivs() streamId: "+c.getID()+" error: "+ka)}}))}};c.muteSubscriberStreamVideo=function(a){c.stream&&!c.local&&c.stream.getVideoTracks().forEach(function(c){c.enabled=
!a})};c.updateVideo=function(b){b=c.getPlayerId();void 0!==document.querySelector("#"+b.stream)&&null!==document.querySelector("#"+b.stream)?(a["default"].info("Player element exists and playing the video",""+b.stream),c.htmlPlay(""+b.stream)):a["default"].error("Player element does not exist")};c.play=function(b,f){if("object"===typeof f&&f.hasOwnProperty("player")){a["default"].debug("Element ID is "+b);var g=f||{};c.elementID=b;f.player&&f.player.abwd&&(void 0!==f.player.abwd.enabled&&(c.abwdEnabled=
f.player.abwd.enabled),!0===c.abwdEnabled&&f.player.abwd.notification&&(c.abwdNotification=f.player.abwd.notification,"sdk"===c.abwdNotification&&void 0!==f.player.abwd.language&&(c.abwdLanguage="en"===f.player.abwd.language||"zh"===f.player.abwd.language?f.player.abwd.language:"en")));if(c.ifVideo()||c.ifScreen()||c.audioOnly||c.ifAudio())if(void 0!==b&&null!==document.getElementById(b)){if("IE"===d.a.browserEngineCheck()){g=document.getElementById(b);var k=document.getElementById(b);"VIDEO"!==g.nodeName&&
(a["default"].info("not video tag"),k=document.createElement("video"),k.setAttribute("height",g.getAttribute("height")),k.setAttribute("width",g.getAttribute("width")),g.appendChild(k));c.attachMediaStream(k,c.stream)}else k={autoplay:!0},"safari"===d.a.browserEngineCheck()&&(k.playsinline=!0),g=Object(m.a)({id:c.getID(),stream:c,elementID:b,options:g,extraPlayerOptions:k,vroom:c.room?c.room:null,videoSource:c.local?c.inputMediaSource.video[c.inputMediaSource.video.selected]:c.stream}),c.local?g.video.muted=
!0:c.playerDivs=[],c.player=g,c.showing=!0;c.playerDivs.push({elementId:b,options:f});B="audiovideo";void 0!==S&&(a["default"].debug("stream.play currentActiveTalkerList : calling reload player()"),c.reloadPlayer(S.talkerInfo,S.imageOnVideoMute));c.local||void 0==c.room||void 0==c.room.speakerInfo.id&&1==c.room.speakerInfo.volume||c.setSpeaker(c.room.speakerInfo.id,c.room.speakerInfo.volume)}else a["default"].error("Element not found");else if(c.ifAudio()||c.audioOnly)g=Object(u.a)({id:c.getID(),
stream:c,elementID:b,options:g,vroom:c.room?c.room:null}),c.local?g.audio.muted=!0:c.playerDivs=[],c.player=g,c.showing=!0,c.playerDivs.push({elementId:b,options:f}),B="audio";c.reload&&delete c.reload;void 0!==c.room?!0===c.room.subscribeSessionStats?c.ShowSessionStats(!0):c.ShowSessionStats(!1):a["default"].info("room is not allocated to stream , stats UI will not be shown")}else a["default"].error("play() invalid param - callback/RoomDefinition")};c.resetMediaConfiguration=function(a){c.pc.resetSDP(a)};
c.htmlPlay=function(b,d){c.elementID=b;(c.ifVideo()||c.ifScreen())&&void 0!==b&&document.querySelectorAll("#"+b).forEach(function(b){try{b.srcObject=c.local?c.videoStream:c.stream}catch(Aa){b.src=URL.createObjectURL(c.local?c.videoStream:c.stream)}b.play().then(function(){}).catch(function(c){a["default"].error("Error playing video stream: "+c)})})};c.stop=function(a){if(c.showing){if(void 0!=a&&(c.playerDivs=c.playerDivs.filter(function(c){return c.elementId!=a}),!c.playerDivs.length))return;void 0!==
c.player&&(c.player.destroy(),c.showing=!1)}};c.show=c.play;c.hide=c.stop;var ia=function(a){if(void 0!==c.player&&void 0!==c.stream){var b=document.defaultView.getComputedStyle(c.player.video),d=parseInt(b.getPropertyValue("width"),10),f=parseInt(b.getPropertyValue("height"),10);parseInt(b.getPropertyValue("left"),10);parseInt(b.getPropertyValue("top"),10);b="object"===typeof c.elementID&&"function"===typeof c.elementID.appendChild?c.elementID:document.getElementById(c.elementID);var g=document.defaultView.getComputedStyle(b);
b=parseInt(g.getPropertyValue("width"),10);g=parseInt(g.getPropertyValue("height"),10);if(document.getElementById(a))var k=document.getElementById(a);else k=document.createElement("canvas"),k.id=a,k.width=b,k.height=g,k.className="canvas_input",k.setAttribute("style","position: absolute;top: 15%;left: 45%;z-index: 897;"),document.body.appendChild(k);c.inputContext=k.getContext("2d");c.inputContext.drawImage(c.player.video,0,0,d,f);return k}return null};c.getVideoFrameURL=function(a){var c=ia();return null!==
c?a?c.toDataURL.apply(c,$jscomp.arrayFromIterable(a)):c.toDataURL():null};c.getVideoFrameImage=function(a){a=ia(a);return null!==a?a.getContext("2d").getImageData(10,10,a.width,a.height):null};c.checkOptions=function(b,d){if(!0===d){if(b.audio||b.screen)a["default"].warning("Error! Cannot update type of subscription"),b.audio=void 0,b.screen=void 0}else!1===c.local&&(!0===b.video&&!1===c.ifVideo()&&(a["default"].warning("Error! Stream doesn't have Video Track. Can't subscribe to Video"),b.video=!1),
!0===b.audio&&!1===c.ifAudio()&&(a["default"].warning("Error! Stream doesn't have Audio Track. Can't subscribe to Audio"),b.audio=!1));!1!==c.local||c.ifVideo()||!0!==b.slideShowMode||(a["default"].warning("Error! Stream doesn't have Video Track. Cannot enable slideShowMode. Check parameters"),b.slideShowMode=!1)};var ea=function(b,f,e){e=void 0===e?function(){}:e;console.log("Muting the stream : enable "+b);if(c.negotiatedMedia.audio)if(b===n)k.a.error("stream-event",p.a.event_general_failed,{message:"muteStreamAudio - MediaDevice state is already in same state"}),
e(g.a.error_1177);else if(0==ca("setMicrophoneTrack"))k.a.error("stream-event",p.a.event_general_failed,{message:"muteStreamAudio - Previous similar request in process"}),e(g.a.error_1140);else{var m=function(b,f){try{var e=!1;if("safari"===d.a.browserEngineCheck()){var m=c.pc.peerConnection.getSenders().find(function(a){return a.track&&"audio"===a.track.kind||null===a.track});m&&c.audioStream.getAudioTracks().forEach(function(a){a.enabled=!b;b||"live"==a.readyState?m.replaceTrack(b?null:c.audioStream.getAudioTracks()[0]):
(console.log(" setAudioTrack(): safari trackstate: ended"),e=!0)})}else c.audioStream.getAudioTracks().forEach(function(a){a.enabled=!b;e||"ended"!=a.readyState||(e=!0);console.log(" setAudioTrack(): trackstate: ended")});n=b;I("setMicrophoneTrack");void 0!=c.selectedMicId&&console.log("that.selectedMicId: "+c.selectedMicId);if(!b&&e){var t=void 0!=c.selectedMicId?c.selectedMicId:q.audio.deviceId;t?N(c,t,void 0,!0,function(a){console.log("setMediaDevicesTrack : audio  status: "+a);a.result===g.a.error_000.result&&
("safari"===d.a.browserEngineCheck()&&(c.pc.peerConnection.getSenders().find(function(a){return a.track&&"audio"===a.track.kind||null===a.track}).replaceTrack(c.audioStream.getAudioTracks()[0]),n=b),f(a))}):(k.a.error("stream-event",p.a.event_general_failed,{message:"muteStreamAudio - error - stream ended"}),f(g.a.error_1191))}else n=b,k.a.info("stream-event",p.a.event_general_success,{message:"muteStreamAudio - success"}),f(g.a.error_000)}catch(sa){a["default"].error("Excpetion happend : "+sa),I("setMicrophoneTrack"),
k.a.error("stream-event",p.a.event_general_failed,{message:"muteStreamAudio - error - "+sa}),f(g.a.error_1150)}};f?setTimeout(m,f,b,e):m(b,e)}else k.a.error("stream-event",p.a.event_general_failed,{message:"muteStreamAudio - Stream not found"}),e(g.a.error_1159)},A=function(a,b,d,f){f=void 0===f?function(){}:f;!a||c.negotiatedMedia.video||d?a!==z||d?0==ca("setCameraTrack")?f(g.a.error_1140):(console.log("muteSTreamVideo() enable: "+a+" localVideoOn: "+K),d=function(a,b){try{if(a)O(c,!1,!0,null,!K),
z=a,I("setCameraTrack"),b(g.a.error_000);else if(K)z=a,c.pc&&c.pc.peerConnection&&O(c,!1,!0,c.videoStream,!1),I("setCameraTrack"),b(g.a.error_000);else{var d={};void 0!=q.video.deviceId?d.deviceId=q.video.deviceId:void 0!==q.video.facingMode&&"mobile"==v.a.browser_info.device_type&&(d.facingMode=q.video.facingMode);void 0==d.deviceId&&void 0==d.facingMode&&(d.deviceId="none");N(c,void 0,d,!0,function(c){if(c.result===g.a.error_000.result)z=a;else{var d=v.a.getLocalStorageItem("vcxRTCLib-log");null!=
d&&(d=JSON.parse(d),k.a.error("stream-event",a?p.a.event_mute_self_video_failed:p.a.event_unmute_self_video_failed,{message:d}))}I("setCameraTrack");b(c)})}}catch(va){console.log("Excpetion happend : "+va),I("setCameraTrack"),d=v.a.getLocalStorageItem("vcxRTCLib-log"),null!=d&&(d=JSON.parse(d),k.a.error("stream-event",a?p.a.event_mute_self_video_failed:p.a.event_unmute_self_video_failed,{message:d})),b(g.a.error_1150)}},b?setTimeout(d,b,a,f):d(a,f)):(k.a.error("stream-event",p.a.event_general_failed,
{message:"muteStreamVideo - MediaDevice state is already in same state"}),f(g.a.error_1177)):(k.a.error("stream-event",p.a.event_general_failed,{message:"muteStreamVideo - Stream not found"}),f(g.a.error_1159))};c.muteAudio=function(b,d,f,k,e){b=void 0===b?function(){}:b;d=void 0===d?!0:d;f=void 0===f?0:f;k=void 0===k?!0:k;e=void 0===e?!1:e;"function"===typeof b?(console.log("muteAudio() selfSet : "+k+" selfMuteAudio: "+c.selfMuteAudio+" hardAudioMuted: "+c.hardAudioMuted+" audioMuted: "+n+" paused: "+
c.selfPausedAudio+" config.audioMuted: "+c.config.audioMuted),k&&c.selfMuteAudio||!k&&(c.hardAudioMuted||c.selfPausedAudio)?(!0===e&&(c.selfPausedAudio=!0),d&&c.sendEvent("user-audio-muted"),b(g.a.error_1177)):void 0!==c.pc&&null!=c.pc||void 0==c.audioStream?ea(!0,f,function(a){if(a.result===g.a.error_000.result||a.result===g.a.error_1177.result)k?c.selfMuteAudio=!0:e?c.selfPausedAudio=!0:c.hardAudioMuted=!0,a.result===g.a.error_000.result&&d?c.sendEvent("user-audio-muted"):d||(a=g.a.error_000);b(a)}):
(c.audioStream.getAudioTracks().forEach(function(a){a.onended=null;a.enabled=!1}),n=!0,k?(c.selfMuteAudio=!0,c.config.audioMuted=!0):e?c.selfPausedAudio=!0:c.hardAudioMuted=!0,b(g.a.error_000))):a["default"].error("muteAudio() invalid param - callback")};c.setMediaDeviceMuteState=function(a,b,d,f,k){try{if(b){if(a===n){k(g.a.error_1177);return}c.audioStream.getAudioTracks().forEach(function(c){c.enabled=!a});n=a;f&&c.sendEvent(n?"user-audio-muted":"user-audio-unmuted")}if(d){if(a===z){k(g.a.error_1177);
return}c.stream.getVideoTracks().forEach(function(c){c.enabled=!a});z=a;f&&c.sendEvent(z?"user-video-muted":"user-video-unmuted")}k(g.a.error_000)}catch(ra){console.log("Excpetion happend : "+ra),k(g.a.error_1150)}};c.muteAudioNotSelf=function(a,b){ea(!0,0,void 0===a?function(){}:a);void 0!==b&&!1===b||c.sendEvent("user-audio-muted")};var Z=function(a){a.data&&0<a.data.size&&c.recordedBlobs.push(a.data)};c.startLocalRecord=function(b){b=void 0===b?function(){}:b;if(c.mediaRecorder)a["default"].error("Recording started already:"),
b(g.a.error_1174);else try{c.mediaRecorder=new MediaRecorder(c.stream,{mimeType:"video/webm"}),c.mediaRecorder.ondataavailable=Z,c.recordedBlobs=[],c.mediaRecorder.start(10),b(g.a.error_000)}catch(fa){a["default"].error("Exception while creating MediaRecorder:",fa),b(g.a.error_000)}};c.stopLocalRecord=function(a){a=void 0===a?function(){}:a;if(c.mediaRecorder&&0<c.recordedBlobs.length){var b=new Date,d=b.getFullYear()+"-"+(b.getMonth()+1)+"-"+b.getDate();b=b.getHours()+":"+b.getMinutes()+":"+b.getSeconds();
d="stream_"+c.getID()+"_"+d+"::"+b+".webm";b=new Blob(c.recordedBlobs,{type:"video/webm"});b=window.URL.createObjectURL(b);var f=document.createElement("a");f.style.display="none";f.href=b;f.download=d;f.click();window.URL.revokeObjectURL(b);a(g.a.error_000)}else a(g.a.error_1175);c.mediaRecorder=void 0;c.recordedBlobs=[]};c.sendEvent=function(a){c.room&&c.room.socket.sendEvent(a,function(a){})};c.sendMessage=function(a,b,d){d=void 0===d?function(){}:d;c.room&&c.room.socket.emitEvent(a,b,function(a){d(a)})};
c.unmuteAudio=function(b,d,f,k,e){b=void 0===b?function(){}:b;d=void 0===d?!0:d;f=void 0===f?0:f;k=void 0===k?!0:k;e=void 0===e?!1:e;if("function"===typeof b)if(console.log("unmuteAudio() selfSet : "+k+" selfMuteAudio: "+c.selfMuteAudio+" hardAudioMuted: "+c.hardAudioMuted+" audioMuted: "+n+" paused: "+c.selfPausedAudio+" config.audioMuted: "+c.config.audioMuted),(!k||c.selfMuteAudio||c.hardAudioMuted||c.selfPausedAudio)&&(k||c.hardAudioMuted||c.selfPausedAudio))if(!k||!c.hardAudioMuted||!c.selfPausedAudio||
c.room&&c.room.isModerator())if(!k&&c.selfMuteAudio)c.hardAudioMuted=!1,e&&(c.selfPausedAudio=!1),b(g.a.error_000);else if(void 0!=w.switchMicrophone){var p=w.switchMicrophone;c.switchMicrophone(p.newStream,p.deviceInfo,function(a){delete w.switchMicrophone;void 0==a.result?b(g.a.error_000):c.unmuteAudio(b,d,f,k,e)},!1)}else void 0!==c.pc&&null!=c.pc||void 0==c.audioStream?ea(!1,f,function(a){if(a.result===g.a.error_000.result||a.result===g.a.error_1177.result)k?c.selfMuteAudio=!1:e?c.selfPausedAudio=
!1:c.hardAudioMuted=!1,a.result===g.a.error_000.result&&d?c.sendEvent("user-audio-unmuted"):d||(a=g.a.error_000);b(a)}):(c.audioStream.getAudioTracks().forEach(function(a){a.enabled=!0}),!0===c.config.audioMuted&&(c.config.audioMuted=!1),n=!1,k?c.selfMuteAudio=!1:e?c.selfPausedAudio=!1:c.hardAudioMuted=!1,b(g.a.error_000));else b(g.a.error_1176);else console.log(" that.unmuteAudio() error177: selfSet: "+k+"  that.selfMuteAudio: "+c.selfMuteAudio+" that.hardAudioMuted: "+c.hardAudioMuted+" that.selfPausedAudio: "+
c.selfPausedAudio),!d||c.selfMuteAudio||c.hardAudioMuted||c.sendEvent("user-audio-unmuted"),b(g.a.error_1177);else a["default"].error("unmuteAudio() invalid param - callback")};c.hardMuteAudio=function(a){c.room&&!c.local&&c.sendMessage("hardmute-user-audio",{clientId:c.clientId})};c.hardUnmuteAudio=function(a){c.room&&!c.local&&c.sendMessage("hardunmute-user-audio",{clientId:c.clientId})};c.hardMuteVideo=function(a){c.room&&!c.local&&c.sendMessage("hardmute-user-video",{clientId:c.clientId})};c.hardUnmuteVideo=
function(a){c.room&&!c.local&&c.sendMessage("hardunmute-user-video",{clientId:c.clientId})};c.muteNonATPubVideo=function(a){c.videoStream&&(c.ATVideoMuted=!0,c.videoStream.getVideoTracks().forEach(function(a){a.enabled=!1}))};c.unmuteNonATPubVideo=function(a){c.videoStream&&!1===c.hardAudioMuted&&!1===c.selfMuteVideo&&!0===c.ATVideoMuted&&(c.ATVideoMuted=!1,c.videoStream.getVideoTracks().forEach(function(a){a.enabled=!0}))};c.muteVideo=function(b,d,f,k,e,p,m){b=void 0===b?function(){}:b;d=void 0===
d?!0:d;f=void 0===f?0:f;k=void 0===k?!0:k;e=void 0===e?!1:e;p=void 0===p?!1:p;m=void 0===m?!1:m;"function"===typeof b?(console.log("SelfSet:"+k+"selfMuteVideo"+c.selfMuteVideo+"selfPausedVideo:"+c.selfPausedVideo),k&&c.selfMuteVideo||!k&&(c.hardVideoMuted||c.selfPausedVideo)?(p&&(c.selfPausedVideo=!0),d&&c.sendEvent("user-video-muted"),b(g.a.error_1177)):void 0!==c.pc&&null!=c.pc||void 0==c.room||void 0==c.videoStream?e?(K||c.videoStream.getVideoTracks().forEach(function(a){a.enabled=!1}),c.softVideoMuted=
!0,b(g.a.error_000)):A(!0,f,m,function(a){if(a.result===g.a.error_000.result||a.result===g.a.error_1177.result)k?c.selfMuteVideo=!0:p?c.selfPausedVideo=!0:c.hardVideoMuted=!0,a.result===g.a.error_000.result?(K||H(null),d&&c.sendEvent("user-video-muted")):a=g.a.error_000;b(a)}):(K||c.videoStream.getVideoTracks().forEach(function(a){a.onended=null;a.enabled=!1}),z=c.config.videoMuted=!0,k?c.selfMuteVideo=!0:p?c.selfPausedVideo=!0:c.hardVideoMuted=!0,b(g.a.error_000))):a["default"].error("muteVideo() invalid param - callback")};
c.unmuteVideo=function(b,d,f,k,e,p){b=void 0===b?function(){}:b;d=void 0===d?!0:d;f=void 0===f?0:f;k=void 0===k?!0:k;e=void 0===e?!1:e;p=void 0===p?!1:p;if("function"===typeof b)if(console.log("unmuteVideo() selfSet : "+k+" that.selfMuteVideo: "+c.selfMuteVideo+" that.softVideoMuted: "+c.softVideoMuted+" that.hardVideoMuted: "+c.hardVideoMuted+" paused: "+c.selfPausedAudio),p||(!k||c.selfMuteVideo||c.softVideoMuted||c.hardVideoMuted||c.selfPausedVideo)&&(k||c.hardVideoMuted||c.selfPausedVideo))if(!k||
!c.hardVideoMuted||!c.selfPausedVideo||c.room&&c.room.isModerator())if(!k&&c.selfMuteVideo)c.hardVideoMuted=!1,e&&(c.selfPausedVideo=!1),b(g.a.error_000);else if(void 0!=w.switchCamera){var m=w.switchCamera;c.switchCamera(m.newStream,m.deviceInfo,function(a){delete w.switchCamera;void 0==a.result?(z=c.softVideoMuted=!1,k?c.selfMuteVideo=!1:e?c.selfPausedVideo=!1:c.hardVideoMuted=!1,console.log("unmuteVideo() switchCamera () NOT attaching playerdivs"),d&&c.sendEvent("user-video-unmuted"),b(g.a.error_000)):
c.unmuteVideo(b,d,f,k,e)},!1,!0)}else void 0!==c.pc&&null!=c.pc||!c.room||void 0==c.videoStream?A(!1,f,p,function(a){if(a.result===g.a.error_000.result||a.result===g.a.error_1177.result)if(c.softVideoMuted=!1,k?c.selfMuteVideo=!1:e?c.selfPausedVideo=!1:c.hardVideoMuted=!1,a.result===g.a.error_000.result?(console.log("unmuteVideo() muteStreamVideo() success"),K||H(c.inputMediaSource.video[c.inputMediaSource.video.selected]),d&&c.sendEvent("user-video-unmuted")):a=g.a.error_000,c.room&&!p){c.room.onMediaDeviceStateChanged(c,
{type:"cam",state:"active"},b);return}b(a)}):(c.videoStream.getVideoTracks().forEach(function(a){a.enabled=!0}),!0===c.config.videoMuted&&(c.config.videoMuted=!1),z=c.softVideoMuted=!1,k?c.selfMuteVideo=!1:e?c.selfPausedVideo=!1:c.hardVideoMuted=!1,b(g.a.error_000));else b(g.a.error_1176);else!d||c.selfMuteVideo||c.softVideoMuted||c.hardVideoMuted||c.sendEvent("user-video-unmuted"),b(g.a.error_1177);else a["default"].error("unmuteVideo() invalid param - callback")};c.setLocalView=function(b,d){d=
void 0===d?function(){}:d;if("function"===typeof d)if(K==b)a["default"].error("setLocalVideo() already in same state"),d(g.a.error_1177);else if(0==ca("setCameraTrack"))k.a.warn("stream-event",p.a.event_general_failed,{message:"setLocalVideo - Previous similar camera request in process"}),d(g.a.error_1140);else if(console.log("setLocalView() enable : "+b),b)if(c.isVideoMuted()){var f={};q.params&&q.params.set.video&&"object"===typeof q.params.set.video.deviceId&&(f.deviceId=q.params.set.video.deviceId.exact);
if(void 0!=w.switchCamera){var e=w.switchCamera;c.switchCamera(e.newStream,e.deviceInfo,function(a){delete w.switchCamera;void 0==a.result?K=!0:c.setLocalView(b,d)},!1,!1)}else e=JSON.parse(JSON.stringify(q.video)),q.params&&q.params.set&&q.params.set.video&&(q.params.set.video.deviceId?e.deviceId="object"==typeof q.params.set.video.deviceId?q.params.set.video.deviceId.exact:q.params.set.video.deviceId:q.params.set.video.facingMode&&(e.facingMode="object"==typeof q.params.set.video.facingMode?q.params.set.video.facingMode.exact:
q.params.set.video.facingMode)),void 0!=e.deviceId?f.deviceId=e.deviceId:void 0!==e.facingMode&&"mobile"==v.a.browser_info.device_type&&(f.facingMode=e.facingMode),void 0==f.deviceId&&void 0==f.facingMode&&(f.deviceId="none"),N(c,void 0,f,!1,function(b){b.result===g.a.error_000.result?(console.log("setMediaDevicesTrack() success attaching playerdiv "),K=!0,H(c.inputMediaSource.video[c.inputMediaSource.video.selected])):(console.log("setMediaDevicesTrack() failed "),a["default"].info("Error setMediaDevicesTrack(), error: "+
JSON.stringify(b)+" cam: "+f.deviceId));I("setCameraTrack");d(b,K?c.videoStream:null)})}else c.negotiatedMedia.video&&void 0!=c.videoStream?(K=!0,I("setCameraTrack"),console.log("not muted sending stream "),d(g.a.error_000,c.videoStream)):(I("setCameraTrack"),console.log("error not muted but no video stream"),d(g.a.error_1159));else K=!1,c.isVideoMuted()&&(console.log("muted disabling localview by replace track"),void 0!==c.videoStream&&c.videoStream.getTracks().forEach(function(a){a.enabled=!1;a.onended=
null;a.stop()})),console.log("disabling localview detaching player divs"),H(null),I("setCameraTrack"),d(g.a.error_000);else a["default"].error("setLocalView() invalid param - callback")};c._setStaticQualityLayer=function(b,d,f){f=void 0===f?function(){}:f;c.room&&c.room.p2p?(a["default"].warning("Error! p2p streams don't support setStaticQualityLayer"),f("error")):(b={qualityLayer:{spatialLayer:b,temporalLayer:d}},c.checkOptions(b,!0),c.pc.updateSpec(b,f))};c._setDynamicQualityLayer=function(b){if(c.room&&
c.room.p2p)a["default"].warning("Error! p2p streams don't support setDynamicQualityLayer"),b("error");else{var d={qualityLayer:{spatialLayer:-1,temporalLayer:-1}};c.checkOptions(d,!0);c.pc.updateSpec(d,b)}};var D=function(a,b,d){!0!==b&&(b=!1);a="string"===typeof a?[a]:a;a=a instanceof Array?a:[];0<a.length&&c.room.sendControlMessage(c,"control",{name:"controlhandlers",enable:d,publisherSide:b,handlers:a})};c.disableHandlers=function(a,c){D(a,c,!1)};c.enableHandlers=function(a,c){D(a,c,!0)};c.updateSimulcastLayersBitrate=
function(a,b){c.pc&&c.local&&(c.pc.updateSimulcastLayersBitrate(a),b&&(config.maxVideoLayeredBitrates=a))};c.updateConfiguration=function(a,b){b=void 0===b?function(){}:b;if(void 0!==a)if(c.pc)if(c.checkOptions(a,!0),c.local)if(c.room.p2p)for(var d=0;d<c.pc.length;d+=1)c.pc[d].updateSpec(a,b);else void 0!=a.maxVideoBW||void 0!=a.minVideoBW||void 0!=a.maxVideoFps||void 0!=a.minVideoFps?1>=c.maxVideoLayers&&c.setVideoParamsRange(a.maxVideoBW,a.minVideoBW,a.maxVideoFps,a.minVideoFps,!1):c.pc.updateSpec(a,
b);else c.pc.updateSpec(a,b);else b("Error! This stream has no peerConnection attached, Skipping")};c.ShowSessionStats=function(b){!0===b?void 0!==c.player?c.player.ShowSessionStats(!0):a["default"].info("stream does not have a player to show stats"):void 0!==c.player?c.player.ShowSessionStats(!1):a["default"].info("stream does not have a player to hide stats")};c.changeInputMediaSource=function(b,d){d=void 0===d?function(){}:d;if("function"!==typeof d)a["default"].error("changeInputMediaSource() invalid param - callback");
else if(!c.local||c.ifCanvas()||c.ifScreen())a["default"].error("changeInputMediaSource() not supported "),d(g.a.error_1156);else if(void 0==b||"object"!==typeof b||void 0==b.video&&void 0==b.audio)a["default"].error("changeInputMediaSource() invalid param - options"),d(g.a.error_1155);else if(b.video)if(!b.stream||b.stream.getVideoTracks()&&b.stream.getVideoTracks().length)if(0==ca("setCameraTrack"))k.a.warn("stream-event",p.a.event_general_failed,{message:"changeInputMediaSource() - Previous similar camera request in process"}),
d(g.a.error_1140);else{c.inputMediaSource.video.user=void 0!=b.stream&&null!=b.stream?b.stream:null;if(null!=c.inputMediaSource.video.user){b=c.inputMediaSource.video.user;var f="user"}else b=c.inputMediaSource.video.self,f="self";c.isVideoMuted()||c.inputMediaSource.video.selected==f||(O(c,!1,!0,b,!1),H(b));c.inputMediaSource.video.selected=f;I("setCameraTrack");d(g.a.error_000)}else a["default"].error("changeInputMediaSource() video tracks not found"),d(g.a.error_1156)};c.replaceLocalTrack=function(a,
c){a.pc.peerConnection.getSenders().forEach(function(b,d){b.track&&("video"===b.track.kind?c&&c.getVideoTracks().forEach(function(a){console.log(a);a.enabled=!0;b.replaceTrack(a)}):"audio"===b.track.kind&&a&&a.audioStream.getAudioTracks().forEach(function(a){console.log(a);a.enabled=!0;b.replaceTrack(a)}))})};c.enableNoiseSuppression=function(b){b=void 0===b?function(){}:b;if("function"!=typeof b)a["default"].error("Incorrect type for callback, it should be a function");else{if(!t)return b(g.a.error_1170);
if(void 0==c.audioStream)return a["default"].debug("audio stream/tracks coming as undefined !!"),b(g.a.error_1198);if(0==t.isAlreadyStarted())t.startNoiseProcessing(c.audioStream).then(function(a){O(c,!0,!1,a,!1,!1);return b(g.a.error_000)}).catch(function(){return b(g.a.error_1198)});else return b(g.a.error_1188)}};c.disableNoiseSuppression=function(b){b=void 0===b?function(){}:b;if("function"!=typeof b)a["default"].error("Incorrect type for callback, it should be a function");else{if(!t)return b(g.a.error_1170);
if(0==t.isAlreadyStarted())return b(g.a.error_1188);1==t.isAlreadyStarted()&&t.stopNoiseProcessing().then(function(){O(c,!0,!1,c.audioStream,!1,!1);return b(g.a.error_000)}).catch(function(){return b(g.a.error_1199)})}};c.noiseProcessingFeatureExists=function(){return t?new Promise(function(a,c){t.checkFileExists().then(function(c){a(c)}).catch(function(a){c(a)})}):callback(g.a.error_1170)};return c}console.log("Webrtc not supported")}},function(l,r,n){r.a=function(){return{player:{default:{autoplay:"autoplay",
name:"",nameDisplayMode:"",frameFitMode:"bestFit",skin:"default",class:"",height:"240px",width:"320px",minHeight:"200px",minWidth:"250px",aspectRatio:"16:9",volume:5,media:"",loader:{show:!0,style:"default",class:""}}},brand:{default:{display:!0,url:"http://www.vcloudx.com",logo:"/assets/favicon.png",show:!0,target:"_blank",title:"VCloudX Infotech"}},toolbar:{default:{skin:"default",buttons:{play:!0,resize:!0,share:!0,mic:!0,volume:!0,mute:!0,record:!0,playtime:!0,zoom:!0},position:"bottom",class:"",
displayMode:!0,autoDisplayTimeout:0}}}}},function(l,r,n){function e(a,c){var b={"Content-Type":"application/json"};c&&(b.Authentication="Bearer "+c);return{method:"POST",headers:new Headers(b),body:JSON.stringify(a)}}function u(a,c,b){var d,g,k,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(p){if(1==p.nextAddress)return d={},c=c||{},p.yield(b.authHeader(),2);if(3!=p.nextAddress)return g=p.yieldResult,c.headers=new Headers({Authorization:g}),p.yield(fetch(a,c),3);k=p.yieldResult;d.response=
k;d.ok=k.ok;e=(k.headers.get("WWW-Authenticate")||"").split(" ")[1];d.shouldRetry=401===k.status&&e!==b.nonce;b.nonce=e;return p.return(d)})}function m(a,c,b){var d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress)return g.yield(u(a,c,b),2);d=g.yieldResult;return d.shouldRetry?g.return(u(a,c,b)):g.return(d)})}function d(a){return new Promise(function(b,d){try{var g=new WebSocket(a);g.addEventListener("open",function(){return b(g)},{once:!0})}catch(y){v["default"].info("asyncInitWebSocket exception while creating websocket",
y),d(new c(!1))}})}function a(a,b){return new Promise(function(d,g){function k(d){a.removeEventListener("message",e);g(new c(b.cancelled))}function e(c){a.removeEventListener("close",k);try{var b=JSON.parse(c.data);if(b.error)throw v["default"].error(" listenForResponse throw exception ",b.error),Error(b.error);d(b)}catch(da){v["default"].error(" listenForResponse exception ",da),g(da)}}a.addEventListener("message",e,{once:!0});a.addEventListener("close",k,{once:!0})})}function b(b,c,g,e,m,l,x,u,
n){var z,G,f,K,B,r,N,O,U,y,Y,F,S,M,D;return $jscomp.asyncExecutePromiseGeneratorProgram(function(H){switch(H.nextAddress){case 1:return z=0,G=Date.now(),f="https:"===window.location.protocol?"wss:":"ws:",K="file:"===window.location.protocol?t:f+"//"+w+(q?":":"")+q+"/api/ws",H.yield(d(K),2);case 2:B=H.yieldResult;H.setCatchFinallyBlocks(3,4);r=Object(p.arrayToB64)(new Uint8Array(c));N={};var ia=x;ia=void 0===ia?{}:ia;E.file_meta=ia;E.trans_dt=Date.now();N=E;O={fileMetadata:r,authorization:"send-v1 "+
g,bearer:l,timeLimit:e,dlimit:m,callInfo:N};U=a(B,n);B.send(JSON.stringify(O));return H.yield(U,6);case 6:return y=H.yieldResult,Y=a(B,n),F=b.getReader(),H.yield(F.read(),7);case 7:S=H.yieldResult;case 8:if(S.done){H.jumpTo(9);break}n.cancelled&&(v["default"].info(" websocket upload cancelled"),B.close());if(B.readyState!==WebSocket.OPEN){H.jumpTo(9);break}M=S.value;B.send(M);u(z);z+=M.length;return H.yield(F.read(),10);case 10:S=H.yieldResult;case 11:if(!(B.bufferedAmount>2*k.a&&B.readyState===WebSocket.OPEN)||
n.cancelled){H.jumpTo(8);break}return H.yield(Object(p.delay)(),11);case 9:return B.readyState===WebSocket.OPEN&&B.send(new Uint8Array([0])),H.yield(Y,14);case 14:return y.duration=Date.now()-G,H.return(y);case 4:H.enterFinallyBlock();[WebSocket.CLOSED,WebSocket.CLOSING].includes(B.readyState)||B.close();H.leaveFinallyBlock(0);break;case 3:throw D=H.enterCatchBlock(),D.size=z,D.duration=Date.now()-G,v["default"].info(" websocket upload failed",D),D;}})}function g(a,b,c,d){var g,k;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==
e.nextAddress)return e.yield(b.authHeader(),2);g=e.yieldResult;k=new XMLHttpRequest;d.oncancel=function(){k.abort()};return e.return(new Promise(function(e,p){k.addEventListener("loadend",function(){d.oncancel=function(){};var a=k.getResponseHeader("WWW-Authenticate");a&&(b.nonce=(a||"").split(" ")[1]);if(200!==k.status)return p(Error(k.status));a=new Blob([k.response]);e(a)});k.addEventListener("progress",function(a){200===a.target.status&&c(a.loaded)});k.open("get",G+("/api/download/blob/"+a));
k.setRequestHeader("Authorization",g);k.responseType="blob";k.send();c(0)}))})}function x(a,b,c,d,k){k=void 0===k?2:k;var e,p;return $jscomp.asyncExecutePromiseGeneratorProgram(function(m){if(1==m.nextAddress)return m.setCatchFinallyBlocks(2),m.yield(g(a,b,c,d),4);if(2!=m.nextAddress)return e=m.yieldResult,m.return(e);p=m.enterCatchBlock();if("401"===p.message&&0<--k)return m.return(x(a,b,c,d,k));throw p;})}r.d=function(a){return G+a};r.f=function(a){void 0!=a&&void 0!=a.url&&void 0!=a.hostName&&
void 0!=a.port&&(G=a.url,w=a.hostName,q=a.port,t="wss://"+w+":"+q+"/api/ws",a=a.callInfo,v["default"].info(" file sharing service call details",a),E.userName=a.userName,E.room_id=a.room_id,E.conf_num=a.conf_num,E.call_num=a.call_num,E.service_id=a.service_id)};r.a=function(a,b){var c;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==d.nextAddress)return d.yield(fetch(G+("/api/delete/"+a),e({owner_token:b})),2);c=d.yieldResult;return d.return(c.ok)})};r.g=function(a,b,c,d){var g;
return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){if(1==k.nextAddress)return k.yield(fetch(G+("/api/params/"+a),e({owner_token:b,dlimit:d.dlimit},c)),2);g=k.yieldResult;return k.return(g.ok)})};r.c=function(a,b){var c,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){switch(g.nextAddress){case 1:return g.yield(fetch(G+("/api/info/"+a),e({owner_token:b})),2);case 2:c=g.yieldResult;if(!c.ok){g.jumpTo(3);break}return g.yield(c.json(),4);case 4:return d=g.yieldResult,g.return(d);
case 3:throw Error(c.status);}})};r.e=function(a,c){var b,d,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){switch(k.nextAddress){case 1:return k.yield(m(G+("/api/metadata/"+a),{method:"GET"},c),2);case 2:b=k.yieldResult;if(!b.ok){k.jumpTo(3);break}return k.yield(b.response.json(),4);case 4:return d=k.yieldResult,k.yield(c.decryptMetadata(Object(p.b64ToArray)(d.metadata)),5);case 5:return g=k.yieldResult,k.return({size:g.size,ttl:d.ttl,iv:g.iv,name:g.name,type:g.type,manifest:g.manifest});
case 3:throw Error(b.response.status);}})};r.h=function(a,c,b){var d,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){if(1==k.nextAddress)return k.yield(b.authKeyB64(),2);if(3!=k.nextAddress)return d=k.yieldResult,k.yield(fetch(G+("/api/password/"+a),e({owner_token:c,auth:d})),3);g=k.yieldResult;return k.return(g.ok)})};r.i=function(a,c,d,g,k,e,p,m){var q={cancelled:!1};return{cancel:function(){q.cancelled=!0},result:b(a,c,d,g,k,e,p,m,q)}};r.b=function(a,c,b){var d={oncancel:function(){}};
return{cancel:function(){d.oncancel()},result:x(a,c,b,d)}};var p=n(12);n.n(p);var k=n(29),v=n(0),t=null,w="",q="";t||(t="");var c=function(a,c,b){var d=Error.call(this,a?"0":"connection closed");this.message=d.message;"stack"in d&&(this.stack=d.stack);this.cancelled=a;this.duration=c;this.size=b};$jscomp.inherits(c,Error);var G="",E={}},function(l,r,n){(function(e){function l(){try{var a=new Uint8Array(1);a.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return 42===a.foo()&&
"function"===typeof a.subarray&&0===a.subarray(1,1).byteLength}catch(O){return!1}}function m(a,c){if((d.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<c)throw new RangeError("Invalid typed array length");d.TYPED_ARRAY_SUPPORT?(a=new Uint8Array(c),a.__proto__=d.prototype):(null===a&&(a=new d(c)),a.length=c);return a}function d(c,b,f){if(!(d.TYPED_ARRAY_SUPPORT||this instanceof d))return new d(c,b,f);if("number"===typeof c){if("string"===typeof b)throw Error("If encoding is specified then the first argument must be a string");
return g(this,c)}return a(this,c,b,f)}function a(a,c,b,f){if("number"===typeof c)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&c instanceof ArrayBuffer){c.byteLength;if(0>b||c.byteLength<b)throw new RangeError("'offset' is out of bounds");if(c.byteLength<b+(f||0))throw new RangeError("'length' is out of bounds");c=void 0===b&&void 0===f?new Uint8Array(c):void 0===f?new Uint8Array(c,b):new Uint8Array(c,b,f);d.TYPED_ARRAY_SUPPORT?(a=c,a.__proto__=
d.prototype):a=x(a,c);return a}if("string"===typeof c){f=a;a=b;if("string"!==typeof a||""===a)a="utf8";if(!d.isEncoding(a))throw new TypeError('"encoding" must be a valid string encoding');b=v(c,a)|0;f=m(f,b);c=f.write(c,a);c!==b&&(f=f.slice(0,c));return f}return p(a,c)}function b(a){if("number"!==typeof a)throw new TypeError('"size" argument must be a number');if(0>a)throw new RangeError('"size" argument must not be negative');}function g(a,c){b(c);a=m(a,0>c?0:k(c)|0);if(!d.TYPED_ARRAY_SUPPORT)for(var f=
0;f<c;++f)a[f]=0;return a}function x(a,c){var b=0>c.length?0:k(c.length)|0;a=m(a,b);for(var d=0;d<b;d+=1)a[d]=c[d]&255;return a}function p(a,c){if(d.isBuffer(c)){var b=k(c.length)|0;a=m(a,b);if(0===a.length)return a;c.copy(a,0,0,b);return a}if(c){if("undefined"!==typeof ArrayBuffer&&c.buffer instanceof ArrayBuffer||"length"in c)return(b="number"!==typeof c.length)||(b=c.length,b=b!==b),b?m(a,0):x(a,c);if("Buffer"===c.type&&ja(c.data))return x(a,c.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");
}function k(a){if(a>=(d.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(d.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return a|0}function v(a,c){if(d.isBuffer(a))return a.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(a)||a instanceof ArrayBuffer))return a.byteLength;"string"!==typeof a&&(a=""+a);var b=a.length;if(0===b)return 0;for(var f=!1;;)switch(c){case "ascii":case "latin1":case "binary":return b;
case "utf8":case "utf-8":case void 0:return M(a).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*b;case "hex":return b>>>1;case "base64":return ha.toByteArray(S(a)).length;default:if(f)return M(a).length;c=(""+c).toLowerCase();f=!0}}function t(a,c,b){var d=!1;if(void 0===c||0>c)c=0;if(c>this.length)return"";if(void 0===b||b>this.length)b=this.length;if(0>=b)return"";b>>>=0;c>>>=0;if(b<=c)return"";for(a||(a="utf8");;)switch(a){case "hex":a=c;c=b;b=this.length;if(!a||0>a)a=0;
if(!c||0>c||c>b)c=b;d="";for(b=a;b<c;++b)a=d,d=this[b],d=16>d?"0"+d.toString(16):d.toString(16),d=a+d;return d;case "utf8":case "utf-8":return G(this,c,b);case "ascii":a="";for(b=Math.min(this.length,b);c<b;++c)a+=String.fromCharCode(this[c]&127);return a;case "latin1":case "binary":a="";for(b=Math.min(this.length,b);c<b;++c)a+=String.fromCharCode(this[c]);return a;case "base64":return c=0===c&&b===this.length?ha.fromByteArray(this):ha.fromByteArray(this.slice(c,b)),c;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":c=
this.slice(c,b);b="";for(a=0;a<c.length;a+=2)b+=String.fromCharCode(c[a]+256*c[a+1]);return b;default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase();d=!0}}function w(a,c,b){var d=a[c];a[c]=a[b];a[b]=d}function q(a,b,f,g,k){if(0===a.length)return-1;"string"===typeof f?(g=f,f=0):2147483647<f?f=2147483647:-2147483648>f&&(f=-2147483648);f=+f;isNaN(f)&&(f=k?0:a.length-1);0>f&&(f=a.length+f);if(f>=a.length){if(k)return-1;f=a.length-1}else if(0>f)if(k)f=0;else return-1;"string"===
typeof b&&(b=d.from(b,g));if(d.isBuffer(b))return 0===b.length?-1:c(a,b,f,g,k);if("number"===typeof b)return b&=255,d.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?k?Uint8Array.prototype.indexOf.call(a,b,f):Uint8Array.prototype.lastIndexOf.call(a,b,f):c(a,[b],f,g,k);throw new TypeError("val must be string, number or Buffer");}function c(a,c,b,d,f){function g(a,c){return 1===k?a[c]:a.readUInt16BE(c*k)}var k=1,e=a.length,p=c.length;if(void 0!==d&&(d=String(d).toLowerCase(),"ucs2"===
d||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(2>a.length||2>c.length)return-1;k=2;e/=2;p/=2;b/=2}if(f)for(d=-1;b<e;b++)if(g(a,b)===g(c,-1===d?0:b-d)){if(-1===d&&(d=b),b-d+1===p)return d*k}else-1!==d&&(b-=b-d),d=-1;else for(b+p>e&&(b=e-p);0<=b;b--){e=!0;for(d=0;d<p;d++)if(g(a,b+d)!==g(c,d)){e=!1;break}if(e)return b}return-1}function G(a,c,b){b=Math.min(a.length,b);for(var d=[];c<b;){var f=a[c],g=null,k=239<f?4:223<f?3:191<f?2:1;if(c+k<=b)switch(k){case 1:128>f&&(g=f);break;case 2:var e=a[c+1];
128===(e&192)&&(f=(f&31)<<6|e&63,127<f&&(g=f));break;case 3:e=a[c+1];var p=a[c+2];128===(e&192)&&128===(p&192)&&(f=(f&15)<<12|(e&63)<<6|p&63,2047<f&&(55296>f||57343<f)&&(g=f));break;case 4:e=a[c+1];p=a[c+2];var m=a[c+3];128===(e&192)&&128===(p&192)&&128===(m&192)&&(f=(f&15)<<18|(e&63)<<12|(p&63)<<6|m&63,65535<f&&1114112>f&&(g=f))}null===g?(g=65533,k=1):65535<g&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|g&1023);d.push(g);c+=k}a=d.length;if(a<=ca)d=String.fromCharCode.apply(String,d);else{b="";for(c=
0;c<a;)b+=String.fromCharCode.apply(String,d.slice(c,c+=ca));d=b}return d}function E(a,c,b){if(0!==a%1||0>a)throw new RangeError("offset is not uint");if(a+c>b)throw new RangeError("Trying to access beyond buffer length");}function z(a,c,b,f,g,k){if(!d.isBuffer(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>g||c<k)throw new RangeError('"value" argument is out of bounds');if(b+f>a.length)throw new RangeError("Index out of range");}function K(a,c,b,d){0>c&&(c=65535+c+1);
for(var f=0,g=Math.min(a.length-b,2);f<g;++f)a[b+f]=(c&255<<8*(d?f:1-f))>>>8*(d?f:1-f)}function B(a,c,b,d){0>c&&(c=4294967295+c+1);for(var f=0,g=Math.min(a.length-b,4);f<g;++f)a[b+f]=c>>>8*(d?f:3-f)&255}function Y(a,c,b,d,f,g){if(b+d>a.length)throw new RangeError("Index out of range");if(0>b)throw new RangeError("Index out of range");}function y(a,c,b,d,g){g||Y(a,c,b,4,3.4028234663852886E38,-3.4028234663852886E38);f.write(a,c,b,d,23,4);return b+4}function F(a,c,b,d,g){g||Y(a,c,b,8,1.7976931348623157E308,
-1.7976931348623157E308);f.write(a,c,b,d,52,8);return b+8}function S(a){a=a.trim?a.trim():a.replace(/^\s+|\s+$/g,"");a=a.replace(I,"");if(2>a.length)return"";for(;0!==a.length%4;)a+="=";return a}function M(a,c){c=c||Infinity;for(var b,d=a.length,f=null,g=[],k=0;k<d;++k){b=a.charCodeAt(k);if(55295<b&&57344>b){if(!f){if(56319<b){-1<(c-=3)&&g.push(239,191,189);continue}else if(k+1===d){-1<(c-=3)&&g.push(239,191,189);continue}f=b;continue}if(56320>b){-1<(c-=3)&&g.push(239,191,189);f=b;continue}b=(f-55296<<
10|b-56320)+65536}else f&&-1<(c-=3)&&g.push(239,191,189);f=null;if(128>b){if(0>--c)break;g.push(b)}else if(2048>b){if(0>(c-=2))break;g.push(b>>6|192,b&63|128)}else if(65536>b){if(0>(c-=3))break;g.push(b>>12|224,b>>6&63|128,b&63|128)}else if(1114112>b){if(0>(c-=4))break;g.push(b>>18|240,b>>12&63|128,b>>6&63|128,b&63|128)}else throw Error("Invalid code point");}return g}function da(a){for(var c=[],b=0;b<a.length;++b)c.push(a.charCodeAt(b)&255);return c}function ba(a,c,b,d){for(var f=0;f<d&&!(f+b>=c.length||
f>=a.length);++f)c[f+b]=a[f];return f}var ha=n(28),f=n(54),ja=n(55);r.Buffer=d;r.SlowBuffer=function(a){+a!=a&&(a=0);return d.alloc(+a)};r.INSPECT_MAX_BYTES=50;d.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:l();r.kMaxLength=d.TYPED_ARRAY_SUPPORT?2147483647:1073741823;d.poolSize=8192;d._augment=function(a){a.__proto__=d.prototype;return a};d.from=function(c,b,d){return a(null,c,b,d)};d.TYPED_ARRAY_SUPPORT&&(d.prototype.__proto__=Uint8Array.prototype,d.__proto__=Uint8Array,
$jscomp.initSymbol(),$jscomp.initSymbol(),$jscomp.initSymbol(),"undefined"!==typeof Symbol&&Symbol.species&&d[Symbol.species]===d&&($jscomp.initSymbol(),Object.defineProperty(d,Symbol.species,{value:null,configurable:!0})));d.alloc=function(a,c,d){b(a);a=0>=a?m(null,a):void 0!==c?"string"===typeof d?m(null,a).fill(c,d):m(null,a).fill(c):m(null,a);return a};d.allocUnsafe=function(a){return g(null,a)};d.allocUnsafeSlow=function(a){return g(null,a)};d.isBuffer=function(a){return!(null==a||!a._isBuffer)};
d.compare=function(a,c){if(!d.isBuffer(a)||!d.isBuffer(c))throw new TypeError("Arguments must be Buffers");if(a===c)return 0;for(var b=a.length,f=c.length,g=0,k=Math.min(b,f);g<k;++g)if(a[g]!==c[g]){b=a[g];f=c[g];break}return b<f?-1:f<b?1:0};d.isEncoding=function(a){switch(String(a).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};d.concat=function(a,c){if(!ja(a))throw new TypeError('"list" argument must be an Array of Buffers');
if(0===a.length)return d.alloc(0);var b;if(void 0===c)for(b=c=0;b<a.length;++b)c+=a[b].length;c=d.allocUnsafe(c);var f=0;for(b=0;b<a.length;++b){var g=a[b];if(!d.isBuffer(g))throw new TypeError('"list" argument must be an Array of Buffers');g.copy(c,f);f+=g.length}return c};d.byteLength=v;d.prototype._isBuffer=!0;d.prototype.swap16=function(){var a=this.length;if(0!==a%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var c=0;c<a;c+=2)w(this,c,c+1);return this};d.prototype.swap32=
function(){var a=this.length;if(0!==a%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var c=0;c<a;c+=4)w(this,c,c+3),w(this,c+1,c+2);return this};d.prototype.swap64=function(){var a=this.length;if(0!==a%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var c=0;c<a;c+=8)w(this,c,c+7),w(this,c+1,c+6),w(this,c+2,c+5),w(this,c+3,c+4);return this};d.prototype.toString=function(){var a=this.length|0;return 0===a?"":0===arguments.length?G(this,0,a):t.apply(this,
arguments)};d.prototype.equals=function(a){if(!d.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:0===d.compare(this,a)};d.prototype.inspect=function(){var a="",c=r.INSPECT_MAX_BYTES;0<this.length&&(a=this.toString("hex",0,c).match(/.{2}/g).join(" "),this.length>c&&(a+=" ... "));return"<Buffer "+a+">"};d.prototype.compare=function(a,c,b,f,g){if(!d.isBuffer(a))throw new TypeError("Argument must be a Buffer");void 0===c&&(c=0);void 0===b&&(b=a?a.length:0);void 0===f&&
(f=0);void 0===g&&(g=this.length);if(0>c||b>a.length||0>f||g>this.length)throw new RangeError("out of range index");if(f>=g&&c>=b)return 0;if(f>=g)return-1;if(c>=b)return 1;c>>>=0;b>>>=0;f>>>=0;g>>>=0;if(this===a)return 0;var k=g-f,e=b-c,p=Math.min(k,e);f=this.slice(f,g);a=a.slice(c,b);for(c=0;c<p;++c)if(f[c]!==a[c]){k=f[c];e=a[c];break}return k<e?-1:e<k?1:0};d.prototype.includes=function(a,c,b){return-1!==this.indexOf(a,c,b)};d.prototype.indexOf=function(a,c,b){return q(this,a,c,b,!0)};d.prototype.lastIndexOf=
function(a,c,b){return q(this,a,c,b,!1)};d.prototype.write=function(a,c,b,d){if(void 0===c)d="utf8",b=this.length,c=0;else if(void 0===b&&"string"===typeof c)d=c,b=this.length,c=0;else if(isFinite(c))c|=0,isFinite(b)?(b|=0,void 0===d&&(d="utf8")):(d=b,b=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var f=this.length-c;if(void 0===b||b>f)b=f;if(0<a.length&&(0>b||0>c)||c>this.length)throw new RangeError("Attempt to write outside buffer bounds");
d||(d="utf8");for(f=!1;;)switch(d){case "hex":a:{c=Number(c)||0;d=this.length-c;b?(b=Number(b),b>d&&(b=d)):b=d;d=a.length;if(0!==d%2)throw new TypeError("Invalid hex string");b>d/2&&(b=d/2);for(d=0;d<b;++d){f=parseInt(a.substr(2*d,2),16);if(isNaN(f)){a=d;break a}this[c+d]=f}a=d}return a;case "utf8":case "utf-8":return ba(M(a,this.length-c),this,c,b);case "ascii":return ba(da(a),this,c,b);case "latin1":case "binary":return ba(da(a),this,c,b);case "base64":return ba(ha.toByteArray(S(a)),this,c,b);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":d=
a;f=this.length-c;for(var g=[],k=0;k<d.length&&!(0>(f-=2));++k){var e=d.charCodeAt(k);a=e>>8;e%=256;g.push(e);g.push(a)}return ba(g,this,c,b);default:if(f)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase();f=!0}};d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var ca=4096;d.prototype.slice=function(a,c){var b=this.length;a=~~a;c=void 0===c?b:~~c;0>a?(a+=b,0>a&&(a=0)):a>b&&(a=b);0>c?(c+=b,0>c&&(c=0)):c>b&&(c=b);c<a&&(c=a);if(d.TYPED_ARRAY_SUPPORT)c=
this.subarray(a,c),c.__proto__=d.prototype;else{b=c-a;c=new d(b,void 0);for(var f=0;f<b;++f)c[f]=this[f+a]}return c};d.prototype.readUIntLE=function(a,c,b){a|=0;c|=0;b||E(a,c,this.length);b=this[a];for(var d=1,f=0;++f<c&&(d*=256);)b+=this[a+f]*d;return b};d.prototype.readUIntBE=function(a,c,b){a|=0;c|=0;b||E(a,c,this.length);b=this[a+--c];for(var d=1;0<c&&(d*=256);)b+=this[a+--c]*d;return b};d.prototype.readUInt8=function(a,c){c||E(a,1,this.length);return this[a]};d.prototype.readUInt16LE=function(a,
c){c||E(a,2,this.length);return this[a]|this[a+1]<<8};d.prototype.readUInt16BE=function(a,c){c||E(a,2,this.length);return this[a]<<8|this[a+1]};d.prototype.readUInt32LE=function(a,c){c||E(a,4,this.length);return(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]};d.prototype.readUInt32BE=function(a,c){c||E(a,4,this.length);return 16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])};d.prototype.readIntLE=function(a,c,b){a|=0;c|=0;b||E(a,c,this.length);b=this[a];for(var d=1,f=0;++f<c&&(d*=256);)b+=
this[a+f]*d;b>=128*d&&(b-=Math.pow(2,8*c));return b};d.prototype.readIntBE=function(a,c,b){a|=0;c|=0;b||E(a,c,this.length);b=c;for(var d=1,f=this[a+--b];0<b&&(d*=256);)f+=this[a+--b]*d;f>=128*d&&(f-=Math.pow(2,8*c));return f};d.prototype.readInt8=function(a,c){c||E(a,1,this.length);return this[a]&128?-1*(255-this[a]+1):this[a]};d.prototype.readInt16LE=function(a,c){c||E(a,2,this.length);a=this[a]|this[a+1]<<8;return a&32768?a|4294901760:a};d.prototype.readInt16BE=function(a,c){c||E(a,2,this.length);
a=this[a+1]|this[a]<<8;return a&32768?a|4294901760:a};d.prototype.readInt32LE=function(a,c){c||E(a,4,this.length);return this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24};d.prototype.readInt32BE=function(a,c){c||E(a,4,this.length);return this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]};d.prototype.readFloatLE=function(a,c){c||E(a,4,this.length);return f.read(this,a,!0,23,4)};d.prototype.readFloatBE=function(a,c){c||E(a,4,this.length);return f.read(this,a,!1,23,4)};d.prototype.readDoubleLE=function(a,
c){c||E(a,8,this.length);return f.read(this,a,!0,52,8)};d.prototype.readDoubleBE=function(a,c){c||E(a,8,this.length);return f.read(this,a,!1,52,8)};d.prototype.writeUIntLE=function(a,c,b,d){a=+a;c|=0;b|=0;d||z(this,a,c,b,Math.pow(2,8*b)-1,0);d=1;var f=0;for(this[c]=a&255;++f<b&&(d*=256);)this[c+f]=a/d&255;return c+b};d.prototype.writeUIntBE=function(a,c,b,d){a=+a;c|=0;b|=0;d||z(this,a,c,b,Math.pow(2,8*b)-1,0);d=b-1;var f=1;for(this[c+d]=a&255;0<=--d&&(f*=256);)this[c+d]=a/f&255;return c+b};d.prototype.writeUInt8=
function(a,c,b){a=+a;c|=0;b||z(this,a,c,1,255,0);d.TYPED_ARRAY_SUPPORT||(a=Math.floor(a));this[c]=a&255;return c+1};d.prototype.writeUInt16LE=function(a,c,b){a=+a;c|=0;b||z(this,a,c,2,65535,0);d.TYPED_ARRAY_SUPPORT?(this[c]=a&255,this[c+1]=a>>>8):K(this,a,c,!0);return c+2};d.prototype.writeUInt16BE=function(a,c,b){a=+a;c|=0;b||z(this,a,c,2,65535,0);d.TYPED_ARRAY_SUPPORT?(this[c]=a>>>8,this[c+1]=a&255):K(this,a,c,!1);return c+2};d.prototype.writeUInt32LE=function(a,c,b){a=+a;c|=0;b||z(this,a,c,4,4294967295,
0);d.TYPED_ARRAY_SUPPORT?(this[c+3]=a>>>24,this[c+2]=a>>>16,this[c+1]=a>>>8,this[c]=a&255):B(this,a,c,!0);return c+4};d.prototype.writeUInt32BE=function(a,c,b){a=+a;c|=0;b||z(this,a,c,4,4294967295,0);d.TYPED_ARRAY_SUPPORT?(this[c]=a>>>24,this[c+1]=a>>>16,this[c+2]=a>>>8,this[c+3]=a&255):B(this,a,c,!1);return c+4};d.prototype.writeIntLE=function(a,c,b,d){a=+a;c|=0;d||(d=Math.pow(2,8*b-1),z(this,a,c,b,d-1,-d));d=0;var f=1,g=0;for(this[c]=a&255;++d<b&&(f*=256);)0>a&&0===g&&0!==this[c+d-1]&&(g=1),this[c+
d]=(a/f>>0)-g&255;return c+b};d.prototype.writeIntBE=function(a,c,b,d){a=+a;c|=0;d||(d=Math.pow(2,8*b-1),z(this,a,c,b,d-1,-d));d=b-1;var f=1,g=0;for(this[c+d]=a&255;0<=--d&&(f*=256);)0>a&&0===g&&0!==this[c+d+1]&&(g=1),this[c+d]=(a/f>>0)-g&255;return c+b};d.prototype.writeInt8=function(a,c,b){a=+a;c|=0;b||z(this,a,c,1,127,-128);d.TYPED_ARRAY_SUPPORT||(a=Math.floor(a));0>a&&(a=255+a+1);this[c]=a&255;return c+1};d.prototype.writeInt16LE=function(a,c,b){a=+a;c|=0;b||z(this,a,c,2,32767,-32768);d.TYPED_ARRAY_SUPPORT?
(this[c]=a&255,this[c+1]=a>>>8):K(this,a,c,!0);return c+2};d.prototype.writeInt16BE=function(a,c,b){a=+a;c|=0;b||z(this,a,c,2,32767,-32768);d.TYPED_ARRAY_SUPPORT?(this[c]=a>>>8,this[c+1]=a&255):K(this,a,c,!1);return c+2};d.prototype.writeInt32LE=function(a,c,b){a=+a;c|=0;b||z(this,a,c,4,2147483647,-2147483648);d.TYPED_ARRAY_SUPPORT?(this[c]=a&255,this[c+1]=a>>>8,this[c+2]=a>>>16,this[c+3]=a>>>24):B(this,a,c,!0);return c+4};d.prototype.writeInt32BE=function(a,c,b){a=+a;c|=0;b||z(this,a,c,4,2147483647,
-2147483648);0>a&&(a=4294967295+a+1);d.TYPED_ARRAY_SUPPORT?(this[c]=a>>>24,this[c+1]=a>>>16,this[c+2]=a>>>8,this[c+3]=a&255):B(this,a,c,!1);return c+4};d.prototype.writeFloatLE=function(a,c,b){return y(this,a,c,!0,b)};d.prototype.writeFloatBE=function(a,c,b){return y(this,a,c,!1,b)};d.prototype.writeDoubleLE=function(a,c,b){return F(this,a,c,!0,b)};d.prototype.writeDoubleBE=function(a,c,b){return F(this,a,c,!1,b)};d.prototype.copy=function(a,c,b,f){b||(b=0);f||0===f||(f=this.length);c>=a.length&&
(c=a.length);c||(c=0);0<f&&f<b&&(f=b);if(f===b||0===a.length||0===this.length)return 0;if(0>c)throw new RangeError("targetStart out of bounds");if(0>b||b>=this.length)throw new RangeError("sourceStart out of bounds");if(0>f)throw new RangeError("sourceEnd out of bounds");f>this.length&&(f=this.length);a.length-c<f-b&&(f=a.length-c+b);var g=f-b;if(this===a&&b<c&&c<f)for(f=g-1;0<=f;--f)a[f+c]=this[f+b];else if(1E3>g||!d.TYPED_ARRAY_SUPPORT)for(f=0;f<g;++f)a[f+c]=this[f+b];else Uint8Array.prototype.set.call(a,
this.subarray(b,b+g),c);return g};d.prototype.fill=function(a,c,b,f){if("string"===typeof a){"string"===typeof c?(f=c,c=0,b=this.length):"string"===typeof b&&(f=b,b=this.length);if(1===a.length){var g=a.charCodeAt(0);256>g&&(a=g)}if(void 0!==f&&"string"!==typeof f)throw new TypeError("encoding must be a string");if("string"===typeof f&&!d.isEncoding(f))throw new TypeError("Unknown encoding: "+f);}else"number"===typeof a&&(a&=255);if(0>c||this.length<c||this.length<b)throw new RangeError("Out of range index");
if(b<=c)return this;c>>>=0;b=void 0===b?this.length:b>>>0;a||(a=0);if("number"===typeof a)for(f=c;f<b;++f)this[f]=a;else for(a=d.isBuffer(a)?a:M((new d(a,f)).toString()),g=a.length,f=0;f<b-c;++f)this[f+c]=a[f%g];return this};var I=/[^+\/0-9A-Za-z-_]/g}).call(r,n(30))},function(l,r,n){function e(d,a){this.test=a;this.statsGatheringRunning=!1;this.pc1=new RTCPeerConnection(d);this.pc2=new RTCPeerConnection(d);this.pc1.addEventListener("icecandidate",this.onIceCandidate_.bind(this,this.pc2));this.pc2.addEventListener("icecandidate",
this.onIceCandidate_.bind(this,this.pc1));this.iceCandidateFilter_=e.noFilter}var u=n(13),m=n(1);e.prototype={establishConnection:function(){this.pc1.createOffer().then(this.gotOffer_.bind(this),this.test.reportFatal.bind(this.test))},close:function(){this.pc1.close();this.pc2.close()},setIceCandidateFilter:function(d){this.iceCandidateFilter_=d},constrainVideoBitrate:function(d){this.constrainVideoBitrateKbps_=d},disableVideoFec:function(){this.constrainOfferToRemoveVideoFec_=!0},gatherStats:function(d,
a,b,g){function e(){"closed"===d.signalingState?(c.statsGatheringRunning=!1,g(m,l,t,q)):(d.getStats().then(k).catch(function(a){c.test.reportError("Could not gather stats: "+a);c.statsGatheringRunning=!1;g(m,l)}),a&&a.getStats().then(p))}function p(a){"chrome"===adapter.browserDetails.browser?(a=u.enumerateStats(a,c.localTrackIds,c.remoteTrackIds),t.push(a),q.push(Date.now())):"firefox"===adapter.browserDetails.browser?(a=u.enumerateStatsFirefox(a),t.push(a),q.push(Date.now())):c.test.reportError("Only Firefox and Chrome getStats implementations are supported.")}
function k(a){"chrome"===adapter.browserDetails.browser?(a=u.enumerateStats(a,c.localTrackIds,c.remoteTrackIds),m.push(a),l.push(Date.now())):"firefox"===adapter.browserDetails.browser?(a=u.enumerateStatsFirefox(a),m.push(a),l.push(Date.now())):c.test.reportError("Only Firefox and Chrome getStats implementations are supported.");setTimeout(e,100)}var m=[],t=[],l=[],q=[],c=this;c.localTrackIds={audio:"",video:""};c.remoteTrackIds={audio:"",video:""};d.getSenders().forEach(function(a){"audio"===a.track.kind?
c.localTrackIds.audio=a.track.id:"video"===a.track.kind&&(c.localTrackIds.video=a.track.id)});a&&a.getReceivers().forEach(function(a){"audio"===a.track.kind?c.remoteTrackIds.audio=a.track.id:"video"===a.track.kind&&(c.remoteTrackIds.video=a.track.id)});this.statsGatheringRunning=!0;e()},gotOffer_:function(d){this.constrainOfferToRemoveVideoFec_&&(d.sdp=d.sdp.replace(/(m=video 1 [^\r]+)(116 117)(\r\n)/g,"$1\r\n"),d.sdp=d.sdp.replace(/a=rtpmap:116 red\/90000\r\n/g,""),d.sdp=d.sdp.replace(/a=rtpmap:117 ulpfec\/90000\r\n/g,
""),d.sdp=d.sdp.replace(/a=rtpmap:98 rtx\/90000\r\n/g,""),d.sdp=d.sdp.replace(/a=fmtp:98 apt=116\r\n/g,""));this.pc1.setLocalDescription(d);this.pc2.setRemoteDescription(d);this.pc2.createAnswer().then(this.gotAnswer_.bind(this),this.test.reportFatal.bind(this.test))},gotAnswer_:function(d){this.constrainVideoBitrateKbps_&&(d.sdp=d.sdp.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+this.constrainVideoBitrateKbps_+"\r\n"));this.pc2.setLocalDescription(d);this.pc1.setRemoteDescription(d)},onIceCandidate_:function(d,
a){if(a.candidate){var b=e.parseCandidate(a.candidate.candidate);this.iceCandidateFilter_(b)&&d.addIceCandidate(a.candidate)}}};e.noFilter=function(){return!0};e.isRelay=function(d){return"relay"===d.type};e.isNotHostCandidate=function(d){return"host"!==d.type};e.isReflexive=function(d){return"srflx"===d.type};e.isHost=function(d){return"host"===d.type};e.isIpv6=function(d){return void 0!==d.address&&-1!==d.address.indexOf(":")};e.parseCandidate=function(d){var a=d.indexOf("candidate:")+10;d=d.substr(a).split(" ");
return{type:d[7],protocol:d[2],address:d[4]}};e.cachedIceServers_=null;e.cachedIceConfigFetchTime_=null;e.asyncCreateTurnConfig=function(d,a,b){a=m.ice_servers[b];""!==a.turnURI&&setTimeout(d.bind(null,{iceServers:[{username:a.turnUsername,credential:a.turnCredential,urls:a.turnURI}]}),0)};e.asyncCreateStunConfig=function(d,a,b){a=m.ice_servers[b];""!==a.stunURI&&setTimeout(d.bind(null,{iceServers:[{urls:a.stunURI}]}),0)};l.exports=e},function(l,r,n){l=function(){for(var e,l,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),
d=[],a=0;a<m.length;a+=1)d[m[a]]=a;var b=function(){if(!e||l>=e.length)return-1;var a=e.charCodeAt(l)&255;l+=1;return a},g=function(){if(!e)return-1;for(;;){if(l>=e.length)return-1;var a=e.charAt(l);l+=1;if(d[a])return d[a];if("A"===a)return 0}},x=function(a){a=a.toString(16);1===a.length&&(a="0"+a);return unescape("%"+a)};return{encodeBase64:function(a){var d;e=a;l=0;a="";var g=Array(3);var p=0;for(d=!1;!d&&-1!==(g[0]=b());)g[1]=b(),g[2]=b(),a+=m[g[0]>>2],-1!==g[1]?(a+=m[g[0]<<4&48|g[1]>>4],-1!==
g[2]?(a+=m[g[1]<<2&60|g[2]>>6],a+=m[g[2]&63]):(a+=m[g[1]<<2&60],a+="=",d=!0)):(a+=m[g[0]<<4&48],a+="=",a+="=",d=!0),p+=4,76<=p&&(a+="\n",p=0);return a},decodeBase64:function(a){var b;e=a;l=0;a="";var d=Array(4);for(b=!1;!b&&-1!==(d[0]=g())&&-1!==(d[1]=g());)d[2]=g(),d[3]=g(),a+=x(d[0]<<2&255|d[1]>>4),-1!==d[2]?(a+=x(d[1]<<4&255|d[2]>>2),-1!==d[3]?a+=x(d[2]<<6&255|d[3]):b=!0):b=!0;return a}}}();r.a=l},function(l,r,n){r.c=function(e,d,a){try{return e.pipeThrough(new TransformStream(d))}catch(g){var b=
e.getReader();return new ReadableStream({start:function(a){if(d.start)return d.start(a)},pull:function(a){var g,k,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(p){switch(p.nextAddress){case 1:g=!1,k={enqueue:function(b){g=!0;a.enqueue(b)}};case 2:if(g){p.jumpTo(0);break}return p.yield(b.read(),4);case 4:e=p.yieldResult;if(!e.done){p.jumpTo(5);break}if(!d.flush){p.jumpTo(6);break}return p.yield(d.flush(a),6);case 6:return p.return(a.close());case 5:return p.yield(d.transform(e.value,
k),2)}})},cancel:function(b){e.cancel(b);a&&a(b)}})}};r.a=function(m,d){return new ReadableStream(new e(m,d))};r.b=function(e){return new ReadableStream(new u(e))};var e=function(e,d){this.blob=e;this.index=0;this.chunkSize=d||65536};e.prototype.pull=function(e){var d=this;return new Promise(function(a,b){var g=d.blob.size-d.index;if(0>=g)return e.close(),a();g=Math.min(d.chunkSize,g);var m=d.blob.slice(d.index,d.index+g),p=new FileReader;p.onload=function(){e.enqueue(new Uint8Array(p.result));a()};
p.onerror=b;p.readAsArrayBuffer(m);d.index+=g})};var u=function(e){this.streams=e;this.index=0;this.reader=null;this.nextReader()};u.prototype.nextReader=function(){var e=this.streams[this.index++];this.reader=e&&e.getReader()};u.prototype.pull=function(e){var d=this,a;return $jscomp.asyncExecutePromiseGeneratorProgram(function(b){if(1==b.nextAddress)return d.reader?b.yield(d.reader.read(),2):b.return(e.close());a=b.yieldResult;if(a.done)return d.nextReader(),b.return(d.pull(e));e.enqueue(a.value);
b.jumpToEnd()})}},function(l,r){function n(e,l){if(!e)throw Error(l||"AssertionError");}n.notEqual=function(e,l,m){n(e!=l,m)};n.notOk=function(e,l){n(!e,l)};n.equal=function(e,l,m){n(e==l,m)};n.ok=n;l.exports=n},function(l,r,n){var e=n(12);n.n(e);var u=n(29),m=new TextEncoder,d=new TextDecoder;l=function(a,b){this._nonce=b||"yRCdyQ1EMSA3mo4rqSkuNQ==";this.rawSecret=a?Object(e.b64ToArray)(a):crypto.getRandomValues(new Uint8Array(16));this.secretKeyPromise=crypto.subtle.importKey("raw",this.rawSecret,
"HKDF",!1,["deriveKey"]);this.metaKeyPromise=this.secretKeyPromise.then(function(a){return crypto.subtle.deriveKey({name:"HKDF",salt:new Uint8Array,info:m.encode("metadata"),hash:"SHA-256"},a,{name:"AES-GCM",length:128},!1,["encrypt","decrypt"])});this.authKeyPromise=this.secretKeyPromise.then(function(a){return crypto.subtle.deriveKey({name:"HKDF",salt:new Uint8Array,info:m.encode("authentication"),hash:"SHA-256"},a,{name:"HMAC",hash:{name:"SHA-256"}},!0,["sign"])})};l.prototype.setPassword=function(a,
b){this.authKeyPromise=crypto.subtle.importKey("raw",m.encode(a),{name:"PBKDF2"},!1,["deriveKey"]).then(function(a){return crypto.subtle.deriveKey({name:"PBKDF2",salt:m.encode(b),iterations:100,hash:"SHA-256"},a,{name:"HMAC",hash:"SHA-256"},!0,["sign"])})};l.prototype.setAuthKey=function(a){this.authKeyPromise=crypto.subtle.importKey("raw",Object(e.b64ToArray)(a),{name:"HMAC",hash:"SHA-256"},!0,["sign"])};l.prototype.authKeyB64=function(){var a=this,b,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==
g.nextAddress)return g.yield(a.authKeyPromise,2);if(3!=g.nextAddress)return b=g.yieldResult,g.yield(crypto.subtle.exportKey("raw",b),3);d=g.yieldResult;return g.return(Object(e.arrayToB64)(new Uint8Array(d)))})};l.prototype.authHeader=function(){var a=this,b,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress)return g.yield(a.authKeyPromise,2);if(3!=g.nextAddress)return b=g.yieldResult,g.yield(crypto.subtle.sign({name:"HMAC"},b,Object(e.b64ToArray)(a.nonce)),3);d=
g.yieldResult;return g.return("send-v1 "+Object(e.arrayToB64)(new Uint8Array(d)))})};l.prototype.encryptMetadata=function(a){var b=this,d,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress)return g.yield(b.metaKeyPromise,2);if(3!=g.nextAddress)return d=g.yieldResult,g.yield(crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(12),tagLength:128},d,m.encode(JSON.stringify({name:a.name,size:a.size,type:a.type||"application/octet-stream",manifest:a.manifest||{},roomMeta:a.roomMeta||
{}}))),3);e=g.yieldResult;return g.return(e)})};l.prototype.encryptStream=function(a){return Object(u.c)(a,this.rawSecret)};l.prototype.decryptStream=function(a){return Object(u.b)(a,this.rawSecret)};l.prototype.decryptMetadata=function(a){var b=this,g,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(p){if(1==p.nextAddress)return p.yield(b.metaKeyPromise,2);if(3!=p.nextAddress)return g=p.yieldResult,p.yield(crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(12),tagLength:128},g,
a),3);e=p.yieldResult;return p.return(JSON.parse(d.decode(e)))})};$jscomp.global.Object.defineProperties(l.prototype,{nonce:{configurable:!0,enumerable:!0,get:function(){return this._nonce},set:function(a){a&&a!==this._nonce&&(this._nonce=a)}}});r.a=l},function(l,r,n){var e=n(24),u=n(0),m=n(7),d=n(5);n(8);n(9);l=n(1);var a=n.n(l);r.a=function(b){function g(){return document.getElementById("WebrtcEverywherePluginId")}function l(a,c,b){a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next())if(d=
d.value,d.media.toLowerCase()===c.toLowerCase()){d=$jscomp.makeIterator(d.codecs);for(var g=d.next();!g.done;g=d.next())if(g=g.value,g.name.toLowerCase()===b.toLowerCase())return g}}var p={},k;p.remoteDesc=void 0;u["default"].info("Starting Base stack",b);p.pcConfig={iceServers:[]};p.con={};void 0!==b.iceServers&&(p.pcConfig.iceServers=b.iceServers);!0===b.forceTurn&&(p.pcConfig.iceTransportPolicy="relay");void 0===b.audio&&(b.audio=!0);void 0===b.video&&(b.video=!0);b.remoteCandidates=[];b.localCandidates=
[];b.remoteDescriptionSet=!1;p.mediaConstraints={offerToReceiveVideo:void 0!==b.video&&!1!==b.video,offerToReceiveAudio:void 0!==b.audio&&!1!==b.audio};var v=function(a){return g().createSessionDescription(a)},t=function(a,c){return g().createPeerConnection(a,c)};"IE"===m.a.browserEngineCheck()?p.peerConnection=t(p.pcConfig,p.con):p.peerConnection=new RTCPeerConnection(p.pcConfig,p.con);var w=function(a){k=a;k.sdp=k.sdp.replace("a=sendrecv","a=sendonly");n(!1,a)},q=function(a){k=a;n(!0,a)},c=function(a,
c,b){u["default"].error("message:",b,"in baseStack at",a);void 0!==c&&c("error")},n=function(a,c){k=c;a||(k.sdp=p.enableSimulcast(k.sdp));a||"safari"!==m.a.browserEngineCheck()||(k.sdp=k.sdp.replace("a=sendrecv","a=sendonly"));k.sdp=e.a.setMaxBW(k.sdp,b);b.callback({type:k.type,sdp:k.sdp})},r=function(a,c){var b={};b.sdp=a.sdp;b.type=a.type;if(c===d.a.constant.H264_CODEC)c=l(a.media,"video","vp8"),a=l(a.media,"video","h264");else if(c===d.a.constant.default)c=l(a.media,"video","h264"),a=l(a.media,
"video","vp8"),void 0!=c&&(b.sdp=b.sdp.replace("a=fmtp:"+c.payload+" level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f\r\n",""));else return b;void 0!=c&&(b.sdp=b.sdp.replace("a=rtpmap:"+c.payload+" "+c.name+"/90000\r\n",""),b.sdp=b.sdp.replace("m=video 1 UDP/TLS/RTP/SAVPF "+a.payload+" "+c.payload+"\r\n","m=video 1 UDP/TLS/RTP/SAVPF "+a.payload+"\r\n"),b.sdp=b.sdp.replace("m=video 1 UDP/TLS/RTP/SAVPF "+c.payload+" "+a.payload+"\r\n","m=video 1 UDP/TLS/RTP/SAVPF "+a.payload+"\r\n"),
b.sdp=b.sdp.replace("a=rtcp-fb:"+c.payload+" ccm fir\r\n",""),b.sdp=b.sdp.replace("a=rtcp-fb:"+c.payload+" nack\r\n",""),b.sdp=b.sdp.replace("a=rtcp-fb:"+c.payload+" nack pli\r\n",""),b.sdp=b.sdp.replace("a=rtcp-fb:"+c.payload+" goog-remb\r\n",""));return b};p.resetSDP=function(a){var b=r(p.remoteDesc,a);p.peerConnection.createOffer({offerToReceiveVideo:!0,offerToReceiveAudio:!0,iceRestart:!1}).then(function(a){u["default"].info("OFFER: - \n"+a.sdp);u["default"].info("RECVD ANSWER B4: - \n"+p.remoteDesc.sdp);
p.peerConnection.setLocalDescription(a).then(function(){u["default"].info("ANSWER: - \n"+b.sdp);p.peerConnection.setRemoteDescription(new RTCSessionDescription(b))}).catch(c.bind(null,"processAnswer",void 0))}).catch(function(a){u["default"].info(a)})};var z=function(g,q){var t=g;u["default"].info("Set remote and local description");u["default"].debug("Remote Description",t.sdp);u["default"].debug("Local Description",k.sdp);t.sdp=e.a.setMaxBW(t.sdp,b);p.remoteDesc=JSON.parse(JSON.stringify(t));if("IE"===
m.a.browserEngineCheck()){p.peerConnection.setLocalDescription(k);u["default"].info("Remote msg details for sdp:- "+JSON.stringify(t));p.peerConnection.setRemoteDescription(v(t));b.remoteDescriptionSet=!0;for(u["default"].info("Candidates to be added: ",b.remoteCandidates.length,b.remoteCandidates);0<b.remoteCandidates.length;)p.peerConnection.addIceCandidate(b.remoteCandidates.shift());for(u["default"].info("Local candidates to send:",b.localCandidates.length);0<b.localCandidates.length&&!p.peerConnection;)b.callback({type:"candidate",
candidate:b.localCandidates.shift()})}else u["default"].debug("Remote Description",p.remoteDesc.sdp),p.peerConnection.setLocalDescription(k).then(function(){t="safari"===a.a.browser_info.name&&a.a.browser_info.version>=d.a.constant.SAFARI_VERSION_SUPPORTING_VP8&&q!==d.a.constant.H264_CODEC?r(t,d.a.constant.default):"safari"===a.a.browser_info.name&&a.a.browser_info.version<=d.a.constant.SAFARI_VERSION_NOT_SUPPORTING_VP8&&q!==d.a.constant.H264_CODEC?r(t,d.a.constant.H264_CODEC):r(t,d.a.constant.default);
u["default"].debug("Remote Description",p.remoteDesc.sdp);p.peerConnection.setRemoteDescription(new RTCSessionDescription(t)).then(function(){b.remoteDescriptionSet=!0;u["default"].info("Candidates to be added: ",b.remoteCandidates.length,b.remoteCandidates);for(var a={};0<b.remoteCandidates.length;)a.$jscomp$loop$prop$cand$235=b.remoteCandidates.shift(),p.peerConnection.addIceCandidate(a.$jscomp$loop$prop$cand$235).then(function(a){return function(){u["default"].debug("process answer adding remote ice cand Success: "+
JSON.stringify(a.$jscomp$loop$prop$cand$235))}}(a)).catch(function(a){return function(c){u["default"].error("process answer Failed addIceCandidate(): "+c+" cand: "+JSON.stringify(a.$jscomp$loop$prop$cand$235))}}(a)),a={$jscomp$loop$prop$cand$235:a.$jscomp$loop$prop$cand$235};for(u["default"].info("Local candidates to send:",b.localCandidates.length);0<b.localCandidates.length;)b.callback({type:"candidate",candidate:b.localCandidates.shift()})}).catch(c.bind(null,"processAnswer",void 0))}).catch(c.bind(null,
"processAnswer",void 0))},K=function(a){try{var c="object"===typeof a.candidate?a.candidate:JSON.parse(a.candidate);if("end"===c.candidate)console.log("end candidates: ignore");else{c.candidate=c.candidate.replace(/a=/g,"");c.sdpMLineIndex=parseInt(c.sdpMLineIndex,10);c.sdpMid="audio"!=c.sdpMid&&b.audio?1:0;var d=new RTCIceCandidate(c);b.remoteDescriptionSet?p.peerConnection.addIceCandidate(d).then(function(){u["default"].info("IN adding remote ice candidate Success: "+JSON.stringify(c))}).catch(function(a){u["default"].error("addIceCandidate() Failed err: "+
a+" cand: "+JSON.stringify(c))}):(u["default"].debug("queuing candidates since remote description not set: "+JSON.stringify(c)),b.remoteCandidates.push(d))}}catch(F){u["default"].error("Error parsing candidate error: "+F+" cand:"+a.candidate)}};p.peerConnection.onicecandidate=function(a){(a=a.candidate)?a={sdpMLineIndex:a.sdpMLineIndex,sdpMid:a.sdpMid,candidate:"a="+a.candidate}:(u["default"].info("Gathered all candidates. Sending END candidate"),a={sdpMLineIndex:-1,sdpMid:"end",candidate:"end"});
b.remoteDescriptionSet?b.callback({type:"candidate",candidate:a}):(b.localCandidates.push(a),u["default"].info("Storing candidate: ",b.localCandidates.length,a))};p.peerConnection.onaddstream=function(a){if(p.onaddstream)p.onaddstream(a)};p.peerConnection.onremovestream=function(a){if(p.onremovestream)p.onremovestream(a)};p.peerConnection.oniceconnectionstatechange=function(a){p.oniceconnectionstatechange&&(u["default"].debug("ICE connection state changed",a.currentTarget.iceConnectionState),u["default"].debug("ICE gathering state changed",
a.currentTarget.iceGatheringState),p.oniceconnectionstatechange(a.currentTarget.iceConnectionState))};p.peerConnection.onconnectionstatechange=function(a){p.onconnectionstatechange&&(u["default"].debug("Peer connection state changed",p.peerConnection.connectionState),p.onconnectionstatechange(p.peerConnection.connectionState))};p.enableSimulcast=function(a){u["default"].error("Simulcast not implemented");return a};p.updateSimulcastLayersBitrate=function(a){p.simulcast&&(p.simulcast.spatialLayerBitrates=
a,p.setSimulcastLayersBitrate())};p.setSimulcastLayersBitrate=function(){u["default"].error("Simulcast not implemented")};p.setSimulcast=function(a){p.simulcast=a};p.close=function(){p.state="closed";p.peerConnection.close()};p.updateSpec=function(a,d){d=void 0===d?function(){}:d;if(a.maxVideoBW||a.maxAudioBW)a.maxVideoBW&&(u["default"].debug("Maxvideo Requested:",a.maxVideoBW,"limit:",b.limitMaxVideoBW),a.maxVideoBW>b.limitMaxVideoBW&&(a.maxVideoBW=b.limitMaxVideoBW),b.maxVideoBW=a.maxVideoBW,u["default"].debug("Result",
b.maxVideoBW)),a.maxAudioBW&&(a.maxAudioBW>b.limitMaxAudioBW&&(a.maxAudioBW=b.limitMaxAudioBW),b.maxAudioBW=a.maxAudioBW),k.sdp=e.a.setMaxBW(k.sdp,b),a.Sdp||a.maxAudioBW?(u["default"].debug("Updating with SDP renegotiation",b.maxVideoBW,b.maxAudioBW),p.peerConnection.setLocalDescription(k).then(function(){p.remoteDesc.sdp=e.a.setMaxBW(p.remoteDesc.sdp,b);return p.peerConnection.setRemoteDescription(new RTCSessionDescription(p.remoteDesc))}).then(function(){b.remoteDescriptionSet=!0;b.callback({type:"updatestream",
sdp:k.sdp})}).catch(c.bind(null,"updateSpec",d))):(u["default"].debug("Updating without SDP renegotiation, newVideoBW:",b.maxVideoBW,"newAudioBW:",b.maxAudioBW),b.callback({type:"updatestream",sdp:k.sdp}));if(a.minVideoBW||void 0!==a.slideShowMode||void 0!==a.muteStream||void 0!==a.qualityLayer||void 0!==a.video)u["default"].debug("MinVideo Changed to ",a.minVideoBW),u["default"].debug("SlideShowMode Changed to ",a.slideShowMode),u["default"].debug("muteStream changed to ",a.muteStream),u["default"].debug("Video Constraints",
a.video),b.callback({type:"updatestream",config:a})};p.createOffer=function(a,b){!0!==a&&(p.mediaConstraints={offerToReceiveVideo:!1,offerToReceiveAudio:!1});b&&(p.mediaConstraints.iceRestart=b);u["default"].debug("Creating offer :-"+JSON.stringify(p.mediaConstraints));"IE"===m.a.browserEngineCheck()?!0!==a?p.peerConnection.createOffer(w,c):p.peerConnection.createOffer(q,c,{optional:[{OfferToReceiveAudio:!0},{OfferToReceiveVideo:!0}]}):p.peerConnection.createOffer(p.mediaConstraints).then(n.bind(null,
a)).catch(c.bind(null,"Create Offer",void 0))};p.addStream=function(a){p.peerConnection.addStream(a)};p.addTrack=function(a){p.peerConnection.addTrack(a)};p.processSignalingMessage=function(a,c){"answer"===a.type?z(a,c):"candidate"===a.type&&K(a)};return p}},function(l,r,n){r.a={addSim:function(e){var l="a=ssrc-group:SIM";e.forEach(function(e){l+=" "+e});return l+"\r\n"},addGroup:function(e,l){return"a=ssrc-group:FID "+e+" "+l+"\r\n"},addSpatialLayer:function(e,l,m,d,a,b){return"a=ssrc:"+a+" cname:"+
e+"\r\na=ssrc:"+(a+" msid:"+l+"\r\na=ssrc:")+(a+" mslabel:"+m+"\r\na=ssrc:")+(a+" label:"+d+"\r\na=ssrc:")+(b+" cname:"+e+"\r\na=ssrc:")+(b+" msid:"+l+"\r\na=ssrc:")+(b+" mslabel:"+m+"\r\na=ssrc:")+(b+" label:"+d+"\r\n")},setMaxBW:function(e,l){var m=e;if(l.video&&l.maxVideoBW){m=m.replace(/b=AS:.*\r\n/g,"");var d=m.match(/m=video.*\r\n/);null==d&&(d=m.match(/m=video.*\n/));d&&0<d.length&&(e=d[0]+"b=AS:"+l.maxVideoBW+"\r\n",m=m.replace(d[0],e))}l.audio&&l.maxAudioBW&&(d=m.match(/m=audio.*\r\n/),null==
d&&(d=m.match(/m=audio.*\n/)),d&&0<d.length&&(e=d[0]+"b=AS:"+l.maxAudioBW+"\r\n",m=m.replace(d[0],e)));return m},enableOpusNacks:function(e){var l=e.match(/a=rtpmap:(.*)opus.*\r\n/);null!==l&&(e=e.replace(l[0],l[0]+"a=rtcp-fb:"+l[1]+"nack\r\n"));return e}}},function(l,r,n){var e=n(6);r.a=function(l){return"OverconstrainedError"===l.name&&"deviceId"===l.constraint?e.a.error_1142:"OverconstrainedError"!=l.name&&"ConstraintNotSatisfiedError"!=l.name||"width"!==l.constraint?"OverconstrainedError"!=l.name&&
"ConstraintNotSatisfiedError"!=l.name||"height"!==l.constraint?"OverconstrainedError"!=l.name&&"ConstraintNotSatisfiedError"!=l.name||l.constraint?"NotFoundError"==l.name||"DevicesNotFoundError"==l.name?e.a.error_1143:"NotReadableError"==l.name||"TrackStartError"==l.name?e.a.error_1145:"NotAllowedError"==l.name||"PermissionDeniedError"==l.name?e.a.error_1144:"TypeError"==l.name||"TypeError"==l.name?e.a.error_1146:e.a.error_1150:e.a.error_1149:e.a.error_1148:e.a.error_1147}},function(l,r,n){var e=
n(2),u=n(15),m=n(3),d=n(27);l=n(1);var a=n.n(l);r.a=function(b){var g=Object(e.a)({}),l=Object(u.a)().player.default;if(m.a.checkParam(b.options)&&m.a.checkParam(b.options.player)){var p=b.options.player;m.a.checkParam(p.autoplay)&&(l.autoplay=p.autoplay);m.a.checkParam(p.name)&&(l.name=p.name);m.a.checkParam(p.nameDisplayMode)&&(l.nameDisplayMode=p.nameDisplayMode);m.a.checkParam(p.frameFitMode)&&(l.frameFitMode=p.frameFitMode);m.a.checkParam(p.skin)&&(l.skin=p.skin);m.a.checkParam(p.class)&&(l.class=
p.class);m.a.checkParam(p.height)&&(l.height=p.height);m.a.checkParam(p.width)&&(l.width=p.width);m.a.checkParam(p.minHeight)&&(l.minHeight=p.minHeight);m.a.checkParam(p.minWidth)&&(l.minWidth=p.minWidth);m.a.checkParam(p.aspectRatio)&&(l.aspectRatio=p.aspectRatio);m.a.checkParam(p.volume)&&(l.volume=p.volume);m.a.checkParam(p.backgroundImg)&&(l.backgroundImg=p.backgroundImg);m.a.checkParam(p.media)&&(l.media=p.media);m.a.checkParam(p.loader)&&(p=p.loader,m.a.checkParam(p.url)&&(l.loader.url=p.url),
l.loader.show=p.show,m.a.checkParam(p.class)&&(l.loader.class=p.class),m.a.checkParam(p.style)&&(l.loader.style=p.style))}g.id=b.id;g.stream=b.videoSource;g.elementID=b.elementID;g.abwd={};g.abwd.notification=!0;g.abwd.lang="en";m.a.checkParam(b.options)&&m.a.checkParam(b.options.player)&&m.a.checkParam(b.options.player.abwd)&&(p=b.options.player.abwd,!1===p.enabled?g.abwd.notification=!1:!0===p.enabled&&"sdk"===p.notification?(g.abwd.notification=!0,g.abwd.lang="en"===p.language||"zh"===p.language?
p.language:"en"):!0===p.enabled&&"app"===p.notification&&(g.abwd.notification=!1,g.abwd.lang=""));p=m.a.getById(b.elementID);p.style.height=l.height;p.style.width=l.width;p.style.minHeight=l.minHeight;p.style.minWidth=l.minWidth;var k=function(a,c,b,d){(d?1/a*c>b:1/a*c<b)?(g.video.style.width=c+"px",g.video.style.height=1/a*c+"px",g.video.style.top=-(1/a*c/2-b/2)+"px",g.video.style.left="0px"):(g.video.style.height=b+"px",g.video.style.width=a*b+"px",g.video.style.left=-(a*b/2-c/2)+"px",g.video.style.top=
"0px");g.video.style.overflow="hidden"};g.destroy=function(){console.log("video player destroy ");g.video.pause();if(a.a.csp_enabled)g.container.removeChild(g.div);else{delete g.resizer;try{g.div.removeChild(v),g.div.removeChild(q)}catch(K){console.log("error videoplayer.destroy() removeChild err: "+K)}}};g.resize=function(){var a=g.container.offsetWidth,c=g.container.offsetHeight;b.stream.screen||!1===b.options.crop||b.stream.canvas?k(16/9,a,c,!1):(a!==g.containerWidth||c!==g.containerHeight)&&k(4/
3,a,c,!0);g.containerWidth=a;g.containerHeight=c};p=b.stream.getPlayerId(b.vroom?b.vroom:b.stream.room);g.div=a.a.csp_enabled?Object(m.a)({name:"div",id:""+p.player,class:"vcx_player "+l.skin+"_vcx_player"}):Object(m.a)({name:"div",id:""+p.player,class:"vcx_player "+l.skin+"_vcx_player",style:{"object-position":"65% 50%"}});l.loader.url&&(g.loader=Object(m.a)({name:"img",src:l.loader.url,id:"back_"+g.id,class:"vcx_player_loader "+l.loader.class+" "+l.skin+"_vcx_player_loader"}),l.loader.show||(g.loader.style.display=
"none"));l.backgroundImg&&(g.screenSaver=Object(m.a)({name:"img",src:l.backgroundImg,id:"screen_saver_"+g.id,class:"vcx_player_screen_saver "+l.skin+"_vcx_player_screen_saver"}),g.screenSaver.style.display="none");l={name:"video",id:""+p.stream,class:"vcx_stream "+l.skin+"_vcx_stream"};b.extraPlayerOptions.autoplay&&(l.autoplay=b.extraPlayerOptions.autoplay);b.extraPlayerOptions.playsinline&&(l.playsinline=b.extraPlayerOptions.playsinline);g.video=Object(m.a)(l);b.stream.local&&(g.video.volume=0);
g.container=void 0!==g.elementID?"object"===typeof g.elementID&&"function"===typeof g.elementID.appendChild?g.elementID:m.a.getById(g.elementID):document.body;g.container.appendChild(g.div);g.parentNode=g.div.parentNode;var v=void 0,t=void 0,w=void 0,q=void 0,c=void 0,n=void 0,r=void 0;if(!a.a.csp_enabled){t=document.createElement("div");t.setAttribute("id","stats-container-"+g.id);t.setAttribute("class","stats-container");t.setAttribute("style","display:none;");v=document.createElement("div");v.setAttribute("id",
"bw-notif-"+g.id);v.setAttribute("class","bw-notification");v.setAttribute("style","display:none;");if(a.a.alertNotifyInfo&&a.a.alertNotifyInfo.mode&&"image"==a.a.alertNotifyInfo.mode){var z=document.createElement("div");z.setAttribute("id","icon-bw-low-"+g.id);z.setAttribute("class","icon-bw");z.innerHTML=window.lowBwIcon;v.appendChild(z)}w=document.createElement("div");w.setAttribute("id","stats-button-"+g.id);w.setAttribute("class","stats-button");w.setAttribute("title","Click to see stats");w.innerHTML=
window.statsIcon;t.appendChild(w);q=document.createElement("div");q.setAttribute("class","stats-overlay");q.setAttribute("id","stats-overlay-"+g.id);q.setAttribute("style","display: none;\n            position: absolute;z-index: 3;\n            padding: 5px;top: 0px;right: 0px;\n            background: linear-gradient(90deg,rgb(204 41 42 / 62%),#a20a90b0);\n            border-radius: 5px;color: #fff;width: 100%;");c=document.createElement("div");c.setAttribute("class","stats-overlay-inner");c.setAttribute("id",
"stats-overlay-inner-"+g.id);n=document.createElement("div");r=document.createElement("div");n.setAttribute("class","stats-left-partition");n.setAttribute("id","stats-left-part-"+g.id);r.setAttribute("class","stats-right-partition");r.setAttribute("id","stats-right-part-"+g.id);w.addEventListener("click",function(){q.style.display="none"===q.style.display?"block":"none"});g.div.parentNode.style.position="relative";g.div.appendChild(t);g.div.appendChild(q);q.appendChild(c);g.div.appendChild(v);c.appendChild(n);
c.appendChild(r)}g.loader&&g.div.appendChild(g.loader);g.screenSaver&&g.div.appendChild(g.screenSaver);g.div.appendChild(g.video);g.containerWidth=0;g.containerHeight=0;!a.a.csp_enabled&&b.options&&!1!==b.options.resizer&&(g.resizer=L.ResizeSensor(g.container,g.resize),g.resize());!1===b.options.bar&&(g.media=g.video);g.video.srcObject=g.stream;g.ShowSessionStats=function(c){a.a.csp_enabled||(!0===c?(t.setAttribute("style","display:block;"),q.setAttribute("style","display:block;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);")):
(t.setAttribute("style","display:none;"),q.setAttribute("style","display:none;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);")))};g.streamUpdated=function(a){a!=g.id&&(g.id=a,g.video&&(a=b.stream.getPlayerId(b.vroom?b.vroom:b.stream.room),g.div.setAttribute("id",""+a.player),g.video.setAttribute("id",""+a.stream),void 0!=g.loader&&g.loader.setAttribute("id","back_"+g.id),void 0!=g.screenSaver&&g.screenSaver.setAttribute("id","screen_saver_"+g.id),void 0!=
t&&t.setAttribute("id","stats-container-"+g.id),void 0!=v&&v.setAttribute("id","bw-notif-"+g.id),void 0!=z&&z.setAttribute("id","icon-bw-low-"+g.id),void 0!=w&&w.setAttribute("id","bw-notif-"+g.id),void 0!=q&&q.setAttribute("id","stats-overlay-"+g.id),void 0!=c&&c.setAttribute("id","stats-overlay-inner-"+g.id),void 0!=n&&n.setAttribute("id","stats-left-part-"+g.id),void 0!=r&&r.setAttribute("id","stats-right-part-"+g.id)))};g.setBwAlert=function(c,b,k){!1===g.abwd.notification||a.a.csp_enabled||(!0===
c?(c="Low Bandwidth",a.a.alertNotifyInfo.customLowBw?c=a.a.alertNotifyInfo.customLowBw:g.abwd.lang&&""!=g.abwd.lang&&(c="subscriber"===b?d.a.abwd[g.abwd.lang].bw_alert_subscriber:k+d.a.abwd[g.abwd.lang].bw_alert_publisher),"text"==a.a.alertNotifyInfo.mode?(console.log("videoPlayer - setBwAlert(): setting  text id: "+g.id),v.innerText=c,v.setAttribute("style","display:block;position:absolute;z-index:3;padding:5px 10px;top:50%;right:50%"),v.setAttribute("style","transform:translateX(50%);background:rgba(0,0,0,0.29)"),
v.setAttribute("style","border-radius:5px;color:rgb(255,255,255)")):"image"==a.a.alertNotifyInfo.mode&&(console.log("videoPlayer - setBwAlert(): setting  image id: "+g.id),z.setAttribute("title",c),v.setAttribute("style","display:block;position:absolute;z-index:3;padding:5px;bottom:5%;right:5%"))):(console.log("videoPlayer - setBwAlert(): removing image/text  id: "+g.id),v.setAttribute("style","display:none")))};g.setVideoMutedMsg=function(c){if(!1!==g.abwd.notification&&!a.a.csp_enabled)if(!0===
c.videomuted&&"bw"===c.reason){var b="Video Muted";a.a.alertNotifyInfo.customVideoMute?b=a.a.alertNotifyInfo.customVideoMute:g.abwd.lang&&""!=g.abwd.lang&&(b=c.name+" "+d.a.abwd[g.abwd.lang].video_muted);"text"==a.a.alertNotifyInfo.mode?(v.innerText=b,v.setAttribute("style","display:block;position:absolute;z-index:3;padding:5px 10px;top:50%;right:50%"),v.setAttribute("style","transform:translateX(50%);background:rgba(0,0,0,0.29)"),v.setAttribute("style","border-radius:5px;color:rgb(255,255,255)")):
"image"==a.a.alertNotifyInfo.mode&&(z.setAttribute("title",b),v.setAttribute("style","display:block;position:absolute;z-index:3;padding:5px"))}else v.setAttribute("style","display:none")};return g}},function(l,r,n){r.a={abwd:{en:{bw_alert_publisher:" Low upload bandwidth",bw_alert_subscriber:" Low Download bandwidth",video_muted:" Video muted due to low bandwidth"},zh:{bw_alert_publisher:" \u7f51\u7edc\u4e0d\u597d",bw_alert_subscriber:"\u4f60\u7684\u4e0b\u8f7d\u5e26\u5bbd\u5f88\u4f4e",video_muted:" \u60a8\u7684\u89c6\u9891\u56e0\u5e26\u5bbd\u800c\u9759\u97f3"}}}},
function(l,r,n){function e(a){var b=a.length;if(0<b%4)throw Error("Invalid string. Length must be a multiple of 4");a=a.indexOf("=");-1===a&&(a=b);return[a,a===b?0:4-a%4]}function u(a,d,e){for(var b=[],g=d;g<e;g+=3)d=(a[g]<<16&16711680)+(a[g+1]<<8&65280)+(a[g+2]&255),b.push(m[d>>18&63]+m[d>>12&63]+m[d>>6&63]+m[d&63]);return b.join("")}r.byteLength=function(a){a=e(a);var b=a[1];return 3*(a[0]+b)/4-b};r.toByteArray=function(b){var g=e(b);var m=g[0];g=g[1];for(var p=new a(3*(m+g)/4-g),k=0,l=0<g?m-4:
m,t=0;t<l;t+=4)m=d[b.charCodeAt(t)]<<18|d[b.charCodeAt(t+1)]<<12|d[b.charCodeAt(t+2)]<<6|d[b.charCodeAt(t+3)],p[k++]=m>>16&255,p[k++]=m>>8&255,p[k++]=m&255;2===g&&(m=d[b.charCodeAt(t)]<<2|d[b.charCodeAt(t+1)]>>4,p[k++]=m&255);1===g&&(m=d[b.charCodeAt(t)]<<10|d[b.charCodeAt(t+1)]<<4|d[b.charCodeAt(t+2)]>>2,p[k++]=m>>8&255,p[k++]=m&255);return p};r.fromByteArray=function(a){for(var b=a.length,d=b%3,e=[],k=0,l=b-d;k<l;k+=16383)e.push(u(a,k,k+16383>l?l:k+16383));1===d?(a=a[b-1],e.push(m[a>>2]+m[a<<4&
63]+"==")):2===d&&(a=(a[b-2]<<8)+a[b-1],e.push(m[a>>10]+m[a>>4&63]+m[a<<2&63]+"="));return e.join("")};var m=[],d=[],a="undefined"!==typeof Uint8Array?Uint8Array:Array;for(l=0;64>l;++l)m[l]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[l],d["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(l)]=l;d[45]=62;d[95]=63},function(l,r,n){(function(e){r.c=function(d,e,p,k){p=void 0===p?65536:p;void 0===k&&(k=new Uint8Array(16),crypto.getRandomValues(k),k=k.buffer);
d=Object(m.c)(d,new b(p,"encrypt"));return Object(m.c)(d,new a("encrypt",e,p,k))};r.b=function(d,e,p){p=void 0===p?65536:p;d=Object(m.c)(d,new b(p,"decrypt"));return Object(m.c)(d,new a("decrypt",e,p))};var l=n(17);n.n(l);var m=n(20);r.a=65536;var d=new TextEncoder,a=function(a,b,d,k){this.mode=a;this.prevChunk;this.seq=0;this.firstchunk=!0;this.rs=d;this.ikm=b.buffer;this.salt=k};a.prototype.generateKey=function(){var a=this,b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==
g.nextAddress)return g.yield(crypto.subtle.importKey("raw",a.ikm,"HKDF",!1,["deriveKey"]),2);b=g.yieldResult;return g.return(crypto.subtle.deriveKey({name:"HKDF",salt:a.salt,info:d.encode("Content-Encoding: aes128gcm\x00"),hash:"SHA-256"},b,{name:"AES-GCM",length:128},!0,["encrypt","decrypt"]))})};a.prototype.generateNonceBase=function(){var a=this,b,p,k,m;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){switch(g.nextAddress){case 1:return g.yield(crypto.subtle.importKey("raw",a.ikm,
"HKDF",!1,["deriveKey"]),2);case 2:return b=g.yieldResult,p=crypto.subtle,k=p.exportKey,g.yield(crypto.subtle.deriveKey({name:"HKDF",salt:a.salt,info:d.encode("Content-Encoding: nonce\x00"),hash:"SHA-256"},b,{name:"AES-GCM",length:128},!0,["encrypt","decrypt"]),4);case 4:return g.yield(k.call(p,"raw",g.yieldResult),3);case 3:return m=g.yieldResult,g.return(e.from(m.slice(0,12)))}})};a.prototype.generateNonce=function(a){if(4294967295<a)throw Error("record sequence number exceeds limit");var b=e.from(this.nonceBase),
d=b.readUIntBE(b.length-4,4);b.writeUIntBE((d^a)>>>0,b.length-4,4);return b};a.prototype.pad=function(a,b){var d=a.length;if(d+16>=this.rs)throw Error("data too large for record size");if(b)return b=e.alloc(1),b.writeUInt8(2,0),e.concat([a,b]);b=e.alloc(this.rs-d-16);b.fill(0);b.writeUInt8(1,0);return e.concat([a,b])};a.prototype.unpad=function(a,b){for(var d=a.length-1;0<=d;d--)if(a[d]){if(b){if(2!==a[d])throw Error("delimiter of final record is not 2");}else if(1!==a[d])throw Error("delimiter of not final record is not 1");
return a.slice(0,d)}throw Error("no delimiter found");};a.prototype.createHeader=function(){var a=e.alloc(5);a.writeUIntBE(this.rs,0,4);a.writeUIntBE(0,4,1);return e.concat([e.from(this.salt),a])};a.prototype.readHeader=function(a){if(21>a.length)throw Error("chunk too small for reading header");var b={};b.salt=a.buffer.slice(0,16);b.rs=a.readUIntBE(16,4);a=a.readUInt8(20);b.length=a+16+5;return b};a.prototype.encryptRecord=function(a,b,d){var g=this,p,m;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){if(1==
k.nextAddress)return p=g.generateNonce(b),k.yield(crypto.subtle.encrypt({name:"AES-GCM",iv:p},g.key,g.pad(a,d)),2);m=k.yieldResult;return k.return(e.from(m))})};a.prototype.decryptRecord=function(a,b,d){var g=this,p,m;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){if(1==k.nextAddress)return p=g.generateNonce(b),k.yield(crypto.subtle.decrypt({name:"AES-GCM",iv:p,tagLength:128},g.key,a),2);m=k.yieldResult;return k.return(g.unpad(e.from(m),d))})};a.prototype.start=function(a){var b=this,
d,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){if(1==k.nextAddress){if("encrypt"!==b.mode){if("decrypt"!==b.mode)throw Error("mode must be either encrypt or decrypt");return k.jumpTo(0)}d=b;return k.yield(b.generateKey(),3)}if(4!=k.nextAddress)return d.key=k.yieldResult,g=b,k.yield(b.generateNonceBase(),4);g.nonceBase=k.yieldResult;a.enqueue(b.createHeader());k.jumpToEnd()})};a.prototype.transformPrevChunk=function(a,b){var d=this,g,e,m,l,q,c,x;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){switch(k.nextAddress){case 1:if("encrypt"===
d.mode)return c=b,x=c.enqueue,k.yield(d.encryptRecord(d.prevChunk,d.seq,a),9);if(0===d.seq)return m=d.readHeader(d.prevChunk),d.salt=m.salt,d.rs=m.rs,l=d,k.yield(d.generateKey(),7);g=b;e=g.enqueue;return k.yield(d.decryptRecord(d.prevChunk,d.seq-1,a),6);case 6:e.call(g,k.yieldResult);k.jumpTo(5);break;case 7:return l.key=k.yieldResult,q=d,k.yield(d.generateNonceBase(),8);case 8:q.nonceBase=k.yieldResult;case 5:d.seq++;k.jumpTo(0);break;case 9:x.call(c,k.yieldResult),d.seq++,k.jumpToEnd()}})};a.prototype.transform=
function(a,b){var d=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress)return d.firstchunk?g.jumpTo(2):g.yield(d.transformPrevChunk(!1,b),2);d.firstchunk=!1;d.prevChunk=e.from(a.buffer);g.jumpToEnd()})};a.prototype.flush=function(a){var b=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){return b.prevChunk?d.yield(b.transformPrevChunk(!0,a),0):d.jumpTo(0)})};var b=function(a,b){this.mode=b;this.rs=a;this.chunkSize="encrypt"===b?a-17:21;this.partialChunk=
new Uint8Array(this.chunkSize);this.offset=0};b.prototype.send=function(a,b){b.enqueue(a);21===this.chunkSize&&"decrypt"===this.mode&&(this.chunkSize=this.rs);this.partialChunk=new Uint8Array(this.chunkSize);this.offset=0};b.prototype.transform=function(a,b){var d=0;if(0<this.offset){var g=Math.min(a.byteLength,this.chunkSize-this.offset);this.partialChunk.set(a.slice(0,g),this.offset);this.offset+=g;d+=g;this.offset===this.chunkSize&&this.send(this.partialChunk,b)}for(;d<a.byteLength;)g=a.byteLength-
d,g>=this.chunkSize?(g=a.slice(d,d+this.chunkSize),d+=this.chunkSize,this.send(g,b)):(g=a.slice(d,d+g),d+=g.byteLength,this.partialChunk.set(g),this.offset=g.byteLength)};b.prototype.flush=function(a){0<this.offset&&a.enqueue(this.partialChunk.slice(0,this.offset))}}).call(r,n(17).Buffer)},function(l,r){r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(n){"object"===typeof window&&(r=window)}l.exports=r},function(l,r,n){function e(a){if(!(this instanceof e))return new e(a);
this._name=a||"nanobus";this._starListeners=[];this._listeners={}}var u=n(57),m=n(58),d=n(21);l.exports=e;e.prototype.emit=function(a){d.ok("string"===typeof a||"symbol"===typeof a,"nanobus.emit: eventName should be type string or symbol");for(var b=[],g=1,e=arguments.length;g<e;g++)b.push(arguments[g]);g=m(this._name+"('"+a.toString()+"')");(e=this._listeners[a])&&0<e.length&&this._emit(this._listeners[a],b);0<this._starListeners.length&&this._emit(this._starListeners,a,b,g.uuid);g();return this};
e.prototype.on=e.prototype.addListener=function(a,b){d.ok("string"===typeof a||"symbol"===typeof a,"nanobus.on: eventName should be type string or symbol");d.equal(typeof b,"function","nanobus.on: listener should be type function");"*"===a?this._starListeners.push(b):(this._listeners[a]||(this._listeners[a]=[]),this._listeners[a].push(b));return this};e.prototype.prependListener=function(a,b){d.ok("string"===typeof a||"symbol"===typeof a,"nanobus.prependListener: eventName should be type string or symbol");
d.equal(typeof b,"function","nanobus.prependListener: listener should be type function");"*"===a?this._starListeners.unshift(b):(this._listeners[a]||(this._listeners[a]=[]),this._listeners[a].unshift(b));return this};e.prototype.once=function(a,b){function g(){b.apply(e,arguments);e.removeListener(a,g)}d.ok("string"===typeof a||"symbol"===typeof a,"nanobus.once: eventName should be type string or symbol");d.equal(typeof b,"function","nanobus.once: listener should be type function");var e=this;this.on(a,
g);return this};e.prototype.prependOnceListener=function(a,b){function g(){b.apply(e,arguments);e.removeListener(a,g)}d.ok("string"===typeof a||"symbol"===typeof a,"nanobus.prependOnceListener: eventName should be type string or symbol");d.equal(typeof b,"function","nanobus.prependOnceListener: listener should be type function");var e=this;this.prependListener(a,g);return this};e.prototype.removeListener=function(a,b){function g(a,b){if(a&&(b=a.indexOf(b),-1!==b))return u(a,b,1),!0}d.ok("string"===
typeof a||"symbol"===typeof a,"nanobus.removeListener: eventName should be type string or symbol");d.equal(typeof b,"function","nanobus.removeListener: listener should be type function");if("*"===a)return this._starListeners=this._starListeners.slice(),g(this._starListeners,b);"undefined"!==typeof this._listeners[a]&&(this._listeners[a]=this._listeners[a].slice());return g(this._listeners[a],b)};e.prototype.removeAllListeners=function(a){a?"*"===a?this._starListeners=[]:this._listeners[a]=[]:(this._starListeners=
[],this._listeners={});return this};e.prototype.listeners=function(a){a="*"!==a?this._listeners[a]:this._starListeners;var b=[];if(a)for(var d=a.length,e=0;e<d;e++)b.push(a[e]);return b};e.prototype._emit=function(a,b,d,e){if("undefined"!==typeof a&&0!==a.length)for(void 0===d&&(d=b,b=null),b&&(d=void 0!==e?[b].concat(d,e):[b].concat(d)),b=a.length,e=0;e<b;e++){var g=a[e];g.apply(g,d)}}},function(l,r,n){Object.defineProperty(r,"__esModule",{value:!0});l=n(0);var e=n(11),u=n(4),m=n(14),d=n(15),a=n(26),
b=n(68),g=n(1);g=n.n(g);var x=n(69),p=n(78),k=n(79);k=n.n(k);n(80);g.a.csp_enabled||n(82);n={Logger:l["default"],clientDiagnostics:x.a.clientDiagnostics,clientBitrate:x.a.clientBitrate,appData:p.a,audience:k.a,EnxRoom:e.a.bind(null,void 0,void 0),Event:u.b,RoomEvent:u.e,StreamEvent:u.f,EnxStream:m.a.bind(null,void 0),VideoPlayer:a.a,ViewProperties:d.a,isSupported:g.a.is_supported,version:g.a.product.version,getDevices:b.a.getDevice,switchMediaDevice:b.a.switchMediaDevice,notifyDeviceUpdate:b.a.notifyDeviceUpdate,
joinRoom:b.a.joinRoom,listParticipants:b.a.listParticipants,getRoom:b.a.getRoom,browserInfo:g.a.browser_info};r["default"]=n},function(l,r,n){!function(e,n){l.exports=n()}(this,function(){var e=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,l=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m=function(a,b,d){var c=String(a);return!c||c.length>=b?a:""+Array(b+1-c.length).join(d)+a},d={s:m,z:function(a){a=-a.utcOffset();
var b=Math.abs(a),d=b%60;return(0>=a?"+":"-")+m(Math.floor(b/60),2,"0")+":"+m(d,2,"0")},m:function c(a,b){if(a.date()<b.date())return-c(b,a);var d=12*(b.year()-a.year())+(b.month()-a.month()),g=a.clone().add(d,"month"),k=0>b-g;a=a.clone().add(d+(k?-1:1),"month");return+(-(d+(b-g)/(k?g-a:a-g))||0)},a:function(a){return 0>a?Math.ceil(a)||0:Math.floor(a)},p:function(a){return{M:"month",y:"year",w:"week",d:"day",D:"date",h:"hour",m:"minute",s:"second",ms:"millisecond",Q:"quarter"}[a]||String(a||"").toLowerCase().replace(/s$/,
"")},u:function(a){return void 0===a}},a="en",b={};b[a]={name:"en",weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),months:"January February March April May June July August September October November December".split(" ")};var g=function(a){return a instanceof k},n=function E(d,c,g){var k;if(!d)return a;if("string"==typeof d){var e=d.toLowerCase();b[e]&&(k=e);c&&(b[e]=c,k=e);d=d.split("-");if(!k&&1<d.length)return E(d[0])}else k=d.name,b[k]=d;return!g&&k&&(a=k),k||!g&&
a},p=function(a,c){if(g(a))return a.clone();var b="object"==typeof c?c:{};return b.date=a,b.args=arguments,new k(b)};d.l=n;d.i=g;d.w=function(a,c){return p(a,{locale:c.$L,utc:c.$u,x:c.$x,$offset:c.$offset})};var k=function(){function a(a){this.$L=n(a.locale,null,!0);this.parse(a)}var c=a.prototype;return c.parse=function(a){this.$d=function(a){var c=a.date;a=a.utc;if(null===c)return new Date(NaN);if(d.u(c))return new Date;if(c instanceof Date)return new Date(c);if("string"==typeof c&&!/Z$/i.test(c)){var b=
c.match(e);if(b){c=b[2]-1||0;var g=(b[7]||"0").substring(0,3);return a?new Date(Date.UTC(b[1],c,b[3]||1,b[4]||0,b[5]||0,b[6]||0,g)):new Date(b[1],c,b[3]||1,b[4]||0,b[5]||0,b[6]||0,g)}}return new Date(c)}(a);this.$x=a.x||{};this.init()},c.init=function(){var a=this.$d;this.$y=a.getFullYear();this.$M=a.getMonth();this.$D=a.getDate();this.$W=a.getDay();this.$H=a.getHours();this.$m=a.getMinutes();this.$s=a.getSeconds();this.$ms=a.getMilliseconds()},c.$utils=function(){return d},c.isValid=function(){return"Invalid Date"!==
this.$d.toString()},c.isSame=function(a,c){a=p(a);return this.startOf(c)<=a&&a<=this.endOf(c)},c.isAfter=function(a,c){return p(a)<this.startOf(c)},c.isBefore=function(a,c){return this.endOf(c)<p(a)},c.$g=function(a,c,b){return d.u(a)?this[c]:this.set(b,a)},c.unix=function(){return Math.floor(this.valueOf()/1E3)},c.valueOf=function(){return this.$d.getTime()},c.startOf=function(a,c){var b=this,g=!!d.u(c)||c,k=d.p(a);a=function(a,c){a=d.w(b.$u?Date.UTC(b.$y,c,a):new Date(b.$y,c,a),b);return g?a:a.endOf("day")};
var e=function(a,c){return d.w(b.toDate()[a].apply(b.toDate("s"),(g?[0,0,0,0]:[23,59,59,999]).slice(c)),b)},m=this.$W;c=this.$M;var p=this.$D,q="set"+(this.$u?"UTC":"");switch(k){case "year":return g?a(1,0):a(31,11);case "month":return g?a(1,c):a(0,c+1);case "week":return k=this.$locale().weekStart||0,m=(m<k?m+7:m)-k,a(g?p-m:p+(6-m),c);case "day":case "date":return e(q+"Hours",0);case "hour":return e(q+"Minutes",1);case "minute":return e(q+"Seconds",2);case "second":return e(q+"Milliseconds",3);default:return this.clone()}},
c.endOf=function(a){return this.startOf(a,!1)},c.$set=function(a,c){var b;a=d.p(a);var g="set"+(this.$u?"UTC":"");g=(b={},b.day=g+"Date",b.date=g+"Date",b.month=g+"Month",b.year=g+"FullYear",b.hour=g+"Hours",b.minute=g+"Minutes",b.second=g+"Seconds",b.millisecond=g+"Milliseconds",b)[a];c="day"===a?this.$D+(c-this.$W):c;"month"===a||"year"===a?(b=this.clone().set("date",1),b.$d[g](c),b.init(),this.$d=b.set("date",Math.min(this.$D,b.daysInMonth())).$d):g&&this.$d[g](c);return this.init(),this},c.set=
function(a,c){return this.clone().$set(a,c)},c.get=function(a){return this[d.p(a)]()},c.add=function(a,c){var b,g=this;a=Number(a);c=d.p(c);var k=function(c){var b=p(g);return d.w(b.date(b.date()+Math.round(c*a)),g)};if("month"===c)return this.set("month",this.$M+a);if("year"===c)return this.set("year",this.$y+a);if("day"===c)return k(1);if("week"===c)return k(7);c=(b={},b.minute=6E4,b.hour=36E5,b.second=1E3,b)[c]||1;b=this.$d.getTime()+a*c;return d.w(b,this)},c.subtract=function(a,c){return this.add(-1*
a,c)},c.format=function(a){var c=this,b=this.$locale();if(!this.isValid())return b.invalidDate||"Invalid Date";var g=a||"YYYY-MM-DDTHH:mm:ssZ",k=d.z(this);a=this.$H;var e=this.$m,m=this.$M,p=b.weekdays,q=b.months,v=function(a,b,d,k){return a&&(a[b]||a(c,g))||d[b].slice(0,k)},n=b.meridiem||function(a,c,b){a=12>a?"AM":"PM";return b?a.toLowerCase():a},x={YY:String(this.$y).slice(-2),YYYY:this.$y,M:m+1,MM:d.s(m+1,2,"0"),MMM:v(b.monthsShort,m,q,3),MMMM:v(q,m),D:this.$D,DD:d.s(this.$D,2,"0"),d:String(this.$W),
dd:v(b.weekdaysMin,this.$W,p,2),ddd:v(b.weekdaysShort,this.$W,p,3),dddd:p[this.$W],H:String(a),HH:d.s(a,2,"0"),h:d.s(a%12||12,1,"0"),hh:d.s(a%12||12,2,"0"),a:n(a,e,!0),A:n(a,e,!1),m:String(e),mm:d.s(e,2,"0"),s:String(this.$s),ss:d.s(this.$s,2,"0"),SSS:d.s(this.$ms,3,"0"),Z:k};return g.replace(l,function(a,c){return c||x[a]||k.replace(":","")})},c.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},c.diff=function(a,c,b){var g;c=d.p(c);var k=p(a);a=6E4*(k.utcOffset()-this.utcOffset());
var e=this-k;k=d.m(this,k);return k=(g={},g.year=k/12,g.month=k,g.quarter=k/3,g.week=(e-a)/6048E5,g.day=(e-a)/864E5,g.hour=e/36E5,g.minute=e/6E4,g.second=e/1E3,g)[c]||e,b?k:d.a(k)},c.daysInMonth=function(){return this.endOf("month").$D},c.$locale=function(){return b[this.$L]},c.locale=function(a,c){if(!a)return this.$L;var b=this.clone();a=n(a,c,!0);return a&&(b.$L=a),b},c.clone=function(){return d.w(this.$d,this)},c.toDate=function(){return new Date(this.valueOf())},c.toJSON=function(){return this.isValid()?
this.toISOString():null},c.toISOString=function(){return this.$d.toISOString()},c.toString=function(){return this.$d.toUTCString()},a}(),v=k.prototype;return p.prototype=v,[["$ms","millisecond"],["$s","second"],["$m","minute"],["$H","hour"],["$W","day"],["$M","month"],["$y","year"],["$D","date"]].forEach(function(a){v[a[1]]=function(c){return this.$g(c,a[0],a[1])}}),p.extend=function(a,c){return a.$i||(a(c,k,p),a.$i=!0),p},p.locale=n,p.isDayjs=g,p.unix=function(a){return p(1E3*a)},p.en=b[a],p.Ls=
b,p.p={},p})},function(l,r,n){(function(e){function l(a,d){for(var b=0,g=a.length-1;0<=g;g--){var k=a[g];"."===k?a.splice(g,1):".."===k?(a.splice(g,1),b++):b&&(a.splice(g,1),b--)}if(d)for(;b--;b)a.unshift("..");return a}function m(a,d){if(a.filter)return a.filter(d);for(var b=[],g=0;g<a.length;g++)d(a[g],g,a)&&b.push(a[g]);return b}var d=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;r.resolve=function(){for(var a="",d=!1,n=arguments.length-1;-1<=n&&!d;n--){var p=0<=n?arguments[n]:
e.cwd();if("string"!==typeof p)throw new TypeError("Arguments to path.resolve must be strings");p&&(a=p+"/"+a,d="/"===p.charAt(0))}a=l(m(a.split("/"),function(a){return!!a}),!d).join("/");return(d?"/":"")+a||"."};r.normalize=function(b){var d=r.isAbsolute(b),e="/"===a(b,-1);(b=l(m(b.split("/"),function(a){return!!a}),!d).join("/"))||d||(b=".");b&&e&&(b+="/");return(d?"/":"")+b};r.isAbsolute=function(a){return"/"===a.charAt(0)};r.join=function(){var a=Array.prototype.slice.call(arguments,0);return r.normalize(m(a,
function(a,b){if("string"!==typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))};r.relative=function(a,d){function b(a){for(var b=0;b<a.length&&""===a[b];b++);for(var d=a.length-1;0<=d&&""===a[d];d--);return b>d?[]:a.slice(b,d-b+1)}a=r.resolve(a).substr(1);d=r.resolve(d).substr(1);a=b(a.split("/"));d=b(d.split("/"));for(var g=Math.min(a.length,d.length),k=g,e=0;e<g;e++)if(a[e]!==d[e]){k=e;break}g=[];for(e=k;e<a.length;e++)g.push("..");g=g.concat(d.slice(k));
return g.join("/")};r.sep="/";r.delimiter=":";r.dirname=function(a){var b=d.exec(a).slice(1);a=b[0];b=b[1];if(!a&&!b)return".";b&&(b=b.substr(0,b.length-1));return a+b};r.basename=function(a,g){a=d.exec(a).slice(1)[2];g&&a.substr(-1*g.length)===g&&(a=a.substr(0,a.length-g.length));return a};r.extname=function(a){return d.exec(a).slice(1)[3]};var a="b"==="ab".substr(-1)?function(a,d,e){return a.substr(d,e)}:function(a,d,e){0>d&&(d=a.length+d);return a.substr(d,e)}}).call(r,n(35))},function(l,r){function n(){throw Error("setTimeout has not been defined");
}function e(){throw Error("clearTimeout has not been defined");}function u(a){if(x===setTimeout)return setTimeout(a,0);if((x===n||!x)&&setTimeout)return x=setTimeout,setTimeout(a,0);try{return x(a,0)}catch(c){try{return x.call(null,a,0)}catch(G){return x.call(this,a,0)}}}function m(a){if(p===clearTimeout)return clearTimeout(a);if((p===e||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(a);try{return p(a)}catch(c){try{return p.call(null,a)}catch(G){return p.call(this,a)}}}function d(){v&&t&&(v=
!1,t.length?k=t.concat(k):w=-1,k.length&&a())}function a(){if(!v){var a=u(d);v=!0;for(var c=k.length;c;){t=k;for(k=[];++w<c;)t&&t[w].run();w=-1;c=k.length}t=null;v=!1;m(a)}}function b(a,c){this.fun=a;this.array=c}function g(){}l=l.exports={};try{var x="function"===typeof setTimeout?setTimeout:n}catch(q){x=n}try{var p="function"===typeof clearTimeout?clearTimeout:e}catch(q){p=e}var k=[],v=!1,t,w=-1;l.nextTick=function(d){var c=Array(arguments.length-1);if(1<arguments.length)for(var g=1;g<arguments.length;g++)c[g-
1]=arguments[g];k.push(new b(d,c));1!==k.length||v||u(a)};b.prototype.run=function(){this.fun.apply(null,this.array)};l.title="browser";l.browser=!0;l.env={};l.argv=[];l.version="";l.versions={};l.on=g;l.addListener=g;l.once=g;l.off=g;l.removeListener=g;l.removeAllListeners=g;l.emit=g;l.prependListener=g;l.prependOnceListener=g;l.listeners=function(a){return[]};l.binding=function(a){throw Error("process.binding is not supported");};l.cwd=function(){return"/"};l.chdir=function(a){throw Error("process.chdir is not supported");
};l.umask=function(){return 0}},function(l,r){l.exports=function(l){if(!l.webpackPolyfill){var e=Object.create(l);e.children||(e.children=[]);Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}});Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}});Object.defineProperty(e,"exports",{enumerable:!0});e.webpackPolyfill=1}return e}},function(l,r,n){var e=n(23),u=n(24),m=n(0);r.a=function(d){m["default"].info("Starting Chrome stable stack",d);var a=Object(e.a)(d);
a.enableSimulcast=function(b){var g=b;if(!d.video||!d.simulcast)return g;a.simulcast=d.simulcast;b=g.match(/a=ssrc-group:FID ([0-9]*) ([0-9]*)\r?\n/);if(!b||0>=b.length)return g;var e=d.simulcast.numSpatialLayers||2;var k=parseInt(b[1],10),m=parseInt(b[2],10),l=g.match(new RegExp("a=ssrc:"+b[1]+" cname:(.*)\r?\n"))[1],w=g.match(new RegExp("a=ssrc:"+b[1]+" msid:(.*)\r?\n"))[1],q=g.match(new RegExp("a=ssrc:"+b[1]+" mslabel:(.*)\r?\n"))[1],c=g.match(new RegExp("a=ssrc:"+b[1]+" label:(.*)\r?\n"))[1];
g.match(new RegExp("a=ssrc:"+b[1]+".*\r?\n","g")).forEach(function(a){g=g.replace(a,"")});g.match(new RegExp("a=ssrc:"+b[2]+".*\r?\n","g")).forEach(function(a){g=g.replace(a,"")});for(var n=[k],r=[m],z=1;z<e;z+=1)n.push(k+1E3*z),r.push(m+1E3*z);e=u.a.addSim(n);for(z=0;z<n.length;z+=1)k=n[z],m=r[z],e+=u.a.addGroup(k,m);for(z=0;z<n.length;z+=1)k=n[z],m=r[z],e+=u.a.addSpatialLayer(l,w,q,c,k,m);return g.replace(b[0],e+"a=x-google-flag:conference\r\n")};var b=function(b){if("function"!==typeof b.getParameters||
"function"!==typeof b.setParameters)m["default"].warning("Cannot set simulcast layers bitrate: getParameters or setParameters is not available");else{var d=b.getParameters();Object.keys(a.simulcast.spatialLayerBitrates).forEach(function(b){void 0!==d.encodings[b]&&(m["default"].error("Setting bitrate for layer "+b+", bps: "+a.simulcast.spatialLayerBitrates[b]),d.encodings[b].maxBitrate=a.simulcast.spatialLayerBitrates[b],console.log("setting bitrate for layer "+b+" bitratebps: "+JSON.stringify(a.simulcast.spatialLayerBitrates[b])))});
b.setParameters(d).then(function(a){m["default"].info("Success setting simulcast layer bitrates",a)}).catch(function(a){m["default"].warning("Error setting simulcast layer bitrates",a)})}};a.setSimulcastLayersBitrate=function(){a.simulcast&&a.simulcast.spatialLayerBitrates&&a.peerConnection.getSenders().forEach(function(a){"video"===a.track.kind&&b(a)})};a.setStartVideoBW=function(b){a.video&&d.startVideoBW&&(m["default"].debug("startVideoBW requested: "+d.startVideoBW),u.a.setParamForCodecs(b,"video",
"x-google-start-bitrate",d.startVideoBW))};a.setHardMinVideoBW=function(b){a.video&&d.hardMinVideoBW&&(m["default"].debug("hardMinVideoBW requested: "+d.hardMinVideoBW),u.a.setParamForCodecs(b,"video","x-google-min-bitrate",d.hardMinVideoBW))};return a}},function(l,r,n){var e=n(0),u=n(23);r.a=function(m){e["default"].info("Starting Firefox stack");var d=Object(u.a)(m);d.enableSimulcast=function(a){if(!m.video||!m.simulcast)return a;d.peerConnection.getSenders().forEach(function(a){"video"===a.track.kind&&
(a.getParameters(),a.setParameters({encodings:[{rid:"spam",active:!0,priority:"high",maxBitrate:4E4,maxHeight:640,maxWidth:480},{rid:"egg",active:!0,priority:"medium",maxBitrate:1E4,maxHeight:320,maxWidth:240}]}))});return a};return d}},function(l,r,n){var e=n(0);r.a=function(l){var m={pcConfig:{},peerConnection:{},desc:{},signalCallback:void 0,close:function(){e["default"].info("Close FcStack")},createOffer:function(){e["default"].debug("FCSTACK: CreateOffer")},addStream:function(d){e["default"].debug("FCSTACK: addStream",
d)},addTrack:function(d){e["default"].debug("FCSTACK: addTrack",stream)},processSignalingMessage:function(d){e["default"].debug("FCSTACK: processSignaling",d);void 0!==m.signalCallback&&m.signalCallback(d)},sendSignalingMessage:function(d){e["default"].debug("FCSTACK: Sending signaling Message",d);l.callback(d)},setSignalingCallback:function(d){d=void 0===d?function(){}:d;e["default"].debug("FCSTACK: Setting signalling callback");m.signalCallback=d}};return m}},function(l,r,n){n.d(r,"a",function(){return k});
var e=n(5),u=n(41),m=n(0),d=n(8),a=n(9),b=n(6);l=n(1);var g=n.n(l),x=n(4),p=function(a,b){a=Object(x.b)({type:a});a.args=b.args;return a},k=function(k){var l=Object(x.c)(),v=function(){},q=[];$jscomp.initSymbol();l.CONNECTING=Symbol("connecting");$jscomp.initSymbol();l.CONNECTED=Symbol("connected");$jscomp.initSymbol();l.RECONNECTING=Symbol("reconnecting");$jscomp.initSymbol();l.DISCONNECTED=Symbol("disconnected");l.state=l.DISCONNECTED;l.IO=void 0===k?u.a:k;var c,n=function(a,c){for(var b=[],d=1;d<
arguments.length;++d)b[d-1]=arguments[d];l.emit(p(a,{args:b}))},r=function(){m["default"].info("execute buffer");l.state===l.CONNECTED&&q.forEach(function(a){l.sendMessage.apply(l,$jscomp.arrayFromIterable(a))})};l.connect=function(k,p,q){p=void 0===p?v:p;q=void 0===q?v:q;var w={timeout:3E4,reconnection:!1,secure:k.secure,forceNew:!0,allowEIO4:!0,transports:["websocket"],rejectUnauthorized:!0};void 0!=g.a.socketiopath&&(w.path=g.a.socketiopath);var t="https:"==window.location.protocol?"wss://":"ws://",
u=k.host;void 0==k.gateway||null==k.gateway||""==k.gateway?u=k.host:(u=k.gateway,w.query="X-Forwarded-Host="+k.host);m["default"].info("Connecting socket with option:- "+JSON.stringify(w));console.log("Connecting socket with host:- "+u);l.state=l.CONNECTING;c=l.IO.connect(t+u,w);var x=c.io.engine.transport.ws.onclose;c.io.engine.transport.ws.onclose=function(a){m["default"].warning("WebSocket closed, code:",a.code);x(a);n(e.a.SocketEvent.error);l.state==l.CONNECTING&&p(b.a.error_1161);l.state=l.DISCONNECTED};
c.io.engine.transport.ws.onerror=function(a){};l.socket=c;c.on(e.a.UserEvent.user_awaited,n.bind(l,e.a.UserEvent.user_awaited));c.on(e.a.UserEvent.user_joined,n.bind(l,e.a.UserEvent.user_joined));c.on(e.a.RoomEvent.room_connected,n.bind(l,e.a.RoomEvent.room_connected));c.on(e.a.RoomEvent.room_disconnected,n.bind(l,e.a.RoomEvent.room_disconnected));c.on(e.a.RoomEvent.new_active_talker,n.bind(l,e.a.RoomEvent.new_active_talker));c.on(e.a.SocketEvent.onAddStream,n.bind(l,e.a.SocketEvent.onAddStream));
c.on(e.a.SocketEvent.signaling_message_peer,n.bind(l,e.a.SocketEvent.signaling_message_peer));c.on(e.a.SocketEvent.publish_me,n.bind(l,e.a.SocketEvent.publish_me));c.on(e.a.SocketEvent.unpublish_me,n.bind(l,e.a.SocketEvent.unpublish_me));c.on(e.a.SocketEvent.onBandwidthAlert,n.bind(l,e.a.SocketEvent.onBandwidthAlert));c.on(e.a.SocketEvent.onBandwidthEvents,n.bind(l,e.a.SocketEvent.onBandwidthEvents));c.on(e.a.SocketEvent.onSelfBandwidthAlert,n.bind(l,e.a.SocketEvent.onSelfBandwidthAlert));c.on(e.a.SocketEvent.onRemoveTrack,
n.bind(l,e.a.SocketEvent.onRemoveTrack));c.on(e.a.SocketEvent.onDataStream,n.bind(l,e.a.SocketEvent.onDataStream));c.on(e.a.RoomEvent.room_awaited,n.bind(l,e.a.RoomEvent.room_awaited));c.on(e.a.RoomEvent.room_record_on,n.bind(l,e.a.RoomEvent.room_record_on));c.on(e.a.RoomEvent.room_record_off,n.bind(l,e.a.RoomEvent.room_record_off));c.on(e.a.RoomEvent.hard_mute_audio,n.bind(l,e.a.RoomEvent.hard_mute_audio));c.on(e.a.RoomEvent.hard_unmute_audio,n.bind(l,e.a.RoomEvent.hard_unmute_audio));c.on(e.a.RoomEvent.hard_mute_video,
n.bind(l,e.a.RoomEvent.hard_mute_video));c.on(e.a.RoomEvent.hard_unmute_video,n.bind(l,e.a.RoomEvent.hard_unmute_video));c.on(e.a.RoomEvent.auxilary_publish_events,n.bind(l,e.a.RoomEvent.auxilary_publish_events));c.on(e.a.RoomEvent.share_started,n.bind(l,e.a.RoomEvent.share_started));c.on(e.a.RoomEvent.share_stopped,n.bind(l,e.a.RoomEvent.share_stopped));c.on(e.a.RoomEvent.screen_share_override,n.bind(l,e.a.RoomEvent.screen_share_override));c.on(e.a.RoomEvent.stop_sharing,n.bind(l,e.a.RoomEvent.stop_sharing));
c.on(e.a.RoomEvent.update_layout,n.bind(l,e.a.RoomEvent.update_layout));c.on(e.a.RoomEvent.custom_data_saved,n.bind(l,e.a.RoomEvent.custom_data_saved));c.on(e.a.RoomEvent.custom_data_updated,n.bind(l,e.a.RoomEvent.custom_data_updated));c.on(e.a.RoomEvent.streaming_uri,n.bind(l,e.a.RoomEvent.streaming_uri));c.on(e.a.RoomEvent.canvas_started,n.bind(l,e.a.RoomEvent.canvas_started));c.on(e.a.RoomEvent.canvas_stopped,n.bind(l,e.a.RoomEvent.canvas_stopped));c.on(e.a.RoomEvent.invite_breakout_room,n.bind(l,
e.a.RoomEvent.invite_breakout_room));c.on(e.a.RoomEvent.user_joined_breakout_room,n.bind(l,e.a.RoomEvent.user_joined_breakout_room));c.on(e.a.RoomEvent.user_left_breakout_room,n.bind(l,e.a.RoomEvent.user_left_breakout_room));c.on(e.a.RoomEvent.breakout_room_destroyed,n.bind(l,e.a.RoomEvent.breakout_room_destroyed));c.on(e.a.RoomEvent.transcription_events,n.bind(l,e.a.RoomEvent.transcription_events));c.on(e.a.RoomEvent.analytics_events,n.bind(l,e.a.RoomEvent.analytics_events));c.on(e.a.SocketEvent.dial_state_events,
n.bind(l,e.a.SocketEvent.dial_state_events));c.on(e.a.UserEvent.user_audio_muted,n.bind(l,e.a.UserEvent.user_audio_muted));c.on(e.a.UserEvent.user_audio_unmuted,n.bind(l,e.a.UserEvent.user_audio_unmuted));c.on(e.a.UserEvent.user_video_muted,n.bind(l,e.a.UserEvent.user_video_muted));c.on(e.a.UserEvent.user_video_unmuted,n.bind(l,e.a.UserEvent.user_video_unmuted));c.on(e.a.SocketEvent.media_engine_connecting,n.bind(l,e.a.SocketEvent.media_engine_connecting));c.on(e.a.SocketEvent.onUpdateAttributeStream,
n.bind(l,e.a.SocketEvent.onUpdateAttributeStream));c.on(e.a.SocketEvent.onRemoveStream,n.bind(l,e.a.SocketEvent.onRemoveStream));c.on(e.a.SocketEvent.user_connected,n.bind(l,e.a.SocketEvent.user_connected));c.on(e.a.SocketEvent.user_updated,n.bind(l,e.a.SocketEvent.user_updated));c.on(e.a.SocketEvent.user_disconnected,n.bind(l,e.a.SocketEvent.user_disconnected));c.on(e.a.SocketEvent.user_subscribed,n.bind(l,e.a.SocketEvent.user_subscribed));c.on(e.a.SocketEvent.floor_requested,n.bind(l,e.a.SocketEvent.floor_requested));
c.on(e.a.SocketEvent.floor_granted,n.bind(l,e.a.SocketEvent.floor_granted));c.on(e.a.SocketEvent.floor_not_granted,n.bind(l,e.a.SocketEvent.floor_not_granted));c.on(e.a.SocketEvent.floor_released,n.bind(l,e.a.SocketEvent.floor_released));c.on(e.a.SocketEvent.hard_mute,n.bind(l,e.a.SocketEvent.hard_mute));c.on(e.a.SocketEvent.hard_mute_room,n.bind(l,e.a.SocketEvent.hard_mute_room));c.on(e.a.SocketEvent.hard_unmute_room,n.bind(l,e.a.SocketEvent.hard_unmute_room));c.on(e.a.SocketEvent.switched_room,
n.bind(l,e.a.SocketEvent.switched_room));c.on(e.a.SocketEvent.data_stream_room,n.bind(l,e.a.SocketEvent.data_stream_room));c.on(e.a.RoomEvent.user_role_changed,n.bind(l,e.a.RoomEvent.user_role_changed));c.on(e.a.SocketEvent.onStatSubscription,n.bind(l,e.a.SocketEvent.onStatSubscription));c.on(e.a.SocketEvent.onStreamingNotification,n.bind(l,e.a.SocketEvent.onStreamingNotification));c.on(e.a.SocketEvent.onHlsStreamingNotification,n.bind(l,e.a.SocketEvent.onHlsStreamingNotification));c.on(e.a.SocketEvent.onHlsStreamingNotificationToPublisher,
n.bind(l,e.a.SocketEvent.onHlsStreamingNotificationToPublisher));c.on(e.a.SocketEvent.onLiveRecordingNotification,n.bind(l,e.a.SocketEvent.onLiveRecordingNotification));c.on(e.a.SocketEvent.onRoomLiveRecordingOn,n.bind(l,e.a.SocketEvent.onRoomLiveRecordingOn));c.on(e.a.SocketEvent.onRoomLiveRecordingOff,n.bind(l,e.a.SocketEvent.onRoomLiveRecordingOff));c.on(e.a.SocketEvent.onRoomLiveRecordingFailed,n.bind(l,e.a.SocketEvent.onRoomLiveRecordingFailed));c.on(e.a.RoomEvent.switch_codec,n.bind(l,e.a.RoomEvent.switch_codec));
c.on(e.a.RoomEvent.generic_events,n.bind(l,e.a.RoomEvent.generic_events));c.on(e.a.SocketEvent.room_management_events,n.bind(l,e.a.SocketEvent.room_management_events));c.on(e.a.SocketEvent.floor_management_events,n.bind(l,e.a.SocketEvent.floor_management_events));c.on(e.a.RoomEvent.room_transcription_on,n.bind(l,e.a.RoomEvent.room_transcription_on));c.on(e.a.RoomEvent.room_transcription_on,n.bind(l,e.a.RoomEvent.room_transcription_on));c.on(e.a.RoomEvent.room_transcription_off,n.bind(l,e.a.RoomEvent.room_transcription_off));
c.on(e.a.RoomEvent.self_transcription_on,n.bind(l,e.a.RoomEvent.self_transcription_on));c.on(e.a.RoomEvent.self_transcription_off,n.bind(l,e.a.RoomEvent.self_transcription_off));c.on(e.a.SocketEvent.disconnect,function(a){m["default"].debug(e.a.SocketEvent.disconnect,l.id,a);c.close();n(e.a.SocketEvent.disconnect,a)});c.on(e.a.SocketEvent.connect_timeout,function(a){m["default"].warning(e.a.SocketEvent.connect_timeout+", id:",l.id,", error:",a.message);c.close();n(e.a.SocketEvent.disconnect,a.message)});
c.on(e.a.SocketEvent.connection_failed,function(){m["default"].error(e.a.SocketEvent.connection_failed+", id:",l.id);n(e.a.SocketEvent.connection_failed,{streamId:l.id})});c.on(e.a.SocketEvent.connect_error,function(a){m["default"].warning(e.a.SocketEvent.connect_error+", id:",l.id,", error:",a.message)});c.on(e.a.SocketEvent.error,function(a){m["default"].warning(e.a.SocketEvent.error+", id:",l.id,", error:",a.message);n(e.a.SocketEvent.error)});c.on(e.a.SocketEvent.reconnecting,function(a){m["default"].debug(e.a.SocketEvent.reconnecting+
", id:",l.id,", attempt:",a)});c.on(e.a.SocketEvent.reconnect,function(b){m["default"].debug(e.a.SocketEvent.reconnected+", id:",l.id,", attempt:",b);l.state=l.CONNECTED;c.emit(e.a.SocketEvent.reconnected,l.id);a.a.info("socket-event",d.a.event_reconnect_socket_success,{error:{}});r()});c.on(e.a.SocketEvent.reconnect_attempt,function(a){m["default"].debug(e.a.SocketEvent.reconnect_attempt+", id:",l.id,", attempt:",a)});c.on(e.a.SocketEvent.reconnect_failed,function(){m["default"].warning(e.a.SocketEvent.reconnect_failed+
", id:",l.id);l.state=l.DISCONNECTED;n(e.a.SocketEvent.disconnect,e.a.SocketEvent.reconnect_failed);a.a.error("socket-event",d.a.event_reconnect_socket_failed,{error:{}})});c.on(e.a.SocketEvent.reconnect_error,function(a){m["default"].debug(e.a.SocketEvent.reconnect_error+", id:",l.id,", error:",a.message)});l.sendMessage("token",k,function(a){l.state=l.CONNECTED;l.id=a.clientId;p(a)},q)};l.disconnect=function(){m["default"].debug("socket js disconnect the socket");l.state=l.DISCONNECTED;c.disconnect()};
l.sendMessage=function(g,k,e,p){e=void 0===e?v:e;p=void 0===p?v:p;l.state===l.DISCONNECTED&&"token"!==g?(m["default"].error("Trying to send a message over a disconnected Socket"),e(b.a.error_1163)):l.state===l.RECONNECTING?(m["default"].debug("sendmessage socket state is reconnecting"),q.push([g,k,e,p]),e(b.a.error_1164)):k?c.emit(g,k,function(c,k){"success"===c?e(k):"error"===c?(a.a.error("socket-event",d.a.event_send_message_failed,{type:g,respType:c,resp:k}),p(k)):void 0!=k&&null!=k||void 0==c||
!0!==c&&("object"!=typeof c||void 0==c.result||c.result!=b.a.error_000.result)&&void 0==c.status?(m["default"].debug(" sendMessage() not sucess : respType: "+JSON.stringify(c)+" resp: "+JSON.stringify(k)),e(void 0==k?c:k)):(m["default"].debug(" sendMessage() resp undefined but respType has result with sucees: "+JSON.stringify(c)),e(c))}):p(b.a.error_1155)};l.sendSDP=function(b,g,k,e){e=void 0===e?v:e;l.state===l.DISCONNECTED?(m["default"].error("Trying to send a message over a disconnected Socket"),
a.a.info("socket-event",d.a.event_send_message_failed,{error:"Trying to send a message over a disconnected Socket"})):c.emit(b,g,k,function(a,c){e(a,c)})};l.emitEvent=function(b,g,k){k=void 0===k?v:k;l.state===l.DISCONNECTED?(m["default"].error("Trying to send a message over a disconnected Socket"),a.a.info("socket-event",d.a.event_send_message_failed,{error:"Trying to send a message over a disconnected Socket"})):c.emit(b,g,function(a,c){k(a,c)})};l.sendEvent=function(b,g){g=void 0===g?v:g;l.state===
l.DISCONNECTED?(m["default"].error("Trying to send a message over a disconnected Socket"),a.a.info("socket-event",d.a.event_send_message_failed,{error:"Trying to send a message over a disconnected Socket"})):c.emit(b,function(a){g(a)})};l.sendParamEvent=function(b,g,k){k=void 0===k?v:k;l.state===l.DISCONNECTED?(m["default"].error("Trying to send a message over a disconnected Socket"),a.a.info("socket-event",d.a.event_send_message_failed,{error:"Trying to send a message over a disconnected Socket"})):
c.emit(b,g,function(a){k(a)})};return l}},function(l,r,n){function e(a){a=a.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!a||K))return new XMLHttpRequest}catch(Ga){}if(!a)try{return new (B[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(Ga){}}function u(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];return b.reduce(function(c,b){return a.hasOwnProperty(b)&&(c[b]=a[b]),c},{})}function m(a,c){c.useNativeTimers?(a.setTimeoutFn=Y.bind(B),a.clearTimeoutFn=y.bind(B)):
(a.setTimeoutFn=setTimeout.bind(B),a.clearTimeoutFn=clearTimeout.bind(B))}function d(a){if(a){for(var c in d.prototype)a[c]=d.prototype[c];return a}}function a(a){var c="";do c=ia[a%64]+c,a=Math.floor(a/64);while(0<a);return c}function b(){var c=a(+new Date);return c!==H?(A=0,H=c):c+"."+a(A++)}function g(){}function x(){for(var a in aa.requests)aa.requests.hasOwnProperty(a)&&aa.requests[a].abort()}function p(a){var c;if(c=sa)(c=a instanceof ArrayBuffer)||(c="function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(a):
a.buffer instanceof ArrayBuffer);return c||Fa&&a instanceof Blob||Fb&&a instanceof File}function k(a,c){if(!a||"object"!=typeof a)return!1;if(Array.isArray(a)){for(var b=0,d=a.length;b<d;b++)if(k(a[b]))return!0;return!1}if(p(a))return!0;if(a.toJSON&&"function"==typeof a.toJSON&&1===arguments.length)return k(a.toJSON(),!0);for(b in a)if(Object.prototype.hasOwnProperty.call(a,b)&&k(a[b]))return!0;return!1}function v(a,c){if(!a)return a;if(p(a)){var b={_placeholder:!0,num:c.length};return c.push(a),
b}if(Array.isArray(a)){b=Array(a.length);for(var d=0;d<a.length;d++)b[d]=v(a[d],c);return b}if("object"==typeof a&&!(a instanceof Date)){b={};for(d in a)a.hasOwnProperty(d)&&(b[d]=v(a[d],c));return b}return a}function t(a,c){if(!a)return a;if(a&&a._placeholder)return c[a.num];if(Array.isArray(a))for(var b=0;b<a.length;b++)a[b]=t(a[b],c);else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&(a[b]=t(a[b],c));return a}function w(a,c,b){return a.on(c,b),function(){a.off(c,b)}}function q(a){a=a||
{};this.ms=a.min||100;this.max=a.max||1E4;this.factor=a.factor||2;this.jitter=0<a.jitter&&1>=a.jitter?a.jitter:0;this.attempts=0}function c(a,c){"object"==typeof a&&(c=a,a=void 0);var b=a;a=(c=c||{}).path||"/socket.io";a=void 0===a?"":a;var d=b;var f="undefined"!=typeof location&&location;null==b&&(b=f.protocol+"//"+f.host);"string"==typeof b&&("/"===b.charAt(0)&&(b="/"===b.charAt(1)?f.protocol+b:f.host+b),/^(https?|wss?):\/\//.test(b)||(b=void 0!==f?f.protocol+"//"+b:"https://"+b),d=z(b));d.port||
(/^(http|ws)$/.test(d.protocol)?d.port="80":/^(http|ws)s$/.test(d.protocol)&&(d.port="443"));d.path=d.path||"/";b=-1!==d.host.indexOf(":")?"["+d.host+"]":d.host;a=(d.id=d.protocol+"://"+b+":"+d.port+a,d.href=d.protocol+"://"+b+(f&&f.port===d.port?"":":"+d.port),d);f=a.source;d=a.id;b=a.path;b=xa[d]&&b in xa[d].nsps;var g;return c.forceNew||c["force new connection"]||!1===c.multiplex||b?g=new Q(f,c):(xa[d]||(xa[d]=new Q(f,c)),g=xa[d]),a.query&&!c.query&&(c.query=a.queryKey),g.socket(a.path,c)}n.d(r,
"a",function(){return c});var G=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,E="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),z=function(a){var c=a,b=a.indexOf("["),d=a.indexOf("]");-1!=b&&-1!=d&&(a=a.substring(0,b)+a.substring(b,d).replace(/:/g,
";")+a.substring(d,a.length));var f,g;a=G.exec(a||"");for(var k={},e=14;e--;)k[E[e]]=a[e]||"";return-1!=b&&-1!=d&&(k.source=c,k.host=k.host.substring(1,k.host.length-1).replace(/;/g,":"),k.authority=k.authority.replace("[","").replace("]","").replace(/;/g,":"),k.ipv6uri=!0),k.pathNames=function(a,c){a=c.replace(/\/{2,9}/g,"/").split("/");"/"!=c.substr(0,1)&&0!==c.length||a.splice(0,1);"/"==c.substr(c.length-1,1)&&a.splice(a.length-1,1);return a}(0,k.path),k.queryKey=(f=k.query,g={},f.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,
function(a,c,b){c&&(g[c]=b)}),g),k};l={};try{l="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(R){l=!1}var K=l,B="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")(),Y=setTimeout,y=clearTimeout;d.prototype.on=d.prototype.addEventListener=function(a,c){return this._callbacks=this._callbacks||{},(this._callbacks["$"+a]=this._callbacks["$"+a]||[]).push(c),this};d.prototype.once=function(a,c){function b(){this.off(a,b);c.apply(this,
arguments)}return b.fn=c,this.on(a,b),this};d.prototype.off=d.prototype.removeListener=d.prototype.removeAllListeners=d.prototype.removeEventListener=function(a,c){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var b,d=this._callbacks["$"+a];if(!d)return this;if(1==arguments.length)return delete this._callbacks["$"+a],this;for(var f=0;f<d.length;f++)if((b=d[f])===c||b.fn===c){d.splice(f,1);break}return 0===d.length&&delete this._callbacks["$"+a],this};d.prototype.emit=
function(a){this._callbacks=this._callbacks||{};for(var c=Array(arguments.length-1),b=this._callbacks["$"+a],d=1;d<arguments.length;d++)c[d-1]=arguments[d];if(b){d=0;for(var f=(b=b.slice(0)).length;d<f;++d)b[d].apply(this,c)}return this};d.prototype.emitReserved=d.prototype.emit;d.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks["$"+a]||[]};d.prototype.hasListeners=function(a){return!!this.listeners(a).length};var F=Object.create(null);F.open="0";F.close=
"1";F.ping="2";F.pong="3";F.message="4";F.upgrade="5";F.noop="6";var S=Object.create(null);Object.keys(F).forEach(function(a){S[F[a]]=a});var M={type:"error",data:"parser error"},da="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),ba="function"==typeof ArrayBuffer,ha=function(a,c,b){var d=a.type;a=a.data;return da&&a instanceof Blob?c?b(a):f(a,b):ba&&(a instanceof ArrayBuffer||(g=a,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(g):
g&&g.buffer instanceof ArrayBuffer))?c?b(a):f(new Blob([a]),b):b(F[d]+(a||""));var g},f=function(a,c){var b=new FileReader;return b.onload=function(){var a=b.result.split(",")[1];c("b"+a)},b.readAsDataURL(a)},ja="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(l=0;64>l;l++)ja["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(l)]=l;var ca="function"==typeof ArrayBuffer,I=function(a,c){if("string"!=typeof a)return{type:"message",data:N(a,c)};var b=a.charAt(0);if("b"===
b){a=a.substring(1);if(ca){var d=.75*a.length;b=a.length;var f=0;"="===a[a.length-1]&&(d--,"="===a[a.length-2]&&d--);var g=new ArrayBuffer(d),k=new Uint8Array(g);for(d=0;d<b;d+=4){var e=ja[a.charCodeAt(d)];var m=ja[a.charCodeAt(d+1)];var p=ja[a.charCodeAt(d+2)];var l=ja[a.charCodeAt(d+3)];k[f++]=e<<2|m>>4;k[f++]=(15&m)<<4|p>>2;k[f++]=(3&p)<<6|63&l}c=N(g,c)}else c={base64:!0,data:a};c={type:"message",data:c}}else c=S[b]?1<a.length?{type:S[b],data:a.substring(1)}:{type:S[b]}:M;return c},N=function(a,
c){return"blob"===c&&a instanceof ArrayBuffer?new Blob([a]):a},O=String.fromCharCode(30),U=function(a){var c=d.call(this)||this;c.writable=!1;m(c,a);c.opts=a;c.query=a.query;c.readyState="";c.socket=a.socket;return c};$jscomp.inherits(U,d);U.prototype.onError=function(a,c){a=Error(a);return a.type="TransportError",a.description=c,d.prototype.emit.call(this,"error",a),this};U.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),
this};U.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this};U.prototype.send=function(a){"open"===this.readyState&&this.write(a)};U.prototype.onOpen=function(){this.readyState="open";this.writable=!0;d.prototype.emit.call(this,"open")};U.prototype.onData=function(a){a=I(a,this.socket.binaryType);this.onPacket(a)};U.prototype.onPacket=function(a){d.prototype.emit.call(this,"packet",a)};U.prototype.onClose=function(){this.readyState=
"closed";d.prototype.emit.call(this,"close")};for(var H,ia="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),ea={},A=0,Z=0;64>Z;Z++)ea[ia[Z]]=Z;b.encode=a;b.decode=function(a){var c=0;for(Z=0;Z<a.length;Z++)c=64*c+ea[a.charAt(Z)];return c};var D={encode:function(a){var c="",b;for(b in a)a.hasOwnProperty(b)&&(c.length&&(c+="&"),c+=encodeURIComponent(b)+"="+encodeURIComponent(a[b]));return c},decode:function(a){var c={};a=a.split("&");for(var b=0,d=a.length;b<d;b++){var f=
a[b].split("=");c[decodeURIComponent(f[0])]=decodeURIComponent(f[1])}return c}},V=function(){var a=U.apply(this,arguments)||this;a.polling=!1;return a};$jscomp.inherits(V,U);V.prototype.doOpen=function(){this.poll()};V.prototype.pause=function(a){var c=this;this.readyState="pausing";var b=function(){c.readyState="paused";a()};if(this.polling||!this.writable){var d=0;this.polling&&(d++,this.once("pollComplete",function(){--d||b()}));this.writable||(d++,this.once("drain",function(){--d||b()}))}else b()};
V.prototype.poll=function(){this.polling=!0;this.doPoll();this.emit("poll")};V.prototype.onData=function(a){var c=this;(function(a,c){a=a.split(O);for(var b=[],d=0;d<a.length;d++){var f=I(a[d],c);if(b.push(f),"error"===f.type)break}return b})(a,this.socket.binaryType).forEach(function(a){if("opening"===c.readyState&&"open"===a.type&&c.onOpen(),"close"===a.type)return c.onClose(),!1;c.onPacket(a)});"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState&&this.poll())};
V.prototype.doClose=function(){var a=this,c=function(){a.write([{type:"close"}])};"open"===this.readyState?c():this.once("open",c)};V.prototype.write=function(a){var c=this;this.writable=!1;(function(a,c){var b=a.length,d=Array(b),f=0;a.forEach(function(a,g){ha(a,!1,function(a){d[g]=a;++f===b&&c(d.join(O))})})})(a,function(a){c.doWrite(a,function(){c.writable=!0;c.emit("drain")})})};V.prototype.uri=function(){var a=this.query||{},c=this.opts.secure?"https":"http",d="";!1!==this.opts.timestampRequests&&
(a[this.opts.timestampParam]=b());this.supportsBinary||a.sid||(a.b64=1);this.opts.port&&("https"===c&&443!==Number(this.opts.port)||"http"===c&&80!==Number(this.opts.port))&&(d=":"+this.opts.port);a=D.encode(a);return c+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+d+this.opts.path+(a.length?"?"+a:"")};$jscomp.global.Object.defineProperties(V.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"polling"}}});var fa=null!=(new e({xdomain:!1})).responseType,
aa=function(a,c){var b=d.call(this)||this;m(b,c);b.opts=c;b.method=c.method||"GET";b.uri=a;b.async=!1!==c.async;b.data=void 0!==c.data?c.data:null;b.create();return b};$jscomp.inherits(aa,d);aa.prototype.create=function(){var a=this,c=u(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");c.xdomain=!!this.opts.xd;c.xscheme=!!this.opts.xs;var b=this.xhr=new e(c);try{b.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){b.setDisableHeaderCheck&&
b.setDisableHeaderCheck(!0);for(var d in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(d)&&b.setRequestHeader(d,this.opts.extraHeaders[d])}}catch(za){}if("POST"===this.method)try{b.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(za){}try{b.setRequestHeader("Accept","*/*")}catch(za){}"withCredentials"in b&&(b.withCredentials=this.opts.withCredentials);this.opts.requestTimeout&&(b.timeout=this.opts.requestTimeout);b.onreadystatechange=function(){4===b.readyState&&(200===
b.status||1223===b.status?a.onLoad():a.setTimeoutFn(function(){a.onError("number"==typeof b.status?b.status:0)},0))};b.send(this.data)}catch(za){return void this.setTimeoutFn(function(){a.onError(za)},0)}"undefined"!=typeof document&&(this.index=aa.requestsCount++,aa.requests[this.index]=this)};aa.prototype.onSuccess=function(){this.emit("success");this.cleanup()};aa.prototype.onData=function(a){this.emit("data",a);this.onSuccess()};aa.prototype.onError=function(a){this.emit("error",a);this.cleanup(!0)};
aa.prototype.cleanup=function(a){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=g,a)try{this.xhr.abort()}catch(Ga){}"undefined"!=typeof document&&delete aa.requests[this.index];this.xhr=null}};aa.prototype.onLoad=function(){var a=this.xhr.responseText;null!==a&&this.onData(a)};aa.prototype.abort=function(){this.cleanup()};if(aa.requestsCount=0,aa.requests={},"undefined"!=typeof document)"function"==typeof attachEvent?attachEvent("onunload",x):"function"==typeof addEventListener&&
addEventListener("onpagehide"in B?"pagehide":"unload",x,!1);var Aa="function"==typeof Promise&&"function"==typeof Promise.resolve?function(a){return Promise.resolve().then(a)}:function(a,c){return c(a,0)},ka=B.WebSocket||B.MozWebSocket,ra="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),ma=function(a){var c=U.call(this,a)||this;c.supportsBinary=!a.forceBase64;return c};$jscomp.inherits(ma,U);ma.prototype.doOpen=function(){if(this.check()){var a=
this.uri(),c=this.opts.protocols,b=ra?{}:u(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(b.headers=this.opts.extraHeaders);try{this.ws=ra?new ka(a,c,b):c?new ka(a,c):new ka(a)}catch(ya){return this.emit("error",ya)}this.ws.binaryType=this.socket.binaryType||"arraybuffer";this.addEventListeners()}};ma.prototype.addEventListeners=
function(){var a=this;this.ws.onopen=function(){a.opts.autoUnref&&a.ws._socket.unref();a.onOpen()};this.ws.onclose=this.onClose.bind(this);this.ws.onmessage=function(c){return a.onData(c.data)};this.ws.onerror=function(c){return a.onError("websocket error",c)}};ma.prototype.write=function(a){var c=this;this.writable=!1;for(var b={},d=0;d<a.length;b={$jscomp$loop$prop$n$148$237:b.$jscomp$loop$prop$n$148$237},d++){var f=a[d];b.$jscomp$loop$prop$n$148$237=d===a.length-1;ha(f,this.supportsBinary,function(a){return function(b){try{c.ws.send(b)}catch(Ia){}a.$jscomp$loop$prop$n$148$237&&
Aa(function(){c.writable=!0;c.emit("drain")},c.setTimeoutFn)}}(b))}};ma.prototype.doClose=function(){void 0!==this.ws&&(this.ws.close(),this.ws=null)};ma.prototype.uri=function(){var a=this.query||{},c=this.opts.secure?"wss":"ws",d="";this.opts.port&&("wss"===c&&443!==Number(this.opts.port)||"ws"===c&&80!==Number(this.opts.port))&&(d=":"+this.opts.port);this.opts.timestampRequests&&(a[this.opts.timestampParam]=b());this.supportsBinary||(a.b64=1);a=D.encode(a);return c+"://"+(-1!==this.opts.hostname.indexOf(":")?
"["+this.opts.hostname+"]":this.opts.hostname)+d+this.opts.path+(a.length?"?"+a:"")};ma.prototype.check=function(){return!(!ka||"__initialize"in ka&&this.name===ma.prototype.name)};$jscomp.global.Object.defineProperties(ma.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"websocket"}}});l=function(a){var c;if(c=V.call(this,a)||this,"undefined"!=typeof location){var b="https:"===location.protocol,d=location.port;d||(d=b?"443":"80");c.xd="undefined"!=typeof location&&a.hostname!==
location.hostname||d!==a.port;c.xs=a.secure!==b}a=a&&a.forceBase64;c.supportsBinary=fa&&!a;return c};$jscomp.inherits(l,V);l.prototype.request=function(a){a=void 0===a?{}:a;return Object.assign(a,{xd:this.xd,xs:this.xs},this.opts),new aa(this.uri(),a)};l.prototype.doWrite=function(a,c){var b=this;a=this.request({method:"POST",data:a});a.on("success",c);a.on("error",function(a){b.onError("xhr post error",a)})};l.prototype.doPoll=function(){var a=this,c=this.request();c.on("data",this.onData.bind(this));
c.on("error",function(c){a.onError("xhr poll error",c)});this.pollXhr=c};var va={websocket:ma,polling:l},W=function(a,c){c=void 0===c?{}:c;var b=d.call(this)||this;a&&"object"==typeof a&&(c=a,a=null);a?(a=z(a),c.hostname=a.host,c.secure="https"===a.protocol||"wss"===a.protocol,c.port=a.port,a.query&&(c.query=a.query)):c.host&&(c.hostname=z(c.host).host);m(b,c);b.secure=null!=c.secure?c.secure:"undefined"!=typeof location&&"https:"===location.protocol;c.hostname&&!c.port&&(c.port=b.secure?"443":"80");
b.hostname=c.hostname||("undefined"!=typeof location?location.hostname:"localhost");b.port=c.port||("undefined"!=typeof location&&location.port?location.port:b.secure?"443":"80");b.transports=c.transports||["polling","websocket"];b.readyState="";b.writeBuffer=[];b.prevBufferLen=0;b.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},c);
b.opts.path=b.opts.path.replace(/\/$/,"")+"/";"string"==typeof b.opts.query&&(b.opts.query=D.decode(b.opts.query));b.id=null;b.upgrades=null;b.pingInterval=null;b.pingTimeout=null;b.pingTimeoutTimer=null;"function"==typeof addEventListener&&(b.opts.closeOnBeforeunload&&addEventListener("beforeunload",function(){f.transport&&(f.transport.removeAllListeners(),f.transport.close())},!1),"localhost"!==b.hostname&&(b.offlineEventListener=function(){f.onClose("transport close")},addEventListener("offline",
b.offlineEventListener,!1)));b.open();var f=b;return b};$jscomp.inherits(W,d);W.prototype.createTransport=function(a){var c=this.opts.query,b={},d;for(d in c)c.hasOwnProperty(d)&&(b[d]=c[d]);b.EIO=4;b.transport=a;this.id&&(b.sid=this.id);c=Object.assign({},this.opts.transportOptions[a],this.opts,{query:b,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new va[a](c)};W.prototype.open=function(){var a=this;if(this.opts.rememberUpgrade&&W.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))var c=
"websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(function(){a.emitReserved("error","No transports available")},0);c=this.transports[0]}this.readyState="opening";try{c=this.createTransport(c)}catch(Pa){return this.transports.shift(),void this.open()}c.open();this.setTransport(c)};W.prototype.setTransport=function(a){var c=this;this.transport&&this.transport.removeAllListeners();this.transport=a;a.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",
this.onError.bind(this)).on("close",function(){c.onClose("transport close")})};W.prototype.probe=function(a){function c(){e||(e=!0,l(),k.close(),k=null)}function b(){p("transport closed")}function d(){p("socket closed")}function f(a){k&&a.name!==k.name&&c()}var g=this,k=this.createTransport(a),e=!1;W.priorWebsocketSuccess=!1;var m=function(){e||(k.send([{type:"ping",data:"probe"}]),k.once("packet",function(a){if(!e)if("pong"===a.type&&"probe"===a.data){if(g.upgrading=!0,g.emitReserved("upgrading",
k),k)W.priorWebsocketSuccess="websocket"===k.name,g.transport.pause(function(){e||"closed"!==g.readyState&&(l(),g.setTransport(k),k.send([{type:"upgrade"}]),g.emitReserved("upgrade",k),k=null,g.upgrading=!1,g.flush())})}else a=Error("probe error"),a.transport=k.name,g.emitReserved("upgradeError",a)}))},p=function(a){a=Error("probe error: "+a);a.transport=k.name;c();g.emitReserved("upgradeError",a)},l=function(){k.removeListener("open",m);k.removeListener("error",p);k.removeListener("close",b);g.off("close",
d);g.off("upgrading",f)};k.once("open",m);k.once("error",p);k.once("close",b);this.once("close",d);this.once("upgrading",f);k.open()};W.prototype.onOpen=function(){if(this.readyState="open",W.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause)for(var a=0,c=this.upgrades.length;a<c;a++)this.probe(this.upgrades[a])};W.prototype.onPacket=function(a){if("opening"===this.readyState||"open"===this.readyState||
"closing"===this.readyState)switch(this.emitReserved("packet",a),this.emitReserved("heartbeat"),a.type){case "open":this.onHandshake(JSON.parse(a.data));break;case "ping":this.resetPingTimeout();this.sendPacket("pong");this.emitReserved("ping");this.emitReserved("pong");break;case "error":var c=Error("server error");c.code=a.data;this.onError(c);break;case "message":this.emitReserved("data",a.data),this.emitReserved("message",a.data)}};W.prototype.onHandshake=function(a){this.emitReserved("handshake",
a);this.id=a.sid;this.transport.query.sid=a.sid;this.upgrades=this.filterUpgrades(a.upgrades);this.pingInterval=a.pingInterval;this.pingTimeout=a.pingTimeout;this.onOpen();"closed"!==this.readyState&&this.resetPingTimeout()};W.prototype.resetPingTimeout=function(){var a=this;this.clearTimeoutFn(this.pingTimeoutTimer);this.pingTimeoutTimer=this.setTimeoutFn(function(){a.onClose("ping timeout")},this.pingInterval+this.pingTimeout);this.opts.autoUnref&&this.pingTimeoutTimer.unref()};W.prototype.onDrain=
function(){this.writeBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()};W.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emitReserved("flush"))};W.prototype.write=function(a,c,b){return this.sendPacket("message",a,c,b),this};W.prototype.send=function(a,c,b){return this.sendPacket("message",
a,c,b),this};W.prototype.sendPacket=function(a,c,b,d){if("function"==typeof c&&(d=c,c=void 0),"function"==typeof b&&(d=b,b=null),"closing"!==this.readyState&&"closed"!==this.readyState)(b=b||{}).compress=!1!==b.compress,a={type:a,data:c,options:b},this.emitReserved("packetCreate",a),this.writeBuffer.push(a),d&&this.once("flush",d),this.flush()};W.prototype.close=function(){var a=this,c=function(){a.onClose("forced close");a.transport.close()},b=function(){a.off("upgrade",b);a.off("upgradeError",b);
c()},d=function(){a.once("upgrade",b);a.once("upgradeError",b)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",function(){a.upgrading?d():c()}):this.upgrading?d():c()),this};W.prototype.onError=function(a){W.priorWebsocketSuccess=!1;this.emitReserved("error",a);this.onClose("transport error",a)};W.prototype.onClose=function(a,c){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),
this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",a,c),this.writeBuffer=[],this.prevBufferLen=0)};W.prototype.filterUpgrades=function(a){for(var c=[],b=0,d=a.length;b<d;b++)~this.transports.indexOf(a[b])&&c.push(a[b]);return c};W.protocol=4;W.protocol;var sa="function"==typeof ArrayBuffer;
l=Object.prototype.toString;var Fa="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===l.call(Blob),Fb="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===l.call(File),P;!function(a){a[a.CONNECT=0]="CONNECT";a[a.DISCONNECT=1]="DISCONNECT";a[a.EVENT=2]="EVENT";a[a.ACK=3]="ACK";a[a.CONNECT_ERROR=4]="CONNECT_ERROR";a[a.BINARY_EVENT=5]="BINARY_EVENT";a[a.BINARY_ACK=6]="BINARY_ACK"}(P||(P={}));var T=function(){return d.call(this)||this};$jscomp.inherits(T,
d);T.prototype.add=function(a){if("string"==typeof a)a=this.decodeString(a),a.type===P.BINARY_EVENT||a.type===P.BINARY_ACK?(this.reconstructor=new na(a),0===a.attachments&&d.prototype.emitReserved.call(this,"decoded",a)):d.prototype.emitReserved.call(this,"decoded",a);else{if(!p(a)&&!a.base64)throw Error("Unknown type: "+a);if(!this.reconstructor)throw Error("got binary data when not reconstructing a packet");(a=this.reconstructor.takeBinaryData(a))&&(this.reconstructor=null,d.prototype.emitReserved.call(this,
"decoded",a))}};T.prototype.decodeString=function(a){var c=0,b={type:Number(a.charAt(0))};if(void 0===P[b.type])throw Error("unknown packet type "+b.type);if(b.type===P.BINARY_EVENT||b.type===P.BINARY_ACK){for(var d=c+1;"-"!==a.charAt(++c)&&c!=a.length;);d=a.substring(d,c);if(d!=Number(d)||"-"!==a.charAt(c))throw Error("Illegal attachments");b.attachments=Number(d)}if("/"===a.charAt(c+1)){for(d=c+1;++c&&","!==a.charAt(c)&&c!==a.length;);b.nsp=a.substring(d,c)}else b.nsp="/";d=a.charAt(c+1);if(""!==
d&&Number(d)==d){for(d=c+1;++c;){var f=a.charAt(c);if(null==f||Number(f)!=f){--c;break}if(c===a.length)break}b.id=Number(a.substring(d,c+1))}if(a.charAt(++c)){a=a.substr(c);try{var g=JSON.parse(a)}catch(Ba){g=!1}if(!T.isPayloadValid(b.type,g))throw Error("invalid payload");b.data=g}return b};T.isPayloadValid=function(a,c){switch(a){case P.CONNECT:return"object"==typeof c;case P.DISCONNECT:return void 0===c;case P.CONNECT_ERROR:return"string"==typeof c||"object"==typeof c;case P.EVENT:case P.BINARY_EVENT:return Array.isArray(c)&&
0<c.length;case P.ACK:case P.BINARY_ACK:return Array.isArray(c)}};T.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};var na=function(a){this.packet=a;this.buffers=[];this.reconPack=a};na.prototype.takeBinaryData=function(a){return(this.buffers.push(a),this.buffers.length===this.reconPack.attachments)?(a=this.reconPack,a=(a.data=t(a.data,this.buffers),a.attachments=void 0,a),this.finishedReconstruction(),a):null};na.prototype.finishedReconstruction=function(){this.reconPack=
null;this.buffers=[]};l=function(){};l.prototype.encode=function(a){return a.type!==P.EVENT&&a.type!==P.ACK||!k(a)?[this.encodeAsString(a)]:(a.type=a.type===P.EVENT?P.BINARY_EVENT:P.BINARY_ACK,this.encodeAsBinary(a))};l.prototype.encodeAsString=function(a){var c=""+a.type;return a.type!==P.BINARY_EVENT&&a.type!==P.BINARY_ACK||(c+=a.attachments+"-"),a.nsp&&"/"!==a.nsp&&(c+=a.nsp+","),null!=a.id&&(c+=a.id),null!=a.data&&(c+=JSON.stringify(a.data)),c};l.prototype.encodeAsBinary=function(a){var c=[];
c=(a.data=v(a.data,c),a.attachments=c.length,{packet:a,buffers:c});a=this.encodeAsString(c.packet);c=c.buffers;return c.unshift(a),c};var wa=Object.freeze({__proto__:null,protocol:5,get PacketType(){return P},Encoder:l,Decoder:T}),X=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),J=function(a,c,b){var f=d.call(this)||this;f.connected=!1;f.disconnected=!0;f.receiveBuffer=[];f.sendBuffer=[];f.ids=0;f.acks={};f.flags={};f.io=a;f.nsp=c;b&&b.auth&&
(f.auth=b.auth);f.io._autoConnect&&f.open();return f};$jscomp.inherits(J,d);J.prototype.subEvents=function(){if(!this.subs){var a=this.io;this.subs=[w(a,"open",this.onopen.bind(this)),w(a,"packet",this.onpacket.bind(this)),w(a,"error",this.onerror.bind(this)),w(a,"close",this.onclose.bind(this))]}};J.prototype.connect=function(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this};J.prototype.open=function(){return this.connect()};
J.prototype.send=function(a){for(var c=[],b=0;b<arguments.length;++b)c[b-0]=arguments[b];return c.unshift("message"),this.emit.apply(this,c),this};J.prototype.emit=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];if(X.hasOwnProperty(a))throw Error('"'+a+'" is a reserved event name');b.unshift(a);d={type:P.EVENT,data:b,options:{}};if(d.options.compress=!1!==this.flags.compress,"function"==typeof b[b.length-1]){var f=this.ids++;b=b.pop();this._registerAckCallback(f,b);d.id=
f}b=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!b||!this.connected)||(this.connected?this.packet(d):this.sendBuffer.push(d)),this.flags={},this};J.prototype._registerAckCallback=function(a,c){var b=this,d=this.flags.timeout;if(void 0===d)return void(this.acks[a]=c);var f=this.io.setTimeoutFn(function(){delete b.acks[a];for(var d=0;d<b.sendBuffer.length;d++)b.sendBuffer[d].id===a&&b.sendBuffer.splice(d,1);c.call(b,Error("operation has timed out"))},
d);this.acks[a]=function(a){for(var d=[],g=0;g<arguments.length;++g)d[g-0]=arguments[g];b.io.clearTimeoutFn(f);c.apply(b,[null].concat($jscomp.arrayFromIterable(d)))}};J.prototype.packet=function(a){a.nsp=this.nsp;this.io._packet(a)};J.prototype.onopen=function(){var a=this;"function"==typeof this.auth?this.auth(function(c){a.packet({type:P.CONNECT,data:c})}):this.packet({type:P.CONNECT,data:this.auth})};J.prototype.onerror=function(a){this.connected||this.emitReserved("connect_error",a)};J.prototype.onclose=
function(a){this.connected=!1;this.disconnected=!0;delete this.id;this.emitReserved("disconnect",a)};J.prototype.onpacket=function(a){if(a.nsp===this.nsp)switch(a.type){case P.CONNECT:if(a.data&&a.data.sid)this.onconnect(a.data.sid);else this.emitReserved("connect_error",Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case P.EVENT:case P.BINARY_EVENT:this.onevent(a);
break;case P.ACK:case P.BINARY_ACK:this.onack(a);break;case P.DISCONNECT:this.ondisconnect();break;case P.CONNECT_ERROR:this.destroy();var c=Error(a.data.message);c.data=a.data.data;this.emitReserved("connect_error",c)}};J.prototype.onevent=function(a){var c=a.data||[];null!=a.id&&c.push(this.ack(a.id));this.connected?this.emitEvent(c):this.receiveBuffer.push(Object.freeze(c))};J.prototype.emitEvent=function(a){if(this._anyListeners&&this._anyListeners.length){var c=this._anyListeners.slice();c=$jscomp.makeIterator(c);
for(var b=c.next();!b.done;b=c.next())b.value.apply(this,a)}d.prototype.emit.apply(this,a)};J.prototype.ack=function(a){var c=this,b=!1;return function(d){for(var f=[],g=0;g<arguments.length;++g)f[g-0]=arguments[g];b||(b=!0,c.packet({type:P.ACK,id:a,data:f}))}};J.prototype.onack=function(a){var c=this.acks[a.id];"function"==typeof c&&(c.apply(this,a.data),delete this.acks[a.id])};J.prototype.onconnect=function(a){this.id=a;this.connected=!0;this.disconnected=!1;this.emitBuffered();this.emitReserved("connect")};
J.prototype.emitBuffered=function(){var a=this;this.receiveBuffer.forEach(function(c){return a.emitEvent(c)});this.receiveBuffer=[];this.sendBuffer.forEach(function(c){return a.packet(c)});this.sendBuffer=[]};J.prototype.ondisconnect=function(){this.destroy();this.onclose("io server disconnect")};J.prototype.destroy=function(){this.subs&&(this.subs.forEach(function(a){return a()}),this.subs=void 0);this.io._destroy(this)};J.prototype.disconnect=function(){return this.connected&&this.packet({type:P.DISCONNECT}),
this.destroy(),this.connected&&this.onclose("io client disconnect"),this};J.prototype.close=function(){return this.disconnect()};J.prototype.compress=function(a){return this.flags.compress=a,this};J.prototype.timeout=function(a){return this.flags.timeout=a,this};J.prototype.onAny=function(a){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(a),this};J.prototype.prependAny=function(a){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(a),this};J.prototype.offAny=
function(a){if(!this._anyListeners)return this;if(a)for(var c=this._anyListeners,b=0;b<c.length;b++){if(a===c[b])return c.splice(b,1),this}else this._anyListeners=[];return this};J.prototype.listenersAny=function(){return this._anyListeners||[]};$jscomp.global.Object.defineProperties(J.prototype,{active:{configurable:!0,enumerable:!0,get:function(){return!!this.subs}},volatile:{configurable:!0,enumerable:!0,get:function(){return this.flags.volatile=!0,this}}});q.prototype.duration=function(){var a=
this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var c=Math.random(),b=Math.floor(c*this.jitter*a);a=0==(1&Math.floor(10*c))?a-b:a+b}return 0|Math.min(a,this.max)};q.prototype.reset=function(){this.attempts=0};q.prototype.setMin=function(a){this.ms=a};q.prototype.setMax=function(a){this.max=a};q.prototype.setJitter=function(a){this.jitter=a};var Q=function(a,c){var b;var f=d.call(this)||this;f.nsps={};f.subs=[];a&&"object"==typeof a&&(c=a,a=void 0);(c=c||{}).path=c.path||"/socket.io";
f.opts=c;m(f,c);f.reconnection(!1!==c.reconnection);f.reconnectionAttempts(c.reconnectionAttempts||1/0);f.reconnectionDelay(c.reconnectionDelay||1E3);f.reconnectionDelayMax(c.reconnectionDelayMax||5E3);f.randomizationFactor(null!==(b=c.randomizationFactor)&&void 0!==b?b:.5);f.backoff=new q({min:f.reconnectionDelay(),max:f.reconnectionDelayMax(),jitter:f.randomizationFactor()});f.timeout(null==c.timeout?2E4:c.timeout);f._readyState="closed";f.uri=a;a=c.parser||wa;f.encoder=new a.Encoder;f.decoder=
new a.Decoder;f._autoConnect=!1!==c.autoConnect;f._autoConnect&&f.open();return f};$jscomp.inherits(Q,d);Q.prototype.reconnection=function(a){return arguments.length?(this._reconnection=!!a,this):this._reconnection};Q.prototype.reconnectionAttempts=function(a){return void 0===a?this._reconnectionAttempts:(this._reconnectionAttempts=a,this)};Q.prototype.reconnectionDelay=function(a){var c;return void 0===a?this._reconnectionDelay:(this._reconnectionDelay=a,null===(c=this.backoff)||void 0===c||c.setMin(a),
this)};Q.prototype.randomizationFactor=function(a){var c;return void 0===a?this._randomizationFactor:(this._randomizationFactor=a,null===(c=this.backoff)||void 0===c||c.setJitter(a),this)};Q.prototype.reconnectionDelayMax=function(a){var c;return void 0===a?this._reconnectionDelayMax:(this._reconnectionDelayMax=a,null===(c=this.backoff)||void 0===c||c.setMax(a),this)};Q.prototype.timeout=function(a){return arguments.length?(this._timeout=a,this):this._timeout};Q.prototype.maybeReconnectOnOpen=function(){!this._reconnecting&&
this._reconnection&&0===this.backoff.attempts&&this.reconnect()};Q.prototype.open=function(a){var c=this;if(~this._readyState.indexOf("open"))return this;var b=this.engine=new W(this.uri,this.opts),d=this;this._readyState="opening";this.skipReconnect=!1;var f=w(b,"open",function(){d.onopen();a&&a()}),g=w(b,"error",function(b){d.cleanup();d._readyState="closed";c.emitReserved("error",b);a?a(b):d.maybeReconnectOnOpen()});if(!1!==this._timeout){var k=this._timeout;0===k&&f();var e=this.setTimeoutFn(function(){f();
b.close();b.emit("error",Error("timeout"))},k);this.opts.autoUnref&&e.unref();this.subs.push(function(){clearTimeout(e)})}return this.subs.push(f),this.subs.push(g),this};Q.prototype.connect=function(a){return this.open(a)};Q.prototype.onopen=function(){this.cleanup();this._readyState="open";this.emitReserved("open");var a=this.engine;this.subs.push(w(a,"ping",this.onping.bind(this)),w(a,"data",this.ondata.bind(this)),w(a,"error",this.onerror.bind(this)),w(a,"close",this.onclose.bind(this)),w(this.decoder,
"decoded",this.ondecoded.bind(this)))};Q.prototype.onping=function(){this.emitReserved("ping")};Q.prototype.ondata=function(a){this.decoder.add(a)};Q.prototype.ondecoded=function(a){this.emitReserved("packet",a)};Q.prototype.onerror=function(a){this.emitReserved("error",a)};Q.prototype.socket=function(a,c){var b=this.nsps[a];return b||(b=new J(this,a,c),this.nsps[a]=b),b};Q.prototype._destroy=function(a){a=Object.keys(this.nsps);a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())if(this.nsps[c.value].active)return;
this._close()};Q.prototype._packet=function(a){for(var c=this.encoder.encode(a),b=0;b<c.length;b++)this.engine.write(c[b],a.options)};Q.prototype.cleanup=function(){this.subs.forEach(function(a){return a()});this.subs.length=0;this.decoder.destroy()};Q.prototype._close=function(){this.skipReconnect=!0;this._reconnecting=!1;this.onclose("forced close");this.engine&&this.engine.close()};Q.prototype.disconnect=function(){return this._close()};Q.prototype.onclose=function(a){this.cleanup();this.backoff.reset();
this._readyState="closed";this.emitReserved("close",a);this._reconnection&&!this.skipReconnect&&this.reconnect()};Q.prototype.reconnect=function(){var a=this;if(this._reconnecting||this.skipReconnect)return this;var c=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var b=this.backoff.duration();this._reconnecting=!0;var d=this.setTimeoutFn(function(){c.skipReconnect||(a.emitReserved("reconnect_attempt",
c.backoff.attempts),c.skipReconnect||c.open(function(b){b?(c._reconnecting=!1,c.reconnect(),a.emitReserved("reconnect_error",b)):c.onreconnect()}))},b);this.opts.autoUnref&&d.unref();this.subs.push(function(){clearTimeout(d)})}};Q.prototype.onreconnect=function(){var a=this.backoff.attempts;this._reconnecting=!1;this.backoff.reset();this.emitReserved("reconnect",a)};var xa={};Object.assign(c,{Manager:Q,Socket:J,io:c,connect:c})},function(l,r,n){var e=n(2),u=n(43);l=n(1);var m=n.n(l);r.a=function(d){var a=
Object(e.a)({});a.id=d.id;a.stream=d.stream.stream;a.elementID=d.elementID;var b=d.stream.getPlayerId(d.vroom?d.vroom:d.stream.room);a.audio=document.createElement("audio");a.audio.setAttribute("id",""+b.stream);a.audio.setAttribute("class","vcx_stream");a.audio.setAttribute("style","width: 100%; height: 100%; position: absolute");a.audio.setAttribute("autoplay","autoplay");d.stream.local&&(a.audio.volume=0);void 0!==a.elementID?(a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.div)},
a.div=document.createElement("div"),a.div.setAttribute("id",""+b.player),a.div.setAttribute("class","vcx_player"),a.div.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;"),a.container="object"===typeof a.elementID&&"function"===typeof a.elementID.appendChild?a.elementID:document.getElementById(a.elementID),a.container.appendChild(a.div),a.parentNode=a.div.parentNode,a.div.appendChild(a.audio),!1!==d.options.bar?(a.bar=Object(u.a)({elementID:""+b.player,id:a.id,
stream:d.stream,media:a.audio,options:d.options}),a.div.onmouseover=void 0,a.div.onmouseout=void 0):a.media=a.audio):(a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.audio)},document.body.appendChild(a.audio),a.parentNode=document.body);var g=void 0,l=d=void 0,p=b=void 0,k=void 0;m.a.csp_enabled||(g=document.createElement("div"),g.setAttribute("id","stats-container-"+a.id),g.setAttribute("class","stats-container"),g.setAttribute("style","display:none;"),d=document.createElement("div"),
d.setAttribute("id","stats-button-"+a.id),d.setAttribute("class","stats-button"),d.setAttribute("title","Click to see stats"),d.innerHTML=window.statsIcon,g.appendChild(d),l=document.createElement("div"),l.setAttribute("class","stats-overlay"),l.setAttribute("id","stats-overlay-"+a.id),l.setAttribute("style","display:none;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);"),b=document.createElement("div"),b.setAttribute("class","stats-overlay-inner"),b.setAttribute("id",
"stats-overlay-inner-"+a.id),p=document.createElement("div"),k=document.createElement("div"),p.setAttribute("class","stats-left-partition"),p.setAttribute("id","stats-left-part-"+a.id),k.setAttribute("class","stats-right-partition"),k.setAttribute("id","stats-right-part-"+a.id),d.addEventListener("click",function(){l.style.display="none"===l.style.display?"block":"none"}),a.div.parentNode.style.position="relative",a.div.parentNode.appendChild(g),a.div.parentNode.appendChild(l),l.appendChild(b),b.appendChild(p),
b.appendChild(k));a.audio.srcObject=a.stream;a.ShowSessionStats=function(a){a?(g.setAttribute("style","display:block;"),l.setAttribute("style","display:block;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);")):(g.setAttribute("style","display:none;"),l.setAttribute("style","display:none;position: absolute;z-index:3;padding: 5px;top:0;right:0;background: rgba(20, 198, 239, 0.75);"))};return a}},function(l,r,n){var e=n(15),u=n(2),m=n(3),d=n(44),a=n(45),b=
n(46),g=n(47),x=n(48),p=n(49),k=n(50),v=n(10);r.a=function(l){var n=Object(u.a)({});var q=Object(e.a)().toolbar.default;var c=!1;void 0!==l.options&&void 0!==l.options.player&&(n.playerProperties=l.options.player);if(l.options.toolbar){var t=l.options.toolbar;m.a.checkParam(t.position)&&(q.position=t.position);m.a.checkParam(t.class)&&(q.class=t.class);m.a.checkParam(t.skin)&&(q.skin=t.skin,c="default"===q.skin);m.a.checkParam(t.displayMode);q.displayMode=t.displayMode;m.a.checkParam(t.autoDisplayTimeout)&&
(q.autoDisplayTimeout=t.autoDisplayTimeout);t.buttons&&(q.buttons=t.buttons)}n.elementID=l.elementID;n.id=l.id;n.div=c?Object(m.a)({name:"div",id:"bar_"+n.id,class:"vcx_bar",style:v.a.vcx_bar}):Object(m.a)({name:"div",id:"bar_"+n.id,class:"vcx_bar "+q.skin+"_vcx_bar"});m.a.getById(n.elementID).appendChild(n.div);n.bar=c?Object(m.a)({name:"div",id:"subbar_"+n.id,class:"vcx_subbar "+q.class,style:v.a["vcx_subbar_"+q.position]}):Object(m.a)({name:"div",id:"subbar_"+n.id,class:"vcx_subbar "+q.skin+"_vcx_subbar_"+
q.position+" "+q.class});n.div.appendChild(n.bar);(function(a){function c(a){a=a||window.event;e=a.clientX;m=a.clientY;document.onmouseup=d;document.onmousemove=b}function b(c){c=c||window.event;g=e-c.clientX;k=m-c.clientY;e=c.clientX;m=c.clientY;a.style.top=a.offsetTop-k+"px";a.style.left=a.offsetLeft-g+"px"}function d(){document.onmouseup=null;document.onmousemove=null}var g=0,k=0,e=0,m=0;document.getElementById(a.id)?document.getElementById(a.id).onmousedown=c:a.onmousedown=c})(n.bar);q.buttons.play&&
(n.playIcon=Object(p.a)({stream:l.stream,skin:q.skin}),n.bar.appendChild(n.playIcon));q.buttons.zoom&&(n.zoomIcon=Object(a.a)({skin:q.skin,player:n.playerProperties}),n.bar.appendChild(n.zoomIcon));q.buttons.record&&(n.recIcon=Object(g.a)({skin:q.skin,stream:l.stream}),n.bar.appendChild(n.recIcon));q.buttons.share&&(n.shareIcon=Object(x.a)({skin:q.skin,stream:l.stream}),n.bar.appendChild(n.shareIcon));q.buttons.mic&&(n.micIcon=Object(k.a)({skin:q.skin,stream:l.stream}),n.bar.appendChild(n.micIcon));
c={};l.options&&l.options.toolbar&&l.options.toolbar.branding&&(c=l.options.toolbar.branding);c.skin=q.skin;n.brand=Object(b.a)(c);n.bar.appendChild(n.brand);!q.buttons.volume||l.stream.screen||void 0!==l.options&&void 0!==l.options.speaker&&!0!==l.options.speaker||(n.speaker=Object(d.a)({elementID:"subbar_"+n.id,id:n.id,stream:l.stream,media:l.media,position:q.position,skin:q.skin}));q.displayMode?"auto"==q.displayMode?(n.div.onmouseover=function(a){var c=a.currentTarget;setTimeout(function(){m.a.getByClass("vcx_subbar",
c).style.display="block"},1E3*parseInt(q.autoDisplayTimeout))},n.div.onmouseout=function(a){var c=a.currentTarget;setTimeout(function(){m.a.getByClass("vcx_subbar",c).style.display="none"},1E3*parseInt(q.autoDisplayTimeout))},m.a.getByClass("vcx_subbar",n.div).style.display="none"):m.a.getByClass("vcx_subbar",n.div).style.display="block":m.a.getByClass("vcx_subbar",n.div).style.display="none";return n}},function(l,r,n){var e=n(3),u=n(2),m=n(10);r.a=function(d){var a=Object(u.a)({}),b=50,g="default"===
d.skin;a.elementID=d.elementID;a.media=d.media;a.id=d.id;a.stream=d.stream;a.div=g?Object(e.a)({name:"i",class:"fa fa-volume-up fa-fw fa-lg",style:Object.assign(m.a.icon,m.a.icon_volume),id:"volume_"+a.id}):Object(e.a)({name:"i",class:"fa fa-volume-up fa-fw fa-lg "+d.skin+"_icon "+d.skin+"_icon_volume",id:"volume_"+a.id});e.a.setStyle(a.div,d.position,"0");a.div.onclick=function(){a.media.muted?(a.media.muted=!1,a.div.classList.remove("fa-volume-off"),a.div.classList.add("fa-volume-up"),a.stream.local?
a.stream.stream.getAudioTracks()[0].enabled=!0:(a.picker.value=b,a.media.volume=a.picker.value/100)):(a.media.muted=!0,a.div.classList.remove("fa-volume-up"),a.div.classList.add("fa-volume-off"),a.stream.local?a.stream.stream.getAudioTracks()[0].enabled=!1:(b=a.picker.value,a.picker.value=0,a.media.volume=0))};if(!a.stream.local){a.picker=document.createElement("input");a.picker.setAttribute("id","picker_"+a.id);a.picker.setAttribute("style","position: absolute;max-width: 50px;margin: 1.1%;top:0;");
a.picker.type="range";a.picker.min=0;a.picker.max=1;a.picker.step=.1;a.picker.value=b;a.picker.setAttribute("orient","vertical");a.div.appendChild(a.picker);a.media.volume=a.picker.value;a.media.muted=!1;a.picker.onclick=function(){0<a.picker.value?(a.media.muted=!1,a.div.classList.remove("fa-volume-off"),a.div.classList.add("fa-volume-up")):(a.media.muted=!0,a.div.classList.remove("fa-volume-up"),a.div.classList.add("fa-volume-off"));a.media.volume=a.picker.value};var l=function(b){a.picker.setAttribute("style",
"position: absolute;max-width: 50px;margin: 1.1%;margin-left:32px;top:0;display: "+b)};a.div.onmouseover=function(){l("block")};a.picker.onmouseout=function(){l("none")};l("none")}document.getElementById(a.elementID).appendChild(a.div);return a}},function(l,r,n){var e=n(3);n(2);var u=n(10),m=!1,d=function(a){var b=(m="default"===a.skin)?Object(e.a)({name:"i",title:"zoom",class:"fa fa-expand  fa-lg icon_zoom ",style:Object.assign(u.a.icon,u.a.icon_zoom)}):Object(e.a)({name:"i",title:"zoom",class:"fa fa-expand icon_zoom "+
a.skin+"_icon fa-lg "+a.skin+"_icon_zoom"});b.onclick=function(b){b.stopPropagation();d.click(b,a)};return b};d.click=function(a,b){var d=b.skin;b={height:b.player.height,width:b.player.width,position:"relative"};var l=a.currentTarget.classList;l.contains("fa-expand")?(a.currentTarget.classList.remove("fa-expand"),a.currentTarget.classList.add("fa-arrows-alt"),m?a.currentTarget.parentNode.parentNode.parentNode.parentNode.setAttribute("style",e.a.getStyle(u.a.full_view)):a.currentTarget.parentNode.parentNode.parentNode.classList.add(d+
"_theater_view")):l.contains("fa-arrows-alt")?(a.currentTarget.classList.remove("fa-arrows-alt"),a.currentTarget.classList.add("fa-compress"),m?(a.currentTarget.parentNode.parentNode.parentNode.parentNode.removeAttribute("style"),a.currentTarget.parentNode.parentNode.parentNode.parentNode.setAttribute("style",e.a.getStyle(u.a.full_view))):(a.currentTarget.parentNode.parentNode.parentNode.parentNode.classList.remove(d+"_theater_view"),a.currentTarget.parentNode.parentNode.parentNode.parentNode.classList.add(d+
"_full_view"))):l.contains("fa-compress")&&(a.currentTarget.classList.remove("fa-compress"),a.currentTarget.classList.add("fa-expand"),m?(a.currentTarget.parentNode.parentNode.parentNode.parentNode.removeAttribute("style"),a.currentTarget.parentNode.parentNode.parentNode.parentNode.setAttribute("style",e.a.getStyle(b))):a.currentTarget.parentNode.parentNode.parentNode.classList.remove(d+"_full_view"))};r.a=d},function(l,r,n){var e=n(15),u=n(3),m=n(2),d=n(10);r.a=function(a){Object(m.a)({});var b=
!1,g=Object(e.a)().brand.default;a&&(u.a.checkParam(a.clickthru)&&(g.url=a.clickthru),a.target&&"current"==a.target&&(g.target="_self"),u.a.checkParam(a.logo)&&(g.logo=a.logo),u.a.checkParam(a.title)&&(g.title=a.title),void 0!==a.display&&(g.display=a.display),b="default"===a.skin);var l=Object(u.a)({name:"a",title:g.title,href:g.url,target:g.target});a=b?Object(u.a)({name:"img",src:g.logo,style:d.a.brand_logo}):Object(u.a)({name:"img",class:a.skin+"_brand_logo",src:g.logo});l.appendChild(a);u.a.checkParam(g.display)||
(l.style.display="none");return l}},function(l,r,n){var e=n(3),u=n(2),m=function(d){Object(u.a)({});var a=Object(e.a)({name:"i",title:"record",class:"fa fa-circle fa-fw fa-lg icon_record "+d.skin+"_icon "+d.skin+"_icon_record"});a.onclick=function(a){m.click(a,d.stream)};return a};m.click=function(d,a){var b=d.currentTarget.classList;b.contains("fa-circle")?(d.currentTarget.classList.remove("fa-circle"),d.currentTarget.classList.add("fa-stop-circle"),a.local||a.room.startRecording(a,function(a){})):
b.contains("fa-stop-circle")&&(d.currentTarget.classList.remove("fa-stop-circle"),d.currentTarget.classList.add("fa-circle"),a.recordingId&&a.room.stopRecording(a.recordingId,function(b){b&&(a.recordingId=void 0)}))};r.a=m},function(l,r,n){var e=n(3),u=n(2),m=function(d){Object(u.a)({});var a=d.stream;d=Object(e.a)({name:"i",title:"share screen",class:"fa fa-share-alt fa-fw fa-lg icon_share "+d.skin+"_icon "+d.skin+"_icon_share"});d.onclick=function(b){m.click(b,a)};return d};m.click=function(d,a){var b=
VcxRtc.Stream({screen:!0,data:!0,attributes:{name:"shareStream"}});b.init();b.addEventListener("media-access-allowed",function(){a.room.publish(b,{maxVideoBW:300},function(a,b){})});b.addEventListener("media-access-denied",function(a){})};r.a=m},function(l,r,n){var e=n(3),u=n(2);n(11);var m=n(10),d=function(a){Object(u.a)({});a="default"===a.skin?Object(e.a)({name:"i",title:"pause",class:"fa fa-pause fa-lg icon_play",style:Object.assign(m.a.icon,m.a.icon_play)}):Object(e.a)({name:"i",title:"pause",
class:"fa fa-pause fa-lg "+a.skin+"_icon icon_play "+a.skin+"_icon_play"});a.onclick=function(a){d.click(a)};return a};d.toggleVideo=function(a){a.srcObject.getTracks().forEach(function(a){return a.enabled=!a.enabled})};d.click=function(a){var b=a.currentTarget.classList;b.contains("fa-pause")?(a.currentTarget.classList.remove("fa-pause"),a.currentTarget.classList.add("fa-play"),b=a.currentTarget.parentNode.parentNode.parentNode,a=e.a.getById("stream"+b.id.split("_")[1]),b=e.a.getById("screen_saver_"+
b.id.split("_")[1]),d.toggleVideo(a),""!==b.src?b.style.display="block":a.pause()):b.contains("fa-play")&&(a.currentTarget.classList.remove("fa-play"),a.currentTarget.classList.add("fa-pause"),b=a.currentTarget.parentNode.parentNode.parentNode,a=e.a.getById("stream"+b.id.split("_")[1]),b=e.a.getById("screen_saver_"+b.id.split("_")[1]),d.toggleVideo(a),""!==b.src?b.style.display="none":a.play())};r.a=d},function(l,r,n){var e=n(3),u=n(2),m=n(10),d=function(a){Object(u.a)({});var b="default"===a.skin;
var g=a.stream;a=b?Object(e.a)({name:"i",title:"microphone",class:"fa fa-microphone fa-fw fa-lg icon_mic",style:Object.assign(m.a.icon,m.a.icon_mic)}):Object(e.a)({name:"i",title:"microphone",class:"fa fa-microphone fa-fw fa-lg icon_mic "+a.skin+"_icon "+a.skin+"_icon_mic"});a.onclick=function(a){d.click(a,g)};return a};d.click=function(a,b){var d=a.currentTarget.classList;d.contains("fa-microphone")?(b.muteAudio(),a.currentTarget.classList.remove("fa-microphone"),a.currentTarget.classList.add("fa-microphone-slash")):
d.contains("fa-microphone-slash")&&(b.unmuteAudio(),a.currentTarget.classList.remove("fa-microphone-slash"),a.currentTarget.classList.add("fa-microphone"))};r.a=d},function(l,r,n){l=n(1);var e=n.n(l),u=n(0).default,m;n=function(){this.audioDestination=this.modifiedStream=this.scriptProcessor=this.sourceStream=this.originalMediaTrack=this.audioContext=void 0;this.bufferResidue=new Float32Array([]);this.audioWorklet=void 0;this.bAnalysisStarted=!1;m=this};n.prototype.initAudioWorklet=function(){var d=
this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(a){return a.return(new Promise(function(a,g){var b,p;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){switch(k.nextAddress){case 1:return k.setCatchFinallyBlocks(2),k.yield(d.audioContext.resume(),4);case 4:b=e.a.noise_suppression_sdk_url;if(!(b&&0<b.trim().length)){u.debug("Error in initializing audio context (worklet URL configuration missing)");g();k.jumpTo(5);break}return k.yield(m.audioContext.audioWorklet.addModule(b),
6);case 6:a(new AudioWorkletNode(m.audioContext,"NoiseSuppressorWorklet"));case 5:k.leaveTryBlock(0);break;case 2:p=k.enterCatchBlock(),u.debug("Error while adding audio worklet module: ",p),g(),k.jumpToEnd()}})}))})};n.prototype.checkFileExists=function(){return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){return d.return(new Promise(function(a,b){var d,m;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress)return g.setCatchFinallyBlocks(2),d=e.a.noise_suppression_sdk_url,
g.yield(fetch(d,{method:"HEAD"}),4);if(2!=g.nextAddress)return m=g.yieldResult,a(m.ok),g.leaveTryBlock(0);g.enterCatchBlock();b(!1);g.jumpToEnd()})}))})};n.prototype.startNoiseProcessing=function(d){var a=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(b){u.info("Starting noise suppression...");return b.return(new Promise(function(b,e){try{a.audioContext=new (window.AudioContext||window.webkitAudioContext),a.initAudioWorklet().then(function(g){g?(a.audioWorklet=g,a.originalMediaTrack=
d.getAudioTracks()[0],a.sourceStream=a.audioContext.createMediaStreamSource(d),a.modifiedStream=new MediaStream,a.audioDestination=a.audioContext.createMediaStreamDestination(),a.outputMediaTrack=a.audioDestination.stream.getAudioTracks()[0],a.sourceStream.connect(a.audioWorklet),a.audioWorklet.connect(a.audioDestination),a.modifiedStream.addTrack(a.audioDestination.stream.getAudioTracks()[0]),a.outputMediaTrack.enabled=a.originalMediaTrack.enabled,a.outputMediaTrack.enabled=!0,a.bAnalysisStarted=
!0,b(a.modifiedStream)):(a.bAnalysisStarted=!1,u.debug("Error while starting noise processing (audio worklet is undefined)"),e())}).catch(function(b){a.bAnalysisStarted=!1;u.debug("Error while starting noise processing: ",b);e()})}catch(p){a.bAnalysisStarted=!1,u.debug("Error while starting noise processing: ",p),e()}}))})};n.prototype.stopNoiseProcessing=function(){var d=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function(a){u.info("Stopping noise suppression...");return a.return(new Promise(function(a,
g){try{d.originalMediaTrack.enabled=d.outputMediaTrack.enabled,d.audioDestination.disconnect(),d.audioWorklet.disconnect(),d.sourceStream.disconnect(),d.audioContext.suspend(),d.bAnalysisStarted=!1,a()}catch(x){d.bAnalysisStarted=!1,u.debug("Error while starting noise processing: ",x),g()}}))})};n.prototype.isAlreadyStarted=function(){return this.bAnalysisStarted};r.a=n},function(l,r,n){var e=n(0),u=n(7),m=n(11),d=n(19);n(14);l=n(1);var a=n.n(l),b=n(4);n(6);n(5);r.a=function(g,l){var p=Object(b.c)(l);
p.rooms=new Map;p.currentBreakOutRoom=null;p.joinRoom=function(g,l,n,w){w=void 0===w?{allow_reconnect:!0,number_of_attempts:3,timeout_interval:45E3}:w;var k=null,c=null;e["default"].info("SDK version is: ",a.a.product.version);if(null!=g){e["default"].info("=========== port of hope");g=JSON.parse(window.atob(g));g.version=a.a.product.version;var v=Object(m.a)(void 0,void 0,{token:d.a.encodeBase64(JSON.stringify(g)),reconnectInfo:w});g=function(){if("IE"===u.a.browserEngineCheck()){var a=document.getElementById("WebrtcEverywherePluginId");
a.addEventListener("room-connected",function(a){p.rooms.set(v.roomID,v);c={streams:a.data.streams,room:v,roomData:a.data.room,localStream:x};v.publish(x,{},function(a){0===a.result?(c.publishId=a.id,n(c,null)):n(null,a)})});a.addEventListener("room-error",function(a){n(c,a.data)});a.addEventListener("stream-added",function(a){v.subscribe(a.data.stream)})}else v.addEventListener("room-connected",function(a){e["default"].info("-----------BreakoutRoom-Connected--------");c={streams:a.streams,room:v,
roomData:a.room,localStream:x};n(c,null);v.publish(x,function(a){0===a.result?c.publishId=a.id:v.dispatchEvent(Object(b.e)({type:"room-error",message:a}))});for(a=0;a<c.streams.length;a++)v.subscribe(c.streams[a],{},function(a){!0===a?e["default"].info("breakout room-subscribe callback success"):(e["default"].info("breakout room-subscribe callback failed, could not subscribe streams",a),v.dispatchEvent(Object(b.e)({type:"room-error",message:a})))});p.rooms.set(v.roomID,v);a=Object(b.e)({type:"breakout-room-connected",
success:c});p.dispatchEvent(a)}),v.addEventListener("room-error",function(a){n(null,a)}),v.addEventListener("stream-added",function(a){v.subscribe(a.stream)}),v.addEventListener("room-disconnected",p.onBreakOutRoomDisconnect.bind(v));!1===v.reconnectionState&&0==v.reconnectAttempt?(e["default"].info("-----------BreakoutRoom-Connecting--------"),v.connect(w)):e["default"].debug(" Reconnection case in join room public api")};var t=function(a){k=a;n(c,k)};if(l.audio||l.video)var x=v.initPublishStream(l.div,
l,g,t);else e["default"].info(" No publish stream. audio and video are disabled.."),g()}return x};p.endBreakOutRoom=function(a){e["default"].info("Breakout Room ended, Disconnecting the room");p.rooms.get(a).disconnect()};p.onBreakOutRoomDisconnect=function(a){var d=Object(b.e)({type:"breakout-room-disconnect",message:{room_id:a.id}});p.rooms.delete(a.roomID);p.dispatchEvent(d)};p.onUserLeft=function(a,b){a=UserEvent({type:"user-disconnected",room_id:a.roomID,name:b.name,clientId:b.clientId,role:b.role,
permission:b.permissions});p.dispatchEvent(a)};p.onUserJoined=function(a,b){a=b.name;var d=b.role,g=b.permissions,k={name:b.name,permissions:b.permissions,role:b.role,user_ref:b.user_ref,videoMuted:b.videoMuted,audioMuted:b.audioMuted};p.userList.set(b.clientId,k);b=UserEvent({type:"user-connected",name:a,clientId:b.clientId,role:d,permission:g,user:k});p.dispatchEvent(b)};p.disconnectAll=function(){p.rooms.forEach(function(a,b){a&&a.disconnect()})};return p}},function(l,r,n){r.a=function(){var e=
{},l={};e.add=function(e,d){l[e]=d};e.get=function(e){return l[e]};e.getAll=function(){return l};e.has=function(e){return void 0!==l[e]};e.forEach=function(e){for(var d=Object.keys(l),a=0;a<d.length;a+=1){var b=d[a];e(l[b],b)}};e.keys=function(){return Object.keys(l)};e.remove=function(e){delete l[e]};e.size=function(){var e=0,d;for(d in l)l.hasOwnProperty(d)&&e++;return e};return e}},function(l,r){r.read=function(l,e,u,m,d){var a=8*d-m-1;var b=(1<<a)-1,g=b>>1,n=-7;d=u?d-1:0;var p=u?-1:1,k=l[e+d];
d+=p;u=k&(1<<-n)-1;k>>=-n;for(n+=a;0<n;u=256*u+l[e+d],d+=p,n-=8);a=u&(1<<-n)-1;u>>=-n;for(n+=m;0<n;a=256*a+l[e+d],d+=p,n-=8);if(0===u)u=1-g;else{if(u===b)return a?NaN:Infinity*(k?-1:1);a+=Math.pow(2,m);u-=g}return(k?-1:1)*a*Math.pow(2,u-m)};r.write=function(l,e,u,m,d,a){var b,g=8*a-d-1,n=(1<<g)-1,p=n>>1,k=23===d?Math.pow(2,-24)-Math.pow(2,-77):0;a=m?0:a-1;var v=m?1:-1,t=0>e||0===e&&0>1/e?1:0;e=Math.abs(e);isNaN(e)||Infinity===e?(e=isNaN(e)?1:0,m=n):(m=Math.floor(Math.log(e)/Math.LN2),1>e*(b=Math.pow(2,
-m))&&(m--,b*=2),e=1<=m+p?e+k/b:e+k*Math.pow(2,1-p),2<=e*b&&(m++,b/=2),m+p>=n?(e=0,m=n):1<=m+p?(e=(e*b-1)*Math.pow(2,d),m+=p):(e=e*Math.pow(2,p-1)*Math.pow(2,d),m=0));for(;8<=d;l[u+a]=e&255,a+=v,e/=256,d-=8);m=m<<d|e;for(g+=d;0<g;l[u+a]=m&255,a+=v,m/=256,g-=8);l[u+a-v]|=128*t}},function(l,r){var n={}.toString;l.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(l,r,n){l=n(31);var e=n.n(l),u=n(60),m=n(22),d=n(12);n.n(d);var a=n(16),b=n(0);n=function(){var a=e.a.call(this,
"FileSender")||this;a.keychain=new m.a;a.reset();return a};$jscomp.inherits(n,e.a);n.prototype.reset=function(){this.uploadRequest=null;this.msg="importingFile";this.progress=[0,1];this.cancelled=!1};n.prototype.cancel=function(){this.cancelled=!0;this.uploadRequest&&this.uploadRequest.cancel()};n.prototype.upload=function(g,e){var m=this,k,l,n,w,q,c,x,r,z;return $jscomp.asyncExecutePromiseGeneratorProgram(function(p){switch(p.nextAddress){case 1:if(m.cancelled)throw Error(0);m.msg="encryptingFile";
m.emit("encrypting");k=Object(d.encryptedSize)(g.size);return p.yield(m.keychain.encryptStream(g.stream),2);case 2:return l=p.yieldResult,p.yield(m.keychain.encryptMetadata(g),3);case 3:return n=p.yieldResult,p.yield(m.keychain.authKeyB64(),4);case 4:w=p.yieldResult;q={name:g.name,plainSize:g.size,type:g.type,totalSize:k};m.uploadRequest=Object(a.i)(l,n,w,g.timeLimit,g.dlimit,e,q,function(a){m.progress=[a,k];m.emit("progress")});if(m.cancelled)throw Error(0);m.msg="fileSizeProgress";m.emit("progress");
p.setCatchFinallyBlocks(5);return p.yield(m.uploadRequest.result,7);case 7:return c=p.yieldResult,m.msg="notifyUploadEncryptDone",m.uploadRequest=null,m.progress=[1,1],x=Object(d.arrayToB64)(m.keychain.rawSecret),r=new u.a({id:c.id,url:c.url+"#"+x,name:g.name,size:g.size,manifest:g.manifest,time:c.duration,speed:g.size/(c.duration/1E3),createdAt:Date.now(),expiresAt:Date.now()+1E3*g.timeLimit,secretKey:x,nonce:m.keychain.nonce,ownerToken:c.ownerToken,dlimit:g.dlimit,timeLimit:g.timeLimit,mnounce:c.mnounce}),
p.return(r);case 5:throw z=p.enterCatchBlock(),b["default"].info("upload request failed",z),m.msg="errorPageHeader",m.uploadRequest=null,z;}})};$jscomp.global.Object.defineProperties(n.prototype,{progressRatio:{configurable:!0,enumerable:!0,get:function(){return this.progress[0]/this.progress[1]}},progressIndefinite:{configurable:!0,enumerable:!0,get:function(){return-1===["fileSizeProgress","notifyUploadEncryptDone"].indexOf(this.msg)}},sizes:{configurable:!0,enumerable:!0,get:function(){return{partialSize:Object(d.bytes)(this.progress[0]),
totalSize:Object(d.bytes)(this.progress[1])}}}});r.a=n},function(l,r,n){l.exports=function(e,l,m){var d=e.length;if(!(l>=d||0===m)){m=l+m>d?d-l:m;for(d-=m;l<d;++l)e[l]=e[l+m];e.length=d}}},function(l,r,n){function e(b){function g(d){var g="end-"+l+"-"+b;a.mark(g);m.push(function(){var k=null;try{a.measure(b+" ["+l+"]",p,g),a.clearMarks(p),a.clearMarks(g)}catch(w){k=w}d&&d(k,b)})}d.equal(typeof b,"string","nanotiming: name should be type string");if(e.disabled)return u;var l=(1E4*a.now()).toFixed()%
Number.MAX_SAFE_INTEGER,p="start-"+l+"-"+b;a.mark(p);g.uuid=l;return g}function u(a){a&&m.push(function(){a(Error("nanotiming: performance API unavailable"))})}var m=n(59)(),d=n(21);e.disabled=!0;try{var a=window.performance;e.disabled="true"===window.localStorage.DISABLE_NANOTIMING||!a.mark}catch(b){}l.exports=e},function(l,r,n){function e(d){this.method=(this.hasIdle=(this.hasWindow=d)&&window.requestIdleCallback)?window.requestIdleCallback.bind(window):this.setTimeout;this.scheduled=!1;this.queue=
[]}var u=n(21),m="undefined"!==typeof window;e.prototype.push=function(d){u.equal(typeof d,"function","nanoscheduler.push: cb should be type function");this.queue.push(d);this.schedule()};e.prototype.schedule=function(){if(!this.scheduled){this.scheduled=!0;var d=this;this.method(function(a){for(var b;d.queue.length&&0<a.timeRemaining();)b=d.queue.shift(),b(a);d.scheduled=!1;d.queue.length&&d.schedule()})}};e.prototype.setTimeout=function(d){setTimeout(d,0,{timeRemaining:function(){return 1}})};l.exports=
function(){if(m){window._nanoScheduler||(window._nanoScheduler=new e(!0));var d=window._nanoScheduler}else d=new e;return d}},function(l,r,n){var e=n(22),u=n(12);n.n(u);var m=n(16);l=function(d){if(!d.manifest)throw Error("invalid file object");this.id=d.id;this.url=d.url;this.name=d.name;this.size=d.size;this.manifest=d.manifest;this.time=d.time;this.speed=d.speed;this.createdAt=d.createdAt;this.expiresAt=d.expiresAt;this.ownerToken=d.ownerToken;this.dlimit=d.dlimit||1;this.dtotal=d.dtotal||0;this.keychain=
new e.a(d.secretKey,d.nonce);this._hasPassword=!!d.hasPassword;this.timeLimit=d.timeLimit;this.mnounce=d.mnounce};l.prototype.setPassword=function(d){var a=this,b,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress)return e.setCatchFinallyBlocks(2),a.password=d,a._hasPassword=!0,a.keychain.setPassword(d,a.url),e.yield(Object(m.h)(a.id,a.ownerToken,a.keychain),4);if(2!=e.nextAddress)return b=e.yieldResult,e.return(b);g=e.enterCatchBlock();a.password=null;a._hasPassword=
!1;throw g;})};l.prototype.del=function(){return Object(m.a)(this.id,this.ownerToken)};l.prototype.changeLimit=function(d,a){a=void 0===a?{}:a;return this.dlimit!==d?(this.dlimit=d,Object(m.g)(this.id,this.ownerToken,a.bearerToken,{dlimit:d})):Promise.resolve(!0)};l.prototype.updateDownloadCount=function(){var d=this,a,b,g,e;return $jscomp.asyncExecutePromiseGeneratorProgram(function(l){switch(l.nextAddress){case 1:return a=d.dtotal,b=d.dlimit,l.setCatchFinallyBlocks(2),l.yield(Object(m.c)(d.id,d.ownerToken),
4);case 4:g=l.yieldResult;d.dtotal=g.dtotal;d.dlimit=g.dlimit;l.leaveTryBlock(3);break;case 2:e=l.enterCatchBlock(),"404"===e.message&&(d.dtotal=d.dlimit);case 3:return l.return(a!==d.dtotal||b!==d.dlimit)}})};l.prototype.toJSON=function(){return{id:this.id,url:this.url,name:this.name,size:this.size,manifest:this.manifest,time:this.time,speed:this.speed,createdAt:this.createdAt,expiresAt:this.expiresAt,secretKey:Object(u.arrayToB64)(this.keychain.rawSecret),ownerToken:this.ownerToken,dlimit:this.dlimit,
dtotal:this.dtotal,hasPassword:this.hasPassword,timeLimit:this.timeLimit,mnounce:this.mnounce}};$jscomp.global.Object.defineProperties(l.prototype,{hasPassword:{configurable:!0,enumerable:!0,get:function(){return!!this._hasPassword}},expired:{configurable:!0,enumerable:!0,get:function(){return this.dlimit===this.dtotal||Date.now()>this.expiresAt}}});r.a=l},function(l,r,n){var e=n(20);l=function(e,m,d){e=void 0===e?[]:e;m=void 0===m?86400:m;d=void 0===d?{}:d;this.files=Array.from(e);this.timeLimit=
this.defaultTimeLimit=m;this.dlimit=10;this.password=null;this.roomMeta=d};l.prototype.addFiles=function(e,m,d){var a=this;if(this.files.length+e.length>d)throw Error("tooManyFiles");e=e.filter(function(b){var d;if(d=0<b.size){a:{d=$jscomp.makeIterator(a.files);for(var e=d.next();!e.done;e=d.next())if(e=e.value,b.name===e.name&&b.size===e.size&&b.lastModified===e.lastModified){b=!0;break a}b=!1}d=!b}return d});d=e.reduce(function(a,d){return a+d.size},0);if(this.size+d>m)throw Error("fileTooBig");
this.files=this.files.concat(e);return!0};l.prototype.remove=function(e){e=this.files.indexOf(e);-1<e&&this.files.splice(e,1)};l.prototype.clear=function(){this.files=[];this.dlimit=1;this.timeLimit=this.defaultTimeLimit;this.password=null;this.roomMeta={}};$jscomp.global.Object.defineProperties(l.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return 1<this.files.length?"Send-Archive.zip":this.files[0].name}},type:{configurable:!0,enumerable:!0,get:function(){return 1<this.files.length?
"send-archive":this.files[0].type}},size:{configurable:!0,enumerable:!0,get:function(){return this.files.reduce(function(e,m){return e+m.size},0)}},numFiles:{configurable:!0,enumerable:!0,get:function(){return this.files.length}},manifest:{configurable:!0,enumerable:!0,get:function(){return{files:this.files.map(function(e){return{name:e.name,size:e.size,type:e.type}})}}},stream:{configurable:!0,enumerable:!0,get:function(){return Object(e.b)(this.files.map(function(l){return Object(e.a)(l)}))}}});
r.a=l},function(l,r,n){function e(a,b){b=void 0===b?!1:b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){return d.return(new Promise(function(d,g){var k={};k=new DataView(a.plaintext);k=new Blob([k],{type:a.type});if(!0===b)return x["default"].info(" download file mobile device",b),k={messageType:"download-success",result:0,description:"download-success",response:{downloadStatus:"success",name:a.name,type:a.type,size:a.size,blob:k}},d(k);if(navigator.msSaveBlob)return console.log("nagivator service worker is present"),
navigator.msSaveBlob(k,a.name),d();if(/iPhone|fxios/i.test(navigator.userAgent)){var c=new FileReader;c.addEventListener("loadend",function(){if(c.error)return g(c.error);if(c.result){var b=document.createElement("a");b.href=c.result;b.download=a.name;document.body.appendChild(b);b.click()}d()});c.readAsDataURL(k)}else{k=URL.createObjectURL(k);var e=document.createElement("a");e.href=k;e.download=a.name;document.body.appendChild(e);e.click();URL.revokeObjectURL(k);k={messageType:"download-success",
result:0,description:"download-success",response:{downloadStatus:"success",name:a.name,type:a.type,size:a.size}};setTimeout(d(k),100)}}))})}l=n(31);var u=n.n(l),m=n(22),d=n(12);n.n(d);var a=n(16),b=n(20),g=n(63),x=n(0);n=function(a){var b=u.a.call(this,"FileReceiver")||this;b.keychain=new m.a(a.secretKey,a.nonce);a.requiresPassword&&b.keychain.setPassword(a.password,a.url);b.fileInfo=a;b.reset();return b};$jscomp.inherits(n,u.a);n.prototype.cancel=function(){this.downloadRequest&&this.downloadRequest.cancel()};
n.prototype.reset=function(){this.msg="fileSizeProgress";this.state="initialized";this.progress=[0,1]};n.prototype.getMetadata=function(){var b=this,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==g.nextAddress)return g.yield(Object(a.e)(b.fileInfo.id,b.keychain),2);d=g.yieldResult;b.fileInfo.name=d.name;b.fileInfo.type=d.type;b.fileInfo.iv=d.iv;b.fileInfo.size=+d.size;b.fileInfo.manifest=d.manifest;b.state="ready";g.jumpToEnd()})};n.prototype.sendMessageToSw=function(a){return new Promise(function(b,
d){var g=new MessageChannel;g.port1.onmessage=function(a){void 0===a.data?d("bad response from serviceWorker"):void 0!==a.data.error?d(a.data.error):b(a.data)};navigator.serviceWorker.controller.postMessage(a,[g.port2])})};n.prototype.downloadBlob=function(m,k){m=void 0===m?!1:m;k=void 0===k?!1:k;var l=this,p,n,q,c,u,x,z,r;return $jscomp.asyncExecutePromiseGeneratorProgram(function(v){switch(v.nextAddress){case 1:return l.state="downloading",p=l,v.yield(Object(a.b)(l.fileInfo.id,l.keychain,function(a){l.progress=
[a,l.fileInfo.size];l.emit("progress")}),2);case 2:return p.downloadRequest=v.yieldResult,v.setCatchFinallyBlocks(3),v.yield(l.downloadRequest.result,5);case 5:return n=v.yieldResult,l.downloadRequest=null,l.msg="decryptingFile",l.state="decrypting",l.emit("decrypting"),q=l.fileInfo.size,c=l.keychain.decryptStream(Object(b.a)(n)),"send-archive"===l.fileInfo.type&&(u=new g.a(l.fileInfo.manifest,c),c=u.stream,q=u.size),v.yield(Object(d.streamToArrayBuffer)(c,q),6);case 6:x=v.yieldResult;z={};if(m){v.jumpTo(7);
break}return v.yield(e({plaintext:x,name:decodeURIComponent(l.fileInfo.name),type:l.fileInfo.type},k),8);case 8:z=v.yieldResult;case 7:return l.msg="downloadFinish",l.emit("complete"),l.state="complete",v.return(z);case 3:throw r=v.enterCatchBlock(),l.downloadRequest=null,r;}})};n.prototype.downloadStream=function(b){b=void 0===b?!1:b;var g=this,e,m,l,p,c,n,u,z,x,r,Y,y;return $jscomp.asyncExecutePromiseGeneratorProgram(function(k){switch(k.nextAddress){case 1:return e=Date.now(),m=function(a){g.progress=
[a,g.fileInfo.size];g.emit("progress")},g.downloadRequest={cancel:function(){g.sendMessageToSw({request:"cancel",id:g.fileInfo.id})}},k.setCatchFinallyBlocks(2),g.state="downloading",l={request:"init",id:g.fileInfo.id,filename:g.fileInfo.name,type:g.fileInfo.type,manifest:g.fileInfo.manifest,key:g.fileInfo.secretKey,requiresPassword:g.fileInfo.requiresPassword,password:g.fileInfo.password,url:g.fileInfo.url,size:g.fileInfo.size,nonce:g.keychain.nonce,noSave:b},k.yield(g.sendMessageToSw(l),4);case 4:m(0);
if(!b){p="/api/download/"+g.fileInfo.id;c=Object(a.d)(p);c===p&&(c=location.protocol+"//"+location.host+p);n=document.createElement("a");n.href=c;document.body.appendChild(n);n.click();k.jumpTo(5);break}return k.yield(fetch(Object(a.d)("/api/download/"+g.fileInfo.id)),6);case 6:if(u=k.yieldResult,200!==u.status)throw Error(u.status);case 5:x=z=0;case 7:if(!(z<g.fileInfo.size)){g.downloadRequest=null;g.msg="downloadFinish";g.emit("complete");g.state="complete";k.leaveTryBlock(0);break}return k.yield(g.sendMessageToSw({request:"progress",
id:g.fileInfo.id}),9);case 9:r=k.yieldResult;r.progress===z?x++:x=0;if(30<x)throw Y=Error("hung download"),Y.duration=Date.now()-e,Y.size=g.fileInfo.size,Y.progress=z,Y;z=r.progress;m(z);return k.yield(Object(d.delay)(1E3),7);case 2:y=k.enterCatchBlock();g.downloadRequest=null;if("cancelled"===y||"400"===y.message)throw Error(0);throw y;}})};n.prototype.download=function(a){return a.stream?this.downloadStream(a.noSave):this.downloadBlob(a.noSave,a.isMobile)};$jscomp.global.Object.defineProperties(n.prototype,
{progressRatio:{configurable:!0,enumerable:!0,get:function(){return this.progress[0]/this.progress[1]}},progressIndefinite:{configurable:!0,enumerable:!0,get:function(){return"downloading"!==this.state}},sizes:{configurable:!0,enumerable:!0,get:function(){return{partialSize:Object(d.bytes)(this.progress[0]),totalSize:Object(d.bytes)(this.progress[1])}}}});r.a=n},function(l,r,n){function e(a,d,e){var b=new ArrayBuffer(22),g=new DataView(b);g.setUint32(0,101010256,!0);g.setUint16(4,0,!0);g.setUint16(6,
0,!0);g.setUint16(8,a,!0);g.setUint16(10,a,!0);g.setUint32(12,d,!0);g.setUint32(16,e,!0);g.setUint16(20,0,!0);return new Uint8Array(b)}var u=n(64),m=new TextEncoder,d=function(a){this.name=m.encode(a.name);this.size=a.size;this.bytesRead=0;this.crc=null;a=void 0;a=void 0===a?new Date:a;var b=a.getFullYear()-1980<<9,d=a.getMonth()+1<<5,e=a.getDate();b=b|d|e;d=a.getHours()<<11;e=a.getMinutes()<<5;a=Math.floor(a.getSeconds()/2);this.dateTime={date:b,time:d|e|a}};d.prototype.directoryRecord=function(a){var b=
new ArrayBuffer(46+this.name.byteLength),d=new DataView(b);d.setUint32(0,33639248,!0);d.setUint16(4,20,!0);d.setUint16(6,20,!0);d.setUint16(8,8,!0);d.setUint16(10,0,!0);d.setUint16(12,this.dateTime.time,!0);d.setUint16(14,this.dateTime.date,!0);d.setUint32(16,this.crc,!0);d.setUint32(20,this.size,!0);d.setUint32(24,this.size,!0);d.setUint16(28,this.name.byteLength,!0);d.setUint16(30,0,!0);d.setUint16(32,0,!0);d.setUint16(34,0,!0);d.setUint16(36,0,!0);d.setUint32(38,0,!0);d.setUint32(42,a,!0);for(a=
0;a<this.name.byteLength;a++)d.setUint8(46+a,this.name[a]);return new Uint8Array(b)};d.prototype.append=function(a,d){this.bytesRead+=a.byteLength;var b=a.byteLength-Math.max(this.bytesRead-this.size,0),g=a.slice(0,b);this.crc=Object(u.a)(g,this.crc);d.enqueue(g);if(b<a.byteLength)return a.slice(b,a.byteLength)};$jscomp.global.Object.defineProperties(d.prototype,{header:{configurable:!0,enumerable:!0,get:function(){var a=new ArrayBuffer(30+this.name.byteLength),d=new DataView(a);d.setUint32(0,67324752,
!0);d.setUint16(4,20,!0);d.setUint16(6,8,!0);d.setUint16(8,0,!0);d.setUint16(10,this.dateTime.time,!0);d.setUint16(12,this.dateTime.date,!0);d.setUint32(14,0,!0);d.setUint32(18,0,!0);d.setUint32(22,0,!0);d.setUint16(26,this.name.byteLength,!0);d.setUint16(28,0,!0);for(var e=0;e<this.name.byteLength;e++)d.setUint8(30+e,this.name[e]);return new Uint8Array(a)}},dataDescriptor:{configurable:!0,enumerable:!0,get:function(){var a=new ArrayBuffer(16),d=new DataView(a);d.setUint32(0,134695760,!0);d.setUint32(4,
this.crc,!0);d.setUint32(8,this.size,!0);d.setUint32(12,this.size,!0);return new Uint8Array(a)}},byteLength:{configurable:!0,enumerable:!0,get:function(){return this.size+this.name.byteLength+30+16}}});var a=function(a,d){this.files=a;this.fileIndex=0;this.file=null;this.reader=d.getReader();this.nextFile();this.extra=null};a.prototype.nextFile=function(){this.file=this.files[this.fileIndex++]};a.prototype.pull=function(a){var b=this,d;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){if(1==
g.nextAddress){if(!b.file){for(var k=b.files,m=0,l=0,p=0;p<k.length;p++){var q=k[p],c=q.directoryRecord(m);m+=q.byteLength;a.enqueue(c);l+=c.byteLength}a.enqueue(e(k.length,l,m));return g.return(a.close())}0===b.file.bytesRead&&(a.enqueue(b.file.header),b.extra&&(b.extra=b.file.append(b.extra,a)));return b.file.bytesRead>=b.file.size?(a.enqueue(b.file.dataDescriptor),b.nextFile(),g.return(b.pull(a))):g.yield(b.reader.read(),2)}d=g.yieldResult;if(d.done)return b.nextFile(),g.return(b.pull(a));b.extra=
b.file.append(d.value,a);g.jumpToEnd()})};l=function(a,g){this.files=a.files.map(function(a){return new d(a)});this.source=g};$jscomp.global.Object.defineProperties(l.prototype,{stream:{configurable:!0,enumerable:!0,get:function(){return new ReadableStream(new a(this.files,this.source))}},size:{configurable:!0,enumerable:!0,get:function(){return this.files.reduce(function(a,d){return a+2*d.byteLength-d.size},0)+22}}});r.a=l},function(l,r,n){var e=n(17);n.n(e);var u=n(65);l=n(66);var m=[0,1996959894,
3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,
1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,
1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,
2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,
752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,
3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!==typeof Int32Array&&(m=new Int32Array(m));l=Object(l.a)("crc-32",function(d,a){e.Buffer.isBuffer(d)||(d=Object(u.a)(d));a=0===a?0:~~a^-1;for(var b=0;b<d.length;b++)a=m[(a^d[b])&255]^a>>>8;return a^-1});r.a=l},function(l,r,n){var e=n(17);n.n(e);r.a=e.Buffer.from&&e.Buffer.alloc&&e.Buffer.allocUnsafe&&
e.Buffer.allocUnsafeSlow?e.Buffer.from:function(l){return new e.Buffer(l)}},function(l,r,n){r.a=function(e,l){var m=function(d,a){return l(d,a)>>>0};m.signed=l;m.unsigned=m;m.model=e;return m}},function(l,r,n){r.a={isAnnotationStarted:!1,canvasOptions:{width:0,height:0},frameStyle:"display:block; user-select: none;z-index:0; position:absolute;top:0%",annotateStyle:"display:block; user-select: none;z-index:2; position:absolute;top:0%",annotationConfig:{toolType:"draw",isErase:!1,drawMethod:"pencil",
strokeColor:"#ff0000",lineWidth:3,hasInput:!1,lastMouseX:0,lastMouseY:0,canvasX:0,canvasY:0,mouseX:0,mouseY:0,mouseDown:!1,drawElement:null,drawCtx:null,canvasDomID:null,canvasVideoPlayerID:null,customCanvasID:"draw_veneer2",customframeID:"draw_frame",pausePlayTime:0,videoPlaying:!1,streamid:0,setTimeLoop:.3},setupAnnotationToolbar:function(){var e=document.createElement("div");e.setAttribute("id","annotationToolbarContainer");e.style="position: absolute;bottom: 0; z-index: 98;";var l=document.createElement("div");
l.setAttribute("id","toolbar");l.innerHTML='<div class="atn-btns">\n      <button id="annotate-draw">Draw</button>\n      <select id="selDrawMethod">\n        <option value="pencil" selected="selected">Pencil</option>\n        <option value="text">Text</option>\n      </select>\n      <input\n      type="color"\n      id="favcolor"\n      name="favcolor"\n      value="#ff0000"\n      \n    />\n    <select id="selWidth" >\n      <option value="1">1</option>\n      <option value="3" selected="selected">3</option>\n      <option value="5">5</option>\n      <option value="7">7</option>\n      <option value="9">9</option>\n      <option value="11">11</option>\n    </select>\n    <input type="button" id="eraseBtn" value="Erase" />\n    <input type="button" id="clearBtn" value="Clear" />\n    <input type="button" id="play" value="Play-Pause" />\n    \n      </div>';
e.append(l);return{toolbarCont:e,toolbar:l}},_QS:function(e,l){return(void 0===l?0:l)?document.querySelectorAll(""+e)?document.querySelectorAll(""+e):!1:document.querySelector(""+e)?document.querySelector(""+e):!1},bindEventListernersForTools:function(){var e=this;e._QS("#annotate-draw")&&e._QS("#annotate-draw").addEventListener("click",function(l){e.annotateToolAction("tool","draw")});e._QS("#selDrawMethod")&&e._QS("#selDrawMethod").addEventListener("change",function(l){e.annotateToolAction("drawMethod",
l.target.value)});e._QS("#selWidth")&&e._QS("#selWidth").addEventListener("change",function(l){e.annotateToolAction("lineWidth",l.target.value)});e._QS("#favcolor")&&e._QS("#favcolor").addEventListener("change",function(l){e.annotateToolAction("strokeColor",l.target.value)});e._QS("#eraseBtn")&&e._QS("#eraseBtn").addEventListener("click",function(l){e.annotateToolAction("erase")});e._QS("#clearBtn")&&e._QS("#clearBtn").addEventListener("click",function(l){e.annotateToolAction("clear")});e._QS("#play")&&
e._QS("#play").addEventListener("click",function(l){e.pause_play()})},annotateAddInput:function(e,l){var m=this,d=document.createElement("input");d.className="annotate-text";d.type="text";d.style.position="fixed";d.style.zIndex=50;d.style.left=e-4+"px";d.style.top=l-4+"px";d.onkeydown=function(a){var b=a.keyCode;13===b?(m.annotateDrawText(a.target.value),document.body.removeChild(a.target),m.annotationConfig.hasInput=!1):27===b&&(document.body.removeChild(a.target),m.annotationConfig.hasInput=!1)};
document.body.appendChild(d);d.focus();this.annotationConfig.hasInput=!0},pause_play:function(){var e=this;if(e.annotationConfig.videoPlaying)clearInterval(e.annotationConfig.pausePlayTime),e.annotationConfig.videoPlaying=!1;else{var l=document.getElementById("stream"+e.annotationConfig.streamid);if(l){var m=document.getElementById(e.annotationConfig.customframeID);if(m){var d=m.getContext("2d");e.annotationConfig.pausePlayTime=setInterval(function(){0<e.canvasOptions.width&&0<e.canvasOptions.height&&
d.drawImage(l,0,0,e.canvasOptions.width,e.canvasOptions.height)},e.annotationConfig.setTimeLoop);e.annotationConfig.videoPlaying=!0}}}},handleEnter:function(e){var l=e.keyCode;13===l?(this.annotateDrawText(e.target.value),document.body.removeChild(e.target),this.annotationConfig.hasInput=!1):27===l&&(document.body.removeChild(e.target),this.annotationConfig.hasInput=!1)},annotateDrawText:function(e){this.annotationConfig.drawCtx.textBaseline="top";this.annotationConfig.drawCtx.textAlign="left";this.annotationConfig.drawCtx.fillStyle=
this.annotationConfig.strokeColor;this.annotationConfig.drawCtx.font="14px sans-serif";this.annotationConfig.drawCtx.fillText(e,this.annotationConfig.lastMouseX-4,this.annotationConfig.lastMouseY-4)},reOffset:function(e){e=e.getBoundingClientRect();this.annotationConfig.canvasX=e.left;this.annotationConfig.canvasY=e.top},startFrame:function(){this.annotationConfig.videoPlaying=!1},getCanvasId:function(){return this.annotationConfig.customCanvasID},getVideoFrameId:function(){return this.annotationConfig.customframeID},
getCanvasWidth:function(){return this.canvasOptions.width},getCanvasHeight:function(){return this.canvasOptions.height},toolBarAction:function(e,l){if("tool"===e)this.annotationConfig.toolType=l,this.annotationConfig.isErase=!1;else if("erase"===e)this.annotationConfig.toolType=e,this.annotationConfig.isErase=!0;else if("strokeColor"===e)this.annotationConfig.strokeColor=l;else if("lineWidth"===e)this.annotationConfig.lineWidth=l;else if("drawMethod"===e)this.annotationConfig.drawMethod=l;else if("clear"===
e){for(e=document.getElementsByClassName("annotate-text");0<e.length;)e[0].remove();this.annotationConfig.drawCtx.clearRect(0,0,this.canvasOptions.width,this.canvasOptions.height)}},appendCustomCanvas:function(e,l,m,d){this.canvasOptions.width=m;this.canvasOptions.height=d;var a=document.createElement("canvas");a.id=this.annotationConfig.customCanvasID;a.width=m;a.height=d;a.className=l;a.setAttribute("style",this.annotateStyle);e&&(e.append(a),l=this.setupAnnotationToolbar(),e.append(l.toolbarCont))},
appendCanvasFrame:function(e,l,m,d,a){this.canvasOptions.width=m;this.canvasOptions.height=d;var b=document.createElement("canvas");b.getContext("2d");b.id=this.annotationConfig.customframeID;b.width=m;b.height=d;a&&(m=a.getID(),this.annotationConfig.streamid=m,document.getElementById("stream"+m)&&(b.className=l,b.setAttribute("style",this.frameStyle),e&&e.append(b)))},onDown:function(e,l){e.preventDefault();if("touchstart"==e.type||"touchmove"==e.type||"touchend"==e.type||"touchcancel"==e.type){e=
"undefined"===typeof e.originalEvent?e:e.originalEvent;l=e.touches[0]||e.changedTouches[0];var m=l.pageX;var d=l.pageY}else if("mousedown"==e.type||"mouseup"==e.type||"mousemove"==e.type||"mouseover"==e.type||"mouseout"==e.type||"mouseenter"==e.type||"mouseleave"==e.type)m=e.clientX,d=e.clientY;this.reOffset(this.annotationConfig.drawElement);this.annotationConfig.lastMouseX=this.annotationConfig.mouseX=parseInt(m-this.annotationConfig.canvasX);this.annotationConfig.lastMouseY=this.annotationConfig.mouseY=
parseInt(d-this.annotationConfig.canvasY);this.annotationConfig.mouseDown=!0;"text"===this.annotationConfig.drawMethod&&"draw"===this.annotationConfig.toolType&&this.annotateAddInput(m,d)},onMove:function(e,l,m){e.preventDefault();if("touchstart"==e.type||"touchmove"==e.type||"touchend"==e.type||"touchcancel"==e.type){e="undefined"===typeof e.originalEvent?e:e.originalEvent;m=e.touches[0]||e.changedTouches[0];var d=m.pageX;var a=m.pageY}else if("mousedown"==e.type||"mouseup"==e.type||"mousemove"==
e.type||"mouseover"==e.type||"mouseout"==e.type||"mouseenter"==e.type||"mouseleave"==e.type)d=e.clientX,a=e.clientY;this.annotationConfig.mouseX=parseInt(d-this.annotationConfig.canvasX);this.annotationConfig.mouseY=parseInt(a-this.annotationConfig.canvasY);this.annotationConfig.mouseDown&&"pencil"===this.annotationConfig.drawMethod&&(this.annotationConfig.drawCtx.beginPath(),"draw"===this.annotationConfig.toolType?(this.annotationConfig.drawCtx.globalCompositeOperation="source-over",this.annotationConfig.drawCtx.strokeStyle=
this.annotationConfig.strokeColor,this.annotationConfig.drawCtx.lineWidth=this.annotationConfig.lineWidth):(this.annotationConfig.drawCtx.globalCompositeOperation="destination-out",this.annotationConfig.drawCtx.lineWidth=10),this.annotationConfig.drawCtx.moveTo(this.annotationConfig.lastMouseX,this.annotationConfig.lastMouseY),this.annotationConfig.drawCtx.lineTo(this.annotationConfig.mouseX,this.annotationConfig.mouseY),this.annotationConfig.drawCtx.lineJoin=l.lineCap="round",this.annotationConfig.drawCtx.stroke());
this.annotationConfig.lastMouseX=this.annotationConfig.mouseX;this.annotationConfig.lastMouseY=this.annotationConfig.mouseY},onUp:function(e){e.preventDefault();this.annotationConfig.mouseDown=!1},annotateToolAction:function(e,l){this.toolBarAction(e,l)},mouseAnnotate:function(e,l,m,d){d=void 0===d?null:d;var a=this;d&&(a.stream=d);a.isAnnotationStarted=!0;a.annotationConfig.drawElement=document.getElementById(a.annotationConfig.customCanvasID);a.annotationConfig.drawCtx=a.annotationConfig.drawElement.getContext("2d");
a.annotationConfig.canvasDomID=e;a.annotationConfig.canvasVideoPlayerID=m;a.annotationConfig.drawElement.addEventListener("mousedown",function(b){a.onDown(b,!1)});a.annotationConfig.drawElement.addEventListener("touchstart",function(b){a.onDown(b,!0)});a.annotationConfig.drawElement.addEventListener("mousemove",function(b){a.onMove(b,l,!1)});a.annotationConfig.drawElement.addEventListener("touchmove",function(b){a.onMove(b,l,!0)});a.annotationConfig.drawElement.addEventListener("mouseup",function(b){a.onUp(b)});
a.annotationConfig.drawElement.addEventListener("touchcancel",function(b){a.onUp(b)});return a.annotationConfig.drawElement},stopAnnotation:function(){this.isAnnotationStarted=!1;var e=document.getElementById("canvas-wrapper");e&&e.remove();for(e=document.getElementsByClassName("annotate-text");0<e.length;)e[0].remove();e=document.querySelector(".annotate-div");var l=e.parentElement;l.prepend(e.firstElementChild);l.firstChild.style.height="100%";l.firstChild.style.width="100%";e.remove();this.annotationConfig.toolType=
"draw";this.annotationConfig.isErase=!1;this.annotationConfig.drawMethod="pencil";this.annotationConfig.strokeColor="#ff0000";this.annotationConfig.lineWidth=3},resize:function(){var e=this;e.isAnnotationStarted&&setTimeout(function(){var l=e.stream;if(l){var m=l.getID(),d=document.getElementById("stream"+m+"_veneer"),a=document.getElementById("draw_veneer2"),b=document.getElementById("draw_frame"),g=document.getElementById("canvas-wrapper");if(a&&b&&g){var n=a.getContext("2d"),p=n.getImageData(0,
0,a.width,a.height);l=l.stream.getVideoTracks()[0];l=l.getSettings()?l.getSettings():l.getConstraints();var k=l.height,v=l.width,t=document.querySelector(".annotate-div");m=document.querySelector("#player_"+m);l=t.clientHeight;t=t.clientWidth;if(l<t){var w=l/k,q=k*w;w*=v;w>t?(w=t/v,k*=w,v*=w):(k=q,v=w)}else w=t/v,q=k*w,w*=v,q>l?(w=l/k,k*=w,v*=w):(k=q,v=w);m.style.height=k+"px";m.style.width=v+"px";d.width=v;d.height=k;a.width=v;a.height=k;b.width=v;b.height=k;g.style.width=v+"px";g.style.height=k+
"px";createImageBitmap(p).then(function(a){n.drawImage(a,0,0,v,k)});e.canvasOptions.width=v;e.canvasOptions.height=k;e.reOffset(e.annotationConfig.drawElement)}}},100)}}},function(l,r,n){var e=n(0),u=n(7),m=n(11),d=n(19);n(14);l=n(1);var a=n.n(l),b=n(4),g=n(6);l=n(5);var x=n(9),p=n(8),k=l.a.constant,v=void 0,t={default:{minVideoBW:80,maxVideoBW:1500,scheme:"notify-break-recover"},disconnectRoom:function(a){v=void 0;a&&a.disconnect()},getDevice:function(b,d){if(void 0!=b&&null!=b)if("function"===typeof b){var c=
b;var k={mic:!0,cam:!0,speaker:!1}}else"object"===typeof b&&(void 0!=b.mic&&"boolean"!==typeof b.mic||void 0!=b.cam&&"boolean"!==typeof b.cam||void 0!=b.speaker&&"boolean"!==typeof b.speaker||(k=b));else k={mic:!0,cam:!0,speaker:!1};c||void 0==d||null==d||"function"!==typeof d||(c=d);a.a.is_supported()&&k&&c?u.a.getDeviceList(k,c):a.a.is_supported()?(e["default"].error("Failed invalid param - callback or options"),c&&c(g.a.error_1155)):(e["default"].error("Failed Webrtc support is missing "),c&&c(g.a.error_1000))},
notifyDeviceUpdate:function(b,d){a.a.is_supported()?(!b||"object"===typeof b&&(b.mic||b.cam))&&d&&"function"===typeof d?u.a.mediaDeviceUpdate(b,"vcxVcxQuickApi_notifyDeviceUpdate",function(a){d(a)}):d&&"function"===typeof d&&d(g.a.error_1155):e["default"].info("Failed Webrtc support is missing ")},switchMediaDevice:function(b,d,c,k){k=void 0===k?function(){}:k;"function"===typeof k?a.a.is_supported()?d&&"string"===typeof d&&c&&"string"===typeof c?b.switchMediaDevices(b,d,c,k):(e["default"].info("Invalid Device Id"),
k(!1)):(e["default"].info("Failed Webrtc support is missing "),k(g.a.error_1000)):e["default"].error("switchMediaDevice() invalid param - callback")},joinRoom:function(l,q,c,n){var w=function(){},z={},r={allow_reconnect:!0,number_of_attempts:3,timeout_interval:45E3};if(void 0==c&&void 0==n)e["default"].error("joinRoom() failed, callback is missing. invalid parameters");else{if(void 0!=c&&"function"===typeof c)w=c,void 0!=n&&(r=n);else if(void 0!=n&&"function"===typeof n)if(w=n,void 0!=c)z=c;else{e["default"].error("joinRoom() failed, callback is missing. invalid parameters");
return}if(a.a.is_supported())if(void 0==l||void 0==q)e["default"].error("joinRoom() failed, token/streamInfo is missing. invalid parameters"),w(null,g.a.error_1155);else{var B=null,G=null;e["default"].info("SDK version: "+a.a.product.version+" browser name: "+a.a.browser_type+" browser version: "+a.a.browser_info.version+" device type: "+a.a.browser_info.device_type);if(null!=l){l=JSON.parse(d.a.decodeBase64(l));x.a.init(l);l.version=a.a.product.version;z.reconnectInfo=r;z.token=d.a.encodeBase64(JSON.stringify(l));
var y=Object(m.a)(void 0,void 0,z);z=function(){"IE"!==u.a.browserEngineCheck()&&(y.addEventListener("room-connected",function(c){G={streams:c.streams,room:y,roomData:c.room,localStream:F};v=y;if(void 0!==c.me&&null!==c.me&&("lecture"!==y.mode||"participant"!==c.me.role||y.floorGranted)&&(q.audio||q.video)){var d={scheme:q.scheme?q.scheme:t.default.scheme,maxVideoLayers:y.maxVideoLayers,forceTurn:q.forceTurn};q.maxVideoBW&&(d.maxVideoBW=q.maxVideoBW);q.minVideoBW&&(d.minVideoBW=q.minVideoBW);q.maxVideoFps&&
(d.maxVideoFps=q.maxVideoFps);q.maxVideoFps&&(d.maxVideoFps=q.maxVideoFps);q.audioMuted&&(d.audioMuted=q.audioMuted);q.videoMuted&&(d.videoMuted=q.videoMuted)}if("audience"===y.me.role&&y.subscription&&!y.subscription.hls)e["default"].error("Licence error :  HLS not supported !!");else if(!1===y.reconnectionState){q.video&&y.subscription&&!y.subscription.audio_video&&(e["default"].error("Licence error : video not supported, ignoring video option"),q.video=!1);q.audio&&y.subscription&&!y.subscription.audio_only&&
!y.subscription.audio_video&&(e["default"].error("Licence error : audio not supported, ignoring audio option"),q.audio=!1);var l=function(d,e){y.publish(F,d,function(d){0===d.result?(G.publishId=d.id,y.mediaConfiguration!==k.H264_CODEC&&"safari"===a.a.browser_info.name&&a.a.browser_info.version<=k.SAFARI_VERSION_NOT_SUPPORTING_VP8?e(G,g.a.error_1152):e(G,null),c.mediaRecord&&y.dispatchEvent(Object(b.e)({type:"room-record-on",message:{}})),y.muteInfo.room.audio&&y.dispatchEvent(Object(b.e)({type:"room-muted",
message:{}}))):d.result===g.a.error_1130.result?e(G,d):e(null,d)})};void 0!=d&&!1===y.waitRoom&&"viewer"!=y.me.role&&"audience"!=y.me.role?l(d,w):"viewer"!=y.me.role&&"audience"!=y.me.role&&y.waitRoom?(w(G,null),y.addEventListener("wait-room-disabled",function(a){y.dispatchEvent(Object(b.e)({type:"room-allowed",message:a.message}));"lecture"!==y.mode&&l(d,w)})):(e["default"].info("no audio&video"),F&&(q.audioMuted&&F.muteAudio(function(a){a.result==g.a.error_000.result&&y.dispatchEvent(Object(b.g)({type:"user-audio-muted",
clientId:y.clientId}));e["default"].info("audioSelfMuteCallback: "+JSON.stringify(a))},!1,0,!0),q.videoMuted&&F.muteVideo(function(a){a.result!==g.a.error_000.result&&y.dispatchEvent(Object(b.g)({type:"user-video-muted",clientId:y.clientId}));e["default"].info("videoSelfMuteCallback: "+JSON.stringify(a))},!1,0,!0)),w(G,null))}else{e["default"].info("handle reconnection: for room-connected ");G={streams:c.streams,room:y,roomData:c.room,localStream:F};for(var m=0;m<G.streams.length;m++)y.subscribe(G.streams[m],
{},function(a){!0===a||"object"===typeof a&&0==a.result?e["default"].info("reconnect subscriber callback success"):(e["default"].info("reconnect subscriber callback failed, could not reconnect",a),y.reconPubSubFailed(a),y.dispatchEvent(Object(b.e)({type:"room-error",message:a})),x.a.error("api-event",p.a.event_reconnect_subscribe_failed,{error:"reconnect subscriber callback failed, couldnt reconnect",message:a}))});e["default"].info("MANAGE LIVE TRANSCRIPTION-> RECONNECTING");y.manageLiveTranscription();
var n=function(a){y.localStreamsBeforeReconnect.forEach(function(a,f){void 0===a.canvas&&void 0===a.screen&&(e["default"].info(" reconnect publish, audio video data stream"),y.localStreamsBeforeReconnect.remove(f),y.publish(a,d,function(d){0===d.result?(G.publishId=d.id,e["default"].info("reconnected and stream published successfully"),y.manageStatsSubscription(a),y.manageRecordingStatus(),c.mediaRecord&&y.dispatchEvent(Object(b.e)({type:"room-record-on",message:{}})),y.muteInfo.room.audio&&y.dispatchEvent({type:"room-muted",
message:{}}),!0===a.selfMuteAudio&&a.sendEvent("user-audio-muted"),1==a.selfMuteVideo&&a.sendEvent("user-video-muted"),y.localStreamsBeforeReconnect.forEach(function(a,c){if(!0===a.canvas)e["default"].info(" reconnect publish, canvas stream"),y.localStreamsBeforeReconnect.remove(c),y.socket.emitEvent("auxilaryPublishRequests",{req:"start",pubType:"canvas",override:!0},function(c){c.result==g.a.error_000.result&&y.publish(a,{maxVideoBW:4096,minVideoBW:1024},function(a){0===a.result?G.publishId=a.id:
(e["default"].info(" reconnect publish failed forcanvas stream failed",a),y.reconPubSubFailed(a),y.dispatchEvent(Object(b.e)({type:"room-error",message:a})),x.a.error("api-event",p.a.event_reconnect_publish_failed,{error:"reconnect publish for canvas stream failed",message:a}))})});else if(!0===a.screen){e["default"].info(" reconnect publish, share stream");y.localStreamsBeforeReconnect.remove(c);var d=function(a){e["default"].info(" reconnect publish share failed with reason",a);y.reconPubSubFailed(a);
y.dispatchEvent(Object(b.e)({type:"room-error",message:a}));x.a.error("api-event",p.a.event_reconnect_publish_failed,{error:"reconnect publish share failed with reason",message:a})};y.socket.emitEvent("auxilaryPublishRequests",{req:"start",pubType:"screen",override:!0},function(c){c.result==g.a.error_000.result?y.publish(a,{share:!0},function(a){e["default"].info(" reconnect publish response for share stream",a);0===a.result?(e["default"].info(" reconnect publish share successful",a),y.localStreams.forEach(function(a,
c){a&&a.ifVideo()&&a.setQualityLayers(2)})):d(a)}):d(c)})}else e["default"].info(" unknown stream type ????????????")})):(e["default"].info(" reconnect publishing failed, response for publish",d),y.reconPubSubFailed(d),y.dispatchEvent(Object(b.e)({type:"room-error",message:d})),x.a.error("api-event",p.a.event_reconnect_publish_failed,{error:"reconnect publishing failed, response for publish",message:d}))}))})};e["default"].info(" reconnect publish, pubOps: "+d+" waitRoom: "+y.waitRoom+" role: "+y.me.role+
" mode: "+y.mode);void 0==d||!1!==y.waitRoom||"viewer"==y.me.role||"audience"==y.me.role||"lecture"===y.mode&&"moderator"!==y.me.role?"viewer"!=y.me.role&&"audience"!=y.me.role&&y.waitRoom?(e["default"].info("Reconnect WaitRoom on no publish"),y.addEventListener("wait-room-disabled",function(a){"lecture"!==y.mode&&n(d)})):"viewer"!=y.me.role&&"audience"!=y.me.role||"lecture"===y.mode&&"moderator"!==y.me.role?("viewer"!=y.me.role&&"audience"!=y.me.role?e["default"].info(" No publish - participant is viewer/audience"):
e["default"].info(" reconnection:: No publish - participant in lecture mode"),y.floorGranted&&(y.floorGranted=!1,y.dispatchEvent(Object(b.e)({type:"release-floor",users:{clientId:y.clientId}})))):e["default"].info("no audio&video"):n(d);e["default"].debug(" setting reconnection state as false ");y.reconnectionState=!1;y.manageNumTalker();e["default"].info("send network reconnected event");m=Object(b.e)({type:"network-reconnected",error:g.a.error_1164.result,message:g.a.error_1164.error});y.dispatchEvent(m)}}),
y.addEventListener("room-error",function(a){null==G&&w(G,a)}),y.addEventListener("stream-added",function(a){y.subscribe(a.stream)}),y.addEventListener("active-talkers-updated",function(a){a=a.message.activeList;var c=a.length;if(0<c)for(var d=0;d<c;d++)if("audio"===a[d].mediatype&&!0===a[d].muteDueToBw){y.remoteStreams.getAll()[a[d].streamId].audioOnly=!0;var g=Object(b.e)({type:"user-muted-due-to-bw-crunch",message:{streamId:a[d].streamId,clientId:a[d].clientId,name:a[d].name}});y.dispatchEvent(g)}}));
!1===y.reconnectionState&&0==y.reconnectAttempt?y.connect(r,function(a){e["default"].debug("room.connect callback resp: "+JSON.stringify(a));a.result!=g.a.error_000.result&&w(null,a)}):e["default"].debug(" Reconnection case in join room public api")};l=function(a){B=a;w(G,B)};if(void 0!=q.stream||q.audio||q.video)var F=y.initPublishStream(q.div,q,z,l);else e["default"].info(" No publish stream. audio and video are disabled.."),z()}return F}else e["default"].info("Failed Webrtc support is missing "),
w(null,g.a.error_1000)}},listParticipants:function(b){if(a.a.is_supported()){var d=[];b&&(d=b.userList);return d}console.log("Failed Webrtc support is missing ")},ReceiveMessage:function(a,b){a&&a.addEventListener("stream-data",function(a){})},sendMessage:function(a,b){a&&a.sendData(b)},getRoom:function(){return v}};r.a=t},function(l,r,n){function e(){y=0;F.splice(0,F.length);S={};M={};da={};ba={};ha={};f={};ja={};ca=I="";N=K.a.default_region;ia=K.a.proxy_api_url;ea=K.a.proxy_api_port;U=A=!1;Z=K.a.data_throughput_duration;
D=K.a.video_bandwidth_duration;V=K.a.audio_bandwidth_duration}function u(){if(!1===O)k();else if(y<F.length){var a=F[y];B.setActiveTest(a);var b={test_group:a.test_group,test_case:a.test_title,status:"started"};if("network"===a.test_group||"connectivity"===a.test_group||"throughput"===a.test_group||"bandwidth"===a.test_group||"signalling"===a.test_group)b.test_region=a.region,b.test_server=a.server;a.start_time=new Date;b=Object(z.a)({type:"client-diagnosis-status",message:b});!0===fa?window.webkit.messageHandlers.callbackHandler.postMessage(b):
H.dispatchEvent(b);switch(a.test_title){case "audio_capture":Object(v.a)(a,ca);break;case "check_resolution_240":case "check_resolution_480":case "check_resolution_720":case "check_supported_resolutions":Object(t.a)(a,I);break;case "udp_enabled":case "tcp_enabled":case "ipv6_enabled":Object(w.a)(a);break;case "relay_connectivity":case "reflexive_connectivity":case "host_connectivity":Object(q.a)(a);break;case "data_throughput":Object(c.a)(a,null,Z);break;case "audio_bandwidth":Object(c.a)(a,ca,V);
break;case "video_bandwidth":Object(c.a)(a,I,D);break;case "signalling_connectivity":Object(G.a)(a,ia,ea)}y+=1}else a={},Object.keys(S).length&&(a.microphone=S),Object.keys(M).length&&(a.camera=M),Object.keys(da).length&&(a.network=da),Object.keys(ba).length&&(a.connectivity=ba),Object.keys(ha).length&&(a.throughput=ha),Object.keys(f).length&&(a.bandwidth=f),Object.keys(ja).length&&(a.signalling=ja),O=!1,E["default"].info("All test case executed"),a=Object(z.a)({type:"client-diagnosis-finished",message:a}),
!0===fa?window.webkit.messageHandlers.callbackHandler.postMessage(a):H.dispatchEvent(a),e()}function m(a,c,b,d,f){b=void 0===b?null:b;d=void 0===d?null:d;f=void 0===f?!1:f;a=new aa(a,c,u);a.region=b;a.server=d;a.bitrate_only=f;F.push(a)}function d(){for(var a in N)Y.includes(N[a])&&(m("udp_enabled","network",N[a],"TURN"),m("tcp_enabled","network",N[a],"TURN"),m("ipv6_enabled","network",N[a],"TURN"))}function a(){for(var a in N)Y.includes(N[a])&&(m("relay_connectivity","connectivity",N[a],"TURN"),
m("reflexive_connectivity","connectivity",N[a],"TURN"),m("host_connectivity","connectivity",N[a],"TURN"))}function b(){for(var a in N)Y.includes(N[a])&&m("data_throughput","throughput",N[a],"TURN")}function g(){for(var a in N)Y.includes(N[a])&&(m("video_bandwidth","bandwidth",N[a],"TURN",U),m("audio_bandwidth","bandwidth",N[a],"TURN",U))}function x(){for(var a in N)Y.includes(N[a])&&m("signalling_connectivity","signalling",N[a],"TURN")}function p(){var a=Object(z.a)({type:"client-diagnosis-failed",
message:{msg:"Invalid arguments"}});!0===fa?window.webkit.messageHandlers.callbackHandler.postMessage(a):H.dispatchEvent(a);e();E["default"].error("Invalid argument")}function k(){var a=Object(z.a)({type:"client-diagnosis-stopped",message:{msg:"Diagnosis stopped."}});!0===fa?window.webkit.messageHandlers.callbackHandler.postMessage(a):H.dispatchEvent(a);e();E["default"].error("diagnosis stopped")}var v=n(70),t=n(71),w=n(73),q=n(74),c=n(75),G=n(76),E=n(0),z=n(4);l=n(1);var K=n.n(l),B=n(13),Y=["IN",
"US","SG","DE"];n={};var y=0,F=[],S={},M={},da={},ba={},ha={},f={},ja={},ca="",I="",N=[],O=!1,U=!1,H=null,ia="",ea="",A=!1,Z=0,D=0,V=0,fa=!1,aa=function(a,c,b){this.test_title=a;this.test_group=c;this.started=!1;this.success_count=this.warning_count=this.error_count=0;this.finished_cb=b;this.region="IN";this.server="TURN";this.uri="";this.progress_value=0;this.state="not_tested";this.start_time=0;this.bitrate_only=!1;this.json_response={result:this.state,execution_time:"not_set",success:[],error:[],
warning:[],info:[]};this.done=function(){this.state=0===this.error_count+this.warning_count&&0<this.success_count?"success":0<this.warning_count&&0===this.error_count?"warning":this.isDisabled?"disabled":"failure";this.json_response.result=this.state;this.json_response.execution_time=new Date-this.start_time+" ms";var a={};switch(this.test_group){case "microphone":S[this.test_title]=this.json_response;a[this.test_title]=S[this.test_title];break;case "camera":M[this.test_title]=this.json_response;
a[this.test_title]=M[this.test_title];break;case "network":this.setServer();a=this.fillResponse(da);break;case "connectivity":this.setServer();a=this.fillResponse(ba);break;case "throughput":this.setServer();a=this.fillResponse(ha);break;case "bandwidth":this.setServer();a=this.fillResponse(f);break;case "signalling":this.setServer(),a=this.fillResponse(ja)}a={test_group:this.test_group,test_case:this.test_title,status:"finished",output:a};if("network"===this.test_group||"connectivity"===this.test_group||
"throughput"===this.test_group||"bandwidth"===this.test_group||"signalling"===this.test_group)a.test_region=this.region,a.test_server=this.server;a=Object(z.a)({type:"client-diagnosis-status",message:a});!0===fa?window.webkit.messageHandlers.callbackHandler.postMessage(a):H.dispatchEvent(a);this.finished_cb()};this.fillResponse=function(a){var c={};a.hasOwnProperty(this.test_title)||(a[this.test_title]={});a[this.test_title].hasOwnProperty(this.region)||(a[this.test_title][this.region]={});a[this.test_title][this.region].hasOwnProperty(this.server)||
(a[this.test_title][this.region][this.server]={});a[this.test_title][this.region][this.server]=this.json_response;c[this.test_title]=this.json_response;return c};this.reportFatal=function(a){this.reportError(a);this.done()};this.reportSuccess=function(a){this.success_count+=1;E["default"].info("[ OK ]"+a);this.json_response.success.push({message:a})};this.setServer=function(){this.json_response.server={};this.json_response.server.region=this.region;this.json_response.server.url="TURN"===this.server?
K.a.ice_servers[this.region].turnURI:K.a.ice_servers[this.region].stunURI};this.reportError=function(a){this.error_count+=1;E["default"].error("[ FAILED ]"+a);this.json_response.error.push({message:a})};this.reportWarning=function(a){this.warning_count+=1;E["default"].warning("[ WARN ]"+a);this.json_response.warning.push({message:a})};this.reportInfo=function(a){E["default"].info("[ INFO ]"+a);this.json_response.info.push({message:a})};this.fillBandwidth=function(a){this.json_response.bandwidth_bps=
a};this.fillPacketsLost=function(a){this.json_response.packets_lost_percentage=a};this.setProgress=function(a){this.progress_value=a};this.fillData=function(a,c){};this.reportByState=function(a,c){switch(c){case "poor":this.error_count+=1;E["default"].error("[ POOR ]"+a);this.json_response.error.push({message:a+" [BAD]"});break;case "moderate":this.warning_count+=1;E["default"].warning("[ MODERATE ]"+a);this.json_response.warning.push({message:a+" [ACCEPTABLE]"});break;case "good":this.success_count+=
1,E["default"].info("[ GOOD ]"+a),this.json_response.success.push({message:a+" [GOOD]"})}}};n.clientDiagnostics=function(c){fa=!1;c.hasOwnProperty("forIosVersion13")&&!0===c.forIosVersion13&&(fa=!0);if(c.hasOwnProperty("stop")&&!0===c.stop&&null!==H)return!1===O&&0===F.length&&k(),O=!1,H;if(O||F.length)return E["default"].error("Diagnosis is already in progress. Few resources are in use and may not be accessible."),H;H=Object(z.c)();if(!c.hasOwnProperty("testNames")||!Array.isArray(c.testNames))return setTimeout(p,
1),H;O=!0;e();c.hasOwnProperty("audioDeviceId")&&(ca=c.audioDeviceId);c.hasOwnProperty("videoDeviceId")&&(I=c.videoDeviceId);c.hasOwnProperty("testServerApiHost")&&(ia=c.testServerApiHost);c.hasOwnProperty("testServerApiPort")&&(ea=c.testServerApiPort);if(c.hasOwnProperty("regionId"))if(Array.isArray(c.regionId))N=c.regionId||K.a.default_region;else return O=!1,setTimeout(p,1),H;c.hasOwnProperty("forMobile")&&!0===c.forMobile&&(A=!0);c.hasOwnProperty("bitrateOnly")&&!0===c.bitrateOnly&&(U=!0);c.hasOwnProperty("testDurationDataThroughput")&&
0<c.testDurationDataThroughput&&(Z=c.testDurationDataThroughput);60<Z&&(Z=60);c.hasOwnProperty("testDurationVideoBandwidth")&&0<c.testDurationVideoBandwidth&&(D=c.testDurationVideoBandwidth);60<D&&(D=60);c.hasOwnProperty("testDurationAudioBandwidth")&&0<c.testDurationAudioBandwidth&&(V=c.testDurationAudioBandwidth);60<V&&(V=60);var f=c.testNames.map(function(a){a=a.toString();return a.toLowerCase()}),l=new Set;if(f.includes("all"))l.add("microphone"),l.add("camera"),l.add("network"),l.add("connectivity"),
l.add("throughput"),l.add("bandwidth"),l.add("signalling");else for(var q in c.testNames)l.add(f[q]);c=$jscomp.makeIterator(l);for(f=c.next();!f.done;f=c.next())switch(f.value){case "microphone":m("audio_capture","microphone");break;case "camera":!0!==A&&(m("check_resolution_240","camera"),m("check_resolution_480","camera"),m("check_resolution_720","camera"));m("check_supported_resolutions","camera");break;case "network":d();break;case "connectivity":a();break;case "throughput":b();break;case "bandwidth":g();
break;case "signalling":x()}0<F.length?setTimeout(u,1):(O=!1,setTimeout(p,1));return H};n.clientBitrate=function(a){var c=Object(z.c)(),b="DE";void 0!==a&&a.hasOwnProperty("region")&&(a=a.region,Y.includes(a)&&(b=a));b=EnxRtc.clientDiagnostics({testNames:["bandwidth"],regionId:[b],testDurationVideoBandwidth:40,testDurationAudioBandwidth:20,bitrateOnly:!0,stop:!1});var d={video:{bitrate_bps:"NA",connection:"NA"},audio:{bitrate_bps:"NA",connection:"NA"}};b.addEventListener("client-diagnosis-status",
function(a){var b=Object(z.a)({type:"client-bitrate-status",message:a.message});a.message.hasOwnProperty("output")&&(a.message.output.hasOwnProperty("video_bandwidth")&&(a.message.output.video_bandwidth.hasOwnProperty("bandwidth_bps")&&(d.video.bitrate_bps=a.message.output.video_bandwidth.bandwidth_bps),a.message.output.video_bandwidth.hasOwnProperty("packets_lost_percentage")&&(d.video.connection=5<a.message.output.video_bandwidth.packets_lost_percentage?"unstable":"stable")),a.message.output.hasOwnProperty("audio_bandwidth")&&
(a.message.output.audio_bandwidth.hasOwnProperty("bandwidth_bps")&&(d.audio.bitrate_bps=a.message.output.audio_bandwidth.bandwidth_bps),a.message.output.audio_bandwidth.hasOwnProperty("packets_lost_percentage")&&(d.audio.connection=5<a.message.output.audio_bandwidth.packets_lost_percentage?"unstable":"stable")));!0===fa?window.webkit.messageHandlers.callbackHandler.postMessage(b):c.dispatchEvent(b)});b.addEventListener("client-diagnosis-finished",function(a){a=Object(z.a)({type:"client-bitrate-finished",
message:d});!0===fa?window.webkit.messageHandlers.callbackHandler.postMessage(a):c.dispatchEvent(a)});return c};r.a=n},function(l,r,n){function e(e,d){this.test=e;this.inputChannelCount=6;this.outputChannelCount=2;this.bufferSize=0;this.deviceId=d;this.constraints={audio:{optional:[{echoCancellation:!1}]}};this.collectSeconds=2;this.silentThreshold=1/32767;this.lowVolumeThreshold=-60;this.monoDetectThreshold=1/65536;this.clipCountThreshold=6;this.clipThreshold=1;this.collectedAudio=[];for(e=this.collectedSampleCount=
0;e<this.inputChannelCount;++e)this.collectedAudio[e]=[];this.audioContext=new (window.AudioContext||window.webkitAudioContext)}r.a=function(l,d){(new e(l,d)).run()};var u=n(13);e.prototype={run:function(){var e=this;this.audioContext.resume().then(function(){u.appendSourceId(e.deviceId,"audio",e.constraints);u.doGetUserMedia(e.constraints,e.gotStream.bind(e),e.onFail.bind(e))}).catch(function(d){e.test.reportError("WebAudio run failure: "+d);e.test.done()})},onFail:function(e){this.test.reportError("getUserMedia failed with error: "+
e);this.test.done()},gotStream:function(e){this.checkAudioTracks(e)?this.createAudioBuffer(e):this.test.done()},checkAudioTracks:function(e){this.stream=e;e=e.getAudioTracks();if(1>e.length)return this.test.reportError("No audio track in returned stream."),!1;this.test.reportSuccess("Audio track created using device="+e[0].label);return!0},createAudioBuffer:function(){this.audioSource=this.audioContext.createMediaStreamSource(this.stream);this.scriptNode=this.audioContext.createScriptProcessor(this.bufferSize,
this.inputChannelCount,this.outputChannelCount);this.audioSource.connect(this.scriptNode);this.scriptNode.connect(this.audioContext.destination);this.scriptNode.onaudioprocess=this.collectAudio.bind(this);this.stopCollectingAudio=u.setTimeoutWithProgressBar(this.onStopCollectingAudio.bind(this),5E3)},collectAudio:function(e){for(var d=e.inputBuffer.length,a=!0,b=0;b<e.inputBuffer.numberOfChannels;b++){var g=e.inputBuffer.getChannelData(b),l=Math.abs(g[d-1]);Math.abs(g[0])>this.silentThreshold||l>
this.silentThreshold?(l=new Float32Array(d),l.set(g),a=!1):l=new Float32Array;this.collectedAudio[b].push(l)}a||(this.collectedSampleCount+=d,this.collectedSampleCount/e.inputBuffer.sampleRate>=this.collectSeconds&&this.stopCollectingAudio())},onStopCollectingAudio:function(){this.stream.getAudioTracks()[0].stop();this.audioSource.disconnect(this.scriptNode);this.scriptNode.disconnect(this.audioContext.destination);this.analyzeAudio(this.collectedAudio);this.test.done()},analyzeAudio:function(e){for(var d=
[],a=0;a<e.length;a++)this.channelStats(a,e[a])&&d.push(a);0===d.length?this.test.reportError("No active input channels detected. Microphone is most likely muted or broken, please check if muted in the sound settings or physically on the device. Then rerun the test."):this.test.reportSuccess("Active audio input channels: "+d.length);2===d.length&&this.detectMono(e[d[0]],e[d[1]])},channelStats:function(e,d){for(var a=0,b=0,g=0,l=0,m=0;m<d.length;m++){var k=d[m];if(0<k.length){for(var n,t=0,w=0;w<k.length;w++)n=
Math.abs(k[w]),a=Math.max(a,n),t+=n*n,a>=this.clipThreshold?(g+=1,l=Math.max(l,g)):g=0;t=Math.sqrt(t/k.length);b=Math.max(b,t)}}return a>this.silentThreshold?(d=this.dBFS(a),b=this.dBFS(b),this.test.reportInfo("Channel "+e+" levels: "+d.toFixed(1)+" dB (peak), "+b.toFixed(1)+" dB (RMS)"),b<this.lowVolumeThreshold&&this.test.reportError("Microphone input level is low, increase input volume or move closer to the microphone."),l>this.clipCountThreshold&&this.test.reportWarning("Clipping detected! Microphone input level is high. Decrease input volume or move away from the microphone."),
!0):!1},detectMono:function(e,d){for(var a=0,b=0;b<e.length;b++){var g=e[b],l=d[b];if(g.length===l.length)for(var m,k=0;k<g.length;k++)m=Math.abs(g[k]-l[k]),m>this.monoDetectThreshold&&(a+=1);else a+=1}0<a?this.test.reportInfo("Stereo microphone detected."):this.test.reportInfo("Mono microphone detected.")},dBFS:function(e){return Math.round(Math.log(e)/Math.log(10)*200)/10}}},function(l,r,n){function e(a,b,d){this.test=a;this.resolutions=b;this.currentResolution=0;this.isShuttingDown=this.isMuted=
!1;this.deviceId=d}r.a=function(a,b){switch(a.test_title){case "check_resolution_240":(new e(a,[[320,240]],b)).run();break;case "check_resolution_480":(new e(a,[[640,480]],b)).run();break;case "check_resolution_720":(new e(a,[[1280,720]],b)).run();break;case "check_supported_resolutions":(new e(a,[[160,120],[320,180],[320,240],[640,360],[640,480],[768,576],[1024,576],[1280,720],[1280,768],[1280,800],[1920,1080],[1920,1200],[3840,2160],[4096,2160]],b)).run()}};l=n(72);var u=n.n(l);l=n(18);var m=n.n(l),
d=n(13);e.prototype={run:function(){this.startGetUserMedia(this.resolutions[this.currentResolution],this.deviceId);this.currentResolution+=1},startGetUserMedia:function(a,b){var d=this;navigator.mediaDevices.getUserMedia({audio:!1,video:{width:{exact:a[0]},height:{exact:a[1]},deviceId:b}}).then(function(b){1<d.resolutions.length?(d.test.reportSuccess("Supported resolution: "+a[0]+"x"+a[1]),b.getTracks().forEach(function(a){a.stop()}),d.maybeContinueGetUserMedia()):d.collectAndAnalyzeStats(b,a)}).catch(function(b){1<
d.resolutions.length?d.test.reportInfo(a[0]+"x"+a[1]+" not supported"):d.test.reportError("getUserMedia failed with error: "+b.name);d.maybeContinueGetUserMedia()})},maybeContinueGetUserMedia:function(){this.currentResolution===this.resolutions.length?this.test.done():(this.startGetUserMedia(this.resolutions[this.currentResolution]),this.currentResolution+=1)},collectAndAnalyzeStats:function(a,b){var g=this,e=a.getVideoTracks();if(1>e.length)this.test.reportError("No video track in returned stream."),
this.maybeContinueGetUserMedia();else{e=e[0];"function"===typeof e.addEventListener&&(e.addEventListener("ended",function(){g.isShuttingDown||g.test.reportError("Video track ended, camera stopped working")}),e.addEventListener("mute",function(){g.isShuttingDown||(g.test.reportWarning("Your camera reported itself as muted."),g.isMuted=!0)}),e.addEventListener("unmute",function(){g.isShuttingDown||(g.test.reportInfo("Your camera reported itself as unmuted."),g.isMuted=!1)}));e=document.createElement("video");
e.setAttribute("autoplay","");e.setAttribute("muted","");e.width=b[0];e.height=b[1];e.srcObject=a;var l=new u.a(e),k=new m.a(null,this.test);k.pc1.addStream(a);k.establishConnection();k.gatherStats(k.pc1,null,a,this.onCallEnded.bind(this,b,e,a,l),100);d.setTimeoutWithProgressBar(this.endCall.bind(this,k,a),8E3)}},onCallEnded:function(a,b,d,e,l,k){this.analyzeStats(a,b,d,e,l,k);e.stop();this.test.done()},analyzeStats:function(a,b,g,e,l,k){var m=[],p=[],n=[],q={};e=e.frameStats;for(var c in l)"ssrc"===
l[c].type&&0<parseInt(l[c].googFrameRateInput)&&(m.push(parseInt(l[c].googAvgEncodeMs)),p.push(parseInt(l[c].googFrameRateInput)),n.push(parseInt(l[c].googFrameRateSent)));q.cameraName=g.getVideoTracks()[0].label||NaN;q.actualVideoWidth=b.videoWidth;q.actualVideoHeight=b.videoHeight;q.mandatoryWidth=a[0];q.mandatoryHeight=a[1];q.encodeSetupTimeMs=this.extractEncoderSetupTime(l,k);q.avgEncodeTimeMs=d.arrayAverage(m);q.minEncodeTimeMs=d.arrayMin(m);q.maxEncodeTimeMs=d.arrayMax(m);q.avgInputFps=d.arrayAverage(p);
q.minInputFps=d.arrayMin(p);q.maxInputFps=d.arrayMax(p);q.avgSentFps=d.arrayAverage(n);q.minSentFps=d.arrayMin(n);q.maxSentFps=d.arrayMax(n);q.isMuted=this.isMuted;q.testedFrames=e.numFrames;q.blackFrames=e.numBlackFrames;q.frozenFrames=e.numFrozenFrames;this.testExpectations(q)},endCall:function(a,b){this.isShuttingDown=!0;b.getTracks().forEach(function(a){a.stop()});a.close()},extractEncoderSetupTime:function(a,b){for(var d=0;d!==a.length;d++)if("ssrc"===a[d].type&&0<parseInt(a[d].googFrameRateInput))return JSON.stringify(b[d]-
b[0]);return NaN},resolutionMatchesIndependentOfRotationOrCrop:function(a,b,d,e){var g=Math.min(d,e);return a===d&&b===e||a===e&&b===d||a===g&&e===g},testExpectations:function(a){var b=[],d;for(d in a)a.hasOwnProperty(d)&&("number"===typeof a[d]&&isNaN(a[d])?b.push(d):this.test.reportInfo(d+": "+a[d]));0!==b.length&&this.test.reportInfo("Not available: "+b.join(", "));isNaN(a.avgSentFps)?this.test.reportInfo("Cannot verify sent FPS."):5>a.avgSentFps?this.test.reportError("Low average sent FPS: "+
a.avgSentFps):this.test.reportSuccess("Average FPS above threshold");this.resolutionMatchesIndependentOfRotationOrCrop(a.actualVideoWidth,a.actualVideoHeight,a.mandatoryWidth,a.mandatoryHeight)?this.test.reportSuccess("Captured video using expected resolution."):this.test.reportError("Incorrect captured resolution.");0===a.testedFrames?this.test.reportError("Could not analyze any video frame."):(a.blackFrames>a.testedFrames/3&&this.test.reportError("Camera delivering lots of black frames."),a.frozenFrames>
a.testedFrames/3&&this.test.reportError("Camera delivering lots of frozen frames."))}}},function(l,r,n){function e(e){this.frameStats={numFrozenFrames:0,numBlackFrames:0,numFrames:0};this.running_=!0;this.nonBlackPixelLumaThreshold=20;this.previousFrame_=[];this.identicalFrameSsimThreshold=.985;this.frameComparator=new u;this.canvas_=document.createElement("canvas");this.videoElement_=e;this.listener_=this.checkVideoFrame_.bind(this);this.videoElement_.addEventListener("play",this.listener_,!1)}function u(){}
e.prototype={stop:function(){this.videoElement_.removeEventListener("play",this.listener_);this.running_=!1},getCurrentImageData_:function(){this.canvas_.width=this.videoElement_.width;this.canvas_.height=this.videoElement_.height;var e=this.canvas_.getContext("2d");e.drawImage(this.videoElement_,0,0,this.canvas_.width,this.canvas_.height);return e.getImageData(0,0,this.canvas_.width,this.canvas_.height)},checkVideoFrame_:function(){if(this.running_&&!this.videoElement_.ended){var e=this.getCurrentImageData_();
this.isBlackFrame_(e.data,e.data.length)&&(this.frameStats.numBlackFrames+=1);this.frameComparator.calculate(this.previousFrame_,e.data)>this.identicalFrameSsimThreshold&&(this.frameStats.numFrozenFrames+=1);this.previousFrame_=e.data;this.frameStats.numFrames+=1;setTimeout(this.checkVideoFrame_.bind(this),20)}},isBlackFrame_:function(e,d){for(var a=this.nonBlackPixelLumaThreshold,b=0,g=4;g<d;g+=4)if(b+=.21*e[g]+.72*e[g+1]+.07*e[g+2],b>a*g/4)return!1;return!0}};u.prototype={statistics:function(e){var d=
0,a;for(a=0;a<e.length;++a)d+=e[a];var b=d/(e.length-1);for(a=1;a<e.length;++a){var g=e[a-1]-b;d+=e[a]+g*g}return{mean:b,variance:d/e.length}},covariance:function(e,d,a,b){for(var g=0,l=0;l<e.length;l+=1)g+=(e[l]-a)*(d[l]-b);return g/e.length},calculate:function(e,d){if(e.length!==d.length)return 0;var a=6.5025,b=58.5225,g=b/2,l=this.statistics(e),m=l.mean;l=l.variance;var k=Math.sqrt(l),n=this.statistics(d),t=n.mean;n=n.variance;var w=Math.sqrt(n);e=this.covariance(e,d,m,t);return(2*m*t+a)/(m*m+
t*t+a)*((2*k*w+b)/(l+n+b))*((e+g)/(k*w+g))}};l.exports=e},function(l,r,n){function e(e,d,a,b){this.test=e;this.protocol=d;this.params=a;this.iceCandidateFilter=b}r.a=function(l){switch(l.test_title){case "udp_enabled":(new e(l,"udp",null,u.a.isRelay)).run();break;case "tcp_enabled":(new e(l,"tcp",null,u.a.isRelay)).run();break;case "ipv6_enabled":(new e(l,null,{optional:[{googIPv6:!0}]},u.a.isIpv6)).run()}};l=n(18);var u=n.n(l);e.prototype={run:function(){this.iceCandidateFilter.toString()===u.a.isIpv6.toString()?
this.gatherCandidates(null,this.params,this.iceCandidateFilter):"TURN"===this.test.server?u.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region):u.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},start:function(e){this.filterConfig(e,this.protocol);this.gatherCandidates(e,this.params,this.iceCandidateFilter)},filterConfig:function(e,d){var a=[],b=e.iceServers[0],g=[];d="transport="+d;d=b.urls.startsWith("turns")?
b.urls+"?"+d:b.urls;g.push(d);b.urls=g;a.push(b);e.iceServers=a},gatherCandidates:function(e,d,a){var b=this;try{var g=new RTCPeerConnection(e,d)}catch(x){null!==d&&d.optional[0].googIPv6?this.test.reportError("Failed to create peer connection, IPv6 might not be setup/supported on the network."):this.test.reportError("Failed to create peer connection: "+x);this.test.done();return}g.addEventListener("icecandidate",function(e){"closed"!==e.currentTarget.signalingState&&(e.candidate?(e=u.a.parseCandidate(e.candidate.candidate),
a(e)&&(b.test.reportSuccess("Gathered candidate of Type: "+e.type+" Protocol: "+e.protocol+" Address: "+e.address),g.close(),g=null,b.test.done())):(g.close(),g=null,null!==d&&d.optional[0].googIPv6?b.test.reportError("Failed to gather IPv6 candidates, it might not be setup/supported on the network."):b.test.reportError("Failed to gather specified candidates"),b.test.done()))});this.createAudioOnlyReceiveOffer(g)},createAudioOnlyReceiveOffer:function(e){function d(){}e.createOffer({offerToReceiveAudio:1}).then(function(a){e.setLocalDescription(a).then(d,
d)},d)}}},function(l,r,n){function e(e,d){this.test=e;this.iceCandidateFilter=d;this.timeout=null;this.parsedCandidates=[];this.call=null}r.a=function(l){switch(l.test_title){case "relay_connectivity":(new e(l,u.a.isRelay)).run();break;case "reflexive_connectivity":(new e(l,u.a.isReflexive)).run();break;case "host_connectivity":(new e(l,u.a.isHost)).start()}};l=n(18);var u=n.n(l);e.prototype={run:function(){"TURN"===this.test.server?u.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),
this.test.region):u.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},start:function(e){var d=this;this.call=new u.a(e,this.test);this.call.setIceCandidateFilter(this.iceCandidateFilter);this.call.pc1.addEventListener("icecandidate",function(a){a.candidate&&(a=u.a.parseCandidate(a.candidate.candidate),d.parsedCandidates.push(a),d.iceCandidateFilter(a)&&d.test.reportInfo("Gathered candidate of Type: "+a.type+" Protocol: "+a.protocol+" Address: "+
a.address))});var a=this.call.pc1.createDataChannel(null);a.addEventListener("open",function(){a.send("hello")});a.addEventListener("message",function(a){"world"!==a.data?d.test.reportError("Invalid data transmitted."):d.test.reportSuccess("Data successfully transmitted between peers.");d.hangup()});this.call.pc2.addEventListener("datachannel",function(a){var b=a.channel;b.addEventListener("message",function(a){"hello"!==a.data?d.hangup("Invalid data transmitted."):b.send("world")})});this.call.establishConnection();
this.timeout=setTimeout(this.hangup.bind(this,"Timed out"),5E3)},filterConfig:function(e){var d=[],a=e.iceServers[0],b=[],g=a.urls.startsWith("turns")?a.urls+"?transport=tcp":a.urls;b.push(g);a.urls=b;d.push(a);e.iceServers=d},findParsedCandidateOfSpecifiedType:function(e){for(var d in this.parsedCandidates)if(e(this.parsedCandidates[d]))return e(this.parsedCandidates[d])},hangup:function(e){e&&("Timed out"===e&&this.iceCandidateFilter.toString()===u.a.isReflexive.toString()&&this.findParsedCandidateOfSpecifiedType(u.a.isReflexive)?
this.test.reportWarning("Could not connect using reflexive candidates, likely due to the network environment/configuration."):this.test.reportError(e));clearTimeout(this.timeout);this.call.close();this.test.done()}}},function(l,r,n){function e(a,b){this.test=a;this.testDurationSeconds=1*b;this.startTime=null;this.receivedPayloadBytes=this.sentPayloadBytes=0;this.stopSending=!1;this.samplePacket="";for(a=0;1024!==a;++a)this.samplePacket+="h";this.maxNumberOfPacketsToSend=1;this.bytesToKeepBuffered=
1024*this.maxNumberOfPacketsToSend;this.lastBitrateMeasureTime=null;this.lastReceivedPayloadBytes=0;this.receiveChannel=this.senderChannel=this.call=null}function u(a,d,c){this.test=a;this.maxVideoBitrateKbps=2E3;this.durationMs=1E3*c;this.statStepMs=100;this.bweStats=new b.StatisticsAggregate(750*this.maxVideoBitrateKbps);this.rttStats=new b.StatisticsAggregate;this.qpSum=this.pliCount=this.nackCount=this.packetsLost=-1;this.packetsReceived=this.packetsSent=0;this.bitrateMean=this.framesSent=this.videoBytesRecieved=
this.videoBytesSent=this.framesDecoded=this.framesEncoded=-1;this.videoStats=[];this.call=this.startTime=null;this.deviceId=d;this.bytesSent=0;this.constraints={audio:!1,video:{optional:[{minWidth:320},{minHeight:240}]}}}function m(a,b){this.test=a;this.candidateFilter=b;this.testDurationMs=3E5;this.sendIntervalMs=100;this.delays=[];this.recvTimeStamps=[];this.running=!1;this.receiveChannel=this.senderChannel=this.call=null}function d(a,d,c){this.test=a;this.maxAudioBitrateKbps=2E3;this.durationMs=
1E3*c;this.statStepMs=100;this.bweStats=new b.StatisticsAggregate(750*this.maxAudioBitrateKbps);this.rttStats=new b.StatisticsAggregate;this.audioBytesRecieved=this.audioBytesSent=this.packetsReceived=this.packetsSent=this.packetsLost=-1;this.startTime=null;this.jitter=0;this.call=null;this.bytesSent=0;this.deviceId=d;this.constraints={audio:!0}}r.a=function(b,g,c){switch(b.test_title){case "data_throughput":(new e(b,c)).run();break;case "video_bandwidth":(new u(b,g,c)).run();break;case "audio_bandwidth":(new d(b,
g,c)).run();break;case "network_latency":(new m(b,a.a.isNotHostCandidate)).run()}};l=n(18);var a=n.n(l),b=n(13),g=[2,6],x=[200,500],p=[200,500],k=[10,30],v=[250,500,800],t=[0,30];e.prototype={run:function(){"TURN"===this.test.server?a.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region):a.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},start:function(b){this.call=new a.a(b,this.test);this.call.setIceCandidateFilter(a.a.isRelay);
this.senderChannel=this.call.pc1.createDataChannel(null);this.senderChannel.addEventListener("open",this.sendingStep.bind(this));this.call.pc2.addEventListener("datachannel",this.onReceiverChannel.bind(this));this.call.establishConnection();this.timeout=setTimeout(this.hangup.bind(this,"Timed out"),3E4)},hangup:function(a){a&&("Timed out"===a?this.test.reportError("maximum timeout"):this.test.reportError(a));clearTimeout(this.timeout);this.call.close();this.test.done()},onReceiverChannel:function(a){this.receiveChannel=
a.channel;this.receiveChannel.addEventListener("message",this.onMessageReceived.bind(this))},sendingStep:function(){clearTimeout(this.timeout);var a=new Date;this.startTime||(this.lastBitrateMeasureTime=this.startTime=a);for(var b=0;b!==this.maxNumberOfPacketsToSend&&!(this.senderChannel.bufferedAmount>=this.bytesToKeepBuffered);++b)this.sentPayloadBytes+=this.samplePacket.length,this.senderChannel.send(this.samplePacket);a-this.startTime>=1E3*this.testDurationSeconds?(this.test.setProgress(100),
this.stopSending=!0):(this.test.setProgress((a-this.startTime)/(10*this.testDurationSeconds)),setTimeout(this.sendingStep.bind(this),1))},onMessageReceived:function(a){this.receivedPayloadBytes+=a.data.length;a=new Date;if(1E3<=a-this.lastBitrateMeasureTime){var b=(this.receivedPayloadBytes-this.lastReceivedPayloadBytes)/(a-this.lastBitrateMeasureTime);b=Math.round(8E3*b)/1E3;this.test.reportSuccess("Transmitting at "+b+" kbps.");this.lastReceivedPayloadBytes=this.receivedPayloadBytes;this.lastBitrateMeasureTime=
a}this.stopSending&&this.sentPayloadBytes===this.receivedPayloadBytes&&(this.call.close(),this.call=null,this.test.reportSuccess("Total transmitted: "+8*this.receivedPayloadBytes/1E3+" kilo-bits in "+Math.round(10*(a-this.startTime))/1E4+" seconds."),this.test.done())}};u.prototype={run:function(){"TURN"===this.test.server?a.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region):a.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),
this.test.region)},start:function(d){this.call=new a.a(d,this.test);this.call.setIceCandidateFilter(a.a.isRelay);this.call.disableVideoFec();this.call.constrainVideoBitrate(this.maxVideoBitrateKbps);b.appendSourceId(this.deviceId,"video",this.constraints);b.doGetUserMedia(this.constraints,this.gotStream.bind(this),this.onFail.bind(this))},onFail:function(a){this.test.reportError("getUserMedia failed with error: "+a);this.test.done()},gotStream:function(a){this.call.pc1.addStream(a);this.call.establishConnection();
this.startTime=new Date;this.localStream=a.getVideoTracks()[0];setTimeout(this.gatherStats.bind(this),this.statStepMs)},gatherStats:function(){var a=new Date;a-this.startTime>this.durationMs?(this.test.setProgress(100),this.hangup()):(this.call.statsGatheringRunning||this.call.gatherStats(this.call.pc1,this.call.pc2,this.localStream,this.gotStats.bind(this)),this.test.setProgress(100*(a-this.startTime)/this.durationMs),setTimeout(this.gatherStats.bind(this),this.statStepMs))},gotStats:function(a,
b,c,d){if("chrome"===adapter.browserDetails.browser)for(var e in a)"undefined"!==typeof a[e].connection&&(this.bweStats.add(a[e].connection.timestamp,parseInt(a[e].connection.availableOutgoingBitrate)),this.rttStats.add(a[e].connection.timestamp,parseInt(1E3*a[e].connection.currentRoundTripTime)),this.videoStats[0]=a[e].video.local.frameWidth,this.videoStats[1]=a[e].video.local.frameHeight,this.nackCount=a[e].video.local.nackCount,this.packetsLost=c[e].video.remote.packetsLost,this.qpSum=c[e].video.remote.qpSum,
this.pliCount=a[e].video.local.pliCount,this.packetsSent=a[e].video.local.packetsSent,this.packetsReceived=c[e].video.remote.packetsReceived,this.framesEncoded=a[e].video.local.framesEncoded,this.videoBytesSent=a[e].video.local.bytesSent,this.videoBytesRecieved=c[e].video.remote.bytesReceived,this.framesDecoded=c[e].video.remote.framesDecoded);else if("firefox"===adapter.browserDetails.browser)for(var g in a)(b=1E3*a[g].video.remote.roundTripTime)&&this.rttStats.add(a[g].video.remote.timestamp,parseInt(b)),
this.bytesSent+=a[g].connection.bytesSent,this.packetsSent=a[g].video.local.packetsSent,this.packetsLost=c[g].video.remote.packetsLost,this.packetsReceived=c[g].video.remote.packetsReceived,this.qpSum=c[g].video.remote.qpSum,this.bitrateMean=a[g].video.local.bitrateMean,this.videoBytesSent=a[g].video.local.bytesSent,this.videoBytesRecieved=c[g].video.remote.bytesReceived;else this.test.reportError("Only Firefox and Chrome getStats implementations are supported.");this.completed()},hangup:function(){this.call.pc1.getLocalStreams()[0].getTracks().forEach(function(a){a.stop()});
this.call.close();this.call=null},completed:function(){if("chrome"===adapter.browserDetails.browser){var a=(new Date-this.startTime)/1E3;if(2>this.videoStats[0]&&2>this.videoStats[1])this.test.reportError("Camera failure: "+this.videoStats[0]+"x"+this.videoStats[1]+". Cannot test bandwidth without a working  camera.");else{this.test.reportSuccess("Video resolution: "+this.videoStats[0]+"x"+this.videoStats[1]);var b=Math.round(this.bweStats.getAverage()/1E3);var c=b<p[0]?"poor":b<p[1]?"moderate":"good";
var d=b<v[0]?1:b<v[1]?2:b<v[2]?4:5;this.test.reportByState("Average Video bandwidth (Send): "+b+" kbps",c);!0===this.test.bitrate_only&&this.test.fillBandwidth(this.bweStats.getAverage());!1===this.test.bitrate_only&&(this.test.reportInfo("Recommended no. of incoming videos :"+d),this.test.reportInfo("Send bandwidth estimate max: "+this.bweStats.getMax()/1E3+" kbps"),this.test.reportInfo("Send bandwidth ramp-up time: "+this.bweStats.getRampUpTime()+" ms"),this.test.reportInfo("Packets sent: "+this.packetsSent),
this.test.reportInfo("Packets received: "+this.packetsReceived),this.test.reportInfo("NACK count: "+this.nackCount),this.test.reportInfo("Picture loss indications: "+this.pliCount),this.test.reportInfo("Quality predictor sum: "+this.qpSum),this.test.reportInfo("Frames encoded: "+this.framesEncoded),this.test.reportInfo("Frames decoded: "+this.framesDecoded));0<this.packetsSent&&(c=(this.packetsSent-this.packetsReceived)/this.packetsSent*100,b=c<g[0]?"good":c<g[1]?"moderate":"poor",this.test.reportByState("Packets lost: "+
c.toFixed(2)+"%",b),!0===this.test.bitrate_only&&this.test.fillPacketsLost(c.toFixed(2)));b=(8*this.videoBytesSent/(1E3*a)).toFixed(2);a=(8*this.videoBytesRecieved/(1E3*a)).toFixed(2);this.test.reportInfo("Video Bitrate (Send) :"+b+" kbps");this.test.reportInfo("Video Bitrate (Receive) :"+a+" kbps")}}else"firefox"===adapter.browserDetails.browser&&(this.test.reportInfo("Bitrate Mean (Send): "+parseInt(this.bitrateMean)/1E3+" kbps"),a=(new Date-this.startTime)/1E3,b=(8*this.bytesSent/(1E3*a)).toFixed(2),
this.test.reportByState("Average Video bandwidth (Send): "+b+" kbps",b<p[0]?"poor":b<p[1]?"moderate":"good"),!0===this.test.bitrate_only&&this.test.fillBandwidth(1E3*b),!1===this.test.bitrate_only&&(this.test.reportInfo("Packets sent: "+this.packetsSent),this.test.reportInfo("Packets received: "+this.packetsReceived)),0<this.packetsSent&&(c=(this.packetsSent-this.packetsReceived)/this.packetsSent*100,b=c<g[0]?"good":c<g[1]?"moderate":"poor",this.test.reportByState("Packets lost: "+c.toFixed(2)+"%",
b),!0===this.test.bitrate_only&&this.test.fillPacketsLost(c.toFixed(2))),b=(8*this.videoBytesSent/(1E3*a)).toFixed(2),a=(8*this.videoBytesRecieved/(1E3*a)).toFixed(2),this.test.reportInfo("Video Bitrate (Send) :"+b+" kbps"),this.test.reportInfo("Video Bitrate (Receive) :"+a+" kbps"));a=this.rttStats.getAverage();this.test.reportByState("RTT average: "+a+" ms",a<x[0]?"good":a<x[1]?"moderate":"poor");!1===this.test.bitrate_only&&this.test.reportInfo("RTT max: "+this.rttStats.getMax()+" ms");this.test.done()}};
m.prototype={run:function(){"TURN"===this.test.server?a.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region):a.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},start:function(d){this.filterConfig(d);this.running=!0;this.call=new a.a(d,this.test);this.call.setIceCandidateFilter(this.candidateFilter);this.senderChannel=this.call.pc1.createDataChannel({ordered:!1,maxRetransmits:0});this.senderChannel.addEventListener("open",
this.send.bind(this));this.call.pc2.addEventListener("datachannel",this.onReceiverChannel.bind(this));this.call.establishConnection();b.setTimeoutWithProgressBar(this.finishTest.bind(this),this.testDurationMs)},filterConfig:function(a){var b=[],c=a.iceServers[0],d=[],e=c.urls.startsWith("turns")?c.urls+"?transport=tcp":c.urls;d.push(e);c.urls=d;b.push(c);a.iceServers=b},onReceiverChannel:function(a){this.receiveChannel=a.channel;this.receiveChannel.addEventListener("message",this.receive.bind(this))},
send:function(){this.running&&(this.senderChannel.send(""+Date.now()),setTimeout(this.send.bind(this),this.sendIntervalMs))},receive:function(a){if(this.running){a=parseInt(a.data);var b=Date.now()-a;this.recvTimeStamps.push(a);this.delays.push(b);this.test.fillData(a+b,b)}},finishTest:function(){this.running=!1;this.call.close();this.call=null;var a=b.arrayMax(this.delays),d=b.arrayMin(this.delays);this.delays.length<.8*this.testDurationMs/this.sendIntervalMs?this.test.reportError("Not enough samples gathered. Keep the page on  the foreground while the test is running."):
this.test.reportSuccess("Collected "+this.delays.length+" delay samples.");a>2*(d+100)&&this.test.reportError("There is a big difference between the min and max delay of packets. Your network appears unstable.min="+d+"max="+a);this.test.done()}};d.prototype={run:function(){"TURN"===this.test.server?a.a.asyncCreateTurnConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region):a.a.asyncCreateStunConfig(this.start.bind(this),this.test.reportFatal.bind(this.test),this.test.region)},
start:function(d){this.call=new a.a(d,this.test);this.call.setIceCandidateFilter(a.a.isRelay);b.appendSourceId(this.deviceId,"audio",this.constraints);b.doGetUserMedia(this.constraints,this.gotStream.bind(this),this.onFail.bind(this))},onFail:function(a){this.test.reportError("getUserMedia failed with error: "+a);this.test.done()},gotStream:function(a){this.call.pc1.addStream(a);this.call.establishConnection();this.startTime=new Date;this.localStream=a.getAudioTracks()[0];setTimeout(this.gatherStats.bind(this),
this.statStepMs)},gatherStats:function(){var a=new Date;a-this.startTime>this.durationMs?(this.test.setProgress(100),this.hangup()):(this.call.statsGatheringRunning||this.call.gatherStats(this.call.pc1,this.call.pc2,this.localStream,this.gotStats.bind(this)),this.test.setProgress(100*(a-this.startTime)/this.durationMs),setTimeout(this.gatherStats.bind(this),this.statStepMs))},gotStats:function(a,b,c,d){if("chrome"===adapter.browserDetails.browser)for(var e in a)"undefined"!==typeof a[e].connection&&
(this.bweStats.add(a[e].connection.timestamp,parseInt(a[e].connection.availableOutgoingBitrate)),this.rttStats.add(a[e].connection.timestamp,parseInt(1E3*a[e].connection.currentRoundTripTime)),this.packetsLost=c[e].audio.remote.packetsLost,this.packetsSent=a[e].audio.local.packetsSent,this.packetsReceived=c[e].audio.remote.packetsReceived,this.audioBytesSent=a[e].audio.local.bytesSent,this.audioBytesRecieved=c[e].audio.remote.bytesReceived,this.jitter=c[e].audio.remote.jitter);else if("firefox"===
adapter.browserDetails.browser)for(var g in a)(b=1E3*a[g].audio.remote.roundTripTime)&&this.rttStats.add(a[g].audio.remote.timestamp,parseInt(b)),this.bytesSent+=a[g].connection.bytesSent,this.packetsSent=a[g].audio.local.packetsSent,this.packetsLost=c[g].audio.remote.packetsLost,this.packetsReceived=c[g].audio.remote.packetsReceived,this.jitter=c[g].audio.remote.jitter,this.audioBytesSent=a[g].audio.local.bytesSent,this.audioBytesRecieved=c[g].audio.remote.bytesReceived;else this.test.reportError("Only Firefox and Chrome getStats implementations are supported.");
this.completed()},hangup:function(){this.call.pc1.getLocalStreams()[0].getTracks().forEach(function(a){a.stop()});this.call.close();this.call=null},completed:function(){if("chrome"===adapter.browserDetails.browser){var a=(new Date-this.startTime)/1E3,b=Math.round(this.bweStats.getAverage()/1E3);this.test.reportByState("Average Audio bandwidth (Send): "+b+" kbps",b<k[0]?"poor":b<k[1]?"moderate":"good");!0===this.test.bitrate_only&&this.test.fillBandwidth(this.bweStats.getAverage());0==this.test.bitrate_only&&
(this.test.reportInfo("Send bandwidth estimate max: "+this.bweStats.getMax()/1E3+" kbps"),this.test.reportInfo("Send bandwidth ramp-up time: "+this.bweStats.getRampUpTime()+" ms"),this.test.reportInfo("Packets sent: "+this.packetsSent),this.test.reportInfo("Packets received: "+this.packetsReceived));if(0<this.packetsSent){var c=(this.packetsSent-this.packetsReceived)/this.packetsSent*100;b=c<g[0]?"good":c<g[1]?"moderate":"poor";this.test.reportByState("Packets lost: "+c.toFixed(2)+"%",b);!0===this.test.bitrate_only&&
this.test.fillPacketsLost(c.toFixed(2))}b=(8*this.audioBytesSent/(1E3*a)).toFixed(2);a=(8*this.audioBytesRecieved/(1E3*a)).toFixed(2);this.test.reportInfo("Audio Bitrate (Send) :"+b+" kbps");this.test.reportInfo("Audio Bitrate (Receive) :'"+a+" 'kbps");a=1E3*this.jitter;a>t[1]||a<=t[0]||this.test.reportByState("Jitter: "+a,"good")}else"firefox"===adapter.browserDetails.browser&&(a=(new Date-this.startTime)/1E3,!1===this.test.bitrate_only&&(this.test.reportInfo("Packets sent: "+this.packetsSent),this.test.reportInfo("Packets received: "+
this.packetsReceived)),0<this.packetsSent&&(c=(this.packetsSent-this.packetsReceived)/this.packetsSent*100,b=c<g[0]?"good":c<g[1]?"moderate":"poor",this.test.reportByState("Packets lost: "+c.toFixed(2)+"%",b),!0===this.test.bitrate_only&&this.test.fillPacketsLost(c.toFixed(2))),b=1E3*this.jitter,b>t[1]||b<=t[0]||this.test.reportByState("Jitter: "+b,"good"),b=(8*this.audioBytesSent/(1E3*a)).toFixed(2),a=(8*this.audioBytesRecieved/(1E3*a)).toFixed(2),this.test.reportInfo("Audio Bitrate (Send) :"+b+
" kbps"),this.test.reportInfo("Audio Bitrate (Receive) :'"+a+" 'kbps"));a=this.rttStats.getAverage();this.test.reportByState("RTT average: "+a+" ms",a<x[0]?"good":a<x[1]?"moderate":"poor");!1===this.test.bitrate_only&&this.test.reportInfo("RTT max: "+this.rttStats.getMax()+" ms");this.test.done()}}},function(l,r,n){function e(e,d,a){this.test=e;this.host=d;this.port=a}r.a=function(l,d,a){(new e(l,d,a)).run()};var u=n(77);e.prototype={run:function(){var e=this;u("https://"+this.host+":"+this.port+
"/proxy-token",{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"No"}}).then(function(d){return d.json()}).then(function(d){e.test.reportSuccess("Token created successfully.");if(!1===Object.prototype.hasOwnProperty.call(d,"token"))e.test.reportError("Token creation failed due to error: "+d.error),e.test.done();else{var a={video:!0,audio:!0,data:!0,videoSize:{LD:[80,45,640,360]}.SD,attributes:{name:"Test connectivity"}},b=EnxRtc.Logger.getLogLevel();EnxRtc.Logger.setLogLevel(EnxRtc.Logger.NONE);
EnxRtc.joinRoom(d.token,a,function(a,d){EnxRtc.Logger.setLogLevel(b);d&&null!=d?(e.test.reportError("Room not joined due to error: "+d.type),e.test.done()):a&&null!=a&&(a.room.disconnect(),e.test.reportSuccess("Room joined successfully."),e.test.done())})}}).catch(function(d){e.test.reportError("Token creation failed due to error: "+d);e.test.done()})}}},function(l,r,n){var e=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof e)return e;
throw Error("unable to locate global object");}();if(l.exports=r=e.fetch)r.default=e.fetch.bind(e);r.Headers=e.Headers;r.Request=e.Request;r.Response=e.Response},function(l,r,n){function e(e){return void 0==e||"app"==e?!1:!0}n(11);r.a={setCustomData:function(e,l,d){console.log("setCustomData")},getCustomData:function(l,m){console.log("getCustomData");var d={result:0};0==e(l.scope)&&(d.result=1,d.error="Invalid scope parameter "+l.scope,m(d))},saveCustomData:function(l,m,d){console.log("saveCustomData");
var a={result:0};if(0==e(l))a.result=1,a.error="Invalid scope parameter: "+l;else if(void 0==m||"object"!=typeof m)a.result=1,a.error="Invalid  data";d(a)}}},function(l,r){},function(l,r,n){r=n(30);l.exports=r.adapter=n(81)},function(l,r,n){l.exports=function(){return function(){function e(l,m,d){function a(g,p){if(!m[g]){if(!l[g]){if(b)return b(g,!0);p=Error("Cannot find module '"+g+"'");throw p.code="MODULE_NOT_FOUND",p;}p=m[g]={exports:{}};l[g][0].call(p.exports,function(b){return a(l[g][1][b]||
b)},p,p.exports,e,l,m,d)}return m[g].exports}for(var b=!1,g=0;g<d.length;g++)a(d[g]);return a}return e}()({1:[function(e,l,m){e=e("./adapter_factory.js");e=(0,e.adapterFactory)({window:window});l.exports=e},{"./adapter_factory.js":2}],2:[function(e,l,m){function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}Object.defineProperty(m,"__esModule",{value:!0});m.adapterFactory=function(){var d=(0<arguments.length&&
void 0!==arguments[0]?arguments[0]:{}).window,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},l=a.log,m=a.detectBrowser(d),c={browserDetails:m,commonShim:k,extractVersion:a.extractVersion,disableLog:a.disableLog,disableWarnings:a.disableWarnings};switch(m.browser){case "chrome":if(!b||!b.shimPeerConnection||!e.shimChrome){l("Chrome shim is not included in this adapter release.");break}l("adapter.js shimming chrome.");c.browserShim=
b;b.shimGetUserMedia(d);b.shimMediaStream(d);b.shimPeerConnection(d);b.shimOnTrack(d);b.shimAddTrackRemoveTrack(d);b.shimGetSendersWithDtmf(d);b.shimGetStats(d);b.shimSenderReceiverGetStats(d);b.fixNegotiationNeeded(d);k.shimRTCIceCandidate(d);k.shimConnectionState(d);k.shimMaxMessageSize(d);k.shimSendThrowTypeError(d);k.removeAllowExtmapMixed(d);break;case "firefox":if(!n||!n.shimPeerConnection||!e.shimFirefox){l("Firefox shim is not included in this adapter release.");break}l("adapter.js shimming firefox.");
c.browserShim=n;n.shimGetUserMedia(d);n.shimPeerConnection(d);n.shimOnTrack(d);n.shimRemoveStream(d);n.shimSenderGetStats(d);n.shimReceiverGetStats(d);n.shimRTCDataChannel(d);k.shimRTCIceCandidate(d);k.shimConnectionState(d);k.shimMaxMessageSize(d);k.shimSendThrowTypeError(d);break;case "edge":if(!g||!g.shimPeerConnection||!e.shimEdge){l("MS edge shim is not included in this adapter release.");break}l("adapter.js shimming edge.");c.browserShim=g;g.shimGetUserMedia(d);g.shimGetDisplayMedia(d);g.shimPeerConnection(d);
g.shimReplaceTrack(d);k.shimMaxMessageSize(d);k.shimSendThrowTypeError(d);break;case "safari":if(!p||!e.shimSafari){l("Safari shim is not included in this adapter release.");break}l("adapter.js shimming safari.");c.browserShim=p;p.shimRTCIceServerUrls(d);p.shimCreateOfferLegacy(d);p.shimCallbacksAPI(d);p.shimLocalStreamsAPI(d);p.shimRemoteStreamsAPI(d);p.shimTrackEventTransceiver(d);p.shimGetUserMedia(d);k.shimRTCIceCandidate(d);k.shimMaxMessageSize(d);k.shimSendThrowTypeError(d);k.removeAllowExtmapMixed(d);
break;default:l("Unsupported browser!")}return c};l=e("./utils");var a=d(l);l=e("./chrome/chrome_shim");var b=d(l);l=e("./edge/edge_shim");var g=d(l);l=e("./firefox/firefox_shim");var n=d(l);l=e("./safari/safari_shim");var p=d(l);e=e("./common_shim");var k=d(e)},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,l,m){function d(a,b,d){b in a?Object.defineProperty(a,b,{value:d,enumerable:!0,configurable:!0,
writable:!0}):a[b]=d;return a}function a(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};return Object.keys(this._shimmedLocalStreams).map(function(c){return a._shimmedLocalStreams[c][0]})};var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,d){if(!d)return b.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var c=b.apply(this,arguments);this._shimmedLocalStreams[d.id]?
-1===this._shimmedLocalStreams[d.id].indexOf(c)&&this._shimmedLocalStreams[d.id].push(c):this._shimmedLocalStreams[d.id]=[d,c];return c};var d=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var c=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};a.getTracks().forEach(function(a){if(c.getSenders().find(function(c){return c.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});var b=this.getSenders();d.apply(this,
arguments);var e=this.getSenders().filter(function(a){return-1===b.indexOf(a)});this._shimmedLocalStreams[a.id]=[a].concat(e)};var e=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{};delete this._shimmedLocalStreams[a.id];return e.apply(this,arguments)};var g=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){var c=this;this._shimmedLocalStreams=this._shimmedLocalStreams||
{};a&&Object.keys(this._shimmedLocalStreams).forEach(function(b){var d=c._shimmedLocalStreams[b].indexOf(a);-1!==d&&c._shimmedLocalStreams[b].splice(d,1);1===c._shimmedLocalStreams[b].length&&delete c._shimmedLocalStreams[b]});return g.apply(this,arguments)}}Object.defineProperty(m,"__esModule",{value:!0});m.shimGetDisplayMedia=m.shimGetUserMedia=void 0;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:
function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},g=e("./getusermedia");Object.defineProperty(m,"shimGetUserMedia",{enumerable:!0,get:function(){return g.shimGetUserMedia}});var n=e("./getdisplaymedia");Object.defineProperty(m,"shimGetDisplayMedia",{enumerable:!0,get:function(){return n.shimGetDisplayMedia}});m.shimMediaStream=function(a){a.MediaStream=a.MediaStream||a.webkitMediaStream};
m.shimOnTrack=function(a){if("object"!==("undefined"===typeof a?"undefined":b(a))||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)p.wrapPeerConnectionEvent(a,"track",function(a){a.transceiver||Object.defineProperty(a,"transceiver",{value:{receiver:a.receiver}});return a});else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&this.removeEventListener("track",this._ontrack);this.addEventListener("track",
this._ontrack=a)},enumerable:!0,configurable:!0});var d=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var b=this;this._ontrackpoly||(this._ontrackpoly=function(d){d.stream.addEventListener("addtrack",function(e){var c=void 0;c=a.RTCPeerConnection.prototype.getReceivers?b.getReceivers().find(function(a){return a.track&&a.track.id===e.track.id}):{track:e.track};var g=new Event("track");g.track=e.track;g.receiver=c;g.transceiver={receiver:c};
g.streams=[d.stream];b.dispatchEvent(g)});d.stream.getTracks().forEach(function(e){var c=void 0;c=a.RTCPeerConnection.prototype.getReceivers?b.getReceivers().find(function(a){return a.track&&a.track.id===e.id}):{track:e};var g=new Event("track");g.track=e;g.receiver=c;g.transceiver={receiver:c};g.streams=[d.stream];b.dispatchEvent(g)})},this.addEventListener("addstream",this._ontrackpoly));return d.apply(this,arguments)}}};m.shimGetSendersWithDtmf=function(a){if("object"===("undefined"===typeof a?
"undefined":b(a))&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){var d=function(a,c){return{track:c,get dtmf(){void 0===this._dtmf&&(this._dtmf="audio"===c.kind?a.createDTMFSender(c):null);return this._dtmf},_pc:a}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){this._senders=this._senders||[];return this._senders.slice()};var e=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=
function(a,c){var b=e.apply(this,arguments);b||(b=d(this,a),this._senders.push(b));return b};var g=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){g.apply(this,arguments);var c=this._senders.indexOf(a);-1!==c&&this._senders.splice(c,1)}}var k=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var c=this;this._senders=this._senders||[];k.apply(this,[a]);a.getTracks().forEach(function(a){c._senders.push(d(c,a))})};
var c=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;this._senders=this._senders||[];c.apply(this,[a]);a.getTracks().forEach(function(a){var c=b._senders.find(function(c){return c.track===a});c&&b._senders.splice(b._senders.indexOf(c),1)})}}else if("object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in
a.RTCRtpSender.prototype)){var l=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){var a=this,c=l.apply(this,[]);c.forEach(function(c){return c._pc=a});return c};Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null);return this._dtmf}})}};m.shimGetStats=function(a){if(a.RTCPeerConnection){var b=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=
function(){var a=this,d=Array.prototype.slice.call(arguments),e=d[0],c=d[1];d=d[2];if(0<arguments.length&&"function"===typeof e)return b.apply(this,arguments);if(0===b.length&&(0===arguments.length||"function"!==typeof e))return b.apply(this,[]);var g=function(a){var c={};a.result().forEach(function(a){var b={id:a.id,timestamp:a.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[a.type]||a.type};a.names().forEach(function(c){b[c]=a.stat(c)});c[b.id]=b});return c},
k=function(a){return new Map(Object.keys(a).map(function(c){return[c,a[c]]}))};return 2<=arguments.length?b.apply(this,[function(a){c(k(g(a)))},e]):(new Promise(function(c,d){b.apply(a,[function(a){c(k(g(a)))},d])})).then(c,d)}}};m.shimSenderReceiverGetStats=function(a){if("object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver){if(!("getStats"in a.RTCRtpSender.prototype)){var d=a.RTCPeerConnection.prototype.getSenders;d&&(a.RTCPeerConnection.prototype.getSenders=
function(){var a=this,b=d.apply(this,[]);b.forEach(function(c){return c._pc=a});return b});var e=a.RTCPeerConnection.prototype.addTrack;e&&(a.RTCPeerConnection.prototype.addTrack=function(){var a=e.apply(this,arguments);a._pc=this;return a});a.RTCRtpSender.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(c){return p.filterStats(c,a.track,!0)})}}if(!("getStats"in a.RTCRtpReceiver.prototype)){var g=a.RTCPeerConnection.prototype.getReceivers;g&&(a.RTCPeerConnection.prototype.getReceivers=
function(){var a=this,b=g.apply(this,[]);b.forEach(function(c){return c._pc=a});return b});p.wrapPeerConnectionEvent(a,"track",function(a){a.receiver._pc=a.srcElement;return a});a.RTCRtpReceiver.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(c){return p.filterStats(c,a.track,!1)})}}if("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype){var k=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){if(0<
arguments.length&&arguments[0]instanceof a.MediaStreamTrack){var c=arguments[0],b=void 0,d=void 0,e=void 0;this.getSenders().forEach(function(a){a.track===c&&(b?e=!0:b=a)});this.getReceivers().forEach(function(a){a.track===c&&(d?e=!0:d=a);return a.track===c});return e||b&&d?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):b?b.getStats():d?d.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return k.apply(this,
arguments)}}}};m.shimAddTrackRemoveTrackWithNative=a;m.shimAddTrackRemoveTrack=function(b){function e(a,c){var b=c.sdp;Object.keys(a._reverseStreams||[]).forEach(function(c){c=a._reverseStreams[c];b=b.replace(new RegExp(a._streams[c.id].id,"g"),c.id)});return new RTCSessionDescription({type:c.type,sdp:b})}function g(a,c){var b=c.sdp;Object.keys(a._reverseStreams||[]).forEach(function(c){c=a._reverseStreams[c];b=b.replace(new RegExp(c.id,"g"),a._streams[c.id].id)});return new RTCSessionDescription({type:c.type,
sdp:b})}if(b.RTCPeerConnection){var k=p.detectBrowser(b);if(b.RTCPeerConnection.prototype.addTrack&&65<=k.version)return a(b);var l=b.RTCPeerConnection.prototype.getLocalStreams;b.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this,c=l.apply(this);this._reverseStreams=this._reverseStreams||{};return c.map(function(c){return a._reverseStreams[c.id]})};var c=b.RTCPeerConnection.prototype.addStream;b.RTCPeerConnection.prototype.addStream=function(a){var d=this;this._streams=this._streams||
{};this._reverseStreams=this._reverseStreams||{};a.getTracks().forEach(function(a){if(d.getSenders().find(function(c){return c.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});if(!this._reverseStreams[a.id]){var e=new b.MediaStream(a.getTracks());this._streams[a.id]=e;this._reverseStreams[e.id]=a;a=e}c.apply(this,[a])};var m=b.RTCPeerConnection.prototype.removeStream;b.RTCPeerConnection.prototype.removeStream=function(a){this._streams=this._streams||{};this._reverseStreams=
this._reverseStreams||{};m.apply(this,[this._streams[a.id]||a]);delete this._reverseStreams[this._streams[a.id]?this._streams[a.id].id:a.id];delete this._streams[a.id]};b.RTCPeerConnection.prototype.addTrack=function(a,c){var d=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var e=[].slice.call(arguments,1);if(1!==e.length||!e[0].getTracks().find(function(c){return c===a}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.",
"NotSupportedError");if(this.getSenders().find(function(c){return c.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};(e=this._streams[c.id])?(e.addTrack(a),Promise.resolve().then(function(){d.dispatchEvent(new Event("negotiationneeded"))})):(e=new b.MediaStream([a]),this._streams[c.id]=e,this._reverseStreams[e.id]=c,this.addStream(e));return this.getSenders().find(function(c){return c.track===
a})};["createOffer","createAnswer"].forEach(function(a){var c=b.RTCPeerConnection.prototype[a],g=d({},a,function(){var a=this,b=arguments;return arguments.length&&"function"===typeof arguments[0]?c.apply(this,[function(c){c=e(a,c);b[0].apply(null,[c])},function(a){b[1]&&b[1].apply(null,a)},arguments[2]]):c.apply(this,arguments).then(function(c){return e(a,c)})});b.RTCPeerConnection.prototype[a]=g[a]});var n=b.RTCPeerConnection.prototype.setLocalDescription;b.RTCPeerConnection.prototype.setLocalDescription=
function(){if(!arguments.length||!arguments[0].type)return n.apply(this,arguments);arguments[0]=g(this,arguments[0]);return n.apply(this,arguments)};var r=Object.getOwnPropertyDescriptor(b.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(b.RTCPeerConnection.prototype,"localDescription",{get:function(){var a=r.get.apply(this);return""===a.type?a:e(this,a)}});b.RTCPeerConnection.prototype.removeTrack=function(a){var c=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.",
"InvalidStateError");if(!a._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(a._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var b=void 0;Object.keys(this._streams).forEach(function(d){c._streams[d].getTracks().find(function(c){return a.track===c})&&(b=c._streams[d])});b&&(1===b.getTracks().length?this.removeStream(this._reverseStreams[b.id]):
b.removeTrack(a.track),this.dispatchEvent(new Event("negotiationneeded")))}}};m.shimPeerConnection=function(a){var b=p.detectBrowser(a);!a.RTCPeerConnection&&a.webkitRTCPeerConnection&&(a.RTCPeerConnection=a.webkitRTCPeerConnection);if(a.RTCPeerConnection){53>b.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(b){var e=a.RTCPeerConnection.prototype[b],c=d({},b,function(){arguments[0]=new ("addIceCandidate"===b?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]);
return e.apply(this,arguments)});a.RTCPeerConnection.prototype[b]=c[b]});var e=a.RTCPeerConnection.prototype.addIceCandidate;a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?78>b.version&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};m.fixNegotiationNeeded=function(a){p.wrapPeerConnectionEvent(a,"negotiationneeded",function(a){if("stable"===a.target.signalingState)return a})};
var p=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(e("../utils.js"))},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,l,m){Object.defineProperty(m,"__esModule",{value:!0});m.shimGetDisplayMedia=function(d,a){d.navigator.mediaDevices&&"getDisplayMedia"in d.navigator.mediaDevices||!d.navigator.mediaDevices||("function"!==typeof a?console.error("shimGetDisplayMedia: getSourceId argument is not a function"):
d.navigator.mediaDevices.getDisplayMedia=function(b){return a(b).then(function(a){var e=b.video&&b.video.width,g=b.video&&b.video.height;b.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:a,maxFrameRate:b.video&&b.video.frameRate||3}};e&&(b.video.mandatory.maxWidth=e);g&&(b.video.mandatory.maxHeight=g);return d.navigator.mediaDevices.getUserMedia(b)})})}},{}],5:[function(e,l,m){Object.defineProperty(m,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();
var d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};m.shimGetUserMedia=function(e){var g=e&&e.navigator;if(g.mediaDevices){var l=a.detectBrowser(e),k=function(a){if("object"!==("undefined"===typeof a?"undefined":d(a))||a.mandatory||a.optional)return a;var c={};Object.keys(a).forEach(function(b){if("require"!==
b&&"advanced"!==b&&"mediaSource"!==b){var e="object"===d(a[b])?a[b]:{ideal:a[b]};void 0!==e.exact&&"number"===typeof e.exact&&(e.min=e.max=e.exact);var g=function(a,c){return a?a+c.charAt(0).toUpperCase()+c.slice(1):"deviceId"===c?"sourceId":c};if(void 0!==e.ideal){c.optional=c.optional||[];var k={};"number"===typeof e.ideal?(k[g("min",b)]=e.ideal,c.optional.push(k),k={},k[g("max",b)]=e.ideal):k[g("",b)]=e.ideal;c.optional.push(k)}void 0!==e.exact&&"number"!==typeof e.exact?(c.mandatory=c.mandatory||
{},c.mandatory[g("",b)]=e.exact):["min","max"].forEach(function(a){void 0!==e[a]&&(c.mandatory=c.mandatory||{},c.mandatory[g(a,b)]=e[a])})}});a.advanced&&(c.optional=(c.optional||[]).concat(a.advanced));return c},m=function(a,c){if(61<=l.version)return c(a);if((a=JSON.parse(JSON.stringify(a)))&&"object"===d(a.audio)){var e=function(a,c,b){c in a&&!(b in a)&&(a[b]=a[c],delete a[c])};a=JSON.parse(JSON.stringify(a));e(a.audio,"autoGainControl","googAutoGainControl");e(a.audio,"noiseSuppression","googNoiseSuppression");
a.audio=k(a.audio)}if(a&&"object"===d(a.video)){var m=a.video.facingMode;m=m&&("object"===("undefined"===typeof m?"undefined":d(m))?m:{ideal:m});e=66>l.version;if(!(!m||"user"!==m.exact&&"environment"!==m.exact&&"user"!==m.ideal&&"environment"!==m.ideal||g.mediaDevices.getSupportedConstraints&&g.mediaDevices.getSupportedConstraints().facingMode&&!e)){delete a.video.facingMode;var p=void 0;if("environment"===m.exact||"environment"===m.ideal)p=["back","rear"];else if("user"===m.exact||"user"===m.ideal)p=
["front"];if(p)return g.mediaDevices.enumerateDevices().then(function(d){d=d.filter(function(a){return"videoinput"===a.kind});var e=d.find(function(a){return p.some(function(c){return a.label.toLowerCase().includes(c)})});!e&&d.length&&p.includes("back")&&(e=d[d.length-1]);e&&(a.video.deviceId=m.exact?{exact:e.deviceId}:{ideal:e.deviceId});a.video=k(a.video);b("chrome: "+JSON.stringify(a));return c(a)})}a.video=k(a.video)}b("chrome: "+JSON.stringify(a));return c(a)},n=function(a){return 64<=l.version?
a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,
toString:function(){return this.name+(this.message&&": ")+this.message}}};g.getUserMedia=function(a,c,b){m(a,function(a){g.webkitGetUserMedia(a,c,function(a){b&&b(n(a))})})}.bind(g);if(g.mediaDevices.getUserMedia){var r=g.mediaDevices.getUserMedia.bind(g.mediaDevices);g.mediaDevices.getUserMedia=function(a){return m(a,function(a){return r(a).then(function(c){if(a.audio&&!c.getAudioTracks().length||a.video&&!c.getVideoTracks().length)throw c.getTracks().forEach(function(a){a.stop()}),new DOMException("",
"NotFoundError");return c},function(a){return Promise.reject(n(a))})})}}}};var a=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(e("../utils.js")),b=a.log},{"../utils.js":15}],6:[function(e,l,m){Object.defineProperty(m,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:
function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};m.shimRTCIceCandidate=function(e){if(e.RTCIceCandidate&&!(e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var g=e.RTCIceCandidate;e.RTCIceCandidate=function(b){"object"===("undefined"===typeof b?"undefined":d(b))&&b.candidate&&0===b.candidate.indexOf("a=")&&(b=JSON.parse(JSON.stringify(b)),b.candidate=b.candidate.substr(2));
if(b.candidate&&b.candidate.length){var e=new g(b);b=a.default.parseCandidate(b.candidate);var l=Object.assign(e,b);l.toJSON=function(){return{candidate:l.candidate,sdpMid:l.sdpMid,sdpMLineIndex:l.sdpMLineIndex,usernameFragment:l.usernameFragment}};return l}return new g(b)};e.RTCIceCandidate.prototype=g.prototype;b.wrapPeerConnectionEvent(e,"icecandidate",function(a){a.candidate&&Object.defineProperty(a,"candidate",{value:new e.RTCIceCandidate(a.candidate),writable:"false"});return a})}};m.shimMaxMessageSize=
function(d){if(d.RTCPeerConnection){var e=b.detectBrowser(d);"sctp"in d.RTCPeerConnection.prototype||Object.defineProperty(d.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp}});var g=function(b){if(!b||!b.sdp)return!1;b=a.default.splitSections(b.sdp);b.shift();return b.some(function(c){return(c=a.default.parseMLine(c))&&"application"===c.kind&&-1!==c.protocol.indexOf("SCTP")})},k=function(a){a=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===
a||2>a.length)return-1;a=parseInt(a[1],10);return a!==a?-1:a},l=function(a){var c=65536;"firefox"===e.browser&&(c=57>e.version?-1===a?16384:2147483637:60>e.version?57===e.version?65535:65536:2147483637);return c},m=function(b,c){var d=65536;"firefox"===e.browser&&57===e.version&&(d=65535);b=a.default.matchPrefix(b.sdp,"a=max-message-size:");0<b.length?d=parseInt(b[0].substr(19),10):"firefox"===e.browser&&-1!==c&&(d=2147483637);return d},n=d.RTCPeerConnection.prototype.setRemoteDescription;d.RTCPeerConnection.prototype.setRemoteDescription=
function(){this._sctp=null;"chrome"===e.browser&&76<=e.version&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0});if(g(arguments[0])){var a=k(arguments[0]),c=l(a);a=m(arguments[0],a);var b=void 0;b=0===c&&0===a?Number.POSITIVE_INFINITY:0===c||0===a?Math.max(c,a):Math.min(c,a);c={};Object.defineProperty(c,"maxMessageSize",{get:function(){return b}});this._sctp=c}return n.apply(this,
arguments)}}};m.shimSendThrowTypeError=function(a){function d(a,b){var d=a.send;a.send=function(){var e=arguments[0];e=e.length||e.size||e.byteLength;if("open"===a.readyState&&b.sctp&&e>b.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+b.sctp.maxMessageSize+" bytes)");return d.apply(a,arguments)}}if(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype){var e=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=
function(){var a=e.apply(this,arguments);d(a,this);return a};b.wrapPeerConnectionEvent(a,"datachannel",function(a){d(a.channel,a.target);return a})}};m.shimConnectionState=function(a){if(a.RTCPeerConnection&&!("connectionState"in a.RTCPeerConnection.prototype)){var b=a.RTCPeerConnection.prototype;Object.defineProperty(b,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0});Object.defineProperty(b,
"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(a){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange);a&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=a)},enumerable:!0,configurable:!0});["setLocalDescription","setRemoteDescription"].forEach(function(a){var d=b[a];b[a]=function(){this._connectionstatechangepoly||(this._connectionstatechangepoly=
function(a){var b=a.target;if(b._lastConnectionState!==b.connectionState){b._lastConnectionState=b.connectionState;var d=new Event("connectionstatechange",a);b.dispatchEvent(d)}return a},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly));return d.apply(this,arguments)}})}};m.removeAllowExtmapMixed=function(a){if(a.RTCPeerConnection){var d=b.detectBrowser(a);if(!("chrome"===d.browser&&71<=d.version)){var e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=
function(a){a&&a.sdp&&-1!==a.sdp.indexOf("\na=extmap-allow-mixed")&&(a.sdp=a.sdp.split("\n").filter(function(a){return"a=extmap-allow-mixed"!==a.trim()}).join("\n"));return e.apply(this,arguments)}}}};var a=(l=e("sdp"))&&l.__esModule?l:{default:l},b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(e("./utils"))},{"./utils":15,sdp:17}],7:[function(e,l,m){Object.defineProperty(m,"__esModule",{value:!0});
m.shimGetDisplayMedia=m.shimGetUserMedia=void 0;var d=e("./getusermedia");Object.defineProperty(m,"shimGetUserMedia",{enumerable:!0,get:function(){return d.shimGetUserMedia}});var a=e("./getdisplaymedia");Object.defineProperty(m,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}});m.shimPeerConnection=function(a){var d=b.detectBrowser(a);if(a.RTCIceGatherer&&(a.RTCIceCandidate||(a.RTCIceCandidate=function(a){return a}),a.RTCSessionDescription||(a.RTCSessionDescription=
function(a){return a}),15025>d.version)){var e=Object.getOwnPropertyDescriptor(a.MediaStreamTrack.prototype,"enabled");Object.defineProperty(a.MediaStreamTrack.prototype,"enabled",{set:function(a){e.set.call(this,a);var b=new Event("enabled");b.enabled=a;this.dispatchEvent(b)}})}!a.RTCRtpSender||"dtmf"in a.RTCRtpSender.prototype||Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new a.RTCDtmfSender(this):"video"===this.track.kind&&
(this._dtmf=null));return this._dtmf}});a.RTCDtmfSender&&!a.RTCDTMFSender&&(a.RTCDTMFSender=a.RTCDtmfSender);var l=(0,n.default)(a,d.version);a.RTCPeerConnection=function(a){a&&a.iceServers&&(a.iceServers=(0,g.filterIceServers)(a.iceServers,d.version),b.log("ICE servers after filtering:",a.iceServers));return new l(a)};a.RTCPeerConnection.prototype=l.prototype};m.shimReplaceTrack=function(a){!a.RTCRtpSender||"replaceTrack"in a.RTCRtpSender.prototype||(a.RTCRtpSender.prototype.replaceTrack=a.RTCRtpSender.prototype.setTrack)};
var b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(e("../utils")),g=e("./filtericeservers"),n=(e=e("rtcpeerconnection-shim"))&&e.__esModule?e:{default:e}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,l,m){Object.defineProperty(m,"__esModule",{value:!0});m.filterIceServers=function(a,b){var e=!1;a=JSON.parse(JSON.stringify(a));
return a.filter(function(a){if(a&&(a.urls||a.url)){var b=a.urls||a.url;a.url&&!a.urls&&d.deprecated("RTCIceServer.url","RTCIceServer.urls");var g="string"===typeof b;g&&(b=[b]);b=b.filter(function(a){return 0===a.indexOf("stun:")?!1:(a=a.startsWith("turn")&&!a.startsWith("turn:[")&&a.includes("transport=udp"))&&!e?e=!0:a&&!e});delete a.url;a.urls=g?b[0]:b;return!!b.length}})};var d=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&
(b[d]=a[d]);b.default=a;return b}(e("../utils"))},{"../utils":15}],9:[function(e,l,m){Object.defineProperty(m,"__esModule",{value:!0});m.shimGetDisplayMedia=function(d){"getDisplayMedia"in d.navigator&&d.navigator.mediaDevices&&!(d.navigator.mediaDevices&&"getDisplayMedia"in d.navigator.mediaDevices)&&(d.navigator.mediaDevices.getDisplayMedia=d.navigator.getDisplayMedia.bind(d.navigator))}},{}],10:[function(e,l,m){Object.defineProperty(m,"__esModule",{value:!0});m.shimGetUserMedia=function(d){d=d&&
d.navigator;var a=function(a){return{name:{PermissionDeniedError:"NotAllowedError"}[a.name]||a.name,message:a.message,constraint:a.constraint,toString:function(){return this.name}}},b=d.mediaDevices.getUserMedia.bind(d.mediaDevices);d.mediaDevices.getUserMedia=function(d){return b(d).catch(function(b){return Promise.reject(a(b))})}}},{}],11:[function(e,l,m){function d(a,b,d){b in a?Object.defineProperty(a,b,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[b]=d;return a}Object.defineProperty(m,
"__esModule",{value:!0});m.shimGetDisplayMedia=m.shimGetUserMedia=void 0;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},b=e("./getusermedia");Object.defineProperty(m,"shimGetUserMedia",{enumerable:!0,get:function(){return b.shimGetUserMedia}});
var g=e("./getdisplaymedia");Object.defineProperty(m,"shimGetDisplayMedia",{enumerable:!0,get:function(){return g.shimGetDisplayMedia}});m.shimOnTrack=function(b){"object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCTrackEvent&&"receiver"in b.RTCTrackEvent.prototype&&!("transceiver"in b.RTCTrackEvent.prototype)&&Object.defineProperty(b.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};m.shimPeerConnection=function(b){var e=n.detectBrowser(b);if("object"===
("undefined"===typeof b?"undefined":a(b))&&(b.RTCPeerConnection||b.mozRTCPeerConnection)){!b.RTCPeerConnection&&b.mozRTCPeerConnection&&(b.RTCPeerConnection=b.mozRTCPeerConnection);53>e.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){var c=b.RTCPeerConnection.prototype[a],e=d({},a,function(){arguments[0]=new ("addIceCandidate"===a?b.RTCIceCandidate:b.RTCSessionDescription)(arguments[0]);return c.apply(this,arguments)});b.RTCPeerConnection.prototype[a]=
e[a]});if(68>e.version){var g=b.RTCPeerConnection.prototype.addIceCandidate;b.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():g.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var l={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},m=b.RTCPeerConnection.prototype.getStats;b.RTCPeerConnection.prototype.getStats=
function(){var a=Array.prototype.slice.call(arguments),b=a[1],d=a[2];return m.apply(this,[a[0]||null]).then(function(a){if(53>e.version&&!b)try{a.forEach(function(a){a.type=l[a.type]||a.type})}catch(z){if("TypeError"!==z.name)throw z;a.forEach(function(b,c){a.set(c,Object.assign({},b,{type:l[b.type]||b.type}))})}return a}).then(b,d)}}};m.shimSenderGetStats=function(b){if("object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCPeerConnection&&b.RTCRtpSender&&!(b.RTCRtpSender&&"getStats"in b.RTCRtpSender.prototype)){var d=
b.RTCPeerConnection.prototype.getSenders;d&&(b.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=d.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});var e=b.RTCPeerConnection.prototype.addTrack;e&&(b.RTCPeerConnection.prototype.addTrack=function(){var a=e.apply(this,arguments);a._pc=this;return a});b.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}};m.shimReceiverGetStats=function(b){if("object"===("undefined"===
typeof b?"undefined":a(b))&&b.RTCPeerConnection&&b.RTCRtpSender&&!(b.RTCRtpSender&&"getStats"in b.RTCRtpReceiver.prototype)){var d=b.RTCPeerConnection.prototype.getReceivers;d&&(b.RTCPeerConnection.prototype.getReceivers=function(){var a=this,b=d.apply(this,[]);b.forEach(function(b){return b._pc=a});return b});n.wrapPeerConnectionEvent(b,"track",function(a){a.receiver._pc=a.srcElement;return a});b.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}};m.shimRemoveStream=
function(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;n.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(d){d.track&&a.getTracks().includes(d.track)&&b.removeTrack(d)})})};m.shimRTCDataChannel=function(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)};var n=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,
d)&&(b[d]=a[d]);b.default=a;return b}(e("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,l,m){Object.defineProperty(m,"__esModule",{value:!0});m.shimGetDisplayMedia=function(d,a){d.navigator.mediaDevices&&"getDisplayMedia"in d.navigator.mediaDevices||!d.navigator.mediaDevices||(d.navigator.mediaDevices.getDisplayMedia=function(b){if(!b||!b.video)return b=new DOMException("getDisplayMedia without video constraints is undefined"),b.name="NotFoundError",b.code=
8,Promise.reject(b);!0===b.video?b.video={mediaSource:a}:b.video.mediaSource=a;return d.navigator.mediaDevices.getUserMedia(b)})}},{}],13:[function(e,l,m){Object.defineProperty(m,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===
Symbol&&a!==Symbol.prototype?"symbol":typeof a};m.shimGetUserMedia=function(b){var e=a.detectBrowser(b),l=b&&b.navigator;b=b&&b.MediaStreamTrack;l.getUserMedia=function(b,d,c){a.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");l.mediaDevices.getUserMedia(b).then(d,c)};if(!(55<e.version&&"autoGainControl"in l.mediaDevices.getSupportedConstraints())){var m=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])},k=l.mediaDevices.getUserMedia.bind(l.mediaDevices);l.mediaDevices.getUserMedia=
function(a){"object"===("undefined"===typeof a?"undefined":d(a))&&"object"===d(a.audio)&&(a=JSON.parse(JSON.stringify(a)),m(a.audio,"autoGainControl","mozAutoGainControl"),m(a.audio,"noiseSuppression","mozNoiseSuppression"));return k(a)};if(b&&b.prototype.getSettings){var n=b.prototype.getSettings;b.prototype.getSettings=function(){var a=n.apply(this,arguments);m(a,"mozAutoGainControl","autoGainControl");m(a,"mozNoiseSuppression","noiseSuppression");return a}}if(b&&b.prototype.applyConstraints){var t=
b.prototype.applyConstraints;b.prototype.applyConstraints=function(a){"audio"===this.kind&&"object"===("undefined"===typeof a?"undefined":d(a))&&(a=JSON.parse(JSON.stringify(a)),m(a,"autoGainControl","mozAutoGainControl"),m(a,"noiseSuppression","mozNoiseSuppression"));return t.apply(this,[a])}}}};var a=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(e("../utils"))},{"../utils":15}],14:[function(e,
l,m){function d(a){return a&&void 0!==a.video?Object.assign({},a,{video:b.compactObject(a.video)}):a}Object.defineProperty(m,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};m.shimLocalStreamsAPI=
function(b){if("object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCPeerConnection){"getLocalStreams"in b.RTCPeerConnection.prototype||(b.RTCPeerConnection.prototype.getLocalStreams=function(){this._localStreams||(this._localStreams=[]);return this._localStreams});if(!("addStream"in b.RTCPeerConnection.prototype)){var d=b.RTCPeerConnection.prototype.addTrack;b.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._localStreams||(this._localStreams=[]);this._localStreams.includes(a)||
this._localStreams.push(a);a.getAudioTracks().forEach(function(e){return d.call(b,e,a)});a.getVideoTracks().forEach(function(e){return d.call(b,e,a)})};b.RTCPeerConnection.prototype.addTrack=function(a){var b=arguments[1];b&&(this._localStreams?this._localStreams.includes(b)||this._localStreams.push(b):this._localStreams=[b]);return d.apply(this,arguments)}}"removeStream"in b.RTCPeerConnection.prototype||(b.RTCPeerConnection.prototype.removeStream=function(a){var b=this;this._localStreams||(this._localStreams=
[]);var d=this._localStreams.indexOf(a);if(-1!==d){this._localStreams.splice(d,1);var e=a.getTracks();this.getSenders().forEach(function(a){e.includes(a.track)&&b.removeTrack(a)})}})}};m.shimRemoteStreamsAPI=function(b){if("object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCPeerConnection&&("getRemoteStreams"in b.RTCPeerConnection.prototype||(b.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in b.RTCPeerConnection.prototype))){Object.defineProperty(b.RTCPeerConnection.prototype,
"onaddstream",{get:function(){return this._onaddstream},set:function(a){var b=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly));this.addEventListener("addstream",this._onaddstream=a);this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(function(a){b._remoteStreams||(b._remoteStreams=[]);if(!b._remoteStreams.includes(a)){b._remoteStreams.push(a);var d=new Event("addstream");d.stream=
a;b.dispatchEvent(d)}})})}});var d=b.RTCPeerConnection.prototype.setRemoteDescription;b.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(b){b.streams.forEach(function(b){a._remoteStreams||(a._remoteStreams=[]);if(!(0<=a._remoteStreams.indexOf(b))){a._remoteStreams.push(b);var d=new Event("addstream");d.stream=b;a.dispatchEvent(d)}})});return d.apply(a,arguments)}}};m.shimCallbacksAPI=function(b){if("object"===
("undefined"===typeof b?"undefined":a(b))&&b.RTCPeerConnection){b=b.RTCPeerConnection.prototype;var d=b.createOffer,e=b.createAnswer,g=b.setLocalDescription,l=b.setRemoteDescription,m=b.addIceCandidate;b.createOffer=function(a,b){var c=d.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return c;c.then(a,b);return Promise.resolve()};b.createAnswer=function(a,b){var c=e.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!b)return c;c.then(a,b);return Promise.resolve()};
var n=function(a,b,d){a=g.apply(this,[a]);if(!d)return a;a.then(b,d);return Promise.resolve()};b.setLocalDescription=n;n=function(a,b,d){a=l.apply(this,[a]);if(!d)return a;a.then(b,d);return Promise.resolve()};b.setRemoteDescription=n;n=function(a,b,d){a=m.apply(this,[a]);if(!d)return a;a.then(b,d);return Promise.resolve()};b.addIceCandidate=n}};m.shimGetUserMedia=function(a){var b=a&&a.navigator;if(b.mediaDevices&&b.mediaDevices.getUserMedia){a=b.mediaDevices;var e=a.getUserMedia.bind(a);b.mediaDevices.getUserMedia=
function(a){return e(d(a))}}!b.getUserMedia&&b.mediaDevices&&b.mediaDevices.getUserMedia&&(b.getUserMedia=function(a,d,e){b.mediaDevices.getUserMedia(a).then(d,e)})};m.shimConstraints=d;m.shimRTCIceServerUrls=function(a){var d=a.RTCPeerConnection;a.RTCPeerConnection=function(a,e){if(a&&a.iceServers){for(var g=[],k=0;k<a.iceServers.length;k++){var l=a.iceServers[k];!l.hasOwnProperty("urls")&&l.hasOwnProperty("url")?(b.deprecated("RTCIceServer.url","RTCIceServer.urls"),l=JSON.parse(JSON.stringify(l)),
l.urls=l.url,delete l.url,g.push(l)):g.push(a.iceServers[k])}a.iceServers=g}return new d(a,e)};a.RTCPeerConnection.prototype=d.prototype;"generateCertificate"in a.RTCPeerConnection&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return d.generateCertificate}})};m.shimTrackEventTransceiver=function(b){"object"===("undefined"===typeof b?"undefined":a(b))&&b.RTCTrackEvent&&"receiver"in b.RTCTrackEvent.prototype&&!("transceiver"in b.RTCTrackEvent.prototype)&&Object.defineProperty(b.RTCTrackEvent.prototype,
"transceiver",{get:function(){return{receiver:this.receiver}}})};m.shimCreateOfferLegacy=function(a){var b=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(a){if(a){"undefined"!==typeof a.offerToReceiveAudio&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);var d=this.getTransceivers().find(function(a){return"audio"===a.receiver.track.kind});!1===a.offerToReceiveAudio&&d?"sendrecv"===d.direction?d.setDirection?d.setDirection("sendonly"):d.direction="sendonly":
"recvonly"===d.direction&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive"):!0!==a.offerToReceiveAudio||d||this.addTransceiver("audio");"undefined"!==typeof a.offerToReceiveVideo&&(a.offerToReceiveVideo=!!a.offerToReceiveVideo);d=this.getTransceivers().find(function(a){return"video"===a.receiver.track.kind});!1===a.offerToReceiveVideo&&d?"sendrecv"===d.direction?d.setDirection?d.setDirection("sendonly"):d.direction="sendonly":"recvonly"===d.direction&&(d.setDirection?d.setDirection("inactive"):
d.direction="inactive"):!0!==a.offerToReceiveVideo||d||this.addTransceiver("video")}return b.apply(this,arguments)}};var b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(e("../utils"))},{"../utils":15}],15:[function(e,l,m){function d(a,b,d){b in a?Object.defineProperty(a,b,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[b]=d;return a}function a(a,b,d){return(a=a.match(b))&&a.length>=d&&
parseInt(a[d],10)}function b(a){return"[object Object]"!==Object.prototype.toString.call(a)?a:Object.keys(a).reduce(function(e,g){var k="[object Object]"===Object.prototype.toString.call(a[g]),c=k?b(a[g]):a[g];k=k&&!Object.keys(c).length;return void 0===c||k?e:Object.assign(e,d({},g,c))},{})}function g(a,b,d){b&&!d.has(b.id)&&(d.set(b.id,b),Object.keys(b).forEach(function(e){e.endsWith("Id")?g(a,a.get(b[e]),d):e.endsWith("Ids")&&b[e].forEach(function(b){g(a,a.get(b),d)})}))}Object.defineProperty(m,
"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};m.extractVersion=a;m.wrapPeerConnectionEvent=function(a,b,d){if(a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var e=a.addEventListener;
a.addEventListener=function(a,c){if(a!==b)return e.apply(this,arguments);var g=function(a){(a=d(a))&&c(a)};this._eventMap=this._eventMap||{};this._eventMap[c]=g;return e.apply(this,[a,g])};var c=a.removeEventListener;a.removeEventListener=function(a,d){if(a!==b||!this._eventMap||!this._eventMap[d])return c.apply(this,arguments);var e=this._eventMap[d];delete this._eventMap[d];return c.apply(this,[a,e])};Object.defineProperty(a,"on"+b,{get:function(){return this["_on"+b]},set:function(a){this["_on"+
b]&&(this.removeEventListener(b,this["_on"+b]),delete this["_on"+b]);a&&this.addEventListener(b,this["_on"+b]=a)},enumerable:!0,configurable:!0})}};m.disableLog=function(a){return"boolean"!==typeof a?Error("Argument type: "+("undefined"===typeof a?"undefined":n(a))+". Please use a boolean."):(p=a)?"adapter.js logging disabled":"adapter.js logging enabled"};m.disableWarnings=function(a){if("boolean"!==typeof a)return Error("Argument type: "+("undefined"===typeof a?"undefined":n(a))+". Please use a boolean.");
k=!a;return"adapter.js deprecation warnings "+(a?"disabled":"enabled")};m.log=function(){"object"!==("undefined"===typeof window?"undefined":n(window))||p||"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)};m.deprecated=function(a,b){k&&console.warn(a+" is deprecated, please use "+b+" instead.")};m.detectBrowser=function(b){var d=b.navigator,e={browser:null,version:null};if("undefined"===typeof b||!b.navigator)return e.browser="Not a browser.",e;d.mozGetUserMedia?
(e.browser="firefox",e.version=a(d.userAgent,/Firefox\/(\d+)\./,1)):d.webkitGetUserMedia||!1===b.isSecureContext&&b.webkitRTCPeerConnection&&!b.RTCIceGatherer?(e.browser="chrome",e.version=a(d.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):d.mediaDevices&&d.userAgent.match(/Edge\/(\d+).(\d+)$/)?(e.browser="edge",e.version=a(d.userAgent,/Edge\/(\d+).(\d+)$/,2)):b.RTCPeerConnection&&d.userAgent.match(/AppleWebKit\/(\d+)\./)?(e.browser="safari",e.version=a(d.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=
b.RTCRtpTransceiver&&"currentDirection"in b.RTCRtpTransceiver.prototype):e.browser="Not a supported browser.";return e};m.compactObject=b;m.walkStats=g;m.filterStats=function(a,b,d){var e=d?"outbound-rtp":"inbound-rtp",c=new Map;if(null===b)return c;var k=[];a.forEach(function(a){"track"===a.type&&a.trackIdentifier===b.id&&k.push(a)});k.forEach(function(b){a.forEach(function(d){d.type===e&&d.trackId===b.id&&g(a,d,c)})});return c};var p=!0,k=!0},{}],16:[function(e,l,m){function d(a,b,d,e,c){b=k.writeRtpDescription(a.kind,
b);b+=k.writeIceParameters(a.iceGatherer.getLocalParameters());b+=k.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===d?"actpass":c||"active");b+="a=mid:"+a.mid+"\r\n";b=a.rtpSender&&a.rtpReceiver?b+"a=sendrecv\r\n":a.rtpSender?b+"a=sendonly\r\n":a.rtpReceiver?b+"a=recvonly\r\n":b+"a=inactive\r\n";a.rtpSender&&(d=a.rtpSender._initialTrackId||a.rtpSender.track.id,a.rtpSender._initialTrackId=d,e="msid:"+(e?e.id:"-")+" "+d+"\r\n",b=b+("a="+e)+("a=ssrc:"+a.sendEncodingParameters[0].ssrc+
" "+e),a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+e,b+="a=ssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n"));b+="a=ssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+k.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+k.localCName+"\r\n");return b}function a(a,b){var d=!1;a=JSON.parse(JSON.stringify(a));return a.filter(function(a){if(a&&
(a.urls||a.url)){var c=a.urls||a.url;a.url&&!a.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var e="string"===typeof c;e&&(c=[c]);c=c.filter(function(a){return 0!==a.indexOf("turn:")||-1===a.indexOf("transport=udp")||-1!==a.indexOf("turn:[")||d?0===a.indexOf("stun:")&&14393<=b&&-1===a.indexOf("?transport=udp"):d=!0});delete a.url;a.urls=e?c[0]:c;return!!c.length}})}function b(a,b){var d={codecs:[],headerExtensions:[],fecMechanisms:[]},e=function(a,b){a=parseInt(a,10);for(var c=
0;c<b.length;c++)if(b[c].payloadType===a||b[c].preferredPayloadType===a)return b[c]},c=function(a,b,c,d){a=e(a.parameters.apt,c);b=e(b.parameters.apt,d);return a&&b&&a.name.toLowerCase()===b.name.toLowerCase()};a.codecs.forEach(function(e){for(var g=0;g<b.codecs.length;g++){var k=b.codecs[g];if(e.name.toLowerCase()===k.name.toLowerCase()&&e.clockRate===k.clockRate&&("rtx"!==e.name.toLowerCase()||!e.parameters||!k.parameters.apt||c(e,k,a.codecs,b.codecs))){k=JSON.parse(JSON.stringify(k));k.numChannels=
Math.min(e.numChannels,k.numChannels);d.codecs.push(k);k.rtcpFeedback=k.rtcpFeedback.filter(function(a){for(var b=0;b<e.rtcpFeedback.length;b++)if(e.rtcpFeedback[b].type===a.type&&e.rtcpFeedback[b].parameter===a.parameter)return!0;return!1});break}}});a.headerExtensions.forEach(function(a){for(var c=0;c<b.headerExtensions.length;c++){var e=b.headerExtensions[c];if(a.uri===e.uri){d.headerExtensions.push(e);break}}});return d}function g(a,b,d){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],
setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[b][a].indexOf(d)}function n(a,b){var d=a.getRemoteCandidates().find(function(a){return b.foundation===a.foundation&&b.ip===a.ip&&b.port===a.port&&b.priority===a.priority&&b.protocol===a.protocol&&b.type===a.type});d||a.addRemoteCandidate(b);return!d}function p(a,b){b=Error(b);b.name=a;b.code={NotSupportedError:9,
InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[a];return b}var k=e("sdp");l.exports=function(e,l){function m(a,b){b.addTrack(a);b.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:a}))}function q(a,b){b.removeTrack(a);b.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:a}))}function c(a,b,c,d){var g=new Event("track");g.track=b;g.receiver=c;g.transceiver={receiver:c};g.streams=d;e.setTimeout(function(){a._dispatchEvent("track",g)})}var r=
function(b){var c=this,d=document.createDocumentFragment();["addEventListener","removeEventListener","dispatchEvent"].forEach(function(a){c[a]=d[a].bind(d)});this.canTrickleIceCandidates=null;this.needNegotiation=!1;this.localStreams=[];this.remoteStreams=[];this._remoteDescription=this._localDescription=null;this.signalingState="stable";this.iceGatheringState=this.connectionState=this.iceConnectionState="new";b=JSON.parse(JSON.stringify(b||{}));this.usingBundle="max-bundle"===b.bundlePolicy;if("negotiate"===
b.rtcpMuxPolicy)throw p("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");b.rtcpMuxPolicy||(b.rtcpMuxPolicy="require");switch(b.iceTransportPolicy){case "all":case "relay":break;default:b.iceTransportPolicy="all"}switch(b.bundlePolicy){case "balanced":case "max-compat":case "max-bundle":break;default:b.bundlePolicy="balanced"}b.iceServers=a(b.iceServers||[],l);this._iceGatherers=[];if(b.iceCandidatePoolSize)for(var g=b.iceCandidatePoolSize;0<g;g--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:b.iceServers,
gatherPolicy:b.iceTransportPolicy}));else b.iceCandidatePoolSize=0;this._config=b;this.transceivers=[];this._sdpSessionId=k.generateSessionId();this._sdpSessionVersion=0;this._dtlsRole=void 0;this._isClosed=!1};Object.defineProperty(r.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}});Object.defineProperty(r.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}});r.prototype.onicecandidate=null;r.prototype.onaddstream=
null;r.prototype.ontrack=null;r.prototype.onremovestream=null;r.prototype.onsignalingstatechange=null;r.prototype.oniceconnectionstatechange=null;r.prototype.onconnectionstatechange=null;r.prototype.onicegatheringstatechange=null;r.prototype.onnegotiationneeded=null;r.prototype.ondatachannel=null;r.prototype._dispatchEvent=function(a,b){if(!this._isClosed&&(this.dispatchEvent(b),"function"===typeof this["on"+a]))this["on"+a](b)};r.prototype._emitGatheringStateChange=function(){var a=new Event("icegatheringstatechange");
this._dispatchEvent("icegatheringstatechange",a)};r.prototype.getConfiguration=function(){return this._config};r.prototype.getLocalStreams=function(){return this.localStreams};r.prototype.getRemoteStreams=function(){return this.remoteStreams};r.prototype._createTransceiver=function(a,b){var c=0<this.transceivers.length;a={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:a,mid:null,sendEncodingParameters:null,
recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};this.usingBundle&&c?(a.iceTransport=this.transceivers[0].iceTransport,a.dtlsTransport=this.transceivers[0].dtlsTransport):(c=this._createIceAndDtlsTransports(),a.iceTransport=c.iceTransport,a.dtlsTransport=c.dtlsTransport);b||this.transceivers.push(a);return a};r.prototype.addTrack=function(a,b){if(this._isClosed)throw p("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find(function(b){return b.track===
a}))throw p("InvalidAccessError","Track already exists.");for(var c,d=0;d<this.transceivers.length;d++)this.transceivers[d].track||this.transceivers[d].kind!==a.kind||(c=this.transceivers[d]);c||(c=this._createTransceiver(a.kind));this._maybeFireNegotiationNeeded();-1===this.localStreams.indexOf(b)&&this.localStreams.push(b);c.track=a;c.stream=b;c.rtpSender=new e.RTCRtpSender(a,c.dtlsTransport);return c.rtpSender};r.prototype.addStream=function(a){var b=this;if(15025<=l)a.getTracks().forEach(function(c){b.addTrack(c,
a)});else{var c=a.clone();a.getTracks().forEach(function(a,b){var d=c.getTracks()[b];a.addEventListener("enabled",function(a){d.enabled=a.enabled})});c.getTracks().forEach(function(a){b.addTrack(a,c)})}};r.prototype.removeTrack=function(a){if(this._isClosed)throw p("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(a instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var b=this.transceivers.find(function(b){return b.rtpSender===
a});if(!b)throw p("InvalidAccessError","Sender was not created by this connection.");var c=b.stream;b.rtpSender.stop();b.rtpSender=null;b.track=null;b.stream=null;-1===this.transceivers.map(function(a){return a.stream}).indexOf(c)&&-1<this.localStreams.indexOf(c)&&this.localStreams.splice(this.localStreams.indexOf(c),1);this._maybeFireNegotiationNeeded()};r.prototype.removeStream=function(a){var b=this;a.getTracks().forEach(function(a){var c=b.getSenders().find(function(b){return b.track===a});c&&
b.removeTrack(c)})};r.prototype.getSenders=function(){return this.transceivers.filter(function(a){return!!a.rtpSender}).map(function(a){return a.rtpSender})};r.prototype.getReceivers=function(){return this.transceivers.filter(function(a){return!!a.rtpReceiver}).map(function(a){return a.rtpReceiver})};r.prototype._createIceGatherer=function(a,b){var c=this;if(b&&0<a)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var d=new e.RTCIceGatherer({iceServers:this._config.iceServers,
gatherPolicy:this._config.iceTransportPolicy});Object.defineProperty(d,"state",{value:"new",writable:!0});this.transceivers[a].bufferedCandidateEvents=[];this.transceivers[a].bufferCandidates=function(b){var e=!b.candidate||0===Object.keys(b.candidate).length;d.state=e?"completed":"gathering";null!==c.transceivers[a].bufferedCandidateEvents&&c.transceivers[a].bufferedCandidateEvents.push(b)};d.addEventListener("localcandidate",this.transceivers[a].bufferCandidates);return d};r.prototype._gather=function(a,
b){var c=this,d=this.transceivers[b].iceGatherer;if(!d.onlocalcandidate){var g=this.transceivers[b].bufferedCandidateEvents;this.transceivers[b].bufferedCandidateEvents=null;d.removeEventListener("localcandidate",this.transceivers[b].bufferCandidates);d.onlocalcandidate=function(e){if(!(c.usingBundle&&0<b)){var g=new Event("icecandidate");g.candidate={sdpMid:a,sdpMLineIndex:b};var l=e.candidate;if(e=!l||0===Object.keys(l).length){if("new"===d.state||"gathering"===d.state)d.state="completed"}else"new"===
d.state&&(d.state="gathering"),l.component=1,l.ufrag=d.getLocalParameters().usernameFragment,l=k.writeCandidate(l),g.candidate=Object.assign(g.candidate,k.parseCandidate(l)),g.candidate.candidate=l,g.candidate.toJSON=function(){return{candidate:g.candidate.candidate,sdpMid:g.candidate.sdpMid,sdpMLineIndex:g.candidate.sdpMLineIndex,usernameFragment:g.candidate.usernameFragment}};l=k.getMediaSections(c._localDescription.sdp);l[g.candidate.sdpMLineIndex]=e?l[g.candidate.sdpMLineIndex]+"a=end-of-candidates\r\n":
l[g.candidate.sdpMLineIndex]+("a="+g.candidate.candidate+"\r\n");c._localDescription.sdp=k.getDescription(c._localDescription.sdp)+l.join("");l=c.transceivers.every(function(a){return a.iceGatherer&&"completed"===a.iceGatherer.state});"gathering"!==c.iceGatheringState&&(c.iceGatheringState="gathering",c._emitGatheringStateChange());e||c._dispatchEvent("icecandidate",g);l&&(c._dispatchEvent("icecandidate",new Event("icecandidate")),c.iceGatheringState="complete",c._emitGatheringStateChange())}};e.setTimeout(function(){g.forEach(function(a){d.onlocalcandidate(a)})},
0)}};r.prototype._createIceAndDtlsTransports=function(){var a=this,b=new e.RTCIceTransport(null);b.onicestatechange=function(){a._updateIceConnectionState();a._updateConnectionState()};var c=new e.RTCDtlsTransport(b);c.ondtlsstatechange=function(){a._updateConnectionState()};c.onerror=function(){Object.defineProperty(c,"state",{value:"failed",writable:!0});a._updateConnectionState()};return{iceTransport:b,dtlsTransport:c}};r.prototype._disposeIceAndDtlsTransports=function(a){var b=this.transceivers[a].iceGatherer;
b&&(delete b.onlocalcandidate,delete this.transceivers[a].iceGatherer);if(b=this.transceivers[a].iceTransport)delete b.onicestatechange,delete this.transceivers[a].iceTransport;if(b=this.transceivers[a].dtlsTransport)delete b.ondtlsstatechange,delete b.onerror,delete this.transceivers[a].dtlsTransport};r.prototype._transceive=function(a,c,d){var e=b(a.localCapabilities,a.remoteCapabilities);c&&a.rtpSender&&(e.encodings=a.sendEncodingParameters,e.rtcp={cname:k.localCName,compound:a.rtcpParameters.compound},
a.recvEncodingParameters.length&&(e.rtcp.ssrc=a.recvEncodingParameters[0].ssrc),a.rtpSender.send(e));d&&a.rtpReceiver&&0<e.codecs.length&&("video"===a.kind&&a.recvEncodingParameters&&15019>l&&a.recvEncodingParameters.forEach(function(a){delete a.rtx}),e.encodings=a.recvEncodingParameters.length?a.recvEncodingParameters:[{}],e.rtcp={compound:a.rtcpParameters.compound},a.rtcpParameters.cname&&(e.rtcp.cname=a.rtcpParameters.cname),a.sendEncodingParameters.length&&(e.rtcp.ssrc=a.sendEncodingParameters[0].ssrc),
a.rtpReceiver.receive(e))};r.prototype.setLocalDescription=function(a){var c=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(p("TypeError",'Unsupported type "'+a.type+'"'));if(!g("setLocalDescription",a.type,c.signalingState)||c._isClosed)return Promise.reject(p("InvalidStateError","Can not set local "+a.type+" in state "+c.signalingState));if("offer"===a.type){var d=k.splitSections(a.sdp);var e=d.shift();d.forEach(function(a,b){a=k.parseRtpParameters(a);c.transceivers[b].localCapabilities=
a});c.transceivers.forEach(function(a,b){c._gather(a.mid,b)})}else if("answer"===a.type){d=k.splitSections(c._remoteDescription.sdp);e=d.shift();var l=0<k.matchPrefix(e,"a=ice-lite").length;d.forEach(function(a,d){var g=c.transceivers[d],m=g.iceGatherer,n=g.iceTransport,p=g.dtlsTransport,f=g.localCapabilities,q=g.remoteCapabilities;if(!(k.isRejected(a)&&0===k.matchPrefix(a,"a=bundle-only").length||g.rejected)){var r=k.getIceParameters(a,e);a=k.getDtlsParameters(a,e);l&&(a.role="server");c.usingBundle&&
0!==d||(c._gather(g.mid,d),"new"===n.state&&n.start(m,r,l?"controlling":"controlled"),"new"===p.state&&p.start(a));d=b(f,q);c._transceive(g,0<d.codecs.length,!1)}})}c._localDescription={type:a.type,sdp:a.sdp};"offer"===a.type?c._updateSignalingState("have-local-offer"):c._updateSignalingState("stable");return Promise.resolve()};r.prototype.setRemoteDescription=function(a){var d=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(p("TypeError",'Unsupported type "'+a.type+'"'));if(!g("setRemoteDescription",
a.type,d.signalingState)||d._isClosed)return Promise.reject(p("InvalidStateError","Can not set remote "+a.type+" in state "+d.signalingState));var r={};d.remoteStreams.forEach(function(a){r[a.id]=a});var t=[],u=k.splitSections(a.sdp),v=u.shift(),z=0<k.matchPrefix(v,"a=ice-lite").length,w=0<k.matchPrefix(v,"a=group:BUNDLE ").length;d.usingBundle=w;var x=k.matchPrefix(v,"a=ice-options:")[0];d.canTrickleIceCandidates=x?0<=x.substr(14).split(" ").indexOf("trickle"):!1;u.forEach(function(c,g){var f=k.splitLines(c),
p=k.getKind(c),u=k.isRejected(c)&&0===k.matchPrefix(c,"a=bundle-only").length,x=f[0].substr(2).split(" ")[2];f=k.getDirection(c,v);var y=k.parseMsid(c),B=k.getMid(c)||k.generateIdentifier();if(u||"application"===p&&("DTLS/SCTP"===x||"UDP/DTLS/SCTP"===x))d.transceivers[g]={mid:B,kind:p,protocol:x,rejected:!0};else{!u&&d.transceivers[g]&&d.transceivers[g].rejected&&(d.transceivers[g]=d._createTransceiver(p,!0));var K=k.parseRtpParameters(c);if(!u){var F=k.getIceParameters(c,v);var S=k.getDtlsParameters(c,
v);S.role="client"}x=k.parseRtpEncodingParameters(c);var Y=k.parseRtcpParameters(c),A=0<k.matchPrefix(c,"a=end-of-candidates",v).length,E=k.matchPrefix(c,"a=candidate:").map(function(a){return k.parseCandidate(a)}).filter(function(a){return 1===a.component});("offer"===a.type||"answer"===a.type)&&!u&&w&&0<g&&d.transceivers[g]&&(d._disposeIceAndDtlsTransports(g),d.transceivers[g].iceGatherer=d.transceivers[0].iceGatherer,d.transceivers[g].iceTransport=d.transceivers[0].iceTransport,d.transceivers[g].dtlsTransport=
d.transceivers[0].dtlsTransport,d.transceivers[g].rtpSender&&d.transceivers[g].rtpSender.setTransport(d.transceivers[0].dtlsTransport),d.transceivers[g].rtpReceiver&&d.transceivers[g].rtpReceiver.setTransport(d.transceivers[0].dtlsTransport));if("offer"!==a.type||u)"answer"!==a.type||u||(D=d.transceivers[g],G=D.iceGatherer,p=D.iceTransport,B=D.dtlsTransport,M=D.rtpReceiver,u=D.sendEncodingParameters,c=D.localCapabilities,d.transceivers[g].recvEncodingParameters=x,d.transceivers[g].remoteCapabilities=
K,d.transceivers[g].rtcpParameters=Y,E.length&&"new"===p.state&&(!z&&!A||w&&0!==g?E.forEach(function(a){n(D.iceTransport,a)}):p.setRemoteCandidates(E)),w&&0!==g||("new"===p.state&&p.start(G,F,"controlling"),"new"===B.state&&B.start(S)),!b(D.localCapabilities,D.remoteCapabilities).codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&D.sendEncodingParameters[0].rtx&&delete D.sendEncodingParameters[0].rtx,d._transceive(D,"sendrecv"===f||"recvonly"===f,"sendrecv"===f||"sendonly"===f),
!M||"sendrecv"!==f&&"sendonly"!==f?delete D.rtpReceiver:(f=M.track,y?(r[y.stream]||(r[y.stream]=new e.MediaStream),m(f,r[y.stream]),t.push([f,M,r[y.stream]])):(r.default||(r.default=new e.MediaStream),m(f,r.default),t.push([f,M,r.default]))));else{var D=d.transceivers[g]||d._createTransceiver(p);D.mid=B;D.iceGatherer||(D.iceGatherer=d._createIceGatherer(g,w));E.length&&"new"===D.iceTransport.state&&(!A||w&&0!==g?E.forEach(function(a){n(D.iceTransport,a)}):D.iceTransport.setRemoteCandidates(E));c=
e.RTCRtpReceiver.getCapabilities(p);15019>l&&(c.codecs=c.codecs.filter(function(a){return"rtx"!==a.name}));u=D.sendEncodingParameters||[{ssrc:1001*(2*g+2)}];F=!1;if("sendrecv"===f||"sendonly"===f){F=!D.rtpReceiver;var M=D.rtpReceiver||new e.RTCRtpReceiver(D.dtlsTransport,p);if(F){f=M.track;if(!y||"-"!==y.stream)if(y){r[y.stream]||(r[y.stream]=new e.MediaStream,Object.defineProperty(r[y.stream],"id",{get:function(){return y.stream}}));Object.defineProperty(f,"id",{get:function(){return y.track}});
var G=r[y.stream]}else r.default||(r.default=new e.MediaStream),G=r.default;G&&(m(f,G),D.associatedRemoteMediaStreams.push(G));t.push([f,M,G])}}else D.rtpReceiver&&D.rtpReceiver.track&&(D.associatedRemoteMediaStreams.forEach(function(a){var b=a.getTracks().find(function(a){return a.id===D.rtpReceiver.track.id});b&&q(b,a)}),D.associatedRemoteMediaStreams=[]);D.localCapabilities=c;D.remoteCapabilities=K;D.rtpReceiver=M;D.rtcpParameters=Y;D.sendEncodingParameters=u;D.recvEncodingParameters=x;d._transceive(d.transceivers[g],
!1,F)}}});void 0===d._dtlsRole&&(d._dtlsRole="offer"===a.type?"active":"passive");d._remoteDescription={type:a.type,sdp:a.sdp};"offer"===a.type?d._updateSignalingState("have-remote-offer"):d._updateSignalingState("stable");Object.keys(r).forEach(function(a){var b=r[a];if(b.getTracks().length){if(-1===d.remoteStreams.indexOf(b)){d.remoteStreams.push(b);var f=new Event("addstream");f.stream=b;e.setTimeout(function(){d._dispatchEvent("addstream",f)})}t.forEach(function(a){b.id===a[2].id&&c(d,a[0],a[1],
[b])})}});t.forEach(function(a){a[2]||c(d,a[0],a[1],[])});e.setTimeout(function(){d&&d.transceivers&&d.transceivers.forEach(function(a){a.iceTransport&&"new"===a.iceTransport.state&&0<a.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),a.iceTransport.addRemoteCandidate({}))})},4E3);return Promise.resolve()};r.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.stop();
a.dtlsTransport&&a.dtlsTransport.stop();a.rtpSender&&a.rtpSender.stop();a.rtpReceiver&&a.rtpReceiver.stop()});this._isClosed=!0;this._updateSignalingState("closed")};r.prototype._updateSignalingState=function(a){this.signalingState=a;a=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",a)};r.prototype._maybeFireNegotiationNeeded=function(){var a=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout(function(){if(a.needNegotiation){a.needNegotiation=
!1;var b=new Event("negotiationneeded");a._dispatchEvent("negotiationneeded",b)}},0))};r.prototype._updateIceConnectionState=function(){var a={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&!b.rejected&&a[b.iceTransport.state]++});var b="new";0<a.failed?b="failed":0<a.checking?b="checking":0<a.disconnected?b="disconnected":0<a.new?b="new":0<a.connected?b="connected":0<a.completed&&(b="completed");b!==this.iceConnectionState&&
(this.iceConnectionState=b,b=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",b))};r.prototype._updateConnectionState=function(){var a={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&b.dtlsTransport&&!b.rejected&&(a[b.iceTransport.state]++,a[b.dtlsTransport.state]++)});a.connected+=a.completed;var b="new";0<a.failed?b="failed":0<a.connecting?b="connecting":0<a.disconnected?b="disconnected":
0<a.new?b="new":0<a.connected&&(b="connected");b!==this.connectionState&&(this.connectionState=b,b=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",b))};r.prototype.createOffer=function(a){var b=this;if(b._isClosed)return Promise.reject(p("InvalidStateError","Can not call createOffer after close"));var c=b.transceivers.filter(function(a){return"audio"===a.kind}).length,g=b.transceivers.filter(function(a){return"video"===a.kind}).length;if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");
void 0!==a.offerToReceiveAudio&&(c=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio);void 0!==a.offerToReceiveVideo&&(g=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(b.transceivers.forEach(function(a){"audio"===a.kind?(c--,0>c&&(a.wantReceive=!1)):"video"===a.kind&&(g--,0>g&&(a.wantReceive=!1))});0<c||0<g;)0<c&&(b._createTransceiver("audio"),c--),0<g&&(b._createTransceiver("video"),g--);var m=k.writeSessionBoilerplate(b._sdpSessionId,
b._sdpSessionVersion++);b.transceivers.forEach(function(a,c){var d=a.track,g=a.kind,m=a.mid||k.generateIdentifier();a.mid=m;a.iceGatherer||(a.iceGatherer=b._createIceGatherer(c,b.usingBundle));m=e.RTCRtpSender.getCapabilities(g);15019>l&&(m.codecs=m.codecs.filter(function(a){return"rtx"!==a.name}));m.codecs.forEach(function(b){"H264"===b.name&&void 0===b.parameters["level-asymmetry-allowed"]&&(b.parameters["level-asymmetry-allowed"]="1");a.remoteCapabilities&&a.remoteCapabilities.codecs&&a.remoteCapabilities.codecs.forEach(function(a){b.name.toLowerCase()===
a.name.toLowerCase()&&b.clockRate===a.clockRate&&(b.preferredPayloadType=a.payloadType)})});m.headerExtensions.forEach(function(b){(a.remoteCapabilities&&a.remoteCapabilities.headerExtensions||[]).forEach(function(a){b.uri===a.uri&&(b.id=a.id)})});c=a.sendEncodingParameters||[{ssrc:1001*(2*c+1)}];d&&15019<=l&&"video"===g&&!c[0].rtx&&(c[0].rtx={ssrc:c[0].ssrc+1});a.wantReceive&&(a.rtpReceiver=new e.RTCRtpReceiver(a.dtlsTransport,g));a.localCapabilities=m;a.sendEncodingParameters=c});"max-compat"!==
b._config.bundlePolicy&&(m+="a=group:BUNDLE "+b.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");m+="a=ice-options:trickle\r\n";b.transceivers.forEach(function(a,c){m+=d(a,a.localCapabilities,"offer",a.stream,b._dtlsRole);m+="a=rtcp-rsize\r\n";!a.iceGatherer||"new"===b.iceGatheringState||0!==c&&b.usingBundle||(a.iceGatherer.getLocalCandidates().forEach(function(a){a.component=1;m+="a="+k.writeCandidate(a)+"\r\n"}),"completed"===a.iceGatherer.state&&(m+="a=end-of-candidates\r\n"))});a=
new e.RTCSessionDescription({type:"offer",sdp:m});return Promise.resolve(a)};r.prototype.createAnswer=function(){var a=this;if(a._isClosed)return Promise.reject(p("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==a.signalingState&&"have-local-pranswer"!==a.signalingState)return Promise.reject(p("InvalidStateError","Can not call createAnswer in signalingState "+a.signalingState));var c=k.writeSessionBoilerplate(a._sdpSessionId,a._sdpSessionVersion++);a.usingBundle&&
(c+="a=group:BUNDLE "+a.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");c+="a=ice-options:trickle\r\n";var g=k.getMediaSections(a._remoteDescription.sdp).length;a.transceivers.forEach(function(e,k){if(!(k+1>g))if(e.rejected)"application"===e.kind?c="DTLS/SCTP"===e.protocol?c+"m=application 0 DTLS/SCTP 5000\r\n":c+("m=application 0 "+e.protocol+" webrtc-datachannel\r\n"):"audio"===e.kind?c+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(c+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),
c+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n";else{if(e.stream){var m;"audio"===e.kind?m=e.stream.getAudioTracks()[0]:"video"===e.kind&&(m=e.stream.getVideoTracks()[0]);m&&15019<=l&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1})}k=b(e.localCapabilities,e.remoteCapabilities);!k.codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx;
c+=d(e,k,"answer",e.stream,a._dtlsRole);e.rtcpParameters&&e.rtcpParameters.reducedSize&&(c+="a=rtcp-rsize\r\n")}});var m=new e.RTCSessionDescription({type:"answer",sdp:c});return Promise.resolve(m)};r.prototype.addIceCandidate=function(a){var b=this,c;return a&&void 0===a.sdpMLineIndex&&!a.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(d,e){if(b._remoteDescription)if(a&&""!==a.candidate){var g=a.sdpMLineIndex;if(a.sdpMid)for(var l=0;l<b.transceivers.length;l++)if(b.transceivers[l].mid===
a.sdpMid){g=l;break}var m=b.transceivers[g];if(m){if(m.rejected)return d();l=0<Object.keys(a.candidate).length?k.parseCandidate(a.candidate):{};if("tcp"===l.protocol&&(0===l.port||9===l.port)||l.component&&1!==l.component)return d();if((0===g||0<g&&m.iceTransport!==b.transceivers[0].iceTransport)&&!n(m.iceTransport,l))return e(p("OperationError","Can not add ICE candidate"));e=a.candidate.trim();0===e.indexOf("a=")&&(e=e.substr(2));c=k.getMediaSections(b._remoteDescription.sdp);c[g]+="a="+(l.type?
e:"end-of-candidates")+"\r\n";b._remoteDescription.sdp=k.getDescription(b._remoteDescription.sdp)+c.join("")}else return e(p("OperationError","Can not add ICE candidate"))}else for(g=0;g<b.transceivers.length&&(b.transceivers[g].rejected||(b.transceivers[g].iceTransport.addRemoteCandidate({}),c=k.getMediaSections(b._remoteDescription.sdp),c[g]+="a=end-of-candidates\r\n",b._remoteDescription.sdp=k.getDescription(b._remoteDescription.sdp)+c.join(""),!b.usingBundle));g++);else return e(p("InvalidStateError",
"Can not add ICE candidate without a remote description"));d()})};r.prototype.getStats=function(a){if(a&&a instanceof e.MediaStreamTrack){var b=null;this.transceivers.forEach(function(c){c.rtpSender&&c.rtpSender.track===a?b=c.rtpSender:c.rtpReceiver&&c.rtpReceiver.track===a&&(b=c.rtpReceiver)});if(!b)throw p("InvalidAccessError","Invalid selector.");return b.getStats()}var c=[];this.transceivers.forEach(function(a){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(b){a[b]&&
c.push(a[b].getStats())})});return Promise.all(c).then(function(a){var b=new Map;a.forEach(function(a){a.forEach(function(a){b.set(a.id,a)})});return b})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(a){if((a=e[a])&&a.prototype&&a.prototype.getStats){var b=a.prototype.getStats;a.prototype.getStats=function(){return b.apply(this).then(function(a){var b=new Map;Object.keys(a).forEach(function(c){var d=a[c];a[c].type={inboundrtp:"inbound-rtp",
outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type;b.set(c,a[c])});return b})}}});var t=["createOffer","createAnswer"];t.forEach(function(a){var b=r.prototype[a];r.prototype[a]=function(){var a=arguments;return"function"===typeof a[0]||"function"===typeof a[1]?b.apply(this,[arguments[2]]).then(function(b){"function"===typeof a[0]&&a[0].apply(null,[b])},function(b){"function"===typeof a[1]&&a[1].apply(null,
[b])}):b.apply(this,arguments)}});t=["setLocalDescription","setRemoteDescription","addIceCandidate"];t.forEach(function(a){var b=r.prototype[a];r.prototype[a]=function(){var a=arguments;return"function"===typeof a[1]||"function"===typeof a[2]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)},function(b){"function"===typeof a[2]&&a[2].apply(null,[b])}):b.apply(this,arguments)}});["getStats"].forEach(function(a){var b=r.prototype[a];r.prototype[a]=function(){var a=
arguments;return"function"===typeof a[1]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)}):b.apply(this,arguments)}});return r}},{sdp:17}],17:[function(e,l,m){var d={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};d.localCName=d.generateIdentifier();d.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})};d.splitSections=function(a){return a.split("\nm=").map(function(a,d){return(0<d?"m="+a:a).trim()+
"\r\n"})};d.getDescription=function(a){return(a=d.splitSections(a))&&a[0]};d.getMediaSections=function(a){a=d.splitSections(a);a.shift();return a};d.matchPrefix=function(a,b){return d.splitLines(a).filter(function(a){return 0===a.indexOf(b)})};d.parseCandidate=function(a){a=0===a.indexOf("a=candidate:")?a.substring(12).split(" "):a.substring(10).split(" ");for(var b={foundation:a[0],component:parseInt(a[1],10),protocol:a[2].toLowerCase(),priority:parseInt(a[3],10),ip:a[4],address:a[4],port:parseInt(a[5],
10),type:a[7]},d=8;d<a.length;d+=2)switch(a[d]){case "raddr":b.relatedAddress=a[d+1];break;case "rport":b.relatedPort=parseInt(a[d+1],10);break;case "tcptype":b.tcpType=a[d+1];break;case "ufrag":b.ufrag=a[d+1];b.usernameFragment=a[d+1];break;default:b[a[d]]=a[d+1]}return b};d.writeCandidate=function(a){var b=[];b.push(a.foundation);b.push(a.component);b.push(a.protocol.toUpperCase());b.push(a.priority);b.push(a.address||a.ip);b.push(a.port);var d=a.type;b.push("typ");b.push(d);"host"!==d&&a.relatedAddress&&
a.relatedPort&&(b.push("raddr"),b.push(a.relatedAddress),b.push("rport"),b.push(a.relatedPort));a.tcpType&&"tcp"===a.protocol.toLowerCase()&&(b.push("tcptype"),b.push(a.tcpType));if(a.usernameFragment||a.ufrag)b.push("ufrag"),b.push(a.usernameFragment||a.ufrag);return"candidate:"+b.join(" ")};d.parseIceOptions=function(a){return a.substr(14).split(" ")};d.parseRtpMap=function(a){a=a.substr(9).split(" ");var b={payloadType:parseInt(a.shift(),10)};a=a[0].split("/");b.name=a[0];b.clockRate=parseInt(a[1],
10);b.channels=3===a.length?parseInt(a[2],10):1;b.numChannels=b.channels;return b};d.writeRtpMap=function(a){var b=a.payloadType;void 0!==a.preferredPayloadType&&(b=a.preferredPayloadType);var d=a.channels||a.numChannels||1;return"a=rtpmap:"+b+" "+a.name+"/"+a.clockRate+(1!==d?"/"+d:"")+"\r\n"};d.parseExtmap=function(a){a=a.substr(9).split(" ");return{id:parseInt(a[0],10),direction:0<a[0].indexOf("/")?a[0].split("/")[1]:"sendrecv",uri:a[1]}};d.writeExtmap=function(a){return"a=extmap:"+(a.id||a.preferredId)+
(a.direction&&"sendrecv"!==a.direction?"/"+a.direction:"")+" "+a.uri+"\r\n"};d.parseFmtp=function(a){for(var b={},d=a.substr(a.indexOf(" ")+1).split(";"),e=0;e<d.length;e++)a=d[e].trim().split("="),b[a[0].trim()]=a[1];return b};d.writeFmtp=function(a){var b="",d=a.payloadType;void 0!==a.preferredPayloadType&&(d=a.preferredPayloadType);if(a.parameters&&Object.keys(a.parameters).length){var e=[];Object.keys(a.parameters).forEach(function(b){a.parameters[b]?e.push(b+"="+a.parameters[b]):e.push(b)});
b+="a=fmtp:"+d+" "+e.join(";")+"\r\n"}return b};d.parseRtcpFb=function(a){a=a.substr(a.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}};d.writeRtcpFb=function(a){var b="",d=a.payloadType;void 0!==a.preferredPayloadType&&(d=a.preferredPayloadType);a.rtcpFeedback&&a.rtcpFeedback.length&&a.rtcpFeedback.forEach(function(a){b+="a=rtcp-fb:"+d+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"});return b};d.parseSsrcMedia=function(a){var b=a.indexOf(" "),d={ssrc:parseInt(a.substr(7,
b-7),10)},e=a.indexOf(":",b);-1<e?(d.attribute=a.substr(b+1,e-b-1),d.value=a.substr(e+1)):d.attribute=a.substr(b+1);return d};d.parseSsrcGroup=function(a){a=a.substr(13).split(" ");return{semantics:a.shift(),ssrcs:a.map(function(a){return parseInt(a,10)})}};d.getMid=function(a){if(a=d.matchPrefix(a,"a=mid:")[0])return a.substr(6)};d.parseFingerprint=function(a){a=a.substr(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1]}};d.getDtlsParameters=function(a,b){return{role:"auto",fingerprints:d.matchPrefix(a+
b,"a=fingerprint:").map(d.parseFingerprint)}};d.writeDtlsParameters=function(a,b){var d="a=setup:"+b+"\r\n";a.fingerprints.forEach(function(a){d+="a=fingerprint:"+a.algorithm+" "+a.value+"\r\n"});return d};d.getIceParameters=function(a,b){a=d.splitLines(a);a=a.concat(d.splitLines(b));return{usernameFragment:a.filter(function(a){return 0===a.indexOf("a=ice-ufrag:")})[0].substr(12),password:a.filter(function(a){return 0===a.indexOf("a=ice-pwd:")})[0].substr(10)}};d.writeIceParameters=function(a){return"a=ice-ufrag:"+
a.usernameFragment+"\r\na=ice-pwd:"+(a.password+"\r\n")};d.parseRtpParameters=function(a){for(var b={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},e=d.splitLines(a)[0].split(" "),l=3;l<e.length;l++){var m=e[l],k=d.matchPrefix(a,"a=rtpmap:"+m+" ")[0];if(k){k=d.parseRtpMap(k);var n=d.matchPrefix(a,"a=fmtp:"+m+" ");k.parameters=n.length?d.parseFmtp(n[0]):{};k.rtcpFeedback=d.matchPrefix(a,"a=rtcp-fb:"+m+" ").map(d.parseRtcpFb);b.codecs.push(k);switch(k.name.toUpperCase()){case "RED":case "ULPFEC":b.fecMechanisms.push(k.name.toUpperCase())}}}d.matchPrefix(a,
"a=extmap:").forEach(function(a){b.headerExtensions.push(d.parseExtmap(a))});return b};d.writeRtpDescription=function(a,b){var e="";e+="m="+a+" ";e+=0<b.codecs.length?"9":"0";e+=" UDP/TLS/RTP/SAVPF ";e+=b.codecs.map(function(a){return void 0!==a.preferredPayloadType?a.preferredPayloadType:a.payloadType}).join(" ")+"\r\n";e+="c=IN IP4 0.0.0.0\r\n";e+="a=rtcp:9 IN IP4 0.0.0.0\r\n";b.codecs.forEach(function(a){e+=d.writeRtpMap(a);e+=d.writeFmtp(a);e+=d.writeRtcpFb(a)});var l=0;b.codecs.forEach(function(a){a.maxptime>
l&&(l=a.maxptime)});0<l&&(e+="a=maxptime:"+l+"\r\n");e+="a=rtcp-mux\r\n";b.headerExtensions&&b.headerExtensions.forEach(function(a){e+=d.writeExtmap(a)});return e};d.parseRtpEncodingParameters=function(a){var b=[],e=d.parseRtpParameters(a),l=-1!==e.fecMechanisms.indexOf("RED"),m=-1!==e.fecMechanisms.indexOf("ULPFEC"),k=d.matchPrefix(a,"a=ssrc:").map(function(a){return d.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute}),n=0<k.length&&k[0].ssrc,r;k=d.matchPrefix(a,"a=ssrc-group:FID").map(function(a){return a.substr(17).split(" ").map(function(a){return parseInt(a,
10)})});0<k.length&&1<k[0].length&&k[0][0]===n&&(r=k[0][1]);e.codecs.forEach(function(a){"RTX"===a.name.toUpperCase()&&a.parameters.apt&&(a={ssrc:n,codecPayloadType:parseInt(a.parameters.apt,10)},n&&r&&(a.rtx={ssrc:r}),b.push(a),l&&(a=JSON.parse(JSON.stringify(a)),a.fec={ssrc:n,mechanism:m?"red+ulpfec":"red"},b.push(a)))});0===b.length&&n&&b.push({ssrc:n});var u=d.matchPrefix(a,"b=");u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substr(7),10):0===u[0].indexOf("b=AS:")?950*parseInt(u[0].substr(5),
10)-16E3:void 0,b.forEach(function(a){a.maxBitrate=u}));return b};d.parseRtcpParameters=function(a){var b={},e=d.matchPrefix(a,"a=ssrc:").map(function(a){return d.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute})[0];e&&(b.cname=e.value,b.ssrc=e.ssrc);e=d.matchPrefix(a,"a=rtcp-rsize");b.reducedSize=0<e.length;b.compound=0===e.length;a=d.matchPrefix(a,"a=rtcp-mux");b.mux=0<a.length;return b};d.parseMsid=function(a){var b=d.matchPrefix(a,"a=msid:");if(1===b.length)return a=b[0].substr(7).split(" "),
{stream:a[0],track:a[1]};a=d.matchPrefix(a,"a=ssrc:").map(function(a){return d.parseSsrcMedia(a)}).filter(function(a){return"msid"===a.attribute});if(0<a.length)return a=a[0].value.split(" "),{stream:a[0],track:a[1]}};d.generateSessionId=function(){return Math.random().toString().substr(2,21)};d.writeSessionBoilerplate=function(a,b,e){b=void 0!==b?b:2;a=a?a:d.generateSessionId();return"v=0\r\no="+(e||"thisisadapterortc")+" "+a+" "+b+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"};d.writeMediaSection=function(a,
b,e,l){b=d.writeRtpDescription(a.kind,b);b+=d.writeIceParameters(a.iceGatherer.getLocalParameters());b+=d.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===e?"actpass":"active");b+="a=mid:"+a.mid+"\r\n";b=a.direction?b+("a="+a.direction+"\r\n"):a.rtpSender&&a.rtpReceiver?b+"a=sendrecv\r\n":a.rtpSender?b+"a=sendonly\r\n":a.rtpReceiver?b+"a=recvonly\r\n":b+"a=inactive\r\n";a.rtpSender&&(e="msid:"+l.id+" "+a.rtpSender.track.id+"\r\n",b=b+("a="+e)+("a=ssrc:"+a.sendEncodingParameters[0].ssrc+
" "+e),a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+e,b+="a=ssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n"));b+="a=ssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+d.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(b+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+d.localCName+"\r\n");return b};d.getDirection=function(a,b){a=d.splitLines(a);for(var e=0;e<a.length;e++)switch(a[e]){case "a=sendrecv":case "a=sendonly":case "a=recvonly":case "a=inactive":return a[e].substr(2)}return b?
d.getDirection(b):"sendrecv"};d.getKind=function(a){return d.splitLines(a)[0].split(" ")[0].substr(2)};d.isRejected=function(a){return"0"===a.split(" ",2)[1]};d.parseMLine=function(a){a=d.splitLines(a)[0].substr(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}};d.parseOLine=function(a){a=d.matchPrefix(a,"o=")[0].substr(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}};d.isValidSDP=
function(a){if("string"!==typeof a||0===a.length)return!1;a=d.splitLines(a);for(var b=0;b<a.length;b++)if(2>a[b].length||"="!==a[b].charAt(1))return!1;return!0};"object"===typeof l&&(l.exports=d)},{}]},{},[1])(1)}()},function(l,r,n){n(83)(n(84))},function(l,r){l.exports=function(l){function e(e){"undefined"!==typeof console&&(console.error||console.log)("[Script Loader]",e)}try{"undefined"!==typeof execScript&&"undefined"!==typeof attachEvent&&"undefined"===typeof addEventListener?execScript(l):"undefined"!==
typeof eval?eval.call(null,l):e("EvalError: No eval function available")}catch(u){e(u)}}},function(l,r){l.exports="/* globals $$, jQuery, Elements, document, window, L */\n\n/**\n* Copyright 2013 Marc J. Schmidt. See the LICENSE file at the top-level\n* directory of this distribution and at\n* https://github.com/marcj/css-element-queries/blob/master/LICENSE.\n*/\nthis.L = this.L || {};\n\n/**\n * @param {HTMLElement} element\n * @param {String}      prop\n * @returns {String|Number}\n */\nL.GetComputedStyle = (computedElement, prop) => {\n  if (computedElement.currentStyle) {\n    return computedElement.currentStyle[prop];\n  } else if (window.getComputedStyle) {\n    return window.getComputedStyle(computedElement, null).getPropertyValue(prop);\n  }\n  return computedElement.style[prop];\n};\n\n/**\n *\n * @type {Function}\n * @constructor\n */\nL.ElementQueries = function ElementQueries() {\n  /**\n   *\n   * @param element\n   * @returns {Number}\n   */\n  function getEmSize(element = document.documentElement) {\n    const fontSize = L.GetComputedStyle(element, 'fontSize');\n    return parseFloat(fontSize) || 16;\n  }\n\n  /**\n   *\n   * @copyright https://github.com/Mr0grog/element-query/blob/master/LICENSE\n   *\n   * @param element\n   * @param value\n   * @param units\n   * @returns {*}\n   */\n  function convertToPx(element, originalValue) {\n    let vh;\n    let vw;\n    let chooser;\n    const units = originalValue.replace(/[0-9]*/, '');\n    const value = parseFloat(originalValue);\n    switch (units) {\n      case 'px':\n        return value;\n      case 'em':\n        return value * getEmSize(element);\n      case 'rem':\n        return value * getEmSize();\n      // Viewport units!\n      // According to http://quirksmode.org/mobile/tableViewport.html\n      // documentElement.clientWidth/Height gets us the most reliable info\n      case 'vw':\n        return (value * document.documentElement.clientWidth) / 100;\n      case 'vh':\n        return (value * document.documentElement.clientHeight) / 100;\n      case 'vmin':\n      case 'vmax':\n        vw = document.documentElement.clientWidth / 100;\n        vh = document.documentElement.clientHeight / 100;\n        chooser = Math[units === 'vmin' ? 'min' : 'max'];\n        return value * chooser(vw, vh);\n      default:\n        return value;\n      // for now, not supporting physical units (since they are just a set number of px)\n      // or ex/ch (getting accurate measurements is hard)\n    }\n  }\n\n  /**\n   *\n   * @param {HTMLElement} element\n   * @constructor\n   */\n  function SetupInformation(element) {\n    this.element = element;\n    this.options = [];\n    let i;\n    let j;\n    let option;\n    let width = 0;\n    let height = 0;\n    let value;\n    let actualValue;\n    let attrValues;\n    let attrValue;\n    let attrName;\n\n    /**\n     * @param option {mode: 'min|max', property: 'width|height', value: '123px'}\n     */\n    this.addOption = (newOption) => {\n      this.options.push(newOption);\n    };\n\n    const attributes = ['min-width', 'min-height', 'max-width', 'max-height'];\n\n    /**\n     * Extracts the computed width/height and sets to min/max- attribute.\n     */\n    this.call = () => {\n      // extract current dimensions\n      width = this.element.offsetWidth;\n      height = this.element.offsetHeight;\n\n      attrValues = {};\n\n      for (i = 0, j = this.options.length; i < j; i += 1) {\n        option = this.options[i];\n        value = convertToPx(this.element, option.value);\n\n        actualValue = option.property === 'width' ? width : height;\n        attrName = `${option.mode}-${option.property}`;\n        attrValue = '';\n\n        if (option.mode === 'min' && actualValue >= value) {\n          attrValue += option.value;\n        }\n\n        if (option.mode === 'max' && actualValue <= value) {\n          attrValue += option.value;\n        }\n\n        if (!attrValues[attrName]) attrValues[attrName] = '';\n        if (attrValue && (` ${attrValues[attrName]} `)\n          .indexOf(` ${attrValue} `) === -1) {\n          attrValues[attrName] += ` ${attrValue}`;\n        }\n      }\n\n      for (let k = 0; k < attributes.length; k += 1) {\n        if (attrValues[attributes[k]]) {\n          this.element.setAttribute(\n            attributes[k],\n            attrValues[attributes[k]].substr(1),\n          );\n        } else {\n          this.element.removeAttribute(attributes[k]);\n        }\n      }\n    };\n  }\n\n  /**\n   * @param {HTMLElement} element\n   * @param {Object}      options\n   */\n  function setupElement(originalElement, options) {\n    const element = originalElement;\n    if (element.elementQueriesSetupInformation) {\n      element.elementQueriesSetupInformation.addOption(options);\n    } else {\n      element.elementQueriesSetupInformation = new SetupInformation(element);\n      element.elementQueriesSetupInformation.addOption(options);\n      element.sensor = new L.ResizeSensor(element, () => {\n        element.elementQueriesSetupInformation.call();\n      });\n    }\n    element.elementQueriesSetupInformation.call();\n    return element;\n  }\n\n  /**\n   * @param {String} selector\n   * @param {String} mode min|max\n   * @param {String} property width|height\n   * @param {String} value\n   */\n  function queueQuery(selector, mode, property, value) {\n    let query;\n    if (document.querySelectorAll) query = document.querySelectorAll.bind(document);\n    if (!query && typeof $$ !== 'undefined') query = $$;\n    if (!query && typeof jQuery !== 'undefined') query = jQuery;\n\n    if (!query) {\n      throw new Error('No document.querySelectorAll, jQuery or Mootools\\'s $$ found.');\n    }\n\n    const elements = query(selector) || [];\n    for (let i = 0, j = elements.length; i < j; i += 1) {\n      elements[i] = setupElement(elements[i], {\n        mode,\n        property,\n        value,\n      });\n    }\n  }\n\n  const regex = /,?([^,\\n]*)\\[[\\s\\t]*(min|max)-(width|height)[\\s\\t]*[~$^]?=[\\s\\t]*\"([^\"]*)\"[\\s\\t]*]([^\\n\\s{]*)/mgi; // jshint ignore:line\n\n  /**\n   * @param {String} css\n   */\n  function extractQuery(originalCss) {\n    let match;\n    const css = originalCss.replace(/'/g, '\"');\n    while ((match = regex.exec(css)) !== null) {\n      if (match.length > 5) {\n        queueQuery(match[1] || match[5], match[2], match[3], match[4]);\n      }\n    }\n  }\n\n  /**\n   * @param {CssRule[]|String} rules\n   */\n  function readRules(originalRules) {\n    if (!originalRules) {\n      return;\n    }\n    let selector = '';\n    let rules = originalRules;\n    if (typeof originalRules === 'string') {\n      rules = originalRules.toLowerCase();\n      if (rules.indexOf('min-width') !== -1 || rules.indexOf('max-width') !== -1) {\n        extractQuery(rules);\n      }\n    } else {\n      for (let i = 0, j = rules.length; i < j; i += 1) {\n        if (rules[i].type === 1) {\n          selector = rules[i].selectorText || rules[i].cssText;\n          if (selector.indexOf('min-height') !== -1 ||\n            selector.indexOf('max-height') !== -1) {\n            extractQuery(selector);\n          } else if (selector.indexOf('min-width') !== -1 ||\n            selector.indexOf('max-width') !== -1) {\n            extractQuery(selector);\n          }\n        } else if (rules[i].type === 4) {\n          readRules(rules[i].cssRules || rules[i].rules);\n        }\n      }\n    }\n  }\n\n  /**\n   * Searches all css rules and setups the event listener\n   * to all elements with element query rules..\n   */\n  this.init = () => {\n    const styleSheets = document.styleSheets || [];\n    for (let i = 0, j = styleSheets.length; i < j; i += 1) {\n      readRules(styleSheets[i].cssText ||\n        styleSheets[i].cssRules ||\n        styleSheets[i].rules);\n    }\n  };\n};\n\nfunction init() {\n  (new L.ElementQueries()).init();\n}\n\nif (window.addEventListener) {\n  window.addEventListener('load', init, false);\n} else {\n  window.attachEvent('onload', init);\n}\n\n/**\n * Iterate over each of the provided element(s).\n *\n * @param {HTMLElement|HTMLElement[]} elements\n * @param {Function}                  callback\n */\nfunction forEachElement(elements, callback = () => { }) {\n  const elementsType = Object.prototype.toString.call(elements);\n  const isCollectionTyped = (elementsType === '[object Array]' ||\n    (elementsType === '[object NodeList]') ||\n    (elementsType === '[object HTMLCollection]') ||\n    (typeof jQuery !== 'undefined' && elements instanceof jQuery) || // jquery\n    (typeof Elements !== 'undefined' && elements instanceof Elements) // mootools\n  );\n  let i = 0;\n  const j = elements.length;\n  if (isCollectionTyped) {\n    for (; i < j; i += 1) {\n      callback(elements[i]);\n    }\n  } else {\n    callback(elements);\n  }\n}\n/**\n * Class for dimension change detection.\n *\n * @param {Element|Element[]|Elements|jQuery} element\n * @param {Function} callback\n *\n * @constructor\n */\nL.ResizeSensor = function ResizeSensor(element, callback = () => { }) {\n  /**\n   *\n   * @constructor\n   */\n  function EventQueue() {\n    let q = [];\n    this.add = (ev) => {\n      q.push(ev);\n    };\n\n    let i;\n    let j;\n    this.call = () => {\n      for (i = 0, j = q.length; i < j; i += 1) {\n        q[i].call();\n      }\n    };\n\n    this.remove = (ev) => {\n      const newQueue = [];\n      for (i = 0, j = q.length; i < j; i += 1) {\n        if (q[i] !== ev) newQueue.push(q[i]);\n      }\n      q = newQueue;\n    };\n\n    this.length = () => q.length;\n  }\n\n  /**\n   *\n   * @param {HTMLElement} element\n   * @param {Function}    resized\n   */\n  function attachResizeEvent(htmlElement, resized) {\n    // Only used for the dirty checking, so the event callback count is limted\n    //  to max 1 call per fps per sensor.\n    // In combination with the event based resize sensor this saves cpu time,\n    // because the sensor is too fast and\n    // would generate too many unnecessary events.\n    const customRequestAnimationFrame = window.requestAnimationFrame ||\n      window.mozRequestAnimationFrame ||\n      window.webkitRequestAnimationFrame ||\n      function delay(fn) {\n        return window.setTimeout(fn, 20);\n      };\n\n    const newElement = htmlElement;\n    if (!newElement.resizedAttached) {\n      newElement.resizedAttached = new EventQueue();\n      newElement.resizedAttached.add(resized);\n    } else if (newElement.resizedAttached) {\n      newElement.resizedAttached.add(resized);\n      return;\n    }\n\n    newElement.resizeSensor = document.createElement('div');\n    newElement.resizeSensor.className = 'resize-sensor';\n    const style = 'position: absolute; left: 0; top: 0; right: 0; bottom: 0; ' +\n      'overflow: hidden; z-index: -1; visibility: hidden;';\n    const styleChild = 'position: absolute; left: 0; top: 0; transition: 0s;';\n\n    newElement.resizeSensor.style.cssText = style;\n    newElement.resizeSensor.innerHTML =\n      `<div class=\"resize-sensor-expand\" style=\"${style}\">` +\n      `<div style=\"${styleChild}\"></div>` +\n      '</div>' +\n      `<div class=\"resize-sensor-shrink\" style=\"${style}\">` +\n      `<div style=\"${styleChild} width: 200%; height: 200%\"></div>` +\n      '</div>';\n    newElement.appendChild(newElement.resizeSensor);\n\n    if (L.GetComputedStyle(newElement, 'position') === 'static') {\n      newElement.style.position = 'relative';\n    }\n\n    const expand = newElement.resizeSensor.childNodes[0];\n    const expandChild = expand.childNodes[0];\n    const shrink = newElement.resizeSensor.childNodes[1];\n\n    const reset = () => {\n      expandChild.style.width = `${100000}px`;\n      expandChild.style.height = `${100000}px`;\n\n      expand.scrollLeft = 100000;\n      expand.scrollTop = 100000;\n\n      shrink.scrollLeft = 100000;\n      shrink.scrollTop = 100000;\n    };\n\n    reset();\n    let dirty = false;\n\n    const dirtyChecking = () => {\n      if (!newElement.resizedAttached) return;\n\n      if (dirty) {\n        newElement.resizedAttached.call();\n        dirty = false;\n      }\n\n      customRequestAnimationFrame(dirtyChecking);\n    };\n\n    customRequestAnimationFrame(dirtyChecking);\n    let lastWidth;\n    let lastHeight;\n    let cachedWidth;\n    let cachedHeight; // useful to not query offsetWidth twice\n\n    const onScroll = () => {\n      if ((cachedWidth = newElement.offsetWidth) !== lastWidth ||\n        (cachedHeight = newElement.offsetHeight) !== lastHeight) {\n        dirty = true;\n\n        lastWidth = cachedWidth;\n        lastHeight = cachedHeight;\n      }\n      reset();\n    };\n\n    const addEvent = (el, name, cb) => {\n      if (el.attachEvent) {\n        el.attachEvent(`on${name}`, cb);\n      } else {\n        el.addEventListener(name, cb);\n      }\n    };\n\n    addEvent(expand, 'scroll', onScroll);\n    addEvent(shrink, 'scroll', onScroll);\n  }\n\n  forEachElement(element, (elem) => {\n    attachResizeEvent(elem, callback);\n  });\n\n  this.detach = (ev) => {\n    L.ResizeSensor.detach(element, ev);\n  };\n};\n\nL.ResizeSensor.detach = (element, ev) => {\n  forEachElement(element, (elem) => {\n    const elementItem = elem;\n    if (elementItem.resizedAttached && typeof ev === 'function') {\n      elementItem.resizedAttached.remove(ev);\n      if (elementItem.resizedAttached.length()) return;\n    }\n    if (elementItem.resizeSensor) {\n      if (elementItem.contains(elementItem.resizeSensor)) {\n        elementItem.removeChild(elementItem.resizeSensor);\n      }\n      delete elementItem.resizeSensor;\n      delete elementItem.resizedAttached;\n    }\n  });\n};\n"}])["default"];

//# sourceMappingURL=EnxRtc.js.map